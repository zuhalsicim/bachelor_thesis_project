{
    "b9bf51c5e3af21242ac2e487": "SELECT d_items.label \nFROM d_items \nINNER JOIN inputevents ON d_items.itemid = inputevents.itemid \nWHERE inputevents.itemid = 10024 AND inputevents.totalamount > 0;",
    "71085ce4beef02dd87ed0ae5": "SELECT route, dose_unit_rx\nFROM prescriptions\nWHERE drug = 'amoxicillin';",
    "14282f53339c46daadec3a20": "SELECT \n  d_items.label AS item_label,\n  inputevents.itemid AS input_itemid,\n  inputevents.totalamount,\n  inputevents.totalamountuom AS input_totalamountuom\nFROM \n  inputevents\nINNER JOIN \n  d_items ON inputevents.itemid = d_items.itemid\nWHERE \n  inputevents.totalamount = 5.0 AND inputevents.totalamountuom = 'dL' AND d_items.label = 'D5W';",
    "776a4927e962a0f0d91d35e7": "SELECT T1.route\nFROM prescriptions AS T1\nJOIN d_items AS T2 ON T1.drug = T2.label\nWHERE T2.label = 'citrate dextrose 3% (acd-a) crrt';",
    "e80f4420e687a67930a3fe82": "SELECT d_items.label, d_items.abbreviation, d_items.linksto\nFROM prescriptions\nJOIN d_items ON prescriptions.drug = d_items.label\nWHERE prescriptions.drug = 'tamoxifen citrate';",
    "76e23fd708f338036f1db3a5": "select the `route` column from the `prescriptions` table where the `drug` column matches 'Tramadol'.",
    "1a02966a7807415ea5d44f3e": "SELECT DISTINCT route\nFROM prescriptions\nWHERE drug = 'midodrine';",
    "6360cf590c61b892d228aec3": "SELECT cost\nFROM cost\nWHERE event_type = 'Procedure'\nAND event_id IN (\n  SELECT row_id\n  FROM procedures_icd\n  WHERE icd_code IN (\n    SELECT icd_code\n    FROM d_icd_procedures\n    WHERE long_title = 'Other incision of brain'\n  )\n);",
    "fbcce2387805995ccfb14da7": "SELECT cost.cost\nFROM cost\nJOIN procedures_icd ON cost.event_id = procedures_icd.row_id\nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE d_icd_procedures.long_title = 'Left Heart Cardiac Catheterization';",
    "5d3fdd6cfa3395ed7d31a509": "SELECT \n    SUM(c.cost) AS total_cost\nFROM \n    d_icd_procedures p\nJOIN \n    procedures_icd icd ON p.icd_code = icd.icd_code\nJOIN \n    cost c ON icd.hadm_id = c.hadm_id AND c.event_type = 'procedure'\nWHERE \n    p.long_title = 'alcohol detoxification';",
    "ea5ae93b3e09584a70590863": "SELECT c.cost\nFROM cost AS c\nJOIN d_icd_procedures AS p ON c.event_id = p.row_id\nWHERE c.event_type = 'Procedure'\nAND p.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach';",
    "3dad9658c00a426a28cd032a": "SELECT cost\nFROM cost\nINNER JOIN diagnoses_icd ON cost.event_id = diagnoses_icd.row_id\nINNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title = 'Catheter-based invasive electrophysiology';",
    "23f5cb31ebe9cc2a949960b0": "SELECT cost\nFROM cost\nJOIN procedures_icd ON cost.event_id = procedures_icd.row_id\nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE d_icd_procedures.long_title = 'Arteriography of Femoral and Other Lower Extremity Arteries';",
    "7c477af3b36987109db0d925": "SELECT icd_code \n   FROM d_icd_procedures \n   WHERE long_title = 'repair of rectocele with graft or prosthesis';",
    "6fd97088e685ba9d993b674a": "SELECT \n    (SUM(CASE WHEN stoptime IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS selling_rate\nFROM \n    prescriptions\nWHERE \n    drug = 'acetaminophen-caff-butalbital';",
    "e24decfb710d3c3dc6eab1d8": "SELECT dose_unit_rx\nFROM prescriptions\nWHERE drug = 'multivitamin' AND route = 'iv';",
    "3cf3b888f16e871e3f5f181c": "SELECT dose_val_rx AS price\nFROM prescriptions\nWHERE drug = 'Vial';",
    "a69dfee809d4c6a558d663e8": "SELECT cost\nFROM cost\nJOIN prescriptions ON cost.event_id = prescriptions.row_id\nWHERE prescriptions.drug = 'ferrous sulfate (liquid)';",
    "3a42a1f5b0ab7a9b081c5484": "SELECT cost\nFROM cost\nWHERE event_type = 'drug' AND event_id IN (\n  SELECT row_id\n  FROM prescriptions\n  WHERE drug = 'lactulose'\n);",
    "451285f64c11d4d19cbf2a11": "SELECT T1.price\nFROM prescriptions AS T1\nJOIN d_items AS T2 ON T1.drug = T2.label\nWHERE T2.label = 'vitamin e';",
    "ab2b79aa3faaaa7c9d7f7f40": "SELECT c.cost \nFROM cost AS c\nINNER JOIN prescriptions AS p ON c.event_id = p.row_id\nWHERE p.drug = 'buspirone';",
    "a635207e9ad6b0adfff52120": "",
    "37d5cb2d101d086c45aae957": "",
    "a8225cc86d80b3c2bcb42899": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses d_icd ON d.icd_code = d_icd.icd_code\nWHERE d_icd.long_title = 'Splenomegaly';",
    "6e81a82c2e87daa57c7ae655": "SELECT \n  T4.cost\nFROM \n  d_icd_diagnoses AS T1\n  INNER JOIN diagnoses_icd AS T2 ON T1.icd_code = T2.icd_code\n  INNER JOIN cost AS T4 ON T2.hadm_id = T4.hadm_id\nWHERE \n  T1.long_title = 'dependence on respirator [ventilator] status';",
    "1c82eecbdc0ba4bcb2d34047": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Other primary cardiomyopathies';",
    "fc0f5148afa412b85497beb3": "SELECT SUM(cost)\nFROM cost\nJOIN diagnoses_icd ON cost.event_id = diagnoses_icd.row_id\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title = 'Septicemia due to Escherichia coli [E. coli]';",
    "6594b2ea56fc3dde1c9203af": "SELECT c.cost\nFROM cost c\nINNER JOIN diagnoses_icd d ON c.event_id = d.row_id\nINNER JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\nWHERE ddi.long_title = 'Candidiasis of mouth';",
    "cc2d0e8abf70d2897312faf2": "SELECT gender\nFROM patients\nWHERE row_id = 10014078;",
    "caf2ed4e7d85cf6d0cba15f8": "SELECT gender\nFROM patients\nWHERE subject_id = 10005866;",
    "7a8719784f36b469832da18e": "SELECT gender\nFROM patients\nWHERE subject_id = 10014078;",
    "0e38c978a69e475449c84fee": "SELECT gender\nFROM patients\nWHERE subject_id = 10037975;",
    "cc30aba23d4b59298a12f192": "SELECT gender \nFROM patients \nWHERE subject_id = 10038933;",
    "261994390f6de9839143e6eb": "SELECT gender \nFROM patients \nWHERE subject_id = 10014354;",
    "2d6aa3feeed3bfeb72da5fb2": "SELECT gender\nFROM patients\nWHERE subject_id = 10005348;",
    "cd552ac1f210bf943008ccac": "",
    "7e1617588226f306caaf252b": "SELECT dob \nFROM patients \nWHERE subject_id = 10007928;",
    "11f75d0b44ffab8233b7f684": "SELECT dob\nFROM patients\nWHERE subject_id = 10022281;",
    "16247191e328f040590ae2fc": "SELECT dob \nFROM patients \nWHERE subject_id = 10019568;",
    "d395d70704b10b00a4f7f1af": "SELECT dob\nFROM patients\nWHERE subject_id = 10019172;",
    "eddba4d41895f6e1c03c2a52": "SELECT dob\nFROM patients\nWHERE subject_id = 10022017;",
    "9b7032c149a5ae595cfcdf73": "SELECT dob FROM patients WHERE subject_id = 10004457;",
    "28df618041d9cc5a95d8c30d": "SELECT \n    T1.subject_id, \n    MIN(T1.charttime) AS FirstChartTime,\n    MAX(T1.charttime) AS LastChartTime,\n    T2.valuenum AS FirstValuenum,\n    T3.valuenum AS LastValuenum,\n    (T3.valuenum - T2.valuenum) AS DeltaValuenum\nFROM \n    chartevents T1\nINNER JOIN \n    d_items T4 ON T1.itemid = T4.itemid\nINNER JOIN \n    chartevents T2 ON T1.subject_id = T2.subject_id AND T1.itemid = T2.itemid AND T2.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = T1.subject_id AND itemid = T4.itemid)\nINNER JOIN \n    chartevents T3 ON T1.subject_id = T3.subject_id AND T1.itemid = T3.itemid AND T3.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = T1.subject_id AND itemid = T4.itemid)\nWHERE \n    T1.subject_id = 10020944 AND T4.label = 'Weight' AND T2.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = T1.subject_id AND itemid = T4.itemid)\nGROUP BY \n    T1.subject_id;",
    "ac3aa786885a117e774dc77c": "WITH FirstAdmission AS (\n    SELECT \n        hadm_id\n    FROM admissions\n    WHERE subject_id = 10027602\n    ORDER BY admittime ASC\n    LIMIT 1\n),\nFirstChartEvent AS (\n    SELECT \n        ce.valuenum AS first_weight\n    FROM chartevents ce\n    INNER JOIN d_items di ON ce.itemid = di.itemid\n    INNER JOIN FirstAdmission fa ON ce.hadm_id = fa.hadm_id\n    WHERE di.label = 'Patient Weight'\n    ORDER BY ce.charttime ASC\n    LIMIT 1\n),\nLastChartEvent AS (\n    SELECT \n        ce.valuenum AS last_weight\n    FROM chartevents ce\n    INNER JOIN d_items di ON ce.itemid = di.itemid\n    INNER JOIN FirstAdmission fa ON ce.hadm_id = fa.hadm_id\n    WHERE di.label = 'Patient Weight'\n    ORDER BY ce.charttime DESC\n    LIMIT 1\n)\nSELECT \n    first_weight,\n    last_weight\nFROM FirstChartEvent, LastChartEvent;",
    "97a564727fd229d0a1d9c3ba": "WITH WeightMeasurements AS (\n  SELECT\n    ce.subject_id,\n    ce.hadm_id,\n    ce.charttime,\n    ce.valuenum,\n    ROW_NUMBER() OVER (PARTITION BY ce.subject_id, ce.hadm_id ORDER BY ce.charttime) AS rank\n  FROM chartevents ce\n  JOIN d_items di ON ce.itemid = di.itemid\n  WHERE di.label = 'Weight'\n    AND ce.subject_id = 10027602\n    AND ce.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10027602 ORDER BY admittime DESC LIMIT 1)\n)\nSELECT\n  (SELECT valuenum FROM WeightMeasurements WHERE rank = 2) - (SELECT valuenum FROM WeightMeasurements WHERE rank = 1) AS weight_change\nFROM WeightMeasurements\nWHERE rank IN (1, 2);",
    "10e5776d6866e2b43f77a084": "",
    "350e7b3e88e232febb94440c": "WITH LastMeasurementsCTE AS (\n    SELECT \n        ce.charttime,\n        ce.valuenum,\n        ROW_NUMBER() OVER (ORDER BY ce.charttime DESC) AS rank\n    FROM \n        chartevents ce\n    JOIN \n        d_items di ON ce.itemid = di.itemid\n    WHERE \n        ce.subject_id = 10004422 AND di.label = 'Weight'\n)\nSELECT \n    (SELECT valuenum FROM LastMeasurementsCTE WHERE rank = 1) - \n    (SELECT valuenum FROM LastMeasurementsCTE WHERE rank = 2) AS weight_difference;",
    "dc7482ecedbaea3e549bc140": "SELECT\n    MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10027445) THEN ce.valuenum END) - \n    MIN(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10027445) THEN ce.valuenum END) AS weight_change\nFROM\n    chartevents ce\nWHERE\n    ce.subject_id = 10027445 AND\n    ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight' AND abbreviation = 'weight');",
    "9fee7ced768b7c2b796af2ce": "",
    "922e1796a0883763c0252e8b": "SELECT \n  ROUND(ABS(T1.valuenum - T2.valuenum), 2) AS difference\nFROM \n  labevents T1\nINNER JOIN \n  labevents T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id AND T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10002495\n  AND T1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Alkaline Phosphatase')\n  AND T2.charttime > T1.charttime\n  AND T2.row_id = (SELECT MIN(row_id) FROM labevents WHERE subject_id = 10002495 AND hadm_id = T1.hadm_id AND itemid = T1.itemid);",
    "efb37b1f8299f18af10b51ec": "SELECT \n    (SELECT value FROM chartevents WHERE subject_id = 10019568 AND itemid = 31 AND charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10019568 AND itemid = 31 LIMIT 1) LIMIT 1) - \n    (SELECT value FROM chartevents WHERE subject_id = 10019568 AND itemid = 31 AND charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10019568 AND itemid = 31 LIMIT 1) LIMIT 1) AS difference\nFROM chartevents\nWHERE subject_id = 10019568 AND itemid = 31;",
    "57c595ed27d732fb9989f76d": "selecting the relevant `valuenum` values from the `labevents` table and calculating the difference.",
    "f0713b333180377cd4e7a5ef": "SELECT \n    (SELECT valuenum \n     FROM labevents le \n     WHERE le.subject_id = 10015272 \n     AND le.itemid = (SELECT itemid \n                     FROM d_labitems \n                     WHERE label = 'Alkaline Phosphatase') \n     AND le.charttime = (SELECT MAX(charttime) \n                        FROM labevents \n                        WHERE subject_id = 10015272 \n                        AND itemid = (SELECT itemid \n                                      FROM d_labitems \n                                      WHERE label = 'Alkaline Phosphatase') \n                        AND charttime < (SELECT MIN(charttime) \n                                        FROM labevents \n                                        WHERE subject_id = 10015272 \n                                        AND itemid = (SELECT itemid \n                                                      FROM d_labitems \n                                                      WHERE label = 'Alkaline Phosphatase')))) \n    - (SELECT valuenum \n       FROM labevents le \n       WHERE le.subject_id = 10015272 \n       AND le.itemid = (SELECT itemid \n                       FROM d_labitems \n                       WHERE label = 'Alkaline Phosphatase') \n       AND le.charttime = (SELECT MIN(charttime) \n                          FROM labevents \n                          WHERE subject_id = 10015272 \n                          AND itemid = (SELECT itemid \n                                        FROM d_labitems \n                                        WHERE label = 'Alkaline Phosphatase'))) AS diff;",
    "01b66115a27e8ec4031d99ba": "WITH LastHospitalVisit AS (\n    SELECT \n        MAX(hadm_id) AS hadm_id\n    FROM \n        admissions\n    WHERE \n        subject_id = 10025612\n),\nCKMeasurements AS (\n    SELECT \n        le.charttime,\n        le.valuenum\n    FROM \n        labevents le\n    JOIN \n        d_labitems dl ON le.itemid = dl.itemid\n    JOIN \n        LastHospitalVisit lhv ON le.hadm_id = lhv.hadm_id\n    WHERE \n        dl.label = 'CK' AND le.subject_id = 10025612\n    ORDER BY \n        le.charttime\n),\nFirstSecondMeasurements AS (\n    SELECT \n        valuenum,\n        ROW_NUMBER() OVER (ORDER BY charttime) as row_num\n    FROM \n        CKMeasurements\n)\nSELECT \n    SUM(CASE WHEN row_num = 2 THEN valuenum ELSE 0 END) - \n    SUM(CASE WHEN row_num = 1 THEN valuenum ELSE 0 END) AS difference\nFROM \n    FirstSecondMeasurements\nWHERE \n    row_num IN (1, 2);",
    "beba7369b04f1b191db5f12e": "WITH HyalineCasts AS (\n    SELECT \n        l.subject_id,\n        l.hadm_id,\n        l.charttime,\n        l.valuenum,\n        ROW_NUMBER() OVER (PARTITION BY l.subject_id, l.hadm_id ORDER BY l.charttime) as rn_asc,\n        ROW_NUMBER() OVER (PARTITION BY l.subject_id, l.hadm_id ORDER BY l.charttime DESC) as rn_desc\n    FROM labevents l\n    INNER JOIN d_labitems di ON l.itemid = di.itemid\n    WHERE l.subject_id = 10021487 AND l.hadm_id = 123456 AND di.label = 'hyaline casts'\n),\nFirstValue AS (\n    SELECT \n        hc.subject_id,\n        hc.hadm_id,\n        hc.charttime,\n        hc.valuenum\n    FROM HyalineCasts hc\n    WHERE hc.rn_asc = 1\n),\nLastValue AS (\n    SELECT \n        hc.subject_id,\n        hc.hadm_id,\n        hc.charttime,\n        hc.valuenum\n    FROM HyalineCasts hc\n    WHERE hc.rn_desc = 1\n)\nSELECT \n    (lv.valuenum - fv.valuenum) AS change_in_hyaline_casts\nFROM FirstValue fv\nINNER JOIN LastValue lv ON fv.subject_id = lv.subject_id AND fv.hadm_id = lv.hadm_id;",
    "7e5e17dca306a105f47f9bb7": "WITH LastHospitalVisit AS (\n    SELECT \n        hadm_id, \n        MAX(admittime) AS last_admittime\n    FROM \n        admissions\n    WHERE \n        subject_id = 10002495\n    GROUP BY \n        hadm_id\n),\nTroponinTEvents AS (\n    SELECT \n        le.*\n    FROM \n        labevents le\n    INNER JOIN \n        LastHospitalVisit lhv ON le.hadm_id = lhv.hadm_id\n    INNER JOIN \n        d_labitems li ON le.itemid = li.itemid\n    WHERE \n        li.label = 'Troponin T' AND li.valueuom = 'ng/mL'\n),\nLastTwoTroponinT AS (\n    SELECT \n        le.charttime, \n        le.valuenum,\n        ROW_NUMBER() OVER (PARTITION BY le.hadm_id ORDER BY le.charttime DESC) AS rn\n    FROM \n        TroponinTEvents le\n)\nSELECT \n    (SELECT valuenum FROM LastTwoTroponinT WHERE rn = 1) - (SELECT valuenum FROM LastTwoTroponinT WHERE rn = 2) AS difference_in_last_two_troponin_t_values;",
    "eed5de84751262898d675c22": "WITH icu_stays AS (\n    SELECT \n        icu.stay_id,\n        icu.subject_id,\n        icu.intime,\n        icu.outtime\n    FROM icustays icu\n    WHERE icu.subject_id = 10037975\n),\nspo2_measurements AS (\n    SELECT \n        ch.itemid,\n        ch.charttime,\n        ch.valuenum AS spo2_value,\n        icu.stay_id,\n        ROW_NUMBER() OVER (PARTITION BY icu.stay_id ORDER BY ch.charttime) AS rn\n    FROM chartevents ch\n    JOIN icu_stays icu ON ch.stay_id = icu.stay_id\n    WHERE ch.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\n),\nfirst_icu_visit AS (\n    SELECT \n        stay_id\n    FROM icu_stays\n    ORDER BY intime\n    LIMIT 1\n),\nfirst_visit_spo2 AS (\n    SELECT \n        spo2_value,\n        ROW_NUMBER() OVER (ORDER BY charttime DESC) AS rn\n    FROM spo2_measurements\n    WHERE stay_id = (SELECT stay_id FROM first_icu_visit)\n)\nSELECT \n    MAX(CASE WHEN rn = 1 THEN spo2_value END) - \n    MAX(CASE WHEN rn = 2 THEN spo2_value END) AS spo2_change\nFROM first_visit_spo2\nWHERE rn <= 2;",
    "6b3760b9b37e0bb8f9e647f8": "WITH FirstICUStay AS (\n    SELECT \n        icu.stay_id,\n        icu.intime,\n        icu.outtime,\n        chrt.charttime,\n        chrt.valuenum AS heart_rate\n    FROM \n        icustays icu\n    JOIN \n        chartevents chrt ON icu.stay_id = chrt.stay_id\n    WHERE \n        icu.subject_id = 10014729  \n        AND chrt.itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n        AND icu.first_careunit IS NOT NULL\n    ORDER BY \n        chrt.charttime\n),\nFirstHeartRate AS (\n    SELECT \n        heart_rate AS first_heart_rate\n    FROM \n        FirstICUStay\n    WHERE \n        charttime = (SELECT MIN(charttime) FROM FirstICUStay)\n),\nLastHeartRate AS (\n    SELECT \n        heart_rate AS last_heart_rate\n    FROM \n        FirstICUStay\n    WHERE \n        charttime = (SELECT MAX(charttime) FROM FirstICUStay)\n)\nSELECT \n    fhr.first_heart_rate,\n    lhr.last_heart_rate,\n    (lhr.last_heart_rate - fhr.first_heart_rate) AS heart_rate_change\nFROM \n    FirstHeartRate fhr\nCROSS JOIN \n    LastHeartRate lhr;",
    "a2438ede03e572f4af4fcd58": "WITH first_icu_stay AS (\n    SELECT stay_id\n    FROM icustays\n    WHERE subject_id = 10010471\n    ORDER BY intime\n    LIMIT 1\n),\nheart_rate_measurements AS (\n    SELECT\n        c.charttime,\n        c.valuenum AS heart_rate\n    FROM\n        chartevents c\n    JOIN\n        first_icu_stay f ON c.stay_id = f.stay_id\n    WHERE\n        c.subject_id = 10010471\n        AND c.itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n)\nSELECT\n    MAX(heart_rate) - MIN(heart_rate) AS heart_rate_change\nFROM\n    heart_rate_measurements;",
    "941095e5c2a9df6746e4a383": "WITH FirstICUStay AS (\n    SELECT stay_id\n    FROM icustays\n    WHERE subject_id = 10001725\n    ORDER BY intime ASC\n    LIMIT 1\n),\nFirstICULabEvents AS (\n    SELECT l.labevents.row_id, l.subject_id, l.hadm_id, l.charttime, l.itemid, l.valuenum, l.valueuom\n    FROM labevents l\n    JOIN d_labitems d ON l.itemid = d.itemid\n    WHERE l.subject_id = 10001725 AND l.hadm_id IN (SELECT hadm_id FROM icustays WHERE stay_id = (SELECT stay_id FROM FirstICUStay))\n      AND d.label = 'SpO2'\n),\nLastAndSecondLastLabEvents AS (\n    SELECT\n        LEAD(LEAD(valuenum, 1, NULL) OVER (ORDER BY charttime DESC)) OVER (ORDER BY charttime DESC) AS last_valuenum,\n        LEAD(valuenum, 1, NULL) OVER (ORDER BY charttime DESC) AS second_last_valuenum\n    FROM FirstICULabEvents\n)\nSELECT last_valuenum - second_last_valuenum AS difference\nFROM LastAndSecondLastLabEvents\nLIMIT 1;",
    "b5ddccb2652019203e02c96e": "SELECT MAX(stay_id) AS last_stay_id\n   FROM icustays\n   WHERE subject_id = 10003046;",
    "9ea8c0016a33c461c3a77f56": "WITH first_measurement AS (\n    SELECT \n        valuenum AS first_valuenum\n    FROM \n        chartevents ce\n    INNER JOIN \n        d_items di ON ce.itemid = di.itemid\n    WHERE \n        ce.subject_id = 10037975 AND \n        di.label = 'Systolic Blood Pressure' AND \n        ce.charttime = (\n            SELECT \n                MIN(charttime)\n            FROM \n                chartevents\n            WHERE \n                subject_id = 10037975 AND \n                itemid = (\n                    SELECT \n                        itemid \n                    FROM \n                        d_items \n                    WHERE \n                        label = 'Systolic Blood Pressure'\n                )\n        )\n),\nsecond_measurement AS (\n    SELECT \n        valuenum AS second_valuenum\n    FROM \n        chartevents ce\n    INNER JOIN \n        d_items di ON ce.itemid = di.itemid\n    WHERE \n        ce.subject_id = 10037975 AND \n        di.label = 'Systolic Blood Pressure' AND \n        ce.charttime = (\n            SELECT \n                MIN(charttime)\n            FROM \n                chartevents\n            WHERE \n                subject_id = 10037975 AND \n                itemid = (\n                    SELECT \n                        itemid \n                    FROM \n                        d_items \n                    WHERE \n                        label = 'Systolic Blood Pressure'\n                ) AND \n                charttime > (\n                    SELECT \n                        MIN(charttime)\n                    FROM \n                        chartevents\n                    WHERE \n                        subject_id = 10037975 AND \n                        itemid = (\n                            SELECT \n                                itemid \n                            FROM \n                                d_items \n                            WHERE \n                                label = 'Systolic Blood Pressure'\n                        )\n                )\n        )\n),\nicu_stay AS (\n    SELECT \n        stay_id\n    FROM \n        icustays\n    WHERE \n        subject_id = 10037975 AND \n        stay_id = (\n            SELECT \n                MIN(stay_id)\n            FROM \n                icustays\n            WHERE \n                subject_id = 10037975\n        )\n)\nSELECT \n    first_valuenum, \n    second_valuenum, \n    (second_valuenum - first_valuenum) AS delta\nFROM \n    first_measurement, \n    second_measurement;",
    "5ae9eba9c11262b3bc8961b7": "",
    "617d9b7140ffa467be53e5b8": "",
    "769ea1c5d6c42c47ac9a1735": "SELECT \n    CASE \n        WHEN \n            (SELECT valuenum \n             FROM labevents le1 \n             WHERE le1.subject_id = 10036156 \n               AND le1.itemid = (SELECT itemid \n                                 FROM d_labitems \n                                 WHERE label = 'PLATELET COUNT') \n               AND le1.hadm_id = (SELECT hadm_id \n                                 FROM admissions \n                                 WHERE subject_id = 10036156 \n                                 ORDER BY admittime DESC \n                                 LIMIT 1) \n            ) > \n            (SELECT valuenum \n             FROM labevents le2 \n             WHERE le2.subject_id = 10036156 \n               AND le2.itemid = (SELECT itemid \n                                 FROM d_labitems \n                                 WHERE label = 'PLATELET COUNT') \n               AND le2.hadm_id = (SELECT hadm_id \n                                 FROM admissions \n                                 WHERE subject_id = 10036156 \n                                 ORDER BY admittime ASC \n                                 LIMIT 1) \n            ) \n        THEN 'Yes' \n        ELSE 'No' \n    END AS value_change",
    "ffc47b7e01463f229eb09bce": "SELECT \n    (SELECT l1.valuenum \n     FROM labevents l1 \n     WHERE l1.subject_id = 10021487 \n       AND l1.itemid = (SELECT itemid \n                       FROM d_labitems \n                       WHERE label = 'Calcium, Urine') \n       AND l1.charttime = (SELECT MIN(charttime) \n                          FROM labevents \n                          WHERE subject_id = 10021487 \n                            AND itemid = (SELECT itemid \n                                          FROM d_labitems \n                                          WHERE label = 'Calcium, Urine'))) \n    ) AS first_value,\n    (SELECT l2.valuenum \n     FROM labevents l2 \n     WHERE l2.subject_id = 10021487 \n       AND l2.itemid = (SELECT itemid \n                       FROM d_labitems \n                       WHERE label = 'Calcium, Urine') \n       AND l2.charttime = (SELECT MAX(charttime) \n                          FROM labevents \n                          WHERE subject_id = 10021487 \n                            AND itemid = (SELECT itemid \n                                          FROM d_labitems \n                                          WHERE label = 'Calcium, Urine'))) \n    ) AS last_value\nFROM \n    (SELECT 1) dummy\nWHERE \n    first_value < last_value;",
    "ac19aaffd02ad22588a7a6e7": "",
    "fd2b88c449aa3147d9ef22a9": "SELECT \n    CASE \n        WHEN T2.valuenum > T1.valuenum THEN 'greater'\n        WHEN T2.valuenum < T1.valuenum THEN 'less'\n        ELSE 'same'\n    END AS comparison_result\nFROM \n    labevents AS T1\nINNER JOIN \n    labevents AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10004733 AND\n    T2.subject_id = 10004733 AND\n    T1.hadm_id = T2.hadm_id AND\n    T1.charttime < T2.charttime AND\n    T1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Protein') AND\n    T2.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Protein');",
    "06ed0a3cc8ab3dc7839b7919": "",
    "96a829af0978aeef2a29366b": "",
    "b45fe4ea7ffaf00e84199e79": "SELECT\n    (SELECT valuenum\n     FROM chartevents\n     WHERE charttime = (\n         SELECT MAX(charttime)\n         FROM chartevents\n         WHERE subject_id = 10016742\n           AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')\n           AND stay_id = (SELECT MAX(stay_id)\n                          FROM chartevents\n                          WHERE subject_id = 10016742\n                            AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')))\n     AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')) AS last_value\n,\n    (SELECT valuenum\n     FROM chartevents\n     WHERE charttime = (\n         SELECT MIN(charttime)\n         FROM chartevents\n         WHERE subject_id = 10016742\n           AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')\n           AND stay_id = (SELECT MAX(stay_id)\n                          FROM chartevents\n                          WHERE subject_id = 10016742\n                            AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')))\n     AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')) AS first_value\n;",
    "0845eda9197d9666e0b3a017": "SELECT \n    T1.subject_id, \n    T1.charttime, \n    T1.value, \n    T1.valueuom\nFROM \n    outputevents AS T1\nJOIN \n    d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.subject_id = 10021118\n    AND T2.label = 'Arterial Blood Pressure, Diastolic'\n    AND T1.charttime IN (\n        SELECT charttime \n        FROM outputevents \n        WHERE subject_id = 10021118 \n        AND itemid = T1.itemid \n        ORDER BY charttime DESC \n        LIMIT 1, 1\n    );",
    "7a1c80e590227785f1b6c6a6": "SELECT \n    CASE \n        WHEN \n            (SELECT valuenum \n             FROM chartevents \n             WHERE itemid = (SELECT itemid \n                             FROM d_items \n                             WHERE label = 'o2 saturation pulseoxymetry') \n               AND subject_id = 10020944 \n               AND stay_id = (SELECT stay_id \n                             FROM icustays \n                             WHERE subject_id = 10020944 \n                             ORDER BY outtime DESC \n                             LIMIT 1)\n               ORDER BY charttime DESC \n               LIMIT 1) \n            < \n            (SELECT valuenum \n             FROM chartevents \n             WHERE itemid = (SELECT itemid \n                             FROM d_items \n                             WHERE label = 'o2 saturation pulseoxymetry') \n               AND subject_id = 10020944 \n               AND stay_id = (SELECT stay_id \n                             FROM icustays \n                             WHERE subject_id = 10020944 \n                             ORDER BY outtime DESC \n                             LIMIT 1 OFFSET 1)\n               ORDER BY charttime DESC \n               LIMIT 1) \n        THEN 'Yes' \n        ELSE 'No' \n    END AS result",
    "a4067779dc66a630f0290603": "WITH ICUStays AS (\n    SELECT stay_id, intime, outtime\n    FROM icustays\n    WHERE subject_id = 10019385\n),\nRecentMeasurements AS (\n    SELECT ce.charttime, ce.valuenum\n    FROM chartevents ce\n    INNER JOIN ICUStays icu ON ce.stay_id = icu.stay_id\n    WHERE ce.itemid = 226735  -- Respiratory rate\n    ORDER BY ce.charttime DESC\n    LIMIT 2\n)\nSELECT \n    (CASE WHEN rm1.valuenum > rm2.valuenum THEN 1 ELSE 0 END) AS is_greater\nFROM RecentMeasurements rm1, RecentMeasurements rm2\nWHERE rm1.charttime > rm2.charttime;",
    "5defc394d5a39a4bee811cf5": "SELECT \n    MAX(T1.charttime) AS last_icu_visit,\n    MAX(T2.charttime) AS first_icu_visit,\n    MAX(CASE WHEN T1.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10011398 AND itemid = 226734) THEN T1.valuenum ELSE NULL END) AS last_systolic,\n    MAX(CASE WHEN T2.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10011398 AND itemid = 226734) THEN T2.valuenum ELSE NULL END) AS first_systolic\nFROM \n    chartevents AS T1\nJOIN \n    chartevents AS T2 ON T1.subject_id = T2.subject_id AND T1.itemid = 226734 AND T2.itemid = 226734\nWHERE \n    T1.subject_id = 10011398 AND T2.subject_id = 10011398\n    AND T1.charttime <= (SELECT MAX(outtime) FROM icustays WHERE subject_id = 10011398)\n    AND T2.charttime <= (SELECT MAX(outtime) FROM icustays WHERE subject_id = 10011398);",
    "18712984cf426bc265ef3c86": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN icu_events.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10010471 AND itemid = d_items.itemid AND valueuom = 's saturation pulseoxymetry') \n                      THEN icu_events.valuenum ELSE NULL END) \n        >\n        MAX(CASE WHEN icu_events.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10010471 AND itemid = d_items.itemid AND valueuom = 's saturation pulseoxymetry') \n                      THEN icu_events.valuenum ELSE NULL END) \n        THEN 'greater' \n        ELSE 'not greater' \n    END AS comparison_result\nFROM chartevents icu_events\nJOIN d_items ON icu_events.itemid = d_items.itemid\nWHERE icu_events.subject_id = 10010471 AND d_items.label = 'o2 saturation pulseoxymetry' AND icu_events.charttime IN (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10010471 AND itemid = d_items.itemid);",
    "49096da9fc4db23df0c9ca94": "SELECT \n  c1.charttime AS last_measurement_time,\n  c1.valuenum AS last_measurement_value,\n  c2.charttime AS second_last_measurement_time,\n  c2.valuenum AS second_last_measurement_value\nFROM \n  chartevents c1\nJOIN \n  d_items d ON c1.itemid = d.itemid\nLEFT JOIN \n  chartevents c2 ON c1.subject_id = c2.subject_id AND c1.hadm_id = c2.hadm_id AND c1.itemid = c2.itemid\n  AND c2.charttime < c1.charttime\nWHERE \n  c1.subject_id = 10038999 \n  AND d.label = 'Respiratory Rate'\nORDER BY \n  c1.charttime DESC\nLIMIT 2;",
    "0aaf715cd38172a3fec8d22f": "SELECT a.age\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE p.subject_id = 10022281\nORDER BY a.dischtime DESC\nLIMIT 1;",
    "a5dc36ab0d9765ac8ab2b0be": "SELECT age\nFROM admissions\nWHERE subject_id = 10038992\nORDER BY admittime DESC\nLIMIT 1;",
    "6a0426303656887491909d29": "SELECT age\nFROM admissions\nWHERE subject_id = 10022041 AND hadm_id = (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10022041\n  ORDER BY admittime ASC\n  LIMIT 1\n);",
    "8f9bd64fc45fb2e7efce6e09": "",
    "7181a0d2584214c798eeebfb": "SELECT age\nFROM admissions\nWHERE subject_id = 10000032\nORDER BY admittime ASC\nLIMIT 1;",
    "cf80e026f450ba3b1f34afca": "SELECT age\nFROM admissions\nWHERE subject_id = 10035185\n  AND hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10035185);",
    "d0fede74514340f1c6713467": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10018328\nORDER BY hadm_id DESC\nLIMIT 1;",
    "f34840d2e5d80b70e76bfdec": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10004422\nAND admittime = (\n    SELECT MAX(admittime)\n    FROM admissions\n    WHERE subject_id = 10004422\n);",
    "33eb641aa295e6631d41c5b9": "SELECT T2.insurance\nFROM (\n  SELECT MAX(admittime) AS max_admittime\n  FROM admissions\n  WHERE subject_id = 10004720\n) AS T1\nINNER JOIN admissions T2 ON T1.max_admittime = T2.admittime AND T2.subject_id = 10004720;",
    "695375d6c1fa9fdcc62343bd": "selecting the necessary columns and checking the logic.",
    "cbb82c6ae494381e1e693100": "SELECT insurance\nFROM admissions\nWHERE hadm_id = (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10006053\n  ORDER BY dischtime DESC\n  LIMIT 1\n);",
    "8166e7dd802e75a9bb516018": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10022017\nORDER BY admittime ASC\nLIMIT 1;",
    "f6b19667a6aead364aac15bf": "SELECT insurance \nFROM admissions\nWHERE subject_id = 10023239 AND hadm_id = 1;",
    "6938ea8746e5138601dbdae7": "SELECT age FROM admissions WHERE subject_id = 10035185 AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10035185 ORDER BY admittime LIMIT 1)",
    "b88b37ae5acfee6df9247dfb": "-- Step 1: Find the age of the patient with ID 10038081 during their last hospital visit\nWITH PatientAge AS (\n    SELECT \n        p.age\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE p.subject_id = 10038081\n    ORDER BY a.admittime DESC\n    LIMIT 1\n),\n\n-- Step 2: Find all lab test values for red blood cells tests for patients of the same age\nLabTestValues AS (\n    SELECT \n        l.subject_id,\n        l.charttime,\n        l.valuenum,\n        l.valueuom\n    FROM labevents l\n    INNER JOIN d_labitems d ON l.itemid = d.itemid\n    INNER JOIN patients p ON l.subject_id = p.subject_id\n    WHERE d.label = 'Laboratory - Red Blood Cells Test'\n    AND p.age = (SELECT age FROM PatientAge)\n)\n\n-- Step 3: Calculate the percentile of the 2.71 value among all values for red blood cells tests\nSELECT \n    PERCENT_RANK() OVER (ORDER BY valuenum) AS percentile\nFROM LabTestValues\nWHERE valuenum = 2.71;",
    "f90fbe1a6c278c3d4b3d2829": "",
    "01f54f272e5f4a9bc0a7232d": "WITH PatientAge AS (\n  SELECT \n    p.age\n  FROM \n    admissions p\n  WHERE \n    p.subject_id = 10008287\n  ORDER BY \n    p.admittime DESC\n  LIMIT 1\n),\nLabEvents AS (\n  SELECT \n    l.subject_id,\n    l.itemid,\n    l.charttime,\n    l.valuenum,\n    l.valueuom,\n    d.label\n  FROM \n    labevents l\n  JOIN \n    d_labitems d ON l.itemid = d.itemid\n  JOIN \n    PatientAge pa ON l.subject_id IN (\n      SELECT \n        subject_id\n      FROM \n        admissions\n      WHERE \n        age = pa.age\n    )\n)\nSELECT \n  PERCENT_RANK() OVER (ORDER BY le.valuenum) AS percentile\nFROM \n  LabEvents le\nWHERE \n  le.label = 'ptt' AND le.valuenum = 23.5;",
    "325f8e14568068a880720cc4": "SELECT \n  PERCENT_RANK() OVER (ORDER BY l.valuenum) AS percentile\nFROM \n  labevents l\n  JOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE \n  l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'White Blood Cells')\n  AND a.subject_id = (SELECT subject_id FROM patients WHERE row_id = 10021312)\n  AND l.charttime = (SELECT MAX(charttime) FROM labevents WHERE hadm_id = a.hadm_id)\n  AND l.valuenum = 10.8;",
    "1039ad255c53fd49a3e45f2f": "WITH PatientLastVisit AS (\n    SELECT \n        a.subject_id,\n        a.admittime,\n        a.dischtime,\n        p.gender,\n        p.dob,\n        p.dod,\n        strftime('%Y', p.dob) - strftime('%Y', a.admittime) + \n        (CASE WHEN strftime('%m-%d', p.dob) <= strftime('%m-%d', a.admittime) THEN 0 ELSE -1 END) AS age\n    FROM admissions a\n    INNER JOIN patients p ON a.subject_id = p.subject_id\n    WHERE a.subject_id = 10015931\n    ORDER BY a.admittime DESC\n    LIMIT 1\n),\nAgeGroup AS (\n    SELECT \n        age\n    FROM PatientLastVisit\n),\nGlucoseResults AS (\n    SELECT \n        le.subject_id,\n        le.charttime,\n        le.valuenum,\n        le.valueuom\n    FROM labevents le\n    INNER JOIN d_labitems li ON le.itemid = li.itemid\n    INNER JOIN AgeGroup ag ON ag.age = (\n        SELECT \n            strftime('%Y', p.dob) - strftime('%Y', a.admittime) + \n            (CASE WHEN strftime('%m-%d', p.dob) <= strftime('%m-%d', a.admittime) THEN 0 ELSE -1 END) AS age\n        FROM admissions a\n        INNER JOIN patients p ON a.subject_id = p.subject_id\n        WHERE a.subject_id = le.subject_id\n        ORDER BY a.admittime DESC\n        LIMIT 1\n    )\n    WHERE li.label = 'Glucose'\n),\nRankedGlucoseResults AS (\n    SELECT \n        subject_id,\n        charttime,\n        valuenum,\n        valueuom,\n        PERCENT_RANK() OVER (ORDER BY valuenum) AS percentile_rank\n    FROM GlucoseResults\n)\nSELECT \n    percentile_rank\nFROM RankedGlucoseResults\nWHERE valuenum = 186.0\nLIMIT 1;",
    "7dc8ffd1359d41d1da9da63c": "SELECT \n    PERCENT_RANK() OVER (ORDER BY labevents.valuenum) AS percentile_rank\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nJOIN \n    admissions ON labevents.hadm_id = admissions.hadm_id\nJOIN \n    patients ON admissions.subject_id = patients.subject_id\nWHERE \n    d_labitems.label = 'PLATELET COUNT'\n    AND labevents.valuenum = 114.0\n    AND patients.subject_id = 10021487\n    AND labevents.hadm_id = (\n        SELECT hadm_id \n        FROM admissions \n        WHERE subject_id = 10021487\n    );",
    "b1f43697c74666c4701854b3": "SELECT \n  (STRFTIME('%J', icustays.outtime) - STRFTIME('%J', icustays.intime)) * 24 + \n  (STRFTIME('%H', icustays.outtime) - STRFTIME('%H', icustays.intime)) AS hours_since_admission\nFROM \n  icustays\nJOIN \n  admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE \n  admissions.subject_id = 10018081;",
    "a4601ccbd52ea5048219a13a": "SELECT CAST((strftime('%s', datetime('now')) - strftime('%s', icustays.intime)) AS REAL) / 86400 AS days_since_icu_admission\nFROM icustays\nWHERE icustays.subject_id = 10018081\nLIMIT 1;",
    "90eb2c78447a14389410b63f": "SELECT (strftime('%s', 'now') - strftime('%s', icustays.intime)) / 3600.0 AS hours_elapsed\nFROM icustays\nJOIN admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE admissions.subject_id = 10039831;",
    "3444c5918e4cc5369449a9b3": "SELECT \n    julianday(i.intime) - julianday(a.admittime) AS hours_in_icu\nFROM \n    admissions a\nJOIN \n    icustays i ON a.hadm_id = i.hadm_id AND a.subject_id = i.subject_id\nWHERE \n    a.subject_id = 10018081;",
    "ab9f098a63937bcf7a768bee": "SELECT \n    (julianday('now') - julianday(i.intime)) * 24 AS hours_since_admission\nFROM \n    icustays i\nJOIN \n    patients p ON i.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10018081;",
    "a08cb35b715a295797129d6f": "SELECT julianday(icustays.outtime) - julianday(icustays.intime) AS icu_hours\nFROM icustays\nWHERE icustays.subject_id = 10039831;",
    "12c4448b67fe5aedbc6c32e2": "",
    "2322a6ff73f6c9d85f8b5a42": "SELECT \n  (julianday(icu.intime) - julianday(adm.admittime)) * 24 AS hours_elapsed\nFROM \n  icustays icu\n  INNER JOIN admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE \n  icu.subject_id = 10021487\n  AND icu.first_careunit = 'med/surg/trauma'\nORDER BY \n  icu.intime\nLIMIT 1;",
    "55734b9319f9dd143aa308ee": "SELECT \n  (julianday('now') - julianday(i.intime)) * 24 AS hours_since_first_careunit\nFROM \n  icustays i\nJOIN \n  admissions a ON i.hadm_id = a.hadm_id\nWHERE \n  a.subject_id = 10004733 AND \n  i.first_careunit = 'neurology';",
    "aedafdf56773a3d83e728b07": "",
    "14cbab955b0cd896876914ae": "SELECT \n    (julianday('now') - julianday(MAX(T.intime))) AS days_since_last_stay\nFROM \n    icustays T\nWHERE \n    T.subject_id = 10018081 \n    AND T.last_careunit = 'tsicu';",
    "43896dd8714c99844b172005": "WITH latest_admission AS (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10039831\n  ORDER BY admittime DESC\n  LIMIT 1\n),\nlast_stay AS (\n  SELECT intime\n  FROM icustays\n  WHERE hadm_id = (SELECT hadm_id FROM latest_admission)\n    AND first_careunit = 'discharge lounge'\n  ORDER BY intime DESC\n  LIMIT 1\n)\nSELECT CAST((julianday('now') - julianday((SELECT intime FROM last_stay))) AS INTEGER) AS days_since_last_stay;",
    "468c08e2b6a2ad56c3a4b7ce": "SELECT \n  (julianday('now') - julianday(i.intime)) * 24 AS hours_since_first_stay\nFROM \n  icustays i\nWHERE \n  i.subject_id = 10004733 \n  AND i.first_careunit = 'medicine';",
    "66efbf3af38673128432f1ca": "SELECT \n  CAST((julianday(t1.outtime) - julianday(t1.intime)) AS INTEGER) AS days_in_careunit\nFROM \n  icustays t1\nWHERE \n  t1.subject_id = 10039831 \n  AND t1.first_careunit = 'discharge lounge';",
    "5c76a4f60142e53facaaad36": "WITH RelevantDiagnosesCTE AS (\n  SELECT \n    d.subject_id,\n    d.charttime AS diagnosis_time\n  FROM diagnoses_icd d\n  INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE (di.long_title = 'Hyposmolality' OR di.long_title = 'Hyponatremia')\n    AND d.subject_id = 10018081\n),\nFirstDiagnosisTimeCTE AS (\n  SELECT \n    MIN(diagnosis_time) AS first_diagnosis_time\n  FROM RelevantDiagnosesCTE\n)\nSELECT \n  (JULIANDAY('now') - JULIANDAY(first_diagnosis_time)) * 24 AS hours_since_diagnosis\nFROM FirstDiagnosisTimeCTE;",
    "e02703e99cca2a83c3ce8360": "",
    "5ba5d822e1cd7d6ea2e879f5": "SELECT \n  (JULIANDAY('now') - JULIANDAY(d.charttime)) * 24 AS hours_since_diagnosis\nFROM \n  diagnoses_icd d\nJOIN \n  d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE \n  d.subject_id = 10018081 \n  AND icd.long_title LIKE '%unspecified essential hypertension%'\nORDER BY \n  d.charttime DESC\nLIMIT 1;",
    "84abf7eeac8648121f34613c": "SELECT \n  (julianday('now') - julianday(T2.charttime)) * 24 AS hours_since_diagnosis\nFROM \n  admissions T1\nINNER JOIN \n  diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n  d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\nWHERE \n  T1.subject_id = 10018081 \n  AND T3.long_title = 'Severe sepsis';",
    "851fcf327081528d82ce552c": "SELECT \n    (julianday(T1.charttime) - julianday(T2.admittime)) * 24 AS hours_since_admission\nFROM \n    diagnoses_icd T1\nJOIN \n    admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10021487 \n    AND T1.icd_code = 'E11.80'\n    AND T2.admittime = (\n        SELECT MIN(admittime)\n        FROM admissions\n        WHERE subject_id = 10021487\n    );",
    "b9f5b0364513fe3fe10ac23e": "WITH LatestDiagnosis AS (\n    SELECT \n        T1.subject_id, \n        T1.hadm_id, \n        T1.charttime\n    FROM diagnoses_icd T1\n    INNER JOIN d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\n    WHERE T2.long_title LIKE '%unspecified disturbance of conduct%' \n      AND T1.subject_id = 10004733 \n    ORDER BY T1.charttime DESC \n    LIMIT 1\n)\nSELECT \n    CAST((julianday('now') - julianday(T1.charttime)) AS INTEGER) AS days_since_diagnosis\nFROM LatestDiagnosis T1;",
    "dcc1a24e525aca42e0faa8ad": "SELECT \n    (julianday('now') - julianday(T2.charttime)) * 24 AS hours_since_last_diagnosis\nFROM \n    patients T1\nINNER JOIN \n    diagnoses_icd T2 ON T1.subject_id = T2.subject_id\nINNER JOIN \n    d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\nWHERE \n    T1.subject_id = 10021487 \n    AND T3.long_title = 'Acute vascular insufficiency of intestine';",
    "b037cad3311b5d427cda5306": "WITH FirstBasophilTest AS (\n    SELECT \n        T1.subject_id,\n        T1.hadm_id,\n        T2.charttime AS basophil_charttime\n    FROM admissions T1\n    INNER JOIN labevents T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\n    INNER JOIN d_labitems T3 ON T2.itemid = T3.itemid\n    WHERE T2.subject_id = 10018081 AND T3.label = 'basophils'\n    ORDER BY T2.charttime\n    LIMIT 1\n)\nSELECT \n    (JULIANDAY(T1.basophil_charttime) - JULIANDAY(T2.admittime)) AS days_since_admission\nFROM FirstBasophilTest T1\nINNER JOIN admissions T2 ON T1.hadm_id = T2.hadm_id;",
    "fc9243a5cde088d80aaae29a": "",
    "90b5ca0a939ce91e8678e9e2": "SELECT \n    JULIANDAY(T2.charttime) - JULIANDAY(T1.admittime) AS days_since_admission\nFROM \n    admissions AS T1\nINNER JOIN \n    labevents AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10021487\n    AND T2.itemid = (\n        SELECT \n            itemid \n        FROM \n            d_labitems \n        WHERE \n            label = 'pco2'\n    )\nLIMIT 1;",
    "b2aa7e4ded1cb22312719f24": "SELECT \n  MIN(labs.charttime) AS first_creatinine_charttime,\n  (julianday('now') - julianday(MIN(labs.charttime))) * 24 AS hours_since_first_creatinine\nFROM \n  labevents labs\nJOIN \n  admissions adm ON labs.hadm_id = adm.hadm_id\nWHERE \n  labs.subject_id = 10039831 \n  AND labs.itemid = (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label = 'Creatinine'\n  )\n  AND adm.hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10039831 \n    ORDER BY admittime ASC \n    LIMIT 1\n  );",
    "de82a5b21bc173cb82992e90": "SELECT \n    (strftime('%s', 'now') - strftime('%s', le.charttime)) / (60 * 60 * 24) AS days_since_first_test\nFROM \n    labevents le\nJOIN \n    d_labitems di ON le.itemid = di.itemid\nWHERE \n    le.subject_id = 10021487 AND\n    di.label = 'Amylase, Pleural' AND\n    le.charttime = (\n        SELECT MIN(charttime)\n        FROM labevents\n        WHERE subject_id = 10021487 AND itemid = di.itemid\n    );",
    "e76832974c5806793c6d4c8a": "SELECT \n  (julianday('now') - julianday(MIN(l.charttime))) AS days_since_first_test\nFROM \n  labevents l\n  JOIN d_labitems dl ON l.itemid = dl.itemid\nWHERE \n  l.subject_id = 10021487 AND dl.label = 'po2';",
    "23dd8572482a3b9ef2437c37": "SELECT \n    (julianday(l.charttime) - julianday(a.admittime)) AS days_since_admission\nFROM \n    admissions a\nINNER JOIN \n    labevents l ON a.hadm_id = l.hadm_id\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    a.subject_id = 10018081\n    AND d.label = 'PO2'\nORDER BY \n    l.charttime ASC\nLIMIT 1;",
    "b9271c00a9f5d1cda644a8f7": "WITH LastInputCTE AS (\n    SELECT \n        T3.charttime AS last_input_time\n    FROM patients AS T1\n    INNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\n    INNER JOIN icustays AS T4 ON T2.hadm_id = T4.hadm_id\n    INNER JOIN inputevents AS T3 ON T4.stay_id = T3.stay_id\n    INNER JOIN d_items AS T5 ON T3.itemid = T5.itemid\n    WHERE T1.subject_id = 10039831\n    AND T5.label = 'A or Colloid'\n    AND T3.charttime = (\n        SELECT MAX(T6.charttime)\n        FROM inputevents AS T6\n        INNER JOIN d_items AS T7 ON T6.itemid = T7.itemid\n        WHERE T6.stay_id = T4.stay_id\n        AND T7.label = 'A or Colloid'\n    )\n)\nSELECT \n    CAST(julianday('now') - julianday(LastInputCTE.last_input_time) AS INTEGER) AS days_since_last_input\nFROM LastInputCTE;",
    "56d7f83c3d047987d4f5ad6a": "",
    "d5598306e9ea4771b948f856": "SELECT (julianday(i.intime) - julianday(ie.charttime)) * 24 AS hours_since_first_input\nFROM inputevents i\nJOIN chartevents ie ON i.subject_id = ie.subject_id AND i.hadm_id = ie.hadm_id\nWHERE i.subject_id = 10018081\n  AND i.itemid = (SELECT itemid FROM d_items WHERE label = 'nacl 0.9%')\n  AND ie.charttime = (SELECT MIN(ie2.charttime)\n                      FROM chartevents ie2\n                      WHERE ie2.subject_id = i.subject_id\n                        AND ie2.itemid = (SELECT itemid FROM d_items WHERE label = 'nacl 0.9%'))\n  AND ie.charttime >= i.intime;",
    "86522357b4bc14150a100527": "SELECT \n    (strftime('%J', 'now') - strftime('%J', MIN(t.starttime))) * 24 + \n    (strftime('%H', 'now') - strftime('%H', MIN(t.starttime))) AS hours_since_first_input\nFROM \n    inputevents t\nJOIN \n    icustays i ON t.stay_id = i.stay_id\nWHERE \n    t.subject_id = 10018081\n    AND t.itemid = (SELECT itemid FROM d_items WHERE label = 'Gastric Meds')\n    AND t.starttime >= i.intime\n    AND t.starttime <= i.outtime;",
    "b3f250788370221cd33bdb7b": "SELECT \n    (julianday(i.starttime) - julianday(ic.intime)) * 24 AS hours_since_first_input\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    icustays ic ON a.hadm_id = ic.hadm_id\nJOIN \n    inputevents i ON ic.stay_id = i.stay_id\nWHERE \n    p.subject_id = 10018081\n    AND ic.stay_id = 1\n    AND i.itemid = 1\nORDER BY \n    i.starttime ASC\nLIMIT 1;",
    "a19d8f8790ee9cc3b62ce290": "SELECT \n    JULIANDAY(MAX(ie.charttime)) - JULIANDAY(MIN(ie.charttime)) AS days_since_first_input\nFROM \n    inputevents ie\nJOIN \n    icustays icu ON ie.stay_id = icu.stay_id\nWHERE \n    ie.subject_id = 10018081\n    AND ie.itemid = (\n        SELECT itemid \n        FROM d_items \n        WHERE label = 'Nepro (Full)'\n    );",
    "8fa5e7278b3b5b9b839b6135": "SELECT \n    (julianday('now') - julianday(T1.charttime)) AS days_since_first_gt_flush\nFROM (\n    SELECT \n        charttime\n    FROM inputevents\n    WHERE \n        itemid = (\n            SELECT itemid\n            FROM d_items\n            WHERE label = 'gt flush'\n        )\n    AND \n        subject_id = 10018081\n    AND \n        hadm_id IN (\n            SELECT hadm_id\n            FROM icustays\n            WHERE subject_id = 10018081\n        )\n    ORDER BY charttime ASC\n    LIMIT 1\n) T1;",
    "653e63e266f88f5e4752d092": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10020740\nORDER BY admittime ASC\nLIMIT 1;",
    "129654f0722de6dae2867660": "",
    "6fd5e2805d0a42a23c2787ff": "SELECT \n    admission_type \nFROM \n    admissions \nWHERE \n    subject_id = 10018081 \nORDER BY \n    admittime \nLIMIT 1;",
    "68c085ad9374a9c886e43355": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10019917\nORDER BY admittime DESC\nLIMIT 1;",
    "60f8d59c27fe673230ac2a83": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10006053 \nORDER BY admittime \nLIMIT 1;",
    "94cd2d4043d712084245bed1": "SELECT \n    a.admission_type\nFROM \n    admissions a\nWHERE \n    a.subject_id = 10020740\nORDER BY \n    a.admittime ASC\nLIMIT 1;",
    "8df120a9e3e8d73de47c1a11": "Select the Required Column**: We are only interested in the `admission_type` of the most recent visit.",
    "1b6f72d94895e62f9e279e35": "",
    "b82dba86a4b2a808ab2cef89": "SELECT \n    ce.valuenum AS last_measurement\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10011398\n    AND di.label = 'Weight'\n    AND ce.charttime >= DATE('now', '-30 months')\nORDER BY \n    ce.charttime DESC\nLIMIT 1;",
    "63359ce4687532a538d1238d": "SELECT\n    MAX(ce.charttime) AS last_charttime,\n    ce.valuenum AS last_weight\nFROM\n    chartevents ce\nJOIN\n    d_items di ON ce.itemid = di.itemid\nWHERE\n    ce.subject_id = 10009628\n    AND ce.charttime >= DATE('now', '-25 months')\n    AND di.label = 'Weight'\nGROUP BY\n    ce.subject_id\nORDER BY\n    ce.charttime DESC\nLIMIT 1;",
    "27ce9933ce0b1542c2dd468c": "SELECT \n  T2.valueuom, \n  T2.valuenum AS weight\nFROM \n  patients AS T1 \nINNER JOIN \n  chartevents AS T2 ON T1.row_id = T2.row_id \nWHERE \n  T1.subject_id = 10036156 \n  AND T2.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight') \nORDER BY \n  T2.charttime \nLIMIT 1;",
    "9cd37fc842ad70310d54ee58": "SELECT \n    subject_id, \n    itemid, \n    charttime, \n    valuenum, \n    valueuom\nFROM \n    labevents\nWHERE \n    subject_id = 10027602 \n    AND itemid = 1000000002 \n    AND charttime > datetime('now', '-5 months') \nORDER BY \n    charttime ASC\nLIMIT 1;",
    "689684471cdf1a2cea58ca7c": "SELECT \n    T1.charttime,\n    T1.valuenum,\n    T1.valueuom\nFROM \n    chartevents AS T1\nINNER JOIN \n    admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T2.subject_id = 10007928  \n    AND T1.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\nORDER BY \n    T1.charttime DESC\nLIMIT 1;",
    "5b70769cdf8e342b6b7432c8": "SELECT T2.valuenum\nFROM admissions AS T1\nINNER JOIN chartevents AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2.subject_id\nINNER JOIN d_items AS T3 ON T2.itemid = T3.itemid\nWHERE T1.subject_id = 10005909\nAND T2.charttime = (\n  SELECT MAX(charttime)\n  FROM chartevents\n  WHERE hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10005909\n    ORDER BY admittime DESC\n    LIMIT 1\n  )\n  AND itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'Weight'\n  )\n)\nAND T3.label = 'Weight';",
    "84ffe2eecf94db13c293cd18": "SELECT d.long_title AS diagnosis\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.subject_id = 10006580\nAND di.charttime >= DATE('now', '-1 year')\nORDER BY di.charttime DESC\nLIMIT 1;",
    "531d3b5c9daeaf625b709381": "SELECT d.long_title\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE di.subject_id = 10025612\nAND di.charttime >= DATE('now', '-1 year')\nORDER BY di.charttime DESC\nLIMIT 1;",
    "c382285cc641ffefb4754fec": "SELECT \n    T2.long_title AS diagnosis_title\nFROM \n    diagnoses_icd T1\nINNER JOIN \n    d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\nWHERE \n    T1.subject_id = 10011398\nORDER BY \n    T1.charttime DESC\nLIMIT 1;",
    "a68a8f7c8f9c51d21140fbb2": "SELECT \n  T2.icd_code\nFROM \n  patients T1\nJOIN \n  diagnoses_icd T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.subject_id = 10020740 AND T2.charttime >= '2100-01-01'\nORDER BY \n  T2.charttime ASC\nLIMIT 1;",
    "480b667942347b982307f45c": "SELECT \n    d.long_title AS first_diagnosis\nFROM \n    diagnoses_icd icd\nJOIN \n    d_icd_diagnoses d ON icd.icd_code = d.icd_code\nJOIN \n    admissions a ON icd.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10009628 AND \n    icd.charttime LIKE '2100%'\nORDER BY \n    icd.charttime ASC\nLIMIT 1;",
    "19013f71186dd94c3663224d": "SELECT \n    icd.icd_code,\n    d.long_title,\n    icd.charttime\nFROM \n    diagnoses_icd icd\nJOIN \n    d_icd_diagnoses d ON icd.icd_code = d.icd_code\nWHERE \n    icd.subject_id = 10029291\n    AND icd.charttime LIKE '2100%'\nORDER BY \n    icd.charttime\nLIMIT 1;",
    "b389e224ed07b11a553f0329": "SELECT T3.long_title AS diagnosis_name\nFROM admissions T1\nJOIN diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\nJOIN d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10001217\nAND T2.charttime >= '2100-01-01'\nAND T2.charttime < '2101-01-01'\nORDER BY T2.charttime\nLIMIT 1;",
    "882e179f26d1d73b14ec8e40": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10035185 \nAND route = 'Nu'\nAND hadm_id = (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10035185\n  ORDER BY admittime DESC\n  LIMIT 1\n)\nORDER BY starttime DESC\nLIMIT 1;",
    "0df69b82de6a35ad5bdec3d3": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10010471 AND route = 'neb' AND starttime >= '2012-01-01';",
    "c1b92eb9d2e4ceedd614efe5": "select the correct data from the relevant tables.",
    "ad08e146a6e37e3a138c8c78": "SELECT \n  drug, \n  dose_unit_rx\nFROM \n  prescriptions \nWHERE \n  subject_id = 10020944 \n  AND route = 'iv' \n  AND starttime = (\n    SELECT MIN(starttime) \n    FROM prescriptions \n    WHERE subject_id = 10020944 AND route = 'iv'\n  );",
    "5bb6c677596960ca463e9a0c": "SELECT\n  drug,\n  dose_val_rx,\n  dose_unit_rx,\n  route,\n  starttime,\n  stoptime\nFROM\n  prescriptions p\nWHERE\n  p.subject_id = 10038933\n  AND p.hadm_id = 1\n  AND p.route = 'td'\nORDER BY\n  starttime DESC\nLIMIT 1;",
    "727a314e82ff330ad11ea76a": "",
    "86aa92cf8b22de77c9f101da": "SELECT p.drug\nFROM prescriptions p\nINNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.subject_id = 10007818\n  AND p.route = 'Replace'\n  AND p.starttime = (\n    SELECT MIN(starttime)\n    FROM prescriptions\n    WHERE hadm_id = a.hadm_id\n  );",
    "b1230a6aa17968195ee8b217": "WITH RankedPrescriptions AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.starttime,\n        p.drug,\n        ROW_NUMBER() OVER (PARTITION BY p.subject_id ORDER BY p.starttime) AS rank\n    FROM prescriptions p\n    WHERE p.subject_id = 10003400\n      AND p.starttime >= DATE('now', '-26 months')\n)\nSELECT drug\nFROM RankedPrescriptions\nWHERE rank = 1;",
    "779440f275cacfb10aac9cd9": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10001725\n  AND starttime > DATE('now', '-28 months')\nORDER BY starttime ASC\nLIMIT 1;",
    "db9cfb9fbfbda61eb399064e": "",
    "03dfaec9b60c0b6d9aa52f8a": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10021118 \nAND hadm_id = 122100\nORDER BY starttime DESC \nLIMIT 1;",
    "fe2d6c0f694f5a4cc2357932": "",
    "a0db7ff03e5bff5fb4b04f91": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10007818\nORDER BY starttime DESC\nLIMIT 1;",
    "1bc55cd8f6d690799f8c4047": "WITH RecentPrescriptions AS (\n    SELECT p.subject_id, p.hadm_id, p.starttime, p.drug\n    FROM prescriptions p\n    WHERE p.subject_id = 10020306\n      AND p.starttime >= DATE('now', '-13 months')\n),\nFirstPrescription AS (\n    SELECT subject_id, drug\n    FROM RecentPrescriptions\n    ORDER BY starttime ASC\n    LIMIT 1\n)\nSELECT drug\nFROM FirstPrescription;",
    "d668bffcab5e2672863cb63b": "SELECT DISTINCT p.drug\nFROM diagnoses_icd d\nJOIN prescriptions p ON d.subject_id = p.subject_id AND d.hadm_id = p.hadm_id\nWHERE d.icd_code = 'E118'\nAND d.subject_id = 10018081\nAND p.starttime > d.charttime\nAND p.starttime <= DATE(d.charttime, '+2 days');",
    "59e904000d52c139e656f371": "WITH diagnosis_admission AS (\n  SELECT \n    hadm_id\n  FROM \n    diagnoses_icd di\n  INNER JOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\n  WHERE \n    di.subject_id = 10018081\n    AND d.long_title LIKE '%hyposmolality and/or hyponatremia%'\n    AND di.charttime >= DATE('now', '-3 months')\n),\nmedications AS (\n  SELECT \n    p.drug,\n    p.dose_val_rx,\n    p.dose_unit_rx,\n    p.route\n  FROM \n    prescriptions p\n  INNER JOIN \n    diagnosis_admission da ON p.hadm_id = da.hadm_id\n  WHERE \n    p.subject_id = 10018081\n)\nSELECT * FROM medications;",
    "084bc1062af3fecf71b004b8": "SELECT DISTINCT p.drug\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE p.subject_id = 10022281\nAND d.charttime BETWEEN a.admittime AND a.dischtime\nAND dd.long_title = 'Diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled in 06/2100';",
    "edc9d546d2286562d9028ba2": "WITH patient_diagnoses AS (\n  SELECT \n    d.subject_id,\n    d.icd_code,\n    d.charttime,\n    di.long_title\n  FROM \n    diagnoses_icd d\n  INNER JOIN \n    d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE \n    d.subject_id = 10020306\n    AND di.long_title = 'Family History of Malignant Neoplasm of Breast'\n    AND d.charttime >= date('now', '-1 month')\n),\nprescribed_drug AS (\n  SELECT \n    p.subject_id,\n    p.drug,\n    p.starttime,\n    p.stoptime\n  FROM \n    prescriptions p\n  WHERE \n    p.subject_id = 10020306\n    AND p.starttime >= date('now', '-1 month')\n)\nSELECT \n  pd.subject_id,\n  pd.long_title,\n  pr.drug\nFROM \n  patient_diagnoses pd\nINNER JOIN \n  prescribed_drug pr ON pd.subject_id = pr.subject_id\nWHERE \n  pd.subject_id = 10020306\n  AND pr.starttime >= pd.charttime\nLIMIT 1;",
    "188165b0d15bdb552ff80f78": "",
    "274b0d1304fb6e07afcfbbda": "",
    "fb06199e01e940e2278f83e6": "SELECT \n  p.drug\nFROM \n  diagnoses_icd d\n  INNER JOIN prescriptions p ON d.hadm_id = p.hadm_id\nWHERE \n  d.subject_id = 10011398 \n  AND d.icd_code = 'I20' \n  AND d.charttime BETWEEN DATE('now', 'start of month') AND DATE('now', 'start of month', '+1 month', '-1 day')\n  AND p.starttime BETWEEN d.charttime AND DATE(d.charttime, '+2 days')",
    "d7d06c5202d42d089c98cbcb": "",
    "0e6e7e38aaec3a977e832859": "SELECT \n    pr.drug AS prescription_drug\nFROM \n    prescriptions pr\nJOIN \n    procedures_icd prc ON pr.hadm_id = prc.hadm_id AND pr.subject_id = prc.subject_id\nJOIN \n    d_icd_procedures dicp ON prc.icd_code = dicp.icd_code\nWHERE \n    pr.subject_id = 10019172\n    AND dicp.long_title LIKE '%excision of dental lesion of jaw%'",
    "7e34d3539103f069ec358935": "SELECT T1.drug\nFROM prescriptions AS T1\nJOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.icd_code = 'P09.11'\nAND T1.subject_id = 10027602\nAND T1.starttime > (SELECT MIN(intime) FROM transfers WHERE subject_id = 10027602 AND eventtype = 'Continuous Invasive Mechanical Ventilation (CIMV)')\nAND T1.starttime < (SELECT MAX(intime) FROM transfers WHERE subject_id = 10027602 AND eventtype = 'Continuous Invasive Mechanical Ventilation (CIMV)')\nAND (SELECT MAX(intime) FROM transfers WHERE subject_id = 10027602 AND eventtype = 'Continuous Invasive Mechanical Ventilation (CIMV)') - (SELECT MIN(intime) FROM transfers WHERE subject_id = 10027602 AND eventtype = 'Continuous Invasive Mechanical Ventilation (CIMV)') < 96;",
    "72035c7e697aebbd36cc9933": "SELECT \n    p.drug\nFROM \n    procedures_icd pr \nINNER JOIN \n    d_icd_procedures d ON pr.icd_code = d.icd_code\nINNER JOIN \n    admissions a ON pr.hadm_id = a.hadm_id\nINNER JOIN \n    prescriptions p ON a.subject_id = p.subject_id AND a.hadm_id = p.hadm_id\nWHERE \n    pr.subject_id = 10027602\n    AND d.long_title LIKE '%endovascular (total) embolization or occlusion of head and neck vessels%'\n    AND p.starttime BETWEEN DATE('now', '-1 month') AND DATE('now')\n    AND a.hadm_id IN (\n        SELECT hadm_id \n        FROM procedures_icd \n        WHERE icd_code = pr.icd_code\n    );",
    "812c6c46b3324a53a45d2aeb": "SELECT T1.drug\nFROM prescriptions AS T1\nJOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\nJOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T2.charttime >= DATE('now', 'start of month') \nAND T2.charttime < DATE('now', 'start of month', '+1 month')\nAND T3.long_title = 'Biopsy of Bronchus, Endoscopic'\nAND T1.starttime >= DATE(T2.charttime, '+2 day')\nAND T1.subject_id = 10027602;",
    "2a11db69d8090e01bd8a342f": "SELECT p.drug\nFROM prescriptions p\nJOIN procedures_icd pi ON p.hadm_id = pi.hadm_id AND p.subject_id = pi.subject_id\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10027602 \n  AND pi.icd_code = 'T70.1' \n  AND a.admittime >= DATE('now', 'start of month')\n  AND a.dischtime <= DATE('now', 'start of month', '+1 month')",
    "7de6b061dc649d1607951286": "SELECT p.drug\nFROM prescriptions p\nJOIN procedures_icd pr ON p.hadm_id = pr.hadm_id\nWHERE pr.icd_code = 'T10.002'\nAND p.starttime BETWEEN (\n    SELECT admittime\n    FROM admissions\n    WHERE subject_id = 10021312\n) AND (\n    SELECT admittime\n    FROM admissions\n    WHERE subject_id = 10021312\n) + 2 * 86400;",
    "73f7afc22d0bf51b0967f477": "SELECT \n    p.subject_id, \n    pr.drug, \n    pr.starttime\nFROM \n    prescriptions pr\nJOIN \n    patients p ON pr.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10006053\n    AND pr.drug = '0.9% sodium chloride'\n    AND pr.starttime >= '2000-10-21 00:00:00'\nORDER BY \n    pr.starttime ASC\nLIMIT 1;",
    "0d67d0933db06596007b915d": "SELECT \n  p.subject_id, \n  p.hadm_id, \n  p.starttime AS prescription_start_time, \n  p.stoptime AS prescription_stop_time, \n  p.drug, \n  p.dose_val_rx AS dose_value, \n  p.dose_unit_rx AS dose_unit, \n  p.route\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10005909 AND \n  p.drug = 'Phenazopyridine';",
    "011101a7eeb61bc7e999e5d0": "SELECT MAX(T1.totalamount) AS last_prescription_amount\nFROM inputevents AS T1\nJOIN icustays AS T2 ON T1.stay_id = T2.stay_id\nJOIN admissions AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE T1.itemid = (SELECT itemid FROM d_items WHERE label = 'Ibuprofen Suspension')\n  AND T1.subject_id = 10014078\n  AND T3.subject_id = 10014078\n  AND T2.stay_id = (SELECT MAX(T2.stay_id) FROM icustays AS T2 WHERE T2.subject_id = 10014078)\n  AND T1.starttime = (SELECT MAX(T1.starttime) FROM inputevents AS T1 WHERE T1.stay_id = T2.stay_id AND T1.subject_id = T3.subject_id AND T1.itemid = T1.itemid);",
    "8ddf87626d2c76b0babbc0d9": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10007795 AND drug = 'tamoxifen citrate';\n\nSELECT dose_unit_rx\nFROM prescriptions\nWHERE subject_id = 10007795 AND drug = 'tamoxifen citrate' AND starttime = (\n    SELECT MAX(starttime)\n    FROM prescriptions\n    WHERE subject_id = 10007795 AND drug = 'tamoxifen citrate'\n);",
    "28fd166cd9efc2ab844c870d": "SELECT MAX(starttime) AS latest_starttime\nFROM prescriptions\nWHERE subject_id = 10018423 AND drug = 'metoprolol tartrate';",
    "7db7fa4ecb7523dc29380f8c": "SELECT \n    dose_val_rx, \n    dose_unit_rx, \n    route \nFROM \n    prescriptions \nWHERE \n    subject_id = 10031757 \n    AND drug = 'acetaminophen iv' \n    AND starttime = (\n        SELECT MIN(starttime) \n        FROM prescriptions \n        WHERE subject_id = 10031757 \n        AND drug = 'acetaminophen iv'\n    );",
    "63e4dddc1461b7b4506f3036": "SELECT \n  p.subject_id, \n  pr.drug, \n  pr.dose_val_rx, \n  pr.dose_unit_rx, \n  pr.route, \n  pr.starttime, \n  pr.stoptime\nFROM \n  patients p\n  JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  p.subject_id = 10002495\n  AND pr.drug = 'lidocaine jelly 2% (urojet)'\n  AND pr.starttime = (\n    SELECT MAX(starttime)\n    FROM prescriptions\n    WHERE subject_id = 10002495\n      AND drug = 'lidocaine jelly 2% (urojet)'\n  );",
    "652c13b3ffbd655d3934525f": "SELECT dose_val_rx\nFROM prescriptions\nWHERE subject_id = 10020187 AND drug = 'Oxycodone (immediate release)';",
    "ff8338b63365f7592e0f5601": "select the dose value from the `prescriptions` table where the `subject_id` is `10014354` and the `drug` is 'glucose gel'.",
    "89c2d37bc8253b4bbe4a7c48": "SELECT SUM(totalamount) AS total_amount_prescribed\nFROM prescriptions\nWHERE drug = 'pregabalin'\n  AND subject_id = 10020944\n  AND hadm_id = (\n    SELECT MIN(hadm_id)\n    FROM admissions\n    WHERE subject_id = 10020944\n  );",
    "c342b5e4b0e92d9e4a863516": "SELECT \n  dose_val_rx\nFROM \n  prescriptions\nWHERE \n  subject_id = 10011398\n  AND drug = 'glucagon'\n  AND starttime > '2000-07-01';",
    "5d1a36d000cf036649466742": "SELECT SUM(T2.totalamount) AS total_simvastatin\nFROM prescriptions AS T1\nJOIN inputevents AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2.subject_id\nWHERE T1.subject_id = 10025463 AND T1.drug = 'simvastatin' AND T2.starttime >= '2021-11-21';",
    "372eebaf1307d345c3c26b97": "SELECT hadm_id\n   FROM admissions\n   WHERE subject_id = 10012853\n   ORDER BY admittime DESC\n   LIMIT 1;",
    "21a26369d82d30e8f8036663": "",
    "91c672fcc248e33a4019dadc": "SELECT DISTINCT T1.drug\nFROM prescriptions T1\nWHERE T1.subject_id = 10004733\n  AND T1.starttime >= DATE('now', '-1 day')\n  AND T1.starttime < DATE('now')\n  AND T1.drug NOT IN (\n      SELECT T2.drug\n      FROM prescriptions T2\n      WHERE T2.subject_id = 10004733\n        AND T2.starttime >= DATE('now', '-2 day')\n        AND T2.starttime < DATE('now', '-1 day')\n  );",
    "cf5ba52470d99772c0cfb0ff": "SELECT \n    GROUP_CONCAT(CASE WHEN DATE(starttime) = DATE('now') THEN drug END, ', ') AS today_medications,\n    GROUP_CONCAT(CASE WHEN DATE(starttime) = DATE('now', '-1 day') THEN drug END, ', ') AS yesterday_medications\nFROM \n    prescriptions\nWHERE \n    subject_id = 10004733\n    AND (starttime >= DATE('now', '-1 day') AND starttime < DATE('now'))",
    "5b8ffff4e21d176e195d9c35": "",
    "5dc8c9a7928cb067f4b75d12": "",
    "6675b86607ae8420ab26bdba": "SELECT \n  T1.drug, \n  T1.dose_val_rx, \n  T1.dose_unit_rx, \n  T1.route, \n  T1.starttime AS today_starttime, \n  T1.stoptime AS today_stoptime, \n  T2.starttime AS yesterday_starttime, \n  T2.stoptime AS yesterday_stoptime\nFROM \n  prescriptions T1 \n  LEFT JOIN prescriptions T2 \n    ON T1.subject_id = T2.subject_id \n    AND T1.hadm_id = T2.hadm_id \n    AND strftime('%Y-%m-%d', T1.starttime) = strftime('%Y-%m-%d', 'now') \n    AND strftime('%Y-%m-%d', T2.starttime) = strftime('%Y-%m-%d', 'now', '-1 day') \nWHERE \n  T1.subject_id = 10039831;",
    "50a2de2aeac213e640ee8dfc": "WITH TodayPrescriptions AS (\n    SELECT drug, starttime\n    FROM prescriptions\n    WHERE subject_id = 10018081 AND date(starttime) = date('now')\n),\nYesterdayPrescriptions AS (\n    SELECT drug, starttime\n    FROM prescriptions\n    WHERE subject_id = 10018081 AND date(starttime) = date('now', '-1 day')\n)\nSELECT \n    CASE \n        WHEN t.drug IS NOT NULL AND y.drug IS NULL THEN 'Added: ' || t.drug\n        WHEN t.drug IS NULL AND y.drug IS NOT NULL THEN 'Removed: ' || y.drug\n        ELSE 'No Change'\n    END AS prescription_change\nFROM TodayPrescriptions t\nFULL OUTER JOIN YesterdayPrescriptions y ON t.drug = y.drug;",
    "28d1d61838e9ab66ccc8ae3c": "Select all prescriptions for patient 10004733 where the `starttime` is yesterday.\n\n3. **Compare today's and yesterday's prescriptions**:\n   - Identify medications that are in today's prescriptions but not in yesterday's.\n\n4. **Filter and output the results**:\n   - Ensure that only the newly prescribed medications are output.",
    "e5441310205bb859e8ca31ba": "WITH FirstHospitalEncounter AS (\n    SELECT\n        hadm_id\n    FROM admissions\n    WHERE subject_id = 10023117\n    ORDER BY admittime\n    LIMIT 1\n),\nHemoglobinValue AS (\n    SELECT\n        l.subject_id,\n        l.hadm_id,\n        l.charttime,\n        l.valuenum,\n        l.valueuom\n    FROM labevents l\n    JOIN d_labitems d ON l.itemid = d.itemid\n    WHERE d.label = 'Hemoglobin'\n    AND l.subject_id = 10023117\n)\nSELECT\n   valuenum\nFROM HemoglobinValue\nWHERE hadm_id = (SELECT hadm_id FROM FirstHospitalEncounter)\nORDER BY charttime\nLIMIT 1;",
    "4710d3c9173e3759cd533b86": "SELECT \n  label, \n  valuenum, \n  valueuom\nFROM \n  d_labitems \n  INNER JOIN labevents ON d_labitems.itemid = labevents.itemid\nWHERE \n  subject_id = 10016742 \n  AND label = 'PLATELET COUNT'\n  AND labevents.charttime LIKE '%2100%'\nORDER BY \n  labevents.charttime ASC\nLIMIT 1;",
    "32dc827809f2f3b381144bfc": "SELECT \n    MIN(charttime) AS first_charttime\nFROM \n    labevents\nWHERE \n    subject_id = 10002495;",
    "95de1cbfea9cbbf15a57c2e4": "SELECT \n    ce.charttime, \n    ce.valuenum \nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10008454 AND \n    di.label = 'eag' AND \n    ce.charttime >= DATE('now', 'start of year', '+11 month') AND \n    ce.charttime < DATE('now', 'start of year', '+12 month')\nORDER BY \n    ce.charttime ASC\nLIMIT 1;",
    "bebec164cfe1ff0dced197be": "SELECT \n  l.charttime, \n  l.valuenum, \n  l.valueuom \nFROM \n  labevents l \n  INNER JOIN d_labitems d ON l.itemid = d.itemid \nWHERE \n  l.subject_id = 10018423 \n  AND d.label = 'Potassium, Whole Blood' \nORDER BY \n  l.charttime ASC \nLIMIT 1;",
    "0eeb80895de2cb7f545f7953": "WITH LastAdmission AS (\n  SELECT \n    adm.hadm_id\n  FROM admissions adm\n  WHERE adm.subject_id = 10019917\n  ORDER BY adm.admittime DESC\n  LIMIT 1\n),\nHematocritValues AS (\n  SELECT \n    lab.subject_id,\n    lab.hadm_id,\n    lab.charttime,\n    lab.valuenum,\n    lab.valueuom\n  FROM labevents lab\n  INNER JOIN LastAdmission la ON lab.hadm_id = la.hadm_id\n  INNER JOIN d_labitems li ON lab.itemid = li.itemid\n  WHERE li.label = 'Hematocrit'\n)\nSELECT \n  valuenum\nFROM HematocritValues\nORDER BY charttime ASC\nLIMIT 1;",
    "0252bfa6857e8fa392627cbf": "SELECT \n  t.charttime, \n  t.valuenum, \n  t.valueuom\nFROM \n  labevents t\nJOIN \n  admissions a ON t.hadm_id = a.hadm_id\nWHERE \n  t.subject_id = 10021487\n  AND t.itemid = (SELECT itemid FROM d_labitems WHERE label = 'O2 flow')\n  AND t.charttime = (SELECT MIN(charttime) FROM labevents WHERE subject_id = 10021487 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'O2 flow'))\n  AND a.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10021487 ORDER BY admittime DESC LIMIT 1)\nORDER BY \n  t.charttime ASC\nLIMIT 1;",
    "4be18d3033fa1bac9d4c0223": "SELECT \n  label\nFROM \n  d_labitems\nWHERE \n  itemid = (SELECT \n              itemid \n            FROM \n              labevents \n            WHERE \n              subject_id = 10026255 \n              AND charttime > '2004-04-01' \n            ORDER BY \n              charttime \n            LIMIT 1);",
    "bda2d1d92535f2f380e83c31": "SELECT l.label\nFROM labevents AS le\nINNER JOIN d_labitems AS l ON le.itemid = l.itemid\nWHERE le.subject_id = 10022017 AND le.charttime >= '2001-04-21'\nORDER BY le.charttime ASC\nLIMIT 1;",
    "22e094ace74f0664f5a0629e": "SELECT d_labitems.label\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10023239 AND labevents.charttime <= '2000-06-21'\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "d8d340c85d29c3512cdffb03": "selecting the first entry.\n\nBased on these requirements, we will use the `labevents` table to retrieve the lab test information. The `charttime` column will be used to filter and order the results.",
    "1f1e33683e0ff2f0510efc21": "SELECT d_labitems.label AS lab_test_label\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10002428\nAND STRFTIME('%m/%Y', labevents.charttime) = '07/2000'\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "1a72596befd361ee133771b0": "SELECT dl.label\nFROM labevents le\nJOIN d_labitems dl ON le.itemid = dl.itemid\nWHERE le.subject_id = 10015931 AND le.charttime >= '2021-05-01'\nORDER BY le.charttime ASC\nLIMIT 1;",
    "ecd65c3d262d3e34018c162c": "SELECT l.label AS lab_test\nFROM labevents le\nINNER JOIN d_labitems l ON le.itemid = l.itemid\nWHERE le.subject_id = 10001725\nAND le.charttime >= DATE('now', '-9 months')\nORDER BY le.charttime DESC\nLIMIT 1;",
    "bd3ba61db07a88f7a5920ac6": "SELECT AVG(T1.valuenum) AS average_value\nFROM labevents AS T1\nJOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10037975 AND T2.label = 'Potassium, whole blood in 02/2100';",
    "0c93a24758fe815a4f4bf747": "SELECT MAX(T1.valuenum) AS max_value\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10004235 AND T2.label = 'pt' AND T1.hadm_id = (\n    SELECT MAX(T3.hadm_id)\n    FROM admissions AS T3\n    WHERE T3.subject_id = 10004235\n);",
    "9f0ee496296456e6f48a49a6": "-- Step 1: Identify the last hospital encounter for the specified patient\nWITH last_hadm AS (\n  SELECT \n    hadm_id \n  FROM \n    admissions \n  WHERE \n    subject_id = 10002495 \n  ORDER BY \n    hadm_id DESC \n  LIMIT 1\n)\n\n-- Step 2: Find the minimum protein value for the last hospital encounter\nSELECT \n  MIN(T3.valuenum) AS min_protein_value\nFROM \n  patients AS T1 \n  INNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id \n  INNER JOIN labevents AS T3 ON T2.hadm_id = T3.hadm_id \n  INNER JOIN d_labitems AS T4 ON T3.itemid = T4.itemid\nWHERE \n  T1.subject_id = 10002495 \n  AND T4.label = 'Protein' \n  AND T3.hadm_id = (SELECT hadm_id FROM last_hadm);",
    "89f4e7daebe9b4f5c0d96263": "SELECT \n    MAX(T2.valuenum) AS max_mchc_value\nFROM \n    patients T1\nINNER JOIN \n    labevents T2 ON T1.subject_id = T2.subject_id\nWHERE \n    T1.subject_id = 10026354 \n    AND T2.charttime LIKE '%11/%' -- Assuming the current year is 2023, this filters for November 2023\n    AND T2.itemid IN (SELECT itemid FROM d_labitems WHERE label = 'mchc');",
    "a19666f04f957b696244b895": "",
    "aba8c9a560d7ec87a020f638": "SELECT AVG(c.valuenum) AS avg_bilirubin\nFROM chartevents c\nJOIN d_items d ON c.itemid = d.itemid\nJOIN patients p ON c.subject_id = p.subject_id\nWHERE c.charttime >= '2008-08-01'\nAND c.subject_id = 10021487\nAND d.label = 'BILIRUBIN, TOTAL, ASCITES';",
    "9941ca19aa20b45f0d59bc93": "SELECT AVG(valuenum) AS avg_magnesium\nFROM labevents\nWHERE subject_id = 10019172\nAND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Magnesium')\nAND charttime >= DATE('now', 'start of month', '-1 month')\nAND charttime < DATE('now', 'start of month');",
    "c3edbb8f5bd0cfd4858c41be": "",
    "f6c2ec0da1bf93fc0c8595c0": "SELECT org_name \nFROM microbiologyevents \nWHERE subject_id = 10029291 \n  AND hadm_id = (SELECT hadm_id \n                 FROM admissions \n                 WHERE subject_id = 10029291 \n                 ORDER BY admittime ASC \n                 LIMIT 1) \n  AND spec_type_desc = 'Sputum' \n  AND test_name = 'Gram's Stain' \n  AND charttime = (SELECT MIN(charttime) \n                   FROM microbiologyevents \n                   WHERE subject_id = 10029291 \n                     AND hadm_id = (SELECT hadm_id \n                                    FROM admissions \n                                    WHERE subject_id = 10029291 \n                                    ORDER BY admittime ASC \n                                    LIMIT 1) \n                     AND spec_type_desc = 'Sputum' \n                     AND test_name = 'Gram's Stain');",
    "f2be9084ce59ddbf5372d16a": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10019172\nAND spec_type_desc = 'Urine'\nAND charttime >= DATE('now', '-1 month')\nORDER BY charttime DESC\nLIMIT 1;",
    "bbef3c6dded10fa7874540f2": "SELECT \n  MAX(charttime) AS latest_charttime,\n  org_name AS organism\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10016742\n  AND spec_type_desc = 'Sputum'\n  AND charttime >= '2021-08-21'\nGROUP BY \n  org_name;",
    "dd880129ab0eb4dc203813f8": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10007818 AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10007818\n    ORDER BY admittime\n    LIMIT 1\n) AND spec_type_desc = 'Blood Culture'\nORDER BY charttime\nLIMIT 1;",
    "f5f185ff5f7901dc7c4dd711": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10037861 \n  AND charttime >= '2005-05-2100'\n  AND test_name = 'First urine test';",
    "ee3ef44107690c988c06c3e4": "",
    "441abc9cec7ed48c4b29a5c3": "SELECT \n    spec_type_desc AS Specimen_Test, \n    test_name AS Test_Name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10002495 \n    AND strftime('%Y-%m', charttime) = '2000-06';",
    "c309a617ea1462d56fdac6d2": "SELECT \n    MIN(charttime) AS first_specimen_time,\n    spec_type_desc AS specimen_description\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10018501 AND\n    charttime >= '04/2100' \nGROUP BY \n    spec_type_desc;",
    "7782eddef35c5010b9b90ac3": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10036156\n  AND charttime >= '2006-06-21'\nORDER BY charttime ASC\nLIMIT 1;",
    "38447d52a601457cc529a5b1": "WITH RecentTests AS (\n    SELECT \n        subject_id, \n        spec_type_desc, \n        MAX(charttime) AS latest_charttime\n    FROM \n        microbiologyevents\n    WHERE \n        subject_id = 10005909 \n        AND charttime >= DATE('now', '-15 months')\n    GROUP BY \n        subject_id, \n        spec_type_desc\n)\nSELECT \n    spec_type_desc\nFROM \n    RecentTests;",
    "2d7404fcfff0b855a4fb2fe9": "",
    "2e8d527ae93a03ae76d66369": "SELECT \n  spec_type_desc AS first_specimen_test_name\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10007795\n  AND hadm_id = (SELECT MIN(hadm_id) FROM admissions WHERE subject_id = 10007795);",
    "9720cb4a260b30525538f8b2": "SELECT MIN(charttime) AS first_test_time, spec_type_desc\nFROM microbiologyevents\nWHERE subject_id = 10022281\nAND charttime LIKE '%06/2100%';",
    "bd164a06951b24d9fbb32e90": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10008454\nAND charttime >= DATE('now', 'start of month')\nORDER BY charttime DESC\nLIMIT 1;",
    "c03994e0de214c507a8f8002": "SELECT \n    MIN(charttime) AS first_charttime,\n    spec_type_desc\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10018845\nGROUP BY \n    spec_type_desc\nORDER BY \n    first_charttime\nLIMIT 1;",
    "a49efc1cdf3ebbe617aa7d26": "SELECT test_name, org_name\nFROM microbiologyevents\nWHERE subject_id = 10008454\nAND charttime BETWEEN '2023-12-01' AND '2023-12-31'\nORDER BY charttime DESC\nLIMIT 1;",
    "fd2461146ec138678719d7e3": "WITH LastAdmission AS (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10002495\n    ORDER BY hadm_id DESC\n    LIMIT 1\n)\nSELECT\n    T3.test_name\nFROM\n    patients T1\nINNER JOIN LastAdmission T2 ON T1.subject_id = 10002495\nINNER JOIN microbiologyevents T3 ON T2.hadm_id = T3.hadm_id\nWHERE\n    T3.charttime = (\n        SELECT MAX(charttime)\n        FROM microbiologyevents\n        WHERE hadm_id = T2.hadm_id\n    );",
    "c68bc6d51b04677c09432ee6": "SELECT \n    test_name\nFROM \n    microbiologyevents\nWHERE \n    hadm_id = 1 AND subject_id = 10004235\nORDER BY \n    charttime ASC\nLIMIT 1;",
    "d738acddca870a290c446af4": "",
    "677aa66bc6c493237c9e78ee": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10018845\n  AND charttime = (\n    SELECT MAX(charttime)\n    FROM microbiologyevents\n    WHERE subject_id = 10018845\n  );",
    "21f4165a3f8a7a30e0b78f54": "SELECT label AS input_name\nFROM d_items\nJOIN inputevents ON d_items.itemid = inputevents.itemid\nWHERE inputevents.subject_id = 10009049\nAND DATE(inputevents.starttime) = '2023-06-13';",
    "ac033d9ef9eacbfbf6ddce05": "SELECT T1.itemid, T2.label, T1.totalamount, T1.totalamountuom\nFROM inputevents AS T1\nJOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10021487 AND T1.starttime >= '06/22/2100'\nORDER BY T1.starttime\nLIMIT 1;",
    "0265a95e555d0c4a8c1f3d50": "SELECT \n    d_items.label AS input_item_name\nFROM \n    inputevents\nJOIN \n    d_items ON inputevents.itemid = d_items.itemid\nWHERE \n    inputevents.subject_id = 10021487 \n    AND strftime('%Y-%m', inputevents.starttime) = '2023-11'\nORDER BY \n    inputevents.starttime ASC\nLIMIT 1;",
    "674bcd311bac8e9ec3bcdba0": "",
    "45ecebf7e481e6c14fdc01cd": "SELECT ie.itemid\nFROM inputevents ie\nJOIN patients p ON ie.subject_id = p.subject_id\nWHERE p.subject_id = 10018081\n  AND DATE(ie.starttime) = '2023-12-30'  -- Assuming the year is 2023\nORDER BY ie.starttime DESC\nLIMIT 1;",
    "18bf32ca58ea6def07157a60": "SELECT \n    i.totalamountuom\nFROM \n    inputevents i\nJOIN \n    icustays ic ON i.stay_id = ic.stay_id\nWHERE \n    i.subject_id = 10029291  \n    AND ic.stay_id = (\n        SELECT \n            MAX(stay_id)\n        FROM \n            icustays\n        WHERE \n            subject_id = 10029291\n    )\nORDER BY \n    i.starttime DESC\nLIMIT 1;",
    "6f1d4f9ac8b86db76c98d50f": "SELECT \n    di.label AS input_name\nFROM \n    inputevents ie\nINNER JOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    ie.subject_id = 10011398\n    AND ie.starttime >= '2007-20-2100'\nORDER BY \n    ie.starttime ASC\nLIMIT 1;",
    "6b01b95b07df8e89058e4862": "SELECT SUM(T1.totalamount) AS total_input\nFROM inputevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10021312 \n  AND T1.charttime BETWEEN '2100-09-17 00:00:00' AND '2100-09-17 23:59:59'\n  AND T2.label IN ('Oral', 'Crystalloid');",
    "61044fc8b56af395d27bc3ca": "SELECT SUM(totalamount) AS total_cryoprecipitate\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 10006053\nAND DATE(inputevents.starttime) = '2023-11-16'\nAND d_items.label = 'Cryoprecipitate';",
    "654af28177758d29e5368635": "SELECT totalamount\nFROM inputevents\nWHERE subject_id = 10004235\nAND starttime = '03/20/2100'\nAND itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE abbreviation = 'LR'\n);",
    "9e06157df2f8d7330094763f": "SELECT SUM(totalamount) AS total_solution_amount\nFROM inputevents\nWHERE subject_id = 10019917\n  AND starttime >= DATE('now', 'start of year', '+27 days') -- Assuming 2023 is the current year\n  AND starttime < DATE('now', 'start of year', '+28 days')\n  AND totalamountuom = 'Solution';",
    "4bc83d6264e9674296907cec": "SELECT \n  SUM(ie.totalamount) AS total_amount\nFROM \n  inputevents ie\n  INNER JOIN d_items di ON ie.itemid = di.itemid\nWHERE \n  ie.subject_id = 10027602 \n  AND ie.starttime LIKE '2021-11-29%'\n  AND di.label LIKE '%gastric med%';",
    "9b1a61e9a3cf7261a416c001": "SELECT \n  SUM(T1.totalamount) AS total_kcl_administered\nFROM \n  inputevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10022017 \n  AND T2.label = 'KCl (bolus)'\n  AND DATE(T1.starttime) = '2023-10-03'",
    "62b637c8df8e9435c243a84a": "SELECT SUM(T.totalamount) AS total_amount\nFROM inputevents AS T\nJOIN admissions AS A ON T.hadm_id = A.hadm_id\nWHERE T.subject_id = 10039831 \nAND A.admittime >= '2021-10-06' \nAND T.itemid IN (SELECT itemid FROM d_items WHERE label IN ('OR RBC', 'PACKED RBC'));",
    "6136c38332507c02dfcc394d": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10010471 AND starttime >= '2021-06-08';",
    "032b87119c5b76d8394a9373": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10021487\n  AND starttime LIKE '2021-12-20%';",
    "7868c1035a69f54e888cb24c": "SELECT SUM(totalamount) AS total_volume\nFROM inputevents\nWHERE subject_id = 10020740 AND starttime = '2010-04-11 00:00:00';",
    "5e583d5affb4e1b0f6e62364": "SELECT SUM(T1.totalamount) AS total_input\nFROM inputevents AS T1\nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.subject_id = 10011398 AND T1.starttime >= '2001-10-15';",
    "1652f9d26e284f0b715c9070": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10018081 AND starttime >= '2001-12-01';",
    "852fe0f9eab141f83e933cfd": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10018501 AND starttime BETWEEN '2010-01-01' AND '2020-12-31';",
    "8e819ca96ee526f42389d521": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10005817\nAND starttime >= '2021-04-14';",
    "be9406622ce9314da8536fea": "SELECT \n    valueuom, \n    value, \n    charttime \nFROM \n    outputevents \nWHERE \n    subject_id = 10039831 \n    AND charttime >= '10/23/2100' \nORDER BY \n    charttime ASC \nLIMIT 1;",
    "f6e8b06dc6af06677ce3573e": "SELECT MAX(charttime) AS last_output_time, valueuom, value\nFROM outputevents\nWHERE subject_id = 10014354 AND charttime >= '2021-04-12'\nGROUP BY valueuom, value;",
    "ae9a06614595aba70dc8365e": "SELECT \n    valueuom,\n    value,\n    charttime\nFROM \n    outputevents\nWHERE \n    subject_id = 10010471\n    AND charttime >= '2100-04-01'\nORDER BY \n    charttime ASC\nLIMIT 1;",
    "59e0af10bd7f401a8e0193db": "SELECT outputevents.value, outputevents.valueuom, outputevents.charttime\nFROM outputevents\nWHERE outputevents.subject_id = 10019172\n  AND outputevents.charttime > '03/12/2100'\nORDER BY outputevents.charttime ASC\nLIMIT 1;",
    "9381ef3a83219886a02144fc": "",
    "193315d3d4b5326e56e84b77": "SELECT valueuom\nFROM outputevents\nWHERE subject_id = 10035185 AND charttime = '2023-05-18 00:00:00';",
    "2766c75e65819b7cf9c0fba2": "SELECT value AS output_name\nFROM outputevents\nWHERE subject_id = 10020944 AND charttime > '2021-03-04'\nORDER BY charttime DESC\nLIMIT 1;",
    "1dd5f6600a1779d3902b0c74": "SELECT SUM(T.totalamount) AS total_blakemore_amount\nFROM inputevents T\nINNER JOIN admissions A ON T.hadm_id = A.hadm_id\nWHERE T.subject_id = 10006053 AND T.itemid = (SELECT itemid FROM d_items WHERE label = 'blakemore') AND T.starttime >= '2021-01-17'",
    "e4f78cd53a4a70e9d10c4eea": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10015931\n  AND charttime >= '2006-12-06'\n  AND valueuom = 'uL';",
    "c99300a7ea88ef7b82951b42": "",
    "2821799cf4699b6d8e3e4c43": "SELECT \n    SUM(totalamount) AS total_foley_output\nFROM \n    outputevents\nWHERE \n    subject_id = 10020740\n    AND charttime = '2010-04-13'\n    AND itemid = (SELECT itemid FROM d_items WHERE label = 'Foley Catheter');",
    "e0ef594aee8d798aff512963": "SELECT \n    SUM(totalamount) AS total_tf_residual_output_amount\nFROM \n    inputevents\nWHERE \n    subject_id = 10021487\n    AND starttime = '2021-12-16 00:00:00'\n    AND itemid = (\n        SELECT \n            itemid \n        FROM \n            d_items \n        WHERE \n            label = 'TF Residual Output'\n    );",
    "7594a1fd06d38d2b7a869964": "SELECT i.totalamount, i.totalamountuom\nFROM inputevents i\nJOIN patients p ON i.subject_id = p.subject_id\nWHERE i.starttime >= '2100-12-07' AND p.subject_id = 10004733 AND i.itemid = 12345;",
    "98a679829a4f28ba76a5e3dc": "SELECT SUM(totalamount) AS total_tf_residual\nFROM inputevents\nWHERE subject_id = 10007818\nAND starttime >= '01/23/2100'\nAND totalamountuom = 'tf residual';",
    "184fc5e11e0bfc9be1a0263c": "SELECT o.value\nFROM outputevents o\nINNER JOIN admissions a ON o.hadm_id = a.hadm_id\nWHERE a.subject_id = 10020944 AND strftime('%Y-%m-%d', o.charttime) = '2023-03-15';",
    "9f044b75ba284f6e96d21088": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10010471 AND charttime > '2021-04-11';",
    "06d531ccb4fb7b80b892121f": "SELECT SUM(o.value) AS total_output_volume\nFROM patients p\nJOIN outputevents o ON p.subject_id = o.subject_id\nWHERE p.subject_id = 10023239\nAND o.charttime LIKE '2023-06-29%';",
    "67c2dbeaea4791e0feb0a69b": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10007058 AND charttime > '2021-10-05 00:00:00';",
    "b71409d570252fbb7bc7ecd0": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10007058 AND charttime >= '2100-03-20';",
    "9cb9aa60b28077c70929769c": "SELECT SUM(oe.value) AS total_output_amount\nFROM outputevents oe\nJOIN icustays icu ON oe.hadm_id = icu.hadm_id AND oe.stay_id = icu.stay_id\nWHERE icu.stay_id = (\n    SELECT MAX(stay_id)\n    FROM icustays\n    WHERE subject_id = 10018501\n)\nAND oe.subject_id = 10018501;",
    "8cf47ff1a1ec5cf642c7ff41": "SELECT SUM(T1.value) AS total_output\nFROM outputevents AS T1\nINNER JOIN patients AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.subject_id = 10020740 AND \n      T1.charttime = '04/06/2100';",
    "8223111c9b4bc944555d36a9": "SELECT SUM(i.totalamount) - SUM(o.value) AS volume_difference\nFROM inputevents i\nLEFT JOIN outputevents o ON i.subject_id = o.subject_id AND i.hadm_id = o.hadm_id AND i.itemid = o.itemid AND i.starttime = o.charttime\nWHERE i.subject_id = 10020944 AND i.starttime >= '2021-07-03';",
    "cfc51c8ede5f274642cc55f4": "SELECT value \n     FROM outputevents \n     WHERE subject_id = 10031404 \n       AND charttime >= '2021-06-05') AS combined_events;",
    "1f2e5b03343f0c4f90575af1": "WITH\n  PatientInputOutput AS (\n    SELECT\n      inputevents.subject_id,\n      inputevents.itemid,\n      inputevents.totalamount,\n      inputevents.totalamountuom,\n      inputevents.totalamount * CASE WHEN inputevents.totalamountuom = 'ml' THEN 1 ELSE 0 END AS total_input_ml,\n      outputevents.value * CASE WHEN outputevents.valueuom = 'ml' THEN 1 ELSE 0 END AS total_output_ml\n    FROM\n      inputevents\n      LEFT JOIN outputevents ON inputevents.subject_id = outputevents.subject_id AND inputevents.itemid = outputevents.itemid\n      AND DATE(inputevents.starttime) = DATE(outputevents.charttime)\n    WHERE\n      inputevents.subject_id = 10038999 AND\n      DATE(inputevents.starttime) = '2023-05-31'\n  ),\n  TotalInputOutput AS (\n    SELECT\n      SUM(total_input_ml) AS total_input_ml,\n      SUM(total_output_ml) AS total_output_ml\n    FROM\n      PatientInputInput\n  )\nSELECT\n  total_input_ml - total_output_ml AS difference\nFROM\n  TotalInputOutput;",
    "714cfbc303feb382801e761a": "SELECT \n  SUM(T1.totalamount) AS total_input,\n  SUM(T2.value) AS total_output,\n  SUM(T1.totalamount) - SUM(T2.value) AS input_output_diff\nFROM inputevents T1\nLEFT JOIN outputevents T2 ON T1.subject_id = T2.subject_id\n  AND T1.hadm_id = T2.hadm_id\n  AND T1.itemid = T2.itemid\n  AND T1.starttime <= T2.charttime\nWHERE T1.subject_id = 10021487\n  AND T1.starttime >= '2100-07-21 00:00:00';",
    "9e01feccdfca373aaed464f2": "SELECT \n  (SUM(CASE \n        WHEN ie.subject_id = 10021666 THEN ie.totalamount \n        ELSE 0 \n      END) \n   - SUM(CASE \n        WHEN oe.subject_id = 10021666 THEN oe.value \n        ELSE 0 \n      END)) AS difference\nFROM inputevents ie\nLEFT JOIN outputevents oe ON ie.subject_id = oe.subject_id AND ie.hadm_id = oe.hadm_id\nWHERE ie.subject_id = 10021666\n  AND ie.starttime >= '03/27/2100'\n  AND (oe.charttime >= '03/27/2100' OR oe.charttime IS NULL);",
    "1f2b5a242cc55bb7ebee0365": "SELECT \n    SUM(inputevents.totalamount) AS total_input_volume,\n    SUM(outputevents.value) AS total_output_volume,\n    SUM(inputevents.totalamount) - SUM(outputevents.value) AS volume_difference\nFROM \n    inputevents\nJOIN \n    outputevents ON inputevents.subject_id = outputevents.subject_id\nWHERE \n    inputevents.subject_id = 10015272 \n    AND inputevents.starttime >= '02/08/2100' \n    AND outputevents.charttime >= '02/08/2100';",
    "e64af8ed53f80505d1cf19e3": "SELECT SUM(inputevents.totalamount) AS total_input, \n       SUM(outputevents.value) AS total_output\nFROM inputevents\nJOIN outputevents ON inputevents.subject_id = outputevents.subject_id \n                 AND inputevents.hadm_id = outputevents.hadm_id\nWHERE inputevents.subject_id = 10021312 \nAND inputevents.starttime > datetime('now', '-155 days');",
    "34c6a8eeee0902700d4a2885": "SELECT T1.subject_id, T1.charttime, T2.label, T1.valuenum\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10004422 AND T2.label = 'Respiratory Rate'\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "ea6a1b775d7a1387dac35ee2": "selecting the first one.\n2. **Filter Lab Events**: We need to filter lab events that correspond to arterial blood pressure systolic (`itemid` corresponding to 'Arterial Blood Pressure Systolic').\n3. **Get the Last Value**: We need to retrieve the last value of the lab event within the first ICU stay.",
    "3e69a6b789c8a2c74de0771d": "",
    "550a6a2fb0ecbf40e74fdb86": "SELECT valueuom\nFROM chartevents\nWHERE subject_id = 10010471\nAND itemid = (\n  SELECT itemid\n  FROM d_items\n  WHERE label = 'o2 saturation pulseoxymetry'\n)\nORDER BY charttime DESC\nLIMIT 1;",
    "34320356e0e8b8b03cfb94be": "SELECT valuenum AS last_temperature\nFROM chartevents\nWHERE subject_id = 10009035 AND valueuom = '\u00b0C'\nORDER BY charttime DESC\nLIMIT 1;",
    "880392e9b0ba16e0c00356d2": "SELECT value\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10021487 \n  AND di.label = 'Respiratory Rate'\n  AND ce.charttime = (\n    SELECT MAX(ce2.charttime)\n    FROM chartevents ce2\n    WHERE ce2.subject_id = 10021487 \n      AND di.label = 'Respiratory Rate'\n  );",
    "0e13e0edf9b3f935d475fa33": "SELECT\n    t1.subject_id,\n    t1.hadm_id,\n    t1.charttime,\n    t1.valuenum,\n    t1.valueuom\nFROM\n    chartevents t1\nINNER JOIN\n    d_items t2 ON t1.itemid = t2.itemid\nWHERE\n    t1.subject_id = 10025612\n    AND t2.label = 'O2 saturation pulseoxymetry'\n    AND DATE(t1.charttime) = '2022-10-01'\nORDER BY\n    t1.charttime DESC\nLIMIT 1;",
    "068a6fbca2eb611746f77955": "SELECT \n  MIN(valuenum) AS min_respiratory_rate\nFROM \n  chartevents\nWHERE \n  subject_id = 10021487 AND \n  itemid = (\n    SELECT \n      itemid \n    FROM \n      d_items \n    WHERE \n      label = 'Respiratory Rate'\n  ) AND \n  charttime BETWEEN '2021-01-01 00:00:00' AND '2021-01-31 23:59:59';",
    "8f13d57ff126b0360f9b38a9": "SELECT MIN(T1.valuenum) AS min_SpO2\nFROM labevents T1\nJOIN d_labitems T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10037975\nAND T1.charttime LIKE '2023-02-10%'\nAND T2.label = 'SpO2';",
    "7b7e0d370650fe79de5ab188": "SELECT MIN(chartevents.valuenum) AS minimum_heart_rate\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nJOIN patients ON chartevents.subject_id = patients.subject_id\nWHERE d_items.label = 'Heart Rate'\nAND patients.subject_id = 10016810\nAND chartevents.charttime >= date('now', '-206 days');",
    "fdc3e0fe626d90707f9b9320": "SELECT MAX(T2.valuenum)\nFROM patients AS T1\nINNER JOIN chartevents AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN d_items AS T3 ON T2.itemid = T3.itemid\nWHERE T1.subject_id = 10029291 AND T3.label = 'Heart Rate';",
    "ec946af2d91d7d53d35312e6": "",
    "c002c7dd1abbdad1014192e2": "SELECT AVG(ce.valuenum) AS average_diastolic_blood_pressure\nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10013049\n  AND di.label = 'Diastolic Blood Pressure'\n  AND ce.stay_id = (\n    SELECT icu.stay_id\n    FROM icustays icu\n    WHERE icu.subject_id = 10013049\n    ORDER BY icu.outtime DESC\n    LIMIT 1\n  );",
    "c4e3a7be2d01b9b7351a661d": "SELECT MAX(T1.valuenum) AS max_blood_pressure\nFROM chartevents AS T1\nJOIN d_items AS T2 ON T1.itemid = T2.itemid\nJOIN patients AS T3 ON T3.subject_id = T1.subject_id\nWHERE T3.subject_id = 10005817\n  AND T2.label = 'Mean Blood Pressure'\n  AND T1.charttime > '2021-11-08'",
    "a5253b5b458dbf9c057541b0": "SELECT admittime \nFROM admissions\nWHERE subject_id = 10011398 \nORDER BY admittime DESC \nLIMIT 1;",
    "f03270451ac730c92efdd5b1": "",
    "609e844629d62f94381a53ef": "SELECT MAX(admittime) AS latest_admission_time\nFROM admissions\nWHERE subject_id = 10002495;",
    "82fed921fe732e9851109fa0": "SELECT \n  MAX(admittime) AS last_admission_time\nFROM \n  admissions\nWHERE \n  subject_id = 10016150;",
    "c9887571dd618b516d5a3741": "SELECT \n    admittime \nFROM \n    admissions \nWHERE \n    subject_id = 10003046 \nORDER BY \n    admittime ASC \nLIMIT 1;",
    "b357f1cf8213ef5655a20b3b": "SELECT MIN(admittime) AS first_admission_time\nFROM admissions\nWHERE subject_id = 10014729;",
    "6a0f9787ca51fccbc44a087c": "",
    "44e4b4d97cbe90cf626c4424": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10014729\nAND admission_type = 'Referral';",
    "138fe3a23beda4b897c27c94": "SELECT MIN(a.admittime) AS first_admission_time\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.subject_id = 10004457;",
    "a3b2c1bfc83f38e441791752": "",
    "145d13b35f2fd6558b0a9b99": "SELECT \n  MIN(admissions.admittime) AS first_admission_time\nFROM \n  admissions\nWHERE \n  admissions.subject_id = 10007795\n  AND admissions.admission_type = 'transfer from hospital';",
    "d21ad3ab275f6cb81643201e": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10002930\n  AND admission_type = 'physician referral';",
    "be0c83bb4816c62c521f4f19": "SELECT MIN(a.admittime) AS first_admission_time\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.subject_id = 10025612\nAND a.admission_type = 'Physician referral';",
    "b20d40188481222bfbb9b02f": "SELECT MIN(admittime) AS first_admittime\nFROM admissions\nWHERE subject_id = 10014078 AND admission_location = 'Emergency';",
    "eaf50bee63448bac98063353": "SELECT dischtime \nFROM admissions \nWHERE subject_id = 10029484 \nORDER BY dischtime DESC \nLIMIT 1;",
    "8264ca08e450da03c5c58c2a": "",
    "2cdba5b8a95c49f552fbdf57": "SELECT discharge_location\nFROM admissions\nWHERE subject_id = 10004235\nORDER BY dischtime DESC\nLIMIT 1;",
    "7e8d5196747ac83500ed63a2": "SELECT dischtime\nFROM admissions\nWHERE subject_id = 10036156;",
    "4d5c298e863a86919a4a499a": "SELECT discharge_location\nFROM admissions\nWHERE subject_id = 10015860\nORDER BY admittime ASC\nLIMIT 1;",
    "be1e758721f63febd66af577": "SELECT \n  dischtime AS discharge_time\nFROM \n  admissions\nWHERE \n  subject_id = 10023239\nORDER BY \n  admittime ASC\nLIMIT 1;",
    "d6ea3d8ed946d219e8c6b546": "SELECT dischtime\nFROM admissions\nWHERE subject_id = 10029291\nORDER BY dischtime DESC\nLIMIT 1;",
    "1300c7d483802a1d509ca6f4": "SELECT \n    (julianday(i.outtime) - julianday(i.intime)) AS icu_days\nFROM \n    icustays i\nJOIN \n    admissions a ON i.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10019777;",
    "01c32ce2101e22b2dfea210b": "",
    "f632d74fbbe2ef65a5547997": "SELECT \n    julianday(icu.outtime) - julianday(icu.intime) AS duration_of_stay_days\nFROM \n    icustays icu\nJOIN \n    admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE \n    adm.subject_id = 10006580\nORDER BY \n    icu.intime DESC\nLIMIT 1;",
    "e366e701723a7868b82006d6": "SELECT \n    (julianday(icustays.outtime) - julianday(icustays.intime)) AS LengthOfStay\nFROM \n    icustays\nJOIN \n    admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE \n    admissions.subject_id = 10025612\nORDER BY \n    icustays.outtime DESC\nLIMIT 1;",
    "07e1885e41d9b6a449fd69a5": "SELECT \n  MAX(icustays.outtime) - MIN(icustays.intime) AS last_stay_in_days\nFROM \n  icustays\nWHERE \n  icustays.subject_id = 10023239;",
    "461b2614afff7dfabc033d6e": "SELECT \n  (julianday(icustays.outtime) - julianday(icustays.intime)) AS length_in_days\nFROM \n  icustays\nWHERE \n  icustays.subject_id = 10022041\n  AND icustays.outtime IS NOT NULL\nORDER BY \n  icustays.outtime DESC\nLIMIT 1;",
    "4c25e26fad35ddcb5d7e1eb0": "",
    "c06d5f1b8c8e4396f73f77c8": "SELECT \n    MIN(starttime) AS first_prescription_time\nFROM \n    prescriptions\nWHERE \n    subject_id = 10014729\n    AND starttime >= '01/2100';",
    "953fa6166e8ed2ab67753af8": "SELECT MAX(starttime) AS latest_prescription_date\nFROM prescriptions\nWHERE subject_id = 10008287 AND starttime >= '01/2100';",
    "73924b9389e02ce45d9e3c48": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10022017 AND starttime >= '2021-04-21 00:00:00';",
    "994ebca608bc1b2f8b1bb1c7": "SELECT MIN(starttime) \nFROM prescriptions \nWHERE subject_id = 10016742 \n  AND starttime LIKE '%08/%' \n  AND starttime LIKE '%/%/2023%';",
    "0f107c9e56d31b410f4f045c": "",
    "199101dc32631127e35693a6": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10013049\nAND starttime >= '02/2100';",
    "f5baeb5fd7062bd570005226": "SELECT MAX(T2.starttime) AS last_prescription_time\nFROM admissions AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10027602\nAND T1.admittime = (\n  SELECT MIN(admittime)\n  FROM admissions\n  WHERE subject_id = 10027602\n);",
    "d4f2dc48d747e43282e99fc7": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10025463 AND hadm_id = 1 AND drug = 'quinidine gluconate e.r.';",
    "9ff61e95883c730111d063bb": "SELECT MIN(p.starttime) AS first_prescription\nFROM prescriptions p\nJOIN patients pa ON p.subject_id = pa.subject_id\nWHERE pa.subject_id = 10010471\nAND p.drug = '5% Dextrose'\nAND p.starttime >= '10/21/2000';",
    "448d117f9de70ed2d4dc414e": "SELECT \n  MAX(T1.stoptime) AS last_prescription_time\nFROM \n  prescriptions AS T1\n  INNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2.subject_id\n  INNER JOIN cost AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE \n  T1.drug = 'metoprolol tartrate'\n  AND T3.event_type = '10/2100'\n  AND T2.subject_id = 10019172;",
    "42a6e5d9d3862cee91a004d2": "SELECT MAX(starttime) AS last_prescribed_time\nFROM prescriptions\nWHERE subject_id = 10027602 AND drug = 'bisacodyl' AND starttime >= DATE('now', 'start of month');",
    "1763cfe655f1ba381ad8e71e": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10008454\nAND drug = 'Ciprofloxacin HCl'\nAND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10008454\n    ORDER BY admittime DESC\n    LIMIT 1\n);",
    "28cf75715d1cf3411a84ca65": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10004720\n  AND drug = 'citalopram'\n  AND starttime >= DATE('now', 'start of month');",
    "92d6c5d899dfa362deb44658": "",
    "2a8fea2a00fcd986cf1b8067": "SELECT MIN(T1.starttime) AS first_prescription_time\nFROM prescriptions AS T1\nINNER JOIN prescriptions AS T2\nON T1.subject_id = T2.subject_id\nWHERE T1.subject_id = 10018423 \n  AND T1.drug = 'vancomycin'\n  AND T2.drug = 'ondansetron'\n  AND T1.starttime = T2.starttime;",
    "df18089e3b87a2aa47f39d54": "SELECT MAX(T1.charttime) AS last_chart_time\nFROM labevents AS T1\nINNER JOIN prescriptions AS T2\n    ON T1.subject_id = T2.subject_id\n    AND T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10005817\n    AND T2.drug IN ('insulin', 'glucagon')\n    AND T1.charttime LIKE '%-%-2023%'\n    AND T1.charttime NOT LIKE '%-%-2023%'\nGROUP BY T1.charttime\nHAVING COUNT(DISTINCT T2.drug) = 2;",
    "d570690bd00855db57f1e385": "SELECT MIN(p1.starttime) AS first_prescription_time\nFROM prescriptions p1\nJOIN prescriptions p2 ON p1.subject_id = p2.subject_id AND p1.hadm_id = p2.hadm_id\nWHERE p1.subject_id = 10007058\n  AND p1.drug = 'heparin'\n  AND p2.drug = '5% dextrose'\n  AND p1.starttime >= DATE('now', '-1 month');",
    "21a6fcf7e340c9ff6f9e4eda": "SELECT \n    MAX(p.starttime) AS last_prescription_time\nFROM \n    prescriptions p\nWHERE \n    p.subject_id = 10019172\n    AND p.drug IN ('0.9% sodium chloride', 'docusate sodium (liquid)')\n    AND strftime('%Y-%m', p.starttime) = strftime('%Y-%m', 'now', '-1 month');",
    "380a7bc3779d96acb5543281": "WITH FirstHADM AS (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10020306\n  ORDER BY hadm_id\n  LIMIT 1\n),\nPrescriptionsForHADM AS (\n  SELECT subject_id, hadm_id, starttime, stoptime, drug\n  FROM prescriptions\n  WHERE hadm_id = (SELECT hadm_id FROM FirstHADM)\n    AND subject_id = 10020306\n)\nSELECT MAX(starttime) AS last_prescription_time\nFROM PrescriptionsForHADM p1\nJOIN PrescriptionsForHADM p2 ON p1.subject_id = p2.subject_id\n  AND p1.hadm_id = p2.hadm_id\n  AND p1.starttime <= p2.starttime\n  AND p2.starttime <= p1.stoptime\nWHERE p1.drug = 'glucose gel'\n  AND p2.drug = 'hydrocodone-acetaminophen (5mg-500mg)';",
    "50ba43b1b326c73868a72835": "SELECT \n  MIN(starttime) AS earliest_starttime\nFROM (\n  SELECT \n    starttime\n  FROM \n    prescriptions p\n  WHERE \n    p.subject_id = 10021118\n    AND p.starttime BETWEEN '2021-12-01' AND '2021-12-31'\n    AND p.route = 'iv'\n    AND p.drug IN ('ketorolac', 'acetaminophen')\n  GROUP BY \n    p.starttime\n  HAVING \n    COUNT(DISTINCT p.drug) = 2\n) AS combined_prescriptions;",
    "9333b4860f452a4674c02cbc": "",
    "f75de59a1a66905c8e18c843": "SELECT \n  subject_id, \n  starttime, \n  drug, \n  dose_val_rx, \n  dose_unit_rx, \n  route\nFROM \n  prescriptions\nWHERE \n  subject_id = 10006580 AND \n  starttime >= date('now', '-26 months') AND \n  route = 'im'\nORDER BY \n  starttime DESC\nLIMIT 1;",
    "bf8aee434927ad78efbb9c37": "SELECT \n  MAX(p.starttime) AS last_iv_prescription_time\nFROM \n  prescriptions p\nJOIN \n  admissions a ON p.hadm_id = a.hadm_id\nWHERE \n  a.subject_id = 10026255 \n  AND p.starttime >= '2006-06-01' \n  AND p.route = 'IV';",
    "ba85b4185b40acf102f505e5": "SELECT MAX(starttime) AS latest_prescription_time\nFROM prescriptions\nWHERE subject_id = 10022880\nAND route = 'IV'\nAND starttime >= '03/2100'\nAND starttime < '04/0100';",
    "9c36c694493cc1a4533c0e35": "SELECT MAX(starttime) \nFROM prescriptions \nWHERE subject_id = 10010471 \nAND starttime > '2008-08-21' \nAND route = 'iv';",
    "9db8bd8eeca37c40ce0282d9": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10038081 AND route = 'neb';",
    "0184b4b16596dc35beb98cfd": "SELECT MIN(starttime) AS first_medication_time\nFROM prescriptions\nWHERE subject_id = 10001217\nAND route = 'po/ng'\nAND starttime >= '2023-12-01'\nAND starttime < '2024-01-01';",
    "4ec0747fdc64218ae8ffc26d": "SELECT MIN(p.starttime) AS first_prescription_time\nFROM prescriptions p\nJOIN patients pa ON p.subject_id = pa.subject_id\nWHERE pa.subject_id = 10019172\n  AND p.route = 'pr';",
    "314c43e484535c98944bc116": "SELECT MIN(charttime) AS first_test_date\nFROM labevents\nWHERE subject_id = 10005817\n  AND charttime > '2000-08-21';",
    "649fd348e56a70012edf8781": "SELECT MAX(labevents.charttime) AS last_lab_test_time\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nJOIN admissions ON labevents.hadm_id = admissions.hadm_id\nWHERE labevents.subject_id = 10009628\nAND d_labitems.label = '10/2100';",
    "a991a62ce361a4375831ca50": "SELECT l.charttime AS last_lab_test_time\nFROM labevents l\nJOIN (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10031404\n  ORDER BY admittime DESC\n  LIMIT 1\n) a ON l.hadm_id = a.hadm_id\nORDER BY l.charttime DESC\nLIMIT 1;",
    "a79380b2785aa5ce66c4b881": "SELECT MAX(labevents.charttime) AS last_test_time\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10036156\nAND d_labitems.label = 'Complete Blood Count'\nAND labevents.charttime > '2007-07-01 00:00:00';",
    "f7e273153edfeb72b98bd9c7": "SELECT MAX(charttime) AS last_lab_test_time\nFROM labevents\nWHERE subject_id = 10009628 AND strftime('%Y-%m', charttime) = strftime('%Y-10', 'now');",
    "5a5fd081d30e9927c3c6dad4": "select the maximum `charttime` from this table for the specified patient and date condition.",
    "8e40479dcfc63f5443fa3003": "SELECT \n  MAX(l.charttime) AS latest_lab_test_time\nFROM \n  labevents l\nWHERE \n  l.subject_id = 10006053 \n  AND l.charttime > '01/2100';",
    "9ae67f8f87f7be444b601b61": "SELECT \n    MIN(ce.charttime) AS first_charttime\nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE di.label = 'Bilirubin, Total'\n  AND ce.subject_id = 10021118\n  AND ce.charttime >= '2010-10-21';",
    "c03885ae374eb4c770e9069a": "Select the maximum `charttime` for the filtered lab events.",
    "d495fd8395126c8eb2bfc70f": "SELECT MIN(l.charttime) AS first_test_time\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10022880\n  AND l.charttime BETWEEN '2023-04-01' AND '2023-04-30'\n  AND d.label = 'Chloride';",
    "576e916cf4beca47606878ba": "SELECT MAX(charttime) AS last_test_time\nFROM labevents\nWHERE subject_id = 10016742;",
    "7dc3347edeff0be3bfeb2b14": "WITH LastStayCTE AS (\n    SELECT \n        i.stay_id, \n        i.outtime,\n        ROW_NUMBER() OVER (PARTITION BY i.subject_id ORDER BY i.outtime DESC) AS stay_rank\n    FROM icustays i\n    WHERE i.subject_id = 10022880\n),\nFirstLabTestCTE AS (\n    SELECT \n        l.charttime,\n        l.itemid,\n        ROW_NUMBER() OVER (PARTITION BY l.hadm_id ORDER BY l.charttime) AS lab_rank\n    FROM labevents l\n    INNER JOIN d_labitems d ON l.itemid = d.itemid\n    WHERE l.subject_id = 10022880 AND d.label = 'ntprobnp'\n    AND l.hadm_id IN (SELECT hadm_id FROM icustays WHERE stay_id = (SELECT stay_id FROM LastStayCTE WHERE stay_rank = 1))\n)\nSELECT \n    f.charttime AS first_lab_test_time\nFROM FirstLabTestCTE f\nWHERE f.lab_rank = 1;",
    "fd8916330e9d2c2e5b150852": "SELECT charttime\nFROM labevents\nWHERE subject_id = 10027445\nORDER BY charttime DESC\nLIMIT 1;",
    "528d495934e0aadbd47ad1b6": "SELECT MIN(charttime) AS first_charttime\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE chartevents.subject_id = 10021312 AND d_items.label = 'RDW';",
    "c80160c40fe40760c9ce27b2": "SELECT MIN(charttime) AS first_max_lymphocytes_time\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE d_labitems.label = 'LYMPHOCYTES'\nAND labevents.subject_id = 10016150\nAND labevents.valuenum = (SELECT MAX(valuenum)\n                         FROM labevents le\n                         INNER JOIN d_labitems li ON le.itemid = li.itemid\n                         WHERE li.label = 'LYMPHOCYTES'\n                         AND le.subject_id = 10016150);",
    "d2063048958d7402567becbf": "WITH chloride_events AS (\n    SELECT \n        l.subject_id,\n        l.charttime,\n        l.valuenum\n    FROM \n        labevents l\n    JOIN \n        d_labitems d ON l.itemid = d.itemid\n    WHERE \n        l.subject_id = 10037928\n        AND d.label = 'Chloride'\n        AND l.charttime > '2000-04-01'\n),\nmax_chloride_event AS (\n    SELECT \n        subject_id,\n        charttime,\n        valuenum\n    FROM \n        chloride_events\n    WHERE \n        valuenum = (SELECT MAX(valuenum) FROM chloride_events)\n)\nSELECT \n    charttime\nFROM \n    max_chloride_event\nORDER BY \n    charttime ASC\nLIMIT 1;",
    "3701159d655f47f5724c7180": "SELECT MIN(ce.charttime) AS last_min_monocytes_time\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10004720 \n  AND di.label = 'Monocytes'\n  AND ce.charttime >= '2020-12-01 00:00:00'\nGROUP BY ce.subject_id;",
    "0bf8b08208180cf560844cba": "SELECT MAX(charttime) AS last_min_phosphate_time\nFROM chartevents\nWHERE subject_id = 10016810\n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Min Phosphate')\n  AND charttime LIKE '2023-07-%';",
    "f49e8d99f34677375d3e576d": "SELECT MIN(charttime) AS first_max_iron_time\nFROM labevents\nWHERE subject_id = 10029484\nAND itemid = (\n  SELECT itemid\n  FROM d_labitems\n  WHERE label = 'Iron'\n)\nAND hadm_id = (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10029484\n  ORDER BY admittime DESC\n  LIMIT 1\n);",
    "327eb60e80b925374560c88e": "",
    "9078d39386848fe27cef5f31": "SELECT MIN(charttime) AS first_charttime\nFROM labevents\nWHERE subject_id = 10004720\n  AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10004720\n    ORDER BY admittime\n    LIMIT 1\n  )\n  AND itemid = (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label = 'Neutrophils'\n  )\n  AND valuenum = (\n    SELECT MAX(valuenum)\n    FROM labevents\n    WHERE subject_id = 10004720\n      AND hadm_id = (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10004720\n        ORDER BY admittime\n        LIMIT 1\n      )\n      AND itemid = (\n        SELECT itemid\n        FROM d_labitems\n        WHERE label = 'Neutrophils'\n      )\n  );",
    "494282796f9c3fdde2f7b727": "select the minimum `charttime` from this table for the specified patient and date range.",
    "56ca21bbb266b349bca3f6e5": "SELECT MIN(charttime) AS first_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10000032 AND charttime >= '2000-05-21';",
    "073f2bf50f7338fb5c3bb42b": "SELECT MAX(charttime) AS last_test_time\nFROM microbiologyevents\nWHERE subject_id = 10039997\n  AND charttime >= '2023-09-01'\n  AND charttime < '2023-10-01';",
    "eeeb5ecc1778f72724d0534d": "SELECT MIN(charttime) \nFROM microbiologyevents \nWHERE subject_id = 10010471 \nAND charttime > '06/21/100';",
    "885642fd5ea14ba51403e397": "SELECT \n  MAX(m.charttime) AS last_test_time\nFROM \n  microbiologyevents m\nWHERE \n  m.subject_id = 10001725;",
    "499518ffdd4562209632b0e7": "SELECT \n    MAX(charttime) AS last_microbiology_test_time\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10002495\n    AND charttime >= '02/2100';",
    "f99580261637ffba691a9a72": "SELECT MIN(charttime) AS first_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10010471\nAND charttime > datetime('now', '-1 month');",
    "21765b418ac742a54e95ff43": "SELECT charttime\nFROM microbiologyevents\nWHERE subject_id = 10021487\nAND charttime > '2007-07-21'\nAND test_name = 'Pleural Fluid'\nORDER BY charttime\nLIMIT 1;",
    "031ff26b606f0d58d734256c": "",
    "8fc30d6e91b22c5fbe1a138b": "SELECT \n    MIN(m.charttime) AS first_microbiological_test_time\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    microbiologyevents m ON a.hadm_id = m.hadm_id\nWHERE \n    p.subject_id = 10016150 AND\n    m.charttime >= '2005-01-01' AND\n    m.spec_type_desc = 'Urine'",
    "76a9a991435e9dfbb0590490": "SELECT MAX(m.charttime) AS last_mrsa_screen_time\nFROM microbiologyevents m\nWHERE m.subject_id = 10019777\n  AND m.charttime BETWEEN '2003-01-01' AND '2003-12-31'\n  AND m.test_name = 'MRSA SCREEN';",
    "58f0822239c07b746c5df6fc": "SELECT MIN(charttime) AS first_screen_time\nFROM microbiologyevents\nWHERE subject_id = 10022041\n  AND charttime BETWEEN '2023-06-01' AND '2023-06-30'\n  AND test_name = 'MRSAscreen';",
    "689c016c32621989ea39ef0c": "SELECT MIN(T1.charttime) AS first_charttime\nFROM microbiologyevents AS T1\nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10008454\n  AND T2.subject_id = 10008454\n  AND T1.charttime > T2.admittime\n  AND T1.test_name = 'MRSSCREEN'\n  AND T2.admittime = (\n    SELECT MIN(T3.admittime)\n    FROM admissions AS T3\n    WHERE T3.subject_id = 10008454\n  );",
    "a88028190c05dd2074203820": "",
    "c503cb58dc8455398570f4a4": "SELECT MAX(starttime) AS last_inputtime\nFROM inputevents\nWHERE subject_id = 10022880 \nAND itemid = (SELECT itemid FROM d_items WHERE abbreviation = 'NaCl 0.9%') \nAND starttime LIKE '2023-04-03%';",
    "8ef3a4c7569d9db7872c7fde": "SELECT \n  i.starttime,\n  d.label\nFROM \n  inputevents i\n  INNER JOIN d_items d ON i.itemid = d.itemid\nWHERE \n  i.subject_id = 10010471\n  AND d.label = 'NaCl 0.9%'\n  AND strftime('%Y-%m-%d', i.starttime) = '2021-12-20'\nORDER BY \n  i.starttime\nLIMIT 1;",
    "5b97eeb5e63797ee9185b85c": "SELECT MIN(i.starttime) AS first_input_time\nFROM inputevents i\nJOIN d_items d ON i.itemid = d.itemid\nWHERE i.subject_id = 10022017\n  AND i.starttime >= '2100-10-03 00:00:00'\n  AND i.starttime < '2100-10-04 00:00:00'\n  AND d.label = 'Dextrose 5% (IV)';",
    "bf8bff577fb09a8df5d3e544": "SELECT MIN(starttime) AS first_po_intake_time\nFROM inputevents\nWHERE subject_id = 10027445 AND itemid = 122 AND DATE(starttime) = '2023-09-09';",
    "7b8dd010ac6d51609aa93314": "SELECT MAX(starttime) AS last_multivitamin_time\nFROM inputevents\nWHERE subject_id = 10038933\n  AND itemid = (SELECT itemid FROM d_items WHERE abbreviation = 'MULTIVITAMIN');",
    "7c188f76017d685690e33f58": "SELECT \n    MAX(starttime) AS last_input_time\nFROM \n    inputevents\nWHERE \n    subject_id = 10039831\n    AND starttime > '2012-12-31 23:59:59'\n    AND itemid IN (SELECT itemid \n                    FROM d_items \n                    WHERE label IN ('Or', 'Crystalloid'));",
    "55c38b5362bf49397a27774e": "SELECT \n  i.itemid, \n  i.totalamount, \n  i.starttime\nFROM \n  inputevents i\nWHERE \n  i.subject_id = 10027602 \n  AND i.itemid = (\n    SELECT itemid \n    FROM d_items \n    WHERE abbreviation = 'NaCl 0.45%'\n  )\n  AND i.starttime LIKE '2023-11-30%'\n  ORDER BY i.starttime ASC\n  LIMIT 1;",
    "9bbe2a60bf98d234e5825b6d": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10019172 AND\n      starttime >= DATE('now', 'start of month', '-1 month') AND\n      starttime < DATE('now', 'start of month');",
    "9bdee5cb67ac4e91e5b630da": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10008454\nAND strftime('%Y-%m', starttime) = '2023-04';",
    "5d9fd7530f8b7c30df604ea3": "SELECT MIN(starttime)\nFROM inputevents\nWHERE subject_id = 10004733\nAND starttime >= '2023-12-28 00:00:00'\nAND starttime < '2023-12-29 00:00:00';",
    "4d8649af3dbd396df7c0075b": "SELECT starttime\nFROM inputevents\nWHERE subject_id = 10014354 AND starttime >= '2021-03-20'\nORDER BY starttime ASC\nLIMIT 1;",
    "3e3acb412956feade24cf02d": "SELECT \n    MAX(T1.starttime) AS LastInputTime\nFROM \n    inputevents AS T1\nINNER JOIN \n    admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10015860\n    AND T1.starttime >= '2021-03-07 00:00:00';",
    "3eb33ba93f9cf1fe30f6a3de": "",
    "b6f5c8c63479dc0c781f71d3": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10005817 AND starttime >= '2021-12-21';",
    "234ef243bc79fbeeafde9f09": "",
    "f54a4c50ee67f5dbec1add73": "SELECT charttime\nFROM chartevents\nWHERE subject_id = 10020740 AND itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2') AND DATE(charttime) = '03/24/2100'\nORDER BY charttime DESC\nLIMIT 1;",
    "176c4a282a56f000735207f8": "SELECT \n    MIN(CAST(charttime AS DATE)) AS first_date \nFROM \n    chartevents \nWHERE \n    subject_id = 10010471 \n    AND itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate') \n    AND charttime LIKE '2019-10-%'",
    "ae02dd831bcaea6f356e18cb": "SELECT MIN(charttime) AS first_time_measured\nFROM chartevents\nWHERE subject_id = 10016810\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\nAND DATE(charttime) = '2023-07-07';",
    "ec5c2b153da669ee108c8957": "",
    "9395b479ccae72fb9bd102d3": "SELECT MIN(charttime) AS first_charttime\nFROM chartevents\nWHERE subject_id = 10019568\n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n  AND DATE(charttime) = '2021-04-02';",
    "e5d7989d4180e49d445f9388": "SELECT MIN(e.charttime) AS first_charttime\nFROM chartevents e\nJOIN icustays i ON e.stay_id = i.stay_id\nWHERE e.subject_id = 10009035\n  AND e.itemid = (SELECT itemid FROM d_items WHERE label = 'Systolic Blood Pressure')\n  AND i.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10009035);",
    "53761ebb18ac5c642c4f2006": "SELECT \n  MIN(T1.charttime) AS first_charttime\nFROM \n  labevents T1\n  INNER JOIN d_labitems T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10010471 \n  AND T2.label = 'Respiratory Rate'\n  AND T1.valuenum > 25.0\n  AND DATE(T1.charttime) = '2019-08-01';",
    "7af68876628a4636df61cbce": "SELECT \n  MAX(c.charttime) AS last_measurement_time\nFROM \n  chartevents c\n  INNER JOIN icustays i ON c.hadm_id = i.hadm_id AND c.stay_id = i.stay_id\nWHERE \n  c.subject_id = 10021487\n  AND i.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10021487)\n  AND c.itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')\n  AND c.valuenum > 16.0;",
    "aba2a9f835c596686850b00a": "WITH RECURSIVE FirstICUStay AS (\n    SELECT \n        icustays.stay_id,\n        icustays.intime,\n        icustays.outtime,\n        icustays.subject_id\n    FROM icustays\n    WHERE icustays.subject_id = 10007818\n    ORDER BY icustays.intime\n    LIMIT 1\n),\nLastHeartRateEvent AS (\n    SELECT \n        ce.charttime,\n        ce.itemid,\n        ce.valuenum\n    FROM chartevents ce\n    JOIN FirstICUStay fis ON ce.stay_id = fis.stay_id\n    WHERE ce.itemid = (\n        SELECT d_items.itemid \n        FROM d_items \n        WHERE d_items.label = 'Heart Rate'\n    )\n    AND ce.valuenum < 150.0\n    ORDER BY ce.charttime DESC\n    LIMIT 1\n)\nSELECT \n    charttime AS last_heart_rate_time\nFROM LastHeartRateEvent;",
    "687e1ab45a6ab29b54c44861": "WITH FirstICUStay AS (\n  SELECT \n    icu.stay_id,\n    icu.intime,\n    icu.outtime\n  FROM icustays icu\n  JOIN patients p ON icu.subject_id = p.subject_id\n  WHERE p.subject_id = 10038999\n  ORDER BY icu.intime\n  LIMIT 1\n),\nICUStayEvents AS (\n  SELECT \n    ce.charttime,\n    ce.itemid,\n    ce.valuenum,\n    ce.valueuom,\n    di.label\n  FROM chartevents ce\n  JOIN d_items di ON ce.itemid = di.itemid\n  WHERE ce.stay_id = (SELECT stay_id FROM FirstICUStay)\n)\nSELECT \n  MAX(ce.charttime) AS latest_event_time\nFROM ICUStayEvents ce\nWHERE ce.valuenum < 96.0 AND ce.valueuom = 'percent';",
    "cb2576703363b2124ae28f7c": "SELECT\n  T1.charttime\nFROM\n  chartevents AS T1\n  JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE\n  T1.subject_id = 10010471\n  AND T2.label = 'Respiratory Rate'\n  AND T1.charttime >= '2022-12-20 00:00:00'\n  AND T1.charttime < '2022-12-21 00:00:00'\n  AND T1.valuenum < 27.0\nORDER BY\n  T1.charttime ASC\nLIMIT 1;",
    "dcfff42d3b4e18800ea55074": "SELECT \n  ce.charttime \nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  ce.subject_id = 10007818\n  AND di.label = 'Heart Rate'\n  AND ce.charttime <= '2100-07-05 23:59:59'\n  AND ce.charttime > '2100-07-05 00:00:00'\n  AND ce.valuenum < 83.0\nORDER BY \n  ce.charttime DESC \nLIMIT 1;",
    "29145deb2421f340268f6323": "",
    "b862c7be7085f5768ab9bd66": "select the most recent timestamp for when this minimum value occurred.",
    "b52f4e22cdd27322676517fc": "WITH LastICUStay AS (\n    SELECT icu.stay_id\n    FROM icustays icu\n    INNER JOIN admissions adm ON icu.hadm_id = adm.hadm_id\n    WHERE adm.subject_id = 10004235\n    ORDER BY icu.intime DESC\n    LIMIT 1\n),\nMaxBloodPressure AS (\n    SELECT MAX(ce.valuenum) AS max_bp\n    FROM chartevents ce\n    INNER JOIN d_items di ON ce.itemid = di.itemid\n    WHERE ce.stay_id = (SELECT stay_id FROM LastICUStay)\n      AND di.label = 'Diastolic Blood Pressure'\n),\nFirstTimeMaxBP AS (\n    SELECT ce.charttime\n    FROM chartevents ce\n    INNER JOIN d_items di ON ce.itemid = di.itemid\n    WHERE ce.stay_id = (SELECT stay_id FROM LastICUStay)\n      AND di.label = 'Diastolic Blood Pressure'\n      AND ce.valuenum = (SELECT max_bp FROM MaxBloodPressure)\n)\nSELECT MIN(charttime) AS first_time_max_bp\nFROM FirstTimeMaxBP;",
    "c0b00ebc518d168b79f08eb4": "SELECT \n    MIN(charttime) AS latest_charttime\nFROM \n    chartevents\nWHERE \n    subject_id = 10023239\n    AND itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n    AND DATE(charttime) = '2021-06-29'\nORDER BY \n    latest_charttime DESC\nLIMIT 1;",
    "9ec14e1d25e50dd996d4e3a7": "SELECT MIN(charttime) AS first_time\nFROM chartevents\nWHERE subject_id = 10004720\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'Body Temperature')\nAND charttime >= (SELECT MAX(charttime) - 228*24*3600 FROM chartevents WHERE subject_id = 10004720)\nAND valuenum = (SELECT MAX(valuenum) AS max_body_temp\n                FROM chartevents\n                WHERE subject_id = 10004720\n                AND itemid = (SELECT itemid FROM d_items WHERE label = 'Body Temperature')\n                AND charttime >= (SELECT MAX(charttime) - 228*24*3600 FROM chartevents WHERE subject_id = 10004720));",
    "565bd442b074a6efca2e0887": "",
    "b65ad812aa58a875e2d64890": "",
    "e799539afbf0b691d6a01724": "SELECT \n  charttime\nFROM \n  labevents AS T1\n  INNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10039997 \n  AND T2.label = 'Mean Blood Pressure'\nORDER BY \n  T1.valuenum DESC\nLIMIT 1;",
    "7cf6accf1943c04c3021431d": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_come_to_hospital\nFROM admissions\nWHERE subject_id = 10004422 \n  AND admittime >= DATE('now', '-1 year');",
    "fbf6757b5a77304084ba36d9": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1 \n            FROM admissions \n            WHERE subject_id = 10018845 \n            AND admittime >= DATE('now', '-1 year')\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS has_been_hospitalized;",
    "d012dd1a0c9587638828166b": "SELECT \n  CASE \n    WHEN MAX(admittime) > '2100' THEN 'Yes' \n    ELSE 'No' \n  END AS has_patient_come_since_2100\nFROM \n  admissions\nWHERE \n  subject_id = 10015272;",
    "44877f8ac388426e512417e3": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS is_hospitalized\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.subject_id = 10021118 AND a.dischtime > '2100-01-01 00:00:00';",
    "c73dd80145bee718f2bf509b": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS has_been_to_hospital\nFROM admissions\nWHERE subject_id = 10005909\n  AND admittime > '2100-01-01 00:00:00';",
    "6699cff955e99112f866a2d5": "SELECT \n    CASE \n        WHEN COUNT(T2.hadm_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS is_hospitalized\nFROM \n    patients T1\nLEFT JOIN \n    admissions T2 ON T1.subject_id = T2.subject_id\nWHERE \n    T1.subject_id = 10020740 \n    AND STRFTIME('%Y', T2.admittime) = STRFTIME('%Y', 'now');",
    "33c6e26e755a5e0efb3a25b9": "SELECT \n    CASE \n        WHEN a.admission_location = 'Emergency Room' THEN 'Yes'\n        ELSE 'No'\n    END AS was_in_emergency_room\nFROM \n    admissions a\nWHERE \n    a.subject_id = 10019568\n    AND a.admission_location = 'Emergency Room';",
    "b422362f19ca6957cfa3fb02": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS \"Did the patient come into the ER during the last year?\"\nFROM \n    admissions\nWHERE \n    subject_id = 10007795\n    AND admission_location = 'ER'\n    AND admittime >= DATE('now', '-1 year');",
    "c3c3a56dc8cd277bd5826031": "",
    "461ed0b2f30a1fe2a7aca6e3": "SELECT admission_location \nFROM admissions \nWHERE subject_id = 10012853;",
    "38b8d432b6882df96340f954": "SELECT \n  p.subject_id\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE \n  p.subject_id = 10008454\n  AND a.admission_location = 'Emergency Room'\n  AND STRFTIME('%Y', a.admittime) = '2100';",
    "f020778ee34bfe4318ed4bde": "SELECT \n    CASE \n        WHEN admission_location = 'Emergency Room' THEN 'Yes'\n        ELSE 'No'\n    END AS in_er\nFROM \n    admissions\nWHERE \n    subject_id = 10001217;",
    "18827b43fd9e61dcfc5d9388": "SELECT admission_location \nFROM admissions \nWHERE subject_id = 10016810 \nAND admission_type = 'ER' \nAND admittime >= date('now', '-1 year');",
    "e62cc504176c8533a1e60738": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_procedure\nFROM \n    procedures_icd\nWHERE \n    subject_id = 10018328;",
    "3376a341796a02ddf1d1814f": "SELECT p.subject_id, d.long_title\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE p.subject_id = 10021666 AND pr.charttime > '2100';",
    "0c85596eb9a5ce81b6fb531c": "SELECT \n    p.subject_id AS patient_id,\n    COUNT(prc.row_id) AS procedure_count\nFROM \n    patients p\nLEFT JOIN \n    procedures_icd prc ON p.subject_id = prc.subject_id\nWHERE \n    p.subject_id = 10005909 AND \n    prc.charttime BETWEEN '2023-01-01' AND '2023-12-31'\nGROUP BY \n    p.subject_id\nHAVING \n    procedure_count > 0;",
    "36178f6bba63163826d1292a": "SELECT \n    MAX(CASE WHEN hadm_id IS NOT NULL THEN 1 ELSE 0 END) AS had_procedures\nFROM \n    procedures_icd p\nJOIN \n    admissions a ON p.hadm_id = a.hadm_id\nWHERE \n    p.subject_id = 10007795 \n    AND p.charttime >= DATE('now', '-1 year');",
    "7fbb236187007480210be707": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_procedure\nFROM \n  procedures_icd\nWHERE \n  subject_id = 10023117 \n  AND hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10023117 \n    ORDER BY admittime \n    LIMIT 1\n  );",
    "d081d7e2db7e69a70b388b51": "SELECT \n  p.subject_id,\n  pr.icd_code\nFROM \n  patients p\nJOIN \n  admissions a ON p.subject_id = a.subject_id\nJOIN \n  procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE \n  p.subject_id = 10009035\n  AND pr.hadm_id IN (\n    SELECT hadm_id FROM admissions WHERE subject_id = 10009035\n    ORDER BY admittime\n    LIMIT 1\n  )",
    "10fd1a4b2a07afed251f289a": "",
    "bd8736e59f3b5eb724910a84": "",
    "889ee571402af73523bd702b": "",
    "0018b73b2eda7611f63bee38": "SELECT \n  p.subject_id,\n  d.long_title AS procedure_title,\n  a.hadm_id AS hadm_id,\n  a.admittime AS admission_time,\n  p.gender\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nINNER JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE p.subject_id = 10029291 \n  AND d.long_title = 'Ultrasonography of superior vena cava, guidance treatment'\n  AND a.hadm_id = 1;",
    "05a8454a6a71435a557db2cc": "SELECT \n    a.subject_id,\n    a.hadm_id,\n    p.icd_code,\n    pr.drug\nFROM admissions a\nJOIN procedures_icd p ON a.hadm_id = p.hadm_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE a.subject_id = 10004733\n  AND p.icd_code = 'Q31.0'\n  AND pr.drug = 'CVP\u7f6e\u7ba1\u5f15\u5bfc\u6cbb\u7597';",
    "7ab5610ee5258787397017e1": "SELECT COUNT(*) > 0 AS has_performed\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE p.subject_id = 10007818\n  AND d.long_title = 'Multiple urinary filtration, multiple'\n  AND p.charttime > '2100-01-01';",
    "c8af28411a3f128722567f9e": "SELECT MAX(hadm_id) AS latest_hadm_id\n   FROM admissions\n   WHERE subject_id = 10023117;",
    "75ad6fb522538101f974da54": "SELECT \n    p.label AS procedure_label\nFROM \n    procedures_icd pi\nJOIN \n    d_icd_procedures p ON pi.icd_code = p.icd_code\nJOIN \n    admissions a ON pi.hadm_id = a.hadm_id\nWHERE \n    pi.icd_code = 'Q12.2'\n    AND a.subject_id = 10025463\n    AND strftime('%Y', pi.charttime) = '2100';",
    "6cf60ddb53c69a32d984068c": "",
    "fcfa89f08cd7518cc467a635": "SELECT \n  T1.long_title\nFROM \n  d_icd_procedures AS T1\n  JOIN procedures_icd AS T2 ON T1.icd_code = T2.icd_code\nWHERE \n  T2.subject_id = 10002495\n  AND T2.charttime >= '06/21/2000'\nGROUP BY \n  T1.long_title\nHAVING \n  COUNT(T2.icd_code) > 1;",
    "2bd36cdf648a73c1405bc0bd": "SELECT \n  icd_code, \n  long_title\nFROM \n  d_icd_procedures\nWHERE \n  icd_code IN (\n    SELECT \n      icd_code\n    FROM \n      procedures_icd\n    WHERE \n      subject_id = 10007795\n      AND charttime >= '2100-01-01'\n    GROUP BY \n      icd_code\n    HAVING \n      COUNT(*) = 2\n  );",
    "68e68711b24f4ee363da9739": "SELECT p.long_title\nFROM procedures_icd pr\nINNER JOIN d_icd_procedures p ON pr.icd_code = p.icd_code\nWHERE pr.subject_id = 10027602\nGROUP BY p.long_title\nHAVING COUNT(pr.row_id) = 2;",
    "080005219b1bf48862540ed2": "SELECT \n  p.subject_id,\n  pr.drug,\n  COUNT(*) AS treatment_count\nFROM \n  patients p\n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  p.subject_id = 10015860\nGROUP BY \n  p.subject_id, pr.drug\nHAVING \n  COUNT(*) > 1;",
    "641bf23b0701d0025cafd597": "SELECT p.long_title AS procedure_name\nFROM procedures_icd pr\nJOIN d_icd_procedures p ON pr.icd_code = p.icd_code\nWHERE pr.subject_id = 10002495\n  AND pr.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10002495\n    ORDER BY admittime ASC\n    LIMIT 1\n  )\nGROUP BY p.long_title\nHAVING COUNT(pr.hadm_id) >= 2;",
    "a868ec00f8a5fa468855f6fd": "SELECT icd_code, charttime\nFROM procedures_icd\nWHERE subject_id = 10021312\nAND charttime >= DATE('now', '-10 months')\nGROUP BY icd_code, charttime\nHAVING COUNT(*) > 1;",
    "cc4d6ffe4f9c497d114ffb8f": "SELECT COUNT(*) \nFROM diagnoses_icd \nWHERE subject_id = 10036156;",
    "c5110fc62fc9ba15034f6482": "SELECT EXISTS (\n    SELECT 1\n    FROM diagnoses_icd d\n    INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n    WHERE a.subject_id = 10018081\n    AND d.charttime >= DATE('now', '-1 year')\n) AS has_diagnosis_in_last_year;",
    "eda3c6670454f65cad04f15c": "SELECT EXISTS (\n    SELECT 1\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    WHERE p.subject_id = 10012552\n) AS has_diagnoses;",
    "56765c70e8dbcc6a5ecdaca5": "SELECT d.long_title \nFROM diagnoses_icd di \nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code \nWHERE di.subject_id = 10007818 AND di.charttime > '2100-01-01';",
    "c73288aeb0cfc184ac029f56": "",
    "f209b8c081219def0ef4ace5": "SELECT\n    CASE\n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS received_diagnosis\nFROM diagnoses_icd\nWHERE subject_id = 10022041;",
    "b11b1fc29cb6a59522daeb8d": "WITH LatestAdmissionCTE AS (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10004733\n    ORDER BY admittime DESC\n    LIMIT 1\n)\nSELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Diagnosis Made'\n        ELSE 'No Diagnosis Made'\n    END AS result\nFROM diagnoses_icd\nWHERE hadm_id = (SELECT hadm_id FROM LatestAdmissionCTE);",
    "81233148fcdb550533d311a4": "",
    "eaddbd134c399ccf75e4f24e": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_subdural_hemorrhage\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE d.subject_id = 10018845\n  AND dd.long_title LIKE '%Subdural Hemorrhage following injury%'\n  AND dd.long_title NOT LIKE '%Open Intracranial Wound%'\n  AND dd.long_title NOT LIKE '%State of consciousness%';",
    "ad475c1d5ff7b04c88a96e2c": "SELECT d.long_title AS diagnosis\nFROM diagnoses_icd d\nJOIN admissions a ON d.hadm_id = a.hadm_id\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.subject_id = 10015931\nAND d.icd_code = 'N18.1'\nAND strftime('%Y', a.admittime) = '2100';",
    "f39c38465d2dfe0e93701a52": "SELECT DISTINCT icd_code\nFROM diagnoses_icd\nWHERE subject_id = 10004235\nAND icd_code = 'K70';",
    "50b2a084d9984e05d63230db": "SELECT \n    p.subject_id, \n    d.long_title AS diagnosis_description\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    diagnoses_icd di ON a.hadm_id = di.hadm_id\nINNER JOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    p.subject_id = 10018081 \n    AND d.long_title LIKE '%anticoagulants%' \n    AND a.dischtime > '2100-01-01';",
    "23aeb815d2db0889eb0f2b24": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_encounter\nFROM \n  patients p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  INNER JOIN d_icd_diagnoses dicd ON d.icd_code = dicd.icd_code\nWHERE \n  p.subject_id = 10015931\n  AND dicd.long_title LIKE '%examination for normal comparison and control in clinical research program diagnosis%'\n  AND d.charttime >= '2100-01-01';",
    "48fcb0d1e3395d14eae1e8b2": "",
    "605dc49bacfb0b462cf31880": "SELECT DISTINCT p.subject_id\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE p.subject_id = 10021118 \nAND pr.drug IN ('Docusate Sodium', '5% Dextrose Solution', 'Polyethylene Glycol 400') \nAND pr.starttime >= '2021-11-2100';",
    "2e4d054961ab8dd569126be6": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes' \n         ELSE 'No' \n       END AS has_drug_been_ordered\nFROM prescriptions\nWHERE subject_id = 10021487\n  AND drug IN ('acetazolamide', 'bisacodyl', '5% dextrose');",
    "c6e32087897377afc707821c": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN p.drug = 'heparin' THEN 1 ELSE 0 END) = 1 THEN 'yes'\n    WHEN MAX(CASE WHEN p.drug = 'iso-osmotic dextrose' THEN 1 ELSE 0 END) = 1 THEN 'yes'\n    WHEN MAX(CASE WHEN p.drug = 'milk of magnesia' THEN 1 ELSE 0 END) = 1 THEN 'yes'\n    ELSE 'no'\n  END AS has_been_prescribed\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10022880 AND p.starttime >= '2100-01-01'",
    "03aa2747a4bbb38e1e9ccb85": "SELECT \n  CASE \n    WHEN COUNT(DISTINCT p.drug) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_prescribed_drug\nFROM patients pa\nINNER JOIN admissions a ON pa.subject_id = a.subject_id\nLEFT JOIN prescriptions p ON a.hadm_id = p.hadm_id\nWHERE pa.subject_id = 10003400\n  AND a.hadm_id = (\n    SELECT MIN(hadm_id)\n    FROM admissions\n    WHERE subject_id = pa.subject_id\n  )\n  AND p.drug IN ('Lisinopril', 'Vitamin D', 'Lenalidomide (Revlimide) 15mg');",
    "977a6055c6232b7e550211d6": "",
    "8575a4d0318c42ed703a89a1": "SELECT \n    p.subject_id,\n    pr.drug,\n    pr.dose_val_rx,\n    pr.dose_unit_rx,\n    pr.route,\n    pr.starttime,\n    pr.stoptime\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10015931  \n    AND pr.starttime >= '2012-12-2100'  \n    AND pr.drug IN ('5% dextrose', 'glucose gel', 'ondansetron');",
    "b66ed8145c0b562f96f32f22": "",
    "9a16562e6c22fbc3ecf55004": "SELECT subject_id, hadm_id, drug, starttime, stoptime\nFROM prescriptions\nWHERE subject_id = 10031404 AND starttime BETWEEN '2008-08-01' AND '2008-08-31';",
    "d60412f228f0e3b6df5b6d8c": "SELECT drug, starttime \nFROM prescriptions \nWHERE subject_id = 10021312 \nAND starttime > '2000-03-21';",
    "b07f1b0cf6f5838302e27ea2": "SELECT \n    CASE \n        WHEN p.subject_id = 10005866 THEN 'Medication issued'\n        ELSE 'No medication issued'\n    END AS medication_status\nFROM \n    prescriptions p\nJOIN \n    admissions a ON p.hadm_id = a.hadm_id\nWHERE \n    p.subject_id = 10005866\n    AND p.hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10005866);",
    "407ffa4fc0b1f6b83c6a90e4": "SELECT subject_id\nFROM prescriptions\nWHERE subject_id = 10027445 AND starttime >= DATE('now', '-17 months');",
    "6b7a85cc61dd82548ef2f988": "",
    "fdc9e1c2af088aa194e9faa5": "SELECT EXISTS (\n  SELECT 1\n  FROM prescriptions\n  WHERE subject_id = 10005817\n  AND starttime >= DATE('now', 'start of year', '-1 year', '+4 month', '-1 month')\n  AND starttime < DATE('now', 'start of year', '-1 year', '+5 month', '-1 month')\n) AS has_been_administered;",
    "7e472b43cb7c281ea7ad2326": "SELECT \n    CASE \n        WHEN COUNT(p.prescription_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_prescriptions\nFROM patients pat\nINNER JOIN admissions adm ON pat.subject_id = adm.subject_id\nINNER JOIN prescriptions p ON adm.hadm_id = p.hadm_id\nWHERE pat.subject_id = 10016150\nAND adm.hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10016150);",
    "ab2aad38b2169268cce19216": "SELECT * FROM prescriptions WHERE subject_id = 10019172 AND drug = 'midazolam';",
    "732ddbd8735aa1ef150a5da1": "SELECT \n    subject_id, \n    hadm_id, \n    drug, \n    dose_val_rx, \n    dose_unit_rx, \n    route \nFROM \n    prescriptions \nWHERE \n    subject_id = 10004733 \n    AND drug LIKE '%lidocaine%' \n    AND dose_unit_rx = '%1%' \n    AND route = '% infiltration%';",
    "cc187d8a2ecb0abb9fd2ff92": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS clonidine_prescribed\nFROM prescriptions \nWHERE subject_id = 10004733 \n  AND drug = 'clonidine patch 0.3 mg/24 hr' \n  AND starttime >= '2012-12-21';",
    "dab078420665e61aa6883a1d": "SELECT \n    p.subject_id, \n    pr.drug, \n    pr.route, \n    pr.dose_unit_rx, \n    pr.starttime, \n    pr.stoptime\nFROM \n    patients p\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10021666 \n    AND pr.drug LIKE '%potassium chl 20 meq / 1000 ml ns%' \n    AND pr.route = 'ns' \n    AND pr.starttime >= '2020-01-01' \n    AND pr.stoptime <= '2020-12-31';",
    "b3baba0d3d4a30996c8d7040": "",
    "29ea8f3acec04ab1a79ac191": "SELECT \n    CASE \n        WHEN SUM(CASE WHEN t.totalamount > 0 THEN 1 ELSE 0 END) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS insulin_administered\nFROM \n    inputevents t\nJOIN \n    d_items i ON t.itemid = i.itemid\nWHERE \n    t.subject_id = 10020740\n    AND t.starttime LIKE '03/2100%'\n    AND i.label LIKE '%Insulin%';",
    "f4d19ba764d6773617847b52": "",
    "2b3268beab056ff505b05347": "",
    "d2926f4a0d345771d9cecb6a": "SELECT CASE \n         WHEN MAX(labevents.charttime) >= DATE('now', '-15 months') THEN 'Yes'\n         ELSE 'No'\n       END AS has_received_tests\nFROM labevents\nWHERE labevents.subject_id = 10031757;",
    "d9f1d82756382ceba0364eb7": "SELECT \n    l.row_id\nFROM \n    patients p\nINNER JOIN \n    labevents l ON p.subject_id = l.subject_id\nWHERE \n    p.subject_id = 10020786\n    AND strftime('%Y', l.charttime) = strftime('%Y', 'now');",
    "9957eec4f3658a2214f701c9": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS test_were_administered\nFROM \n    labevents\nWHERE \n    subject_id = 10007795\n    AND STRFTIME('%Y/%m', charttime) = '2000/08';",
    "82c55832a756019258539f9d": "",
    "1a8e264083c39ca2b5c9bc74": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_received_lab_tests\nFROM \n  labevents le\nWHERE \n  le.subject_id = 10018423\n  AND le.charttime > DATE('now', '-1 year');",
    "be808f9b9ff6628170faba78": "SELECT CASE WHEN COUNT(*) > 0 THEN 'Yes' ELSE 'No' END AS has_undergone_lab_test\nFROM labevents\nWHERE subject_id = 10019172\nAND strftime('%Y', charttime) = strftime('%Y', 'now')\nAND strftime('%m', charttime) = '11';",
    "7c0a9c949c9ec7ff63c270ae": "SELECT \n    CASE \n        WHEN SUM(CASE WHEN e.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Total CO2') THEN e.totalamount ELSE 0 END) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS received_test\nFROM inputevents e\nJOIN admissions a ON e.hadm_id = a.hadm_id\nWHERE a.subject_id = 10009628\nAND e.starttime LIKE '10/21/2000%';",
    "4ec3447b9f00804b8d0a3da0": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_base_excess_test\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.subject_id = 10014729 \n  AND d_labitems.label = 'Base Excess'\n  AND labevents.charttime > '2100-01-01 23:59:59';",
    "d68bcea40377baf01b112ced": "SELECT \n    MAX(CASE \n        WHEN l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Albumin') \n        THEN 1 \n        ELSE 0 \n    END) AS AlbuminTestedLastYear\nFROM \n    labevents l\nJOIN \n    patients p ON l.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10007818 AND \n    l.charttime >= DATE('now', '-1 year');",
    "f53166032d928995607d2fc9": "SELECT row_id\nFROM microbiologyevents\nWHERE subject_id = 10016742\n  AND charttime LIKE '2100-07-%'\n  AND test_name = 'Creatinine, Urine Test';",
    "97a7eba99e8adfa9dfe8aaca": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_been_tested\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10005817 \n    AND d_labitems.label = 'Free Calcium'\n    AND labevents.charttime > '2010-10-21';",
    "6f9ec204cf2995a0808955b7": "",
    "26fa750dccd4c284472ecb48": "SELECT \n  CASE \n    WHEN COUNT(labevents.row_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS received_test\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.subject_id = 10025463\n  AND labevents.charttime >= DATE('now', '-1 month')\n  AND d_labitems.label LIKE '%Chloride%';",
    "c8c821f2bce77aa592def2d7": "SELECT \n  CASE \n    WHEN COUNT(microbiologyevents.row_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_microbiology_tests\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10005348\n  AND charttime > DATE('now', '-24 months');",
    "c0193e5f3d01df8825ae0a53": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_microbiology_tests\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10039831\n  AND charttime >= '2021-04-01';",
    "6e5cae3a2758b55ff0bbfc87": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1 \n      FROM microbiologyevents \n      WHERE subject_id = 10039997 \n        AND charttime >= DATE('now', '-1 year')\n    ) THEN 'Yes' \n    ELSE 'No' \n  END AS has_microbiology_event;",
    "4a8bec0e16a11e2197448c3b": "SELECT COUNT(row_id) AS test_count\nFROM microbiologyevents\nWHERE subject_id = 10038933\n  AND charttime BETWEEN '2022-08-01 00:00:00' AND '2022-08-31 23:59:59';",
    "adfdf07d99e741f927fb639b": "",
    "1abc175490e91fdbe78482fb": "SELECT COUNT(*) \nFROM microbiologyevents me\nJOIN patients p ON me.subject_id = p.subject_id\nWHERE p.subject_id = 10001217\nAND me.charttime BETWEEN DATE('now', 'start of year') AND DATE('now');",
    "1c70ab701577302fd7bec691": "SELECT \n  CASE \n    WHEN EXISTS (SELECT 1 \n                 FROM microbiologyevents \n                 WHERE subject_id = 10006053 \n                   AND charttime > '2021-09-01') \n    THEN 'Yes'\n    ELSE 'No'\n  END AS has_microbiology_test;",
    "4f4a3bef12490dacc3837b15": "SELECT \n    CASE \n        WHEN COUNT(T2.row_id) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS found_organism\nFROM \n    patients T1\nLEFT JOIN \n    microbiologyevents T2 \nON \n    T1.subject_id = T2.subject_id \n    AND T2.charttime LIKE '2023-06-%' \n    AND T2.spec_type_desc = 'First urine' \n    AND T2.test_name = 'Microbiology'\n    AND T2.org_name IS NOT NULL\nWHERE \n    T1.subject_id = 10002495;",
    "987c4c9f04e411a9be21bae2": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN spec_type_desc = 'ABSCESS TEST' THEN charttime END) IS NOT NULL THEN 'Yes'\n        ELSE 'No'\n    END AS has_organism\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10007795 \n    AND charttime > '2001-01-01 00:00:00';",
    "128670f0128422d00c359ab0": "SELECT CASE \n    WHEN COUNT(DISTINCT CASE WHEN org_name IS NOT NULL THEN hadm_id ELSE NULL END) > 0 THEN 'Yes'\n    ELSE 'No'\nEND AS has_organism_been_found\nFROM microbiologyevents\nWHERE subject_id = 10005348 \n  AND spec_type_desc = 'Blood Culture'\n  AND charttime >= DATE('now', '-1 year');",
    "2001cff617f1e7a9c0034942": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_organism\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10010471\n  AND test_name = 'Blood Culture'\n  AND org_name IS NOT NULL\n  AND charttime >= '2000-09-21 00:00:00';",
    "1478b8ca5010dfa67a0ce559": "SELECT spec_type_desc, test_name, org_name\nFROM microbiologyevents\nWHERE subject_id = 10007928\nAND charttime = (SELECT MAX(charttime)\n                 FROM microbiologyevents\n                 WHERE subject_id = 10007928);",
    "ec96517b92997f0de9c0bbbe": "SELECT \n  CASE \n    WHEN org_name IS NOT NULL THEN 'Organism Found'\n    ELSE 'No Organism Found'\n  END AS result\nFROM \n  (SELECT \n    org_name \n  FROM \n    microbiologyevents \n  WHERE \n    subject_id = 10002428 \n    AND spec_type_desc = 'Blood Culture' \n    AND charttime >= DATE('now', '-1 year') \n  ORDER BY \n    charttime \n  LIMIT 1) AS subquery;",
    "623a4a91b019a3f07aa9fbb9": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_organism\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10012552 AND\n    charttime LIKE '04/%/2023' AND\n    spec_type_desc = 'Staph Aureus Swab' AND\n    org_name IS NOT NULL;",
    "8ad3bd73b83b2ac224da4fdb": "SELECT \n  MAX(CASE WHEN i.itemid = '10007058' THEN i.itemid END) AS has_been_administered\nFROM \n  inputevents i\nWHERE \n  i.subject_id = 10007058 \n  AND i.starttime >= '2021-10-01';",
    "422b6f9b75c44635d538e4ce": "SELECT \n  subject_id\nFROM \n  inputevents\nWHERE \n  subject_id = 10018845 \n  AND starttime >= '2021-03-19'\n  AND totalamount > 0\nLIMIT 1;",
    "e53e5f3db28341b88fe8d653": "SELECT \n  i.subject_id,\n  i.hadm_id,\n  i.stay_id,\n  d.label AS input_label,\n  i.starttime,\n  i.totalamount,\n  i.totalamountuom\nFROM \n  inputevents i\nINNER JOIN \n  d_items d ON i.itemid = d.itemid\nWHERE \n  i.subject_id = 10029291 \n  AND i.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10029291)\n  AND d.label LIKE '%solution%'\nLIMIT 1;",
    "561e8b21d83aed1d199886d6": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS dextrose_administered\nFROM \n    inputevents\nWHERE \n    subject_id = 10027602\n    AND starttime >= '2000-02-21'\n    AND itemid = (SELECT itemid FROM d_items WHERE label = 'Dextrose 5%');",
    "e84f32d4fad193387ab842e2": "SELECT row_id \nFROM prescriptions \nWHERE subject_id = 10007818 \n  AND drug = 'STERILE WATER' \n  AND starttime >= '2021-06-01 00:00:00';",
    "e6ac4f454e0ced3ae3ac6332": "SELECT \n    subject_id, \n    starttime, \n    totalamount, \n    totalamountuom\nFROM \n    inputevents\nWHERE \n    subject_id = 10006053 AND \n    starttime BETWEEN '2022-11-16 00:00:00' AND '2022-11-16 23:59:59';",
    "f67fb672b995cf406d9a11a1": "",
    "58a8117dba6b4ae43b573d05": "",
    "66226330040dffdd0d5fd903": "SELECT subject_id, hadm_id, start_time, stop_time, route\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE subject_id = 10015931\n  AND start_time LIKE '%this_year%'\n  AND d_items.label = 'Foley Catheter'\n  AND start_time BETWEEN '2022-12-09 00:00:00' AND '2022-12-09 23:59:59';",
    "471c207da5409f3275cc20cb": "SELECT subject_id, eventtype, careunit\nFROM transfers\nWHERE subject_id = 10011398 AND eventtype = 'chest tube #1';",
    "e58ee0e5c472679a4d86b25e": "SELECT CASE \n  WHEN COUNT(*) > 0 THEN 'Yes' \n  ELSE 'No' \nEND AS foley Catheterization\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 10022017 \n  AND inputevents.starttime >= '2023-10-03 00:00:00' \n  AND inputevents.starttime < '2023-10-04 00:00:00'\n  AND d_items.label = 'Foley Catheterization';",
    "0c5849747818dd64e3090cd8": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Emesis event occurred' \n         ELSE 'No Emesis event found' \n       END AS event_status\nFROM outputevents oe\nJOIN d_items di ON oe.itemid = di.itemid\nWHERE oe.subject_id = 10025612 \n  AND oe.charttime LIKE '2023-10-02%' \n  AND di.label = 'Emesis';",
    "cea5a40f3d9844b4ee58041d": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS had_procedure\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE p.subject_id = 10013049\n  AND d.long_title LIKE '%oral gastric%'\n  AND p.charttime LIKE '06/2100%';",
    "40de69e222a145027e4f2169": "SELECT \n    CASE \n        WHEN COUNT(*) = COUNT(CASE WHEN le.valuenum <= 90 THEN 1 ELSE NULL END) THEN 'Normal'\n        ELSE 'Abnormal'\n    END AS diastolic_bp_status\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nJOIN patients p ON le.subject_id = p.subject_id\nWHERE p.subject_id = 10029291\n  AND li.label = 'Diastolic Blood Pressure'\n  AND le.charttime BETWEEN '2000-03-21 00:00:00' AND '2000-03-21 23:59:59';",
    "41e5c617af3a91492dc2e3d0": "SELECT \n    MAX(CASE WHEN d_items.label = 'SpO2' THEN ce.valuenum ELSE NULL END) AS last_SpO2_value\nFROM \n    chartevents ce\nJOIN \n    d_items ON ce.itemid = d_items.itemid\nWHERE \n    ce.subject_id = 10016742;",
    "97551740a3b364d8e2b6214c": "SELECT \n    CASE \n        WHEN GROUP_CONCAT(CASE \n            WHEN ce.valuenum < 12 THEN 'Abnormal'\n            ELSE 'Normal'\n        END) = 'Normal' THEN 'All Normal'\n        ELSE 'Not All Normal'\n    END AS respiratory_rate_status\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN chartevents ce ON a.hadm_id = ce.hadm_id\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE p.subject_id = 10018081\nAND di.label = 'Respiratory Rate'\nAND DATE(ce.charttime) = '2023-12-29';",
    "b23b961d0f2fe2cf1eec5a22": "WITH FirstAdmission AS (\n    SELECT hadm_id, admittime\n    FROM admissions\n    WHERE subject_id = 10019777\n    ORDER BY admittime\n    LIMIT 1\n),\nHeartRateMeasurements AS (\n    SELECT c.subject_id, c.hadm_id, c.itemid, c.charttime, c.valuenum\n    FROM chartevents c\n    JOIN FirstAdmission fa ON c.hadm_id = fa.hadm_id\n    WHERE c.itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n),\nNormalHeartRateRange AS (\n    SELECT \n        60 AS min_heart_rate,\n        100 AS max_heart_rate\n)\nSELECT \n    CASE \n        WHEN hrm.valuenum BETWEEN (SELECT min_heart_rate FROM NormalHeartRateRange) AND (SELECT max_heart_rate FROM NormalHeartRateRange) THEN 'Normal'\n        ELSE 'Abnormal'\n    END AS heart_rate_status\nFROM HeartRateMeasurements hrm\nLIMIT 1;",
    "9a2f8970fbd241c4a1994704": "SELECT \n    T1.subject_id,\n    T2.label AS item_label,\n    T1.charttime,\n    T1.valuenum AS heart_rate,\n    T1.valueuom AS unit\nFROM \n    chartevents T1\nINNER JOIN \n    d_items T2 ON T1.itemid = T2.itemid\nWHERE \n    T2.label = 'Heart Rate'\n    AND T1.subject_id = 10015931\n    AND T1.charttime > '2010-01-01'\n    AND T1.charttime < '2011-01-01'\n    AND T1.valuenum BETWEEN 60 AND 100",
    "9e463af82f31adb188a12310": "",
    "b8e813ddf11159fa6c4ca4ca": "SELECT \n    c.subject_id,\n    c.charttime,\n    c.valuenum,\n    c.valueuom\nFROM \n    chartevents c\nJOIN \n    d_items d ON c.itemid = d.itemid\nWHERE \n    c.subject_id = 10007818 \n    AND c.charttime >= '2023-07-08 00:00:00'\n    AND c.charttime < '2023-07-09 00:00:00'\n    AND d.label = 'SpO2'\n    AND c.valuenum BETWEEN 95 AND 100;",
    "d90596b35371ba4a84a1a128": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10020187;",
    "2fe2de5ecc04ecf656ea58f3": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10023117\nAND admittime >= DATE('now', '-1 year');",
    "0980045acad692ba2a8996db": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10016742 AND admittime > '2100';",
    "05ac3a771a3724d766be2218": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10018423 AND strftime('%Y', admittime) = '2100';",
    "89880a69f1f260cad697501f": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10038999 AND admittime >= '2023-01-01';",
    "fcb5ab40c54f3bce352480bc": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10020740 AND hadm_id = 2100;",
    "bee55ba67d6da489306ff469": "SELECT \n    admittime \nFROM \n    admissions \nWHERE \n    subject_id = 10035185;",
    "b9c136c1e1d19649caabdeb4": "SELECT \n    strftime('%Y-%m', l.charttime) AS month,\n    AVG(l.valuenum) AS average_bilirubin\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10021487 AND\n    l.charttime >= '2005-05-01' AND\n    d.label = 'Bilirubin, Direct'\nGROUP BY \n    month\nORDER BY \n    month;",
    "ab28063625f4ba14b3379479": "SELECT SUM(T1.valuenum) AS total_protein\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nINNER JOIN admissions AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE T2.label = 'Protein' \n  AND T1.subject_id = 10035185\n  AND strftime('%Y', T1.charttime) = strftime('%Y', T3.dischtime)\nGROUP BY strftime('%Y', T1.charttime)\nHAVING total_protein = MIN(total_protein);",
    "abd48dc45ba90022382e02c9": "SELECT \n    strftime('%Y-%m', l.charttime) AS month,\n    AVG(l.valuenum) AS average_creatinine\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10021666\n    AND d.label = 'Creatinine, Urine in 2100'\nGROUP BY \n    month\nORDER BY \n    month;",
    "4ea43bff9e1b8d9f142a816d": "",
    "7a60c2c50fa3345765a83271": "SELECT \n  strftime('%Y-%m', charttime) AS month,\n  MIN(valuenum) AS min_valuenum\nFROM \n  labevents\nWHERE \n  subject_id = 10038999 AND \n  itemid = (SELECT itemid FROM d_labitems WHERE label = 'Lipase in 2100')\nGROUP BY \n  month;",
    "acc9bade197c3728c67fcdd7": "SELECT \n    l.charttime, \n    MIN(l.valuenum) AS min_bilirubin_direct\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10021487 \n    AND d.label = 'Bilirubin, Direct'\nGROUP BY \n    DATE(l.charttime)\nORDER BY \n    l.charttime;",
    "249619a43d4c7fe7add673f1": "SELECT \n    MAX(CAST(labevents.valuenum AS REAL)) AS max_lactate_dehydrogenase_level\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10038933 \n    AND labevents.charttime >= '2100-01-01'\n    AND d_labitems.label = 'lactate dehydrogenase (ld)';",
    "c0faf3e95f2c2000bdda5a2e": "WITH patient_weights AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        SUM(CASE WHEN label = 'Weight' THEN valuenum ELSE 0 END) AS weight,\n        COUNT(DISTINCT DATE(charttime)) AS num_days\n    FROM \n        chartevents ce\n    INNER JOIN \n        d_items di ON ce.itemid = di.itemid\n    WHERE \n        subject_id = 10036156\n    GROUP BY \n        subject_id, hadm_id\n)\nSELECT \n    subject_id,\n    hadm_id,\n    weight / num_days AS avg_weight\nFROM \n    patient_weights\nORDER BY \n    hadm_id\nLIMIT 1;",
    "fa0c00e540e79ae2f208cdee": "SELECT AVG(T1.valueuom) AS average_weight\nFROM chartevents T1\nINNER JOIN d_items T2 ON T1.itemid = T2.itemid\nINNER JOIN admissions T3 ON T1.hadm_id = T3.hadm_id\nWHERE T1.subject_id = 10038933 AND T2.label = 'Weight' AND T3.dischtime = (\n    SELECT MAX(T3.dischtime)\n    FROM chartevents T1\n    INNER JOIN admissions T3 ON T1.hadm_id = T3.hadm_id\n    WHERE T1.subject_id = 10038933\n);",
    "996258522002126afaf5a3c0": "SELECT \n  DATE(c.charttime) AS date,\n  MIN(c.valuenum) AS minimum_weight\nFROM \n  chartevents c\n  INNER JOIN d_items d ON c.itemid = d.itemid\nWHERE \n  c.subject_id = 10027445\n  AND d.label = 'Weight'\n  AND c.charttime >= '2100-01-01'\nGROUP BY \n  DATE(c.charttime);",
    "42d490e9dcc8cd200649d0ff": "SELECT \n    strftime('%Y-%m', charttime) AS month,\n    MIN(valuenum) AS monthly_min_weight\nFROM \n    chartevents\nINNER JOIN \n    d_items ON chartevents.itemid = d_items.itemid\nWHERE \n    subject_id = 10014729\n    AND d_items.label = 'Weight'\n    AND strftime('%Y', charttime) = '2100'\nGROUP BY \n    month;",
    "e8a376ca7f202983221786bd": "SELECT \n    DATE(charttime) AS date,\n    MAX(valuenum) AS daily_max_weight\nFROM \n    chartevents\nWHERE \n    subject_id = 10018081 \n    AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\n    AND charttime >= '2011-11-01'\nGROUP BY \n    DATE(charttime);",
    "b029fa60f795c16ffec2ddf9": "SELECT \n  DATE(ce.charttime) AS date,\n  AVG(ce.valuenum) AS avg_weight\nFROM \n  chartevents ce\n  INNER JOIN patients p ON ce.subject_id = p.subject_id\nWHERE \n  p.subject_id = 10021487 AND\n  ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight') AND\n  ce.charttime > DATE('now', '-16 months')\nGROUP BY \n  DATE(ce.charttime)\nORDER BY \n  DATE(ce.charttime);",
    "230b50a3e6a330e4047ecfd0": "SELECT\n    AVG(CASE WHEN d_items.label = 'Weight' THEN labevents.valuenum ELSE NULL END) AS average_weight\nFROM\n    labevents\nJOIN\n    d_labitems d_items ON labevents.itemid = d_items.itemid\nWHERE\n    labevents.subject_id = 10014729 AND\n    strftime('%Y-%m-%d', labevents.charttime) = '2003-03-21';",
    "8a5a5d29e1a51c172836525e": "SELECT \n    strftime('%Y', i.starttime) AS year,\n    AVG(i.totalamount) AS average_totalamount\nFROM \n    inputevents i\nJOIN \n    icustays ic ON i.stay_id = ic.stay_id\nWHERE \n    i.subject_id = 10020740 \n    AND i.starttime >= '2001-01-01' \n    AND ic.first_careunit = 'PO Intake'\nGROUP BY \n    year;",
    "c37d80a17e1432e62f2c945c": "WITH MonthlyIntakeCTE AS (\n    SELECT \n        strftime('%Y-%m', i.starttime) AS month,\n        AVG(i.totalamount) AS avg_intake\n    FROM \n        inputevents i\n    WHERE \n        i.subject_id = 10005909 AND\n        i.hadm_id = 1 AND\n        i.totalamountuom = 'PO'\n    GROUP BY \n        month\n)\nSELECT \n    month,\n    avg_intake\nFROM \n    MonthlyIntakeCTE;",
    "4811bca64998a864d6db6bc5": "SELECT \n  MIN(T1.starttime) AS day_start_time, \n  MAX(T1.totalamount) AS max_dose\nFROM \n  inputevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10000032 \n  AND T2.label = 'PO Intake'\nGROUP BY \n  MIN(T1.starttime)\nHAVING \n  MAX(T1.totalamount) > 0",
    "53d67e5afb0eef3231919c0e": "SELECT \n    MAX(T1.totalamount) AS max_input_amount\nFROM \n    inputevents AS T1\nINNER JOIN \n    d_items AS T2 ON T1.itemid = T2.itemid\nINNER JOIN \n    admissions AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE \n    T3.subject_id = 10019172 \n    AND T2.label = 'KCL ( Bolus )'\n    AND T1.starttime >= (SELECT MIN(t1.admittime) FROM admissions AS t1 WHERE t1.subject_id = 10019172)\n    AND T1.starttime < (SELECT MAX(t1.dischtime) FROM admissions AS t1 WHERE t1.subject_id = 10019172);",
    "5edb24fc6b54aabb2e6f6f5c": "SELECT \n    MAX(totalamount) AS max_rbc_intake\nFROM \n    inputevents ie\nJOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    ie.subject_id = 10039831\n    AND di.label = 'Packed RBCs'\n    AND ie.starttime >= '2021-12-05';",
    "4e02c94268e273ceadb20be5": "SELECT \n  MIN(T.totalamount) AS min_totalamount\nFROM \n  inputevents AS T\n  JOIN d_items AS D ON T.itemid = D.itemid\nWHERE \n  T.subject_id = 10005817 \n  AND D.label = 'Magnesium Sulfate (Bolus)'\n  AND T.starttime >= '12/06/2100'",
    "e9a0e7111e770b55741de154": "selections. The task is to find the average dose of a specific medication (peptamen bariatric (full)) for a given patient starting from a specific date. The solution should focus on the `prescriptions` table and possibly the `patients` table if additional patient information is required.",
    "8a0c7a7faca024a1eb4dd993": "",
    "2783cbb5eccb2b4d0c78a1e0": "SELECT \n    DATE(ce.charttime) AS date,\n    MAX(ce.valuenum) AS max_systolic_bp\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10003046\n    AND di.label = 'Systolic Blood Pressure'\nGROUP BY \n    DATE(ce.charttime);",
    "dca7f0863bc05ed189b1b292": "",
    "e1d0b53beabc24ec45e07b2d": "WITH FirstHADM AS (\n    SELECT \n        hadm_id\n    FROM \n        admissions\n    WHERE \n        subject_id = 10038999\n    ORDER BY \n        admittime\n    LIMIT 1\n),\nFilteredChartEvents AS (\n    SELECT \n        charttime,\n        valuenum\n    FROM \n        chartevents\n    WHERE \n        subject_id = 10038999 \n        AND hadm_id = (SELECT hadm_id FROM FirstHADM)\n        AND itemid = 3340\n)\nSELECT \n    strftime('%Y-%m', charttime) AS month,\n    AVG(valuenum) AS average_respiratory_rate\nFROM \n    FilteredChartEvents\nGROUP BY \n    month;",
    "f5f18cb5c4dd940a95ec5360": "SELECT MAX(ce valuenum) AS daily_max_body_temp\nFROM chartevents ce\nJOIN icustays is_ ON ce.hadm_id = is_.hadm_id\nWHERE ce.subject_id = 10011398\n  AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Body Temperature')\n  AND is_.stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10011398 ORDER BY outtime DESC LIMIT 1);",
    "0d7f97f7f014369165ccb406": "SELECT \n  DATE(l.charttime) AS Date, \n  MAX(l.valuenum) AS Max_Dia_Blood_Pressure \nFROM \n  patients p \nJOIN \n  admissions a ON p.subject_id = a.subject_id \nJOIN \n  labevents l ON a.hadm_id = l.hadm_id \nWHERE \n  p.subject_id = 10005817 \n  AND l.charttime >= DATE('now', '-14 months') \n  AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Diastolic Blood Pressure') \nGROUP BY \n  DATE(l.charttime) \nORDER BY \n  Date;",
    "2c5b0c8baa3288cd5ae25871": "WITH last_icu_stay AS (\n    SELECT icu.stay_id, icu.intime, icu.outtime\n    FROM patients p\n    INNER JOIN icustays icu ON p.subject_id = icu.subject_id\n    WHERE p.subject_id = 10019385\n    ORDER BY icu.intime DESC\n    LIMIT 1\n)\nSELECT AVG(ch.valuenum) AS avg_systolic_blood_pressure\nFROM last_icu_stay lis\nINNER JOIN chartevents ch ON lis.stay_id = ch.stay_id\nINNER JOIN d_items di ON ch.itemid = di.itemid\nWHERE ch.charttime BETWEEN lis.intime AND lis.outtime\nAND di.label = 'Systolic Blood Pressure';",
    "5e1e03c6f5228f110a137a50": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10023117 \nAND admittime BETWEEN '2100-01-01' AND '2100-12-31';",
    "cfd45a15a268ad1a89df54dd": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10020944 \n  AND admittime > DATE('now', '-1 year');",
    "93181a0681785a3fc636f0c0": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10037861 AND admittime > DATE('now', 'start of year') AND admittime < DATE('now', 'start of year', '+1 year');",
    "1565b3431aebbecefff6df1d": "SELECT COUNT(*) AS number_of_visits\nFROM admissions\nWHERE subject_id = 10018501;",
    "97aace30ba0ffdefe43a92fd": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10014729;",
    "2e777a27e1019908bf9c76e0": "SELECT COUNT(*) AS total_visits\nFROM admissions\nWHERE subject_id = 10003400\nAND admittime >= DATE('now', '-1 year');",
    "bb96274f7d0903a6f3ad4e76": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10007058 AND admittime >= '2100-01-01 00:00:00';",
    "c6ef8b615b48c60724e2636d": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10022880;",
    "6065fc09f8cb8ae10fb76e62": "SELECT \n  COUNT(DISTINCT icu.stay_id) AS icu_admissions_count\nFROM \n  admissions a\n  JOIN icustays icu ON a.subject_id = icu.subject_id AND a.hadm_id = icu.hadm_id\nWHERE \n  a.subject_id = 10038081;",
    "3476f7a1daff51acd412b499": "SELECT COUNT(*) AS icu_visits\nFROM icustays\nWHERE subject_id = 10029291\n  AND intime > date('now', '-1 year');",
    "2e1336e1727d7e40e18f93c4": "SELECT COUNT(*) AS icu_visits\nFROM icustays\nWHERE hadm_id = (\n    SELECT MAX(hadm_id) \n    FROM admissions \n    WHERE subject_id = 10037975\n)",
    "c25b681b346061f536aabbe6": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10013049 AND intime > '2100';",
    "2b28101243e3c66e8678625b": "SELECT COUNT(*) AS icu_admission_count\nFROM icustays\nWHERE subject_id = 10021938 AND intime BETWEEN '2100-01-01' AND '2100-12-31';",
    "4a84bbe324a00742f9bdfa52": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10004720 \nAND hadm_id = (\n  SELECT MAX(hadm_id) \n  FROM admissions \n  WHERE subject_id = 10004720\n);",
    "72f9afe9d7752f2079ec4df1": "SELECT COUNT(DISTINCT drug) AS total_distinct_drugs\nFROM prescriptions\nWHERE subject_id = 10024043 AND starttime >= '2100-01-01';",
    "9db928d9e5f6893e61f4f006": "",
    "ba5d2c366e08023fec9bfbe5": "SELECT COUNT(DISTINCT drug) \nFROM prescriptions \nWHERE subject_id = 10000032 AND starttime >= DATE('now', '-10 months');",
    "5861ef095f4c08ad236ab8c5": "SELECT COUNT(DISTINCT drug)\nFROM prescriptions\nWHERE subject_id = 10005909\nAND starttime > '2010-10-21';",
    "8db871c52022d633a9f58b11": "SELECT \n  COUNT(DISTINCT drug) AS num_unique_drugs\nFROM \n  prescriptions\nWHERE \n  subject_id = 10004720\n  AND starttime >= '2022-11-21'\n  AND starttime < '2023-12-31';",
    "81a5e45699cfa054a335726f": "SELECT COUNT(DISTINCT drug) AS total_unique_drugs\nFROM prescriptions\nWHERE subject_id = 10009628\nAND starttime >= '2023-09-01'\nAND starttime < '2023-10-01';",
    "99420e9ae112f93bdf6f421a": "SELECT \n    COUNT(DISTINCT drug) AS unique_drugs_prescribed\nFROM \n    prescriptions\nWHERE \n    subject_id = 10021938\n    AND starttime >= DATE('now', '-2 months');",
    "b0c1e2c1046cc6dad14ddbe4": "",
    "3290627f36487b94ca743ca3": "SELECT \n  COUNT(*) AS count_of_prescriptions\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10018081\n  AND p.drug = '5% dextrose'\n  AND p.starttime LIKE '2023-%';",
    "f737cdc1f727761a17f22b7d": "SELECT \n  COUNT(*) AS total_albumin_prescriptions\nFROM \n  prescriptions\nWHERE \n  subject_id = 10038081 \n  AND hadm_id = (SELECT MIN(hadm_id) FROM admissions WHERE subject_id = 10038081)\n  AND drug = 'Albumin 25% (12.5g / 50ml)';",
    "0035d27329064c6e313badd1": "SELECT \n    COUNT(*) AS milk_of_magnesia_count\nFROM \n    prescriptions \nWHERE \n    drug = 'Milk of Magnesia' \n    AND subject_id = 10005348\n    AND starttime LIKE '%09/%'\n    AND starttime LIKE '%/%/this_year';",
    "75f2ab4d9c265d10a7c0876f": "SELECT COUNT(*) AS num_events\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.drug = 'potassium chloride replacement (critical care and oncology)'\nAND p.starttime LIKE '2100-%'\nAND a.subject_id = 10015272;",
    "76ddecbe56caba3073d76d2d": "SELECT COUNT(*) AS num_times_prescribed\nFROM prescriptions p\nJOIN d_icd_procedures d ON p.drug = d.long_title\nWHERE p.subject_id = 10038933\n  AND p.drug = 'Levetiracetam oral solution (levetiracetam) 0.04g (0.04g in 09/2100)';",
    "70280353be78e0850355e08c": "",
    "bca12dbeb197151809e62874": "SELECT COUNT(*) AS ast_test_count\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10009628 AND li.label = 'asparate aminotransferase (ast)';",
    "18804b0230296456eb7bf9f3": "SELECT COUNT(*)\nFROM labevents le\nJOIN admissions a ON le.hadm_id = a.hadm_id\nWHERE le.subject_id = 10039831 AND le.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Hemoglobin')\nAND a.dischtime IS NOT NULL;",
    "e46aecc50872e5e43f5dec8b": "SELECT COUNT(*) \nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10038999 AND li.label = 'Lipase';",
    "da0d0d0112db58fa527f189f": "",
    "6b5cff60f50561310ed8c3c2": "SELECT COUNT(*) AS total_tests\nFROM labevents le\nJOIN d_labitems di ON le.itemid = di.itemid\nWHERE le.subject_id = 10011398\nAND di.label = 'Platelet Count'\nAND le.charttime >= DATE('now', '-1 year');",
    "d535c91e21f7926fb37d3dd8": "SELECT COUNT(*) \nFROM labevents\nWHERE subject_id = 10018845 AND itemid = (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label = 'Hemoglobin'\n) AND charttime > '07/2100';",
    "272b7419a6f4ac420aae5839": "SELECT COUNT(*) \nFROM labevents \nWHERE subject_id = 10002428 \nAND itemid IN (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label LIKE '%bicarbonate test%'\n)\nAND strftime('%Y-%m', charttime) = strftime('%Y-%m', 'now', '-1 month');",
    "f9e651bab94c8b0cbc349c8a": "",
    "42133f6ce3b196288d44b9b7": "",
    "822fb5a81c6aa96e17079981": "SELECT COUNT(*) \nFROM patients \nWHERE dod IS NULL;",
    "adeec8d4eea99ded1a136fb0": "SELECT COUNT(DISTINCT subject_id) AS current_patient_count\nFROM patients;",
    "b4e5170ce76c3fd49390d922": "SELECT COUNT(*) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE strftime('%Y', a.dischtime) - strftime('%Y', p.dob) BETWEEN 20 AND 29;",
    "b9dd758d1b4184744da4955b": "WITH CurrentPatients AS (\n    SELECT \n        subject_id,\n        gender,\n        dob,\n        CAST(STRFTIME('%Y', 'now') AS INTEGER) - CAST(STRFTIME('%Y', dob) AS INTEGER) AS age\n    FROM \n        patients\n    WHERE \n        dod IS NULL\n),\nAgeGroupCategorization AS (\n    SELECT \n        subject_id,\n        age,\n        CASE \n            WHEN age BETWEEN 30 AND 39 THEN '30s'\n            ELSE 'Other'\n        END AS age_group\n    FROM \n        CurrentPatients\n)\nSELECT \n    COUNT(*) \nFROM \n    AgeGroupCategorization\nWHERE \n    age_group = '30s';",
    "87df01ff8e5b34782b6f1bab": "SELECT COUNT(*) AS count_of_patients\nFROM patients\nWHERE gender = 'Male'\nAND strftime('%Y', 'now') - strftime('%Y', dob) = 40\nUNION ALL\nSELECT COUNT(*) AS count_of_patients\nFROM patients\nWHERE gender = 'Female'\nAND strftime('%Y', 'now') - strftime('%Y', dob) = 40;",
    "29c1d5e3303ae477c836d0a2": "SELECT COUNT(*) \nFROM patients \nWHERE \n  strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 30 AND 39 \n  AND dod IS NULL;",
    "87157dc1a0c697225e9e5356": "SELECT COUNT(*)\nFROM patients\nWHERE dob IS NOT NULL \n  AND strftime('%Y', 'now') - SUBSTR(dob, 1, 4) BETWEEN 50 AND 59\n  AND dod IS NULL;",
    "466f29187cd0639b0ab5a25c": "WITH CurrentPatients AS (\n  SELECT \n    subject_id,\n    STRFTIME('%Y', dob) AS year_of_birth\n  FROM patients\n  WHERE dob < DATE('now')\n    AND (dod IS NULL OR dod > DATE('now'))\n),\nAgeGroupPatients AS (\n  SELECT \n    subject_id,\n    CASE \n      WHEN year_of_birth BETWEEN '1940' AND '1949' THEN '40s'\n      WHEN year_of_birth BETWEEN '1950' AND '1959' THEN '50s'\n      WHEN year_of_birth BETWEEN '1960' AND '1969' THEN '60s'\n      WHEN year_of_birth BETWEEN '1970' AND '1979' THEN '70s'\n      WHEN year_of_birth BETWEEN '1980' AND '1989' THEN '80s'\n      WHEN year_of_birth BETWEEN '1990' AND '1999' THEN '90s'\n      ELSE 'Others'\n    END AS age_group\n  FROM CurrentPatients\n)\nSELECT \n  COUNT(*) AS total_patients\nFROM AgeGroupPatients\nWHERE age_group = '40s';",
    "1408ef03b015c82da341f94f": "",
    "06766659b8f16c2233c677bd": "SELECT \n  COUNT(DISTINCT CASE WHEN p.dod IS NOT NULL AND p.dod <= DATE(a.dischtime, '+6 months') THEN p.subject_id ELSE NULL END) AS survived_6_months\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE \n  d.icd_code = 'I86.5' AND  \n  pr.icd_code = 'N04'",
    "84cb84cd44b575f06211c452": "WITH PatientDiagnoses AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    WHERE d.icd_code = 'S02.0' -- Subdural hemorrhage following injury\n    AND NOT EXISTS (\n        SELECT 1\n        FROM diagnoses_icd d2\n        WHERE d2.subject_id = p.subject_id\n        AND d2.icd_code = 'S02.5' -- Open intracranial wound\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM diagnoses_icd d3\n        WHERE d3.subject_id = p.subject_id\n        AND d3.icd_code = 'R04.0' -- Loss of consciousness\n    )\n),\nPhenobarbitalPrescriptions AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    JOIN prescriptions pr ON p.subject_id = pr.subject_id\n    WHERE pr.drug = 'Phenobarbital'\n),\nSurvivedPatients AS (\n    SELECT pd.subject_id\n    FROM PatientDiagnoses pd\n    JOIN PhenobarbitalPrescriptions pp ON pd.subject_id = pp.subject_id\n    JOIN admissions a ON a.subject_id = pd.subject_id\n    WHERE a.dischtime IS NOT NULL\n      AND a.dischtime <= DATE(a.admittime, '+3 month')\n)\nSELECT \n    CAST(COUNT(DISTINCT sp.subject_id) AS REAL) / COUNT(DISTINCT pd.subject_id) AS survival_rate\nFROM PatientDiagnoses pd\nLEFT JOIN SurvivedPatients sp ON pd.subject_id = sp.subject_id;",
    "6292671bc40ee6988cb71e1f": "WITH DiagnosedPatients AS (\n    SELECT \n        p.subject_id\n    FROM \n        patients p\n    INNER JOIN \n        diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN \n        d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE \n        dd.long_title = 'Other psychotic disorder not due to a substance or known physiological condition'\n),\nTreatedPatients AS (\n    SELECT \n        dp.subject_id\n    FROM \n        DiagnosedPatients dp\n    INNER JOIN \n        prescriptions pr ON dp.subject_id = pr.subject_id\n    WHERE \n        pr.drug = 'Alteplase'\n),\nSurvivingPatients AS (\n    SELECT \n        tp.subject_id\n    FROM \n        TreatedPatients tp\n    WHERE \n        tp.subject_id NOT IN (\n            SELECT \n                p.subject_id\n            FROM \n                patients p\n            WHERE \n                p.dod IS NOT NULL\n        )\n)\nSELECT \n    COUNT(DISTINCT sp.subject_id) / (SELECT COUNT(DISTINCT tp.subject_id) FROM TreatedPatients tp) AS survival_rate\nFROM \n    SurvivingPatients sp;",
    "0c87ffd881def44ba1a584a4": "WITH pneumonia_klebsiella AS (\n    SELECT \n        p.subject_id,\n        d.charttime AS diagnosis_time,\n        m.charttime AS micro_time,\n        i.hadm_id,\n        i.starttime AS insulin_start\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    INNER JOIN microbiologyevents m ON p.subject_id = m.subject_id\n    INNER JOIN prescriptions i ON p.subject_id = i.subject_id\n    WHERE di.long_title LIKE '%pneumonia%' \n      AND m.org_name = 'klebsiella pneumoniae'\n      AND i.drug LIKE '%insulin%'\n),\nsurvival AS (\n    SELECT \n        pk.subject_id,\n        pk.diagnosis_time,\n        pk.micro_time,\n        pk.insulin_start,\n        CASE \n            WHEN p.dod IS NOT NULL THEN 'Deceased'\n            ELSE 'Alive'\n        END AS survival_status\n    FROM pneumonia_klebsiella pk\n    LEFT JOIN patients p ON pk.subject_id = p.subject_id\n    WHERE pk.insulin_start > pk.diagnosis_time\n)\nSELECT \n    AVG(CASE WHEN survival_status = 'Alive' THEN 1.0 ELSE 0.0 END) * 100 AS six_month_survival_rate\nFROM survival;",
    "67fe7f95e308db2d9fe6ec8f": "SELECT COUNT(DISTINCT p.subject_id) * 100.0 / \n       (SELECT COUNT(DISTINCT subject_id) \n        FROM patients \n        WHERE gender = p.gender \n          AND dob <= p.dod) AS survival_rate\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE d.icd_code = 'R50.8'  -- Unspecified psychosis\n  AND pr.icd_code = 'M12'   -- Glycerin supps\n  AND p.dod IS NOT NULL     -- Patient has passed away\n  AND p.dob <= DATE(p.dod, '+6 months')  -- Survival up to 6 months",
    "f92a0c61488b57aa3f7e3ab1": "",
    "6db6baede71203bbf3781655": "WITH InsulinTreatedPatients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    INNER JOIN d_icd_diagnoses did ON d.icd_code = did.icd_code\n    INNER JOIN labevents l ON a.hadm_id = l.hadm_id\n    INNER JOIN d_labitems li ON l.itemid = li.itemid\n    WHERE did.long_title LIKE '%poliomyelitis%' AND li.label LIKE '%Insulin%'\n),\nSurvivalRate AS (\n    SELECT\n        SUM(CASE WHEN p.dod IS NOT NULL AND p.dod <= DATE(p.dob, '+6 months') THEN 1 ELSE 0 END) AS survived_6_months,\n        SUM(CASE WHEN p.dod IS NULL THEN 1 ELSE 0 END) AS survived_more_than_6_months\n    FROM patients p\n    WHERE p.subject_id IN (SELECT subject_id FROM InsulinTreatedPatients)\n)\nSELECT\n    CAST(survived_6_months AS REAL) * 100 / (survived_6_months + survived_more_than_6_months) AS \"6-Month Survival Rate\"\nFROM SurvivalRate;",
    "bb7f918822ae905cff9cc39e": "WITH \n-- Calculate mortality in the 3-month window after admission\nMortalityInThreeMonths AS (\n    SELECT \n        a.subject_id,\n        a.hadm_id,\n        CASE \n            WHEN julianday(a.dischtime) - julianday(a.admittime) <= 90 THEN 1 \n            ELSE 0 \n        END AS mortality_flag\n    FROM admissions a\n    WHERE a.dischtime IS NOT NULL\n),\n-- Count diagnoses for each subject\nDiagnosisCounts AS (\n    SELECT \n        d.subject_id,\n        COUNT(*) AS diagnosis_count\n    FROM diagnoses_icd d\n    GROUP BY d.subject_id\n),\n-- Filter subjects with four or more diagnoses\nSubjectsFourDiagnoses AS (\n    SELECT \n        dc.subject_id\n    FROM DiagnosisCounts dc\n    WHERE dc.diagnosis_count >= 4\n),\n-- Calculate mortality rate for subjects with four or more diagnoses\nMortalityRate AS (\n    SELECT \n        sfd.subject_id,\n        SUM(m.mortality_flag) * 100.0 / COUNT(m.mortality_flag) AS mortality_rate\n    FROM SubjectsFourDiagnoses sfd\n    JOIN MortalityInThreeMonths m ON sfd.subject_id = m.subject_id\n    GROUP BY sfd.subject_id\n)\n-- Select the top four diagnoses with the highest mortality rate\nSELECT \n    d.icd_code,\n    d.long_title,\n    mr.mortality_rate\nFROM MortalityRate mr\nJOIN diagnoses_icd d ON mr.subject_id = d.subject_id\nORDER BY mr.mortality_rate DESC\nLIMIT 4;",
    "808dfe41dea511c9420e7b88": "",
    "7cc086ff238e8366912ab6a9": "WITH PatientDiagnoses AS (\n    SELECT \n        p.subject_id,\n        d.icd_code,\n        CASE \n            WHEN julianday(p.dod) - julianday(a.admittime) <= 180 THEN 1\n            ELSE 0\n        END AS mortality_status\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n),\nMortalityCounts AS (\n    SELECT \n        icd_code,\n        COUNT(*) AS patient_count,\n        SUM(mortality_status) AS mortality_count\n    FROM PatientDiagnoses\n    GROUP BY icd_code\n),\nMortalityRates AS (\n    SELECT \n        icd_code,\n        patient_count,\n        mortality_count,\n        CAST(mortality_count AS REAL) / patient_count AS mortality_rate\n    FROM MortalityCounts\n),\nRankedDiagnoses AS (\n    SELECT \n        icd_code,\n        mortality_rate,\n        ROW_NUMBER() OVER (ORDER BY mortality_rate DESC) AS rank\n    FROM MortalityRates\n)\nSELECT icd_code\nFROM RankedDiagnoses\nWHERE rank <= 4;",
    "66e468b8ba6fe6d332363ba2": "WITH PatientDiagnoses AS (\n    SELECT DISTINCT p.subject_id, d.long_title\n    FROM patients p\n    JOIN diagnoses_icd icd ON p.subject_id = icd.subject_id\n    JOIN d_icd_diagnoses d ON icd.icd_code = d.icd_code\n),\nPatientMortality AS (\n    SELECT p.subject_id,\n           CASE \n               WHEN p.dod IS NOT NULL AND p.dod <= DATE(p.dob, '+3 month') THEN 'Dead'\n               ELSE 'Alive'\n           END AS mortality_status\n    FROM patients p\n),\nDiagnosisMortality AS (\n    SELECT pd.long_title, pm.mortality_status\n    FROM PatientDiagnoses pd\n    JOIN PatientMortality pm ON pd.subject_id = pm.subject_id\n),\nMortalityRates AS (\n    SELECT long_title, \n           COUNT(*) AS total_patients, \n           AVG(CASE WHEN mortality_status = 'Dead' THEN 1 ELSE 0 END) AS mortality_rate\n    FROM DiagnosisMortality\n    GROUP BY long_title\n),\nRankedDiagnoses AS (\n    SELECT long_title, mortality_rate,\n           RANK() OVER (ORDER BY mortality_rate DESC) AS rank\n    FROM MortalityRates\n)\nSELECT long_title, mortality_rate\nFROM RankedDiagnoses\nWHERE rank <= 3;",
    "561a6f6df9ce2b72802718f6": "WITH PatientAdmissionDiagnoses AS (\n    SELECT p.subject_id,\n           a.hadm_id,\n           d.long_title AS diagnosis\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n    JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n),\nMortalityRate AS (\n    SELECT pad.diagnosis,\n           COUNT(CASE WHEN p.dod IS NOT NULL AND julianday(p.dod) - julianday(a.admittime) <= 90 THEN 1 END) AS mortality_count,\n           COUNT(*) AS total_count\n    FROM PatientAdmissionDiagnoses pad\n    JOIN admissions a ON pad.hadm_id = a.hadm_id\n    JOIN patients p ON pad.subject_id = p.subject_id\n    GROUP BY pad.diagnosis\n),\nRankedMortalityRate AS (\n    SELECT diagnosis,\n           (mortality_count * 1.0 / total_count) AS mortality_rate,\n           ROW_NUMBER() OVER (ORDER BY (mortality_count * 1.0 / total_count) DESC) AS rank\n    FROM MortalityRate\n)\nSELECT diagnosis\nFROM RankedMortalityRate\nWHERE rank <= 3;",
    "4b624ad8a3b82ed7e3e29dc3": "select the top 3.",
    "33531c8f62b92bd9245b9217": "WITH MonthlyMortality AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id,\n        d.icd_code,\n        p.dod,\n        p.gender,\n        p.dob,\n        CASE \n            WHEN p.dod IS NOT NULL AND julianday(p.dod) - julianday(p.dob) <= 1825 THEN 1\n            ELSE 0\n        END AS six_month_mortality\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        patients p ON d.subject_id = p.subject_id\n),\nDiagnosisMortality AS (\n    SELECT \n        icd_code,\n        AVG(six_month_mortality) AS six_month_mortality_rate\n    FROM \n        MonthlyMortality\n    GROUP BY \n        icd_code\n)\nSELECT \n    icd_code,\n    six_month_mortality_rate\nFROM \n    DiagnosisMortality\nORDER BY \n    six_month_mortality_rate DESC\nLIMIT 4;",
    "18df7b68a00300388686a82b": "SELECT \n    MAX(total_cost) AS max_total_cost\nFROM (\n    SELECT \n        SUM(c.cost) AS total_cost\n    FROM cost c\n    JOIN procedures_icd p ON c.event_id = p.row_id\n    JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n    WHERE d.long_title = 'Extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic'\n    AND STRFTIME('%Y', c.chargetime) = STRFTIME('%Y', 'now')\n    GROUP BY c.subject_id\n) AS subquery;",
    "c818322213949df55b14a582": "SELECT AVG(T1.cost) AS average_total_cost\nFROM cost AS T1\nINNER JOIN procedures_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.event_type = 'procedure'\nAND T3.long_title = 'Performance of urinary filtration, multiple since 2100';",
    "719bc524af77a513ee6e0aa0": "SELECT MAX(T1.cost) AS max_total_cost\nFROM cost AS T1\nINNER JOIN procedures_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)';",
    "37edc3b1fd1e40d2f63d5c01": "SELECT \n  AVG(T1.cost) AS average_total_cost\nFROM \n  cost AS T1\nINNER JOIN \n  diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN \n  d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE \n  T3.long_title = 'Other laparoscopic umbilical herniorrhaphy in 2100';",
    "29fabfc4794a216ba5bf1993": "SELECT MAX(T1.cost) AS max_total_hospital_cost\nFROM cost AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nINNER JOIN procedures_icd AS T4 ON T1.event_id = T4.row_id\nINNER JOIN d_icd_procedures AS T5 ON T4.icd_code = T5.icd_code\nWHERE T3.long_title LIKE '%right and left heart cardiac catheterization%' AND T5.long_title LIKE '%combined right and left heart cardiac%';",
    "778832d66a9a3b3ebeb51d39": "SELECT AVG(T1.cost) AS average_total_cost\nFROM cost AS T1\nJOIN procedures_icd AS T2 ON T1.event_id = T2.row_id\nJOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Extirpation of matter from lung lingula, via natural or artificial opening endoscopic';",
    "7bc94deacf6c02cba88f38e5": "",
    "5dc4ad2f2838085f7c4b9af3": "SELECT MAX(c.cost) AS max_cost\nFROM cost c\nJOIN labevents l ON c.event_id = l.row_id\nJOIN d_labitems di ON l.itemid = di.itemid\nWHERE l.charttime >= '2100-01-01'\nAND di.label = 'Phenytoin';",
    "e684deacbe9f8050fb9c2537": "",
    "d91ba5c2ed88034e0a2b3870": "WITH glucose_tests AS (\n  SELECT hadm_id\n  FROM labevents\n  WHERE itemid = (SELECT itemid FROM d_labitems WHERE label LIKE '%glucose%')\n),\npleural_tests AS (\n  SELECT hadm_id\n  FROM labevents\n  WHERE itemid = (SELECT itemid FROM d_labitems WHERE label LIKE '%pleural%')\n),\nfiltered_hadm_ids AS (\n  SELECT hadm_id\n  FROM glucose_tests\n  INTERSECT\n  SELECT hadm_id\n  FROM pleural_tests\n),\ntotal_hospital_costs AS (\n  SELECT hadm_id, SUM(cost) AS total_cost\n  FROM cost\n  WHERE hadm_id IN (SELECT hadm_id FROM filtered_hadm_ids)\n  GROUP BY hadm_id\n)\nSELECT MAX(total_cost) AS max_total_hospital_cost\nFROM total_hospital_costs;",
    "f25934f599ad692e3d1cd779": "SELECT \n    MIN(total_cost) AS min_total_cost\nFROM\n(\n    SELECT \n        c.subject_id, \n        SUM(c.cost) AS total_cost\n    FROM \n        cost c\n    INNER JOIN \n        labevents l ON c.event_id = l.row_id\n    WHERE \n        l.charttime >= DATE('now', '-1 year') \n        AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = '% hemoglobin a1c')\n    GROUP BY \n        c.subject_id\n) AS subquery;",
    "8a678e5db3bbbe38b320aa96": "SELECT \n    MAX(c.cost) AS max_cost\nFROM \n    cost AS c\nINNER JOIN \n    labevents AS l ON c.event_id = l.row_id AND c.event_type = 'labevent'\nWHERE \n    l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Lactate dehydrogenase')\n    AND l.charttime >= '2100-01-01 00:00:00';",
    "688e0f542dd5995fefbabee6": "SELECT MIN(total_cost)\nFROM (\n    SELECT \n        T1.subject_id,\n        SUM(T1.cost) AS total_cost\n    FROM \n        cost T1\n    INNER JOIN \n        labevents T2 ON T1.event_id = T2.row_id\n    INNER JOIN \n        d_labitems T3 ON T2.itemid = T3.itemid\n    WHERE \n        T3.label = 'Lipase'\n    GROUP BY \n        T1.subject_id\n) T4;",
    "8b08fcfc0a63eadbb17b7167": "SELECT MIN(total_cost) AS min_total_cost\nFROM (\n    SELECT \n        a.hadm_id,\n        SUM(c.cost) AS total_cost\n    FROM admissions a\n    INNER JOIN labevents l ON a.hadm_id = l.hadm_id\n    INNER JOIN d_labitems d ON l.itemid = d.itemid\n    INNER JOIN cost c ON a.hadm_id = c.hadm_id\n    WHERE d.label = 'Hyaline Casts'\n    AND STRFTIME('%Y', a.admittime) = STRFTIME('%Y', 'now')\n    GROUP BY a.hadm_id\n) AS subquery;",
    "b0ded0fa2296a8f7a4d0926b": "WITH RelevantPrescriptions AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id, \n        p.drug, \n        p.starttime, \n        p.stoptime\n    FROM \n        prescriptions p\n    WHERE \n        p.drug = 'sulfameth/trimethoprim ss' \n        AND p.starttime > DATE('now', '-1 year')\n),\nTotalCosts AS (\n    SELECT \n        cp.subject_id, \n        cp.hadm_id, \n        SUM(c.cost) AS total_price\n    FROM \n        RelevantPrescriptions cp\n    JOIN \n        cost c ON cp.subject_id = c.subject_id AND cp.hadm_id = c.hadm_id\n    GROUP BY \n        cp.subject_id, \n        cp.hadm_id\n)\nSELECT \n    AVG(total_price) AS average_total_price\nFROM \n    TotalCosts;",
    "ee519753d2c9f939d5fb4219": "",
    "3017014a16809262a247bee7": "SELECT \n  AVG(total_cost) AS average_total_cost\nFROM (\n  SELECT \n    a.subject_id,\n    a.hadm_id,\n    SUM(c.cost) AS total_cost\n  FROM \n    admissions a\n  JOIN \n    prescriptions p ON a.hadm_id = p.hadm_id\n  JOIN \n    cost c ON a.hadm_id = c.hadm_id\n  WHERE \n    p.drug = 'phenazopyridine' AND\n    c.chargetime BETWEEN '2022-01-01' AND '2022-12-31'\n  GROUP BY \n    a.subject_id, a.hadm_id\n) AS subquery;",
    "6b5d224a0e7421bcf92afd3c": "WITH HospitalVisits AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id\n    FROM \n        prescriptions p\n    WHERE \n        p.drug = 'carvedilol'\n),\n\nTotalCost AS (\n    SELECT \n        c.subject_id,\n        c.hadm_id,\n        SUM(c.cost) AS total_cost\n    FROM \n        cost c\n    JOIN \n        HospitalVisits hv ON c.subject_id = hv.subject_id AND c.hadm_id = hv.hadm_id\n    GROUP BY \n        c.subject_id, c.hadm_id\n)\n\nSELECT \n    MAX(total_cost)\nFROM \n    TotalCost;",
    "a1e65b03fe2b7016b885dc09": "SELECT MIN(T1.total_cost) \nFROM (\n    SELECT SUM(T2.cost) AS total_cost\n    FROM admissions T1\n    INNER JOIN cost T2 ON T1.hadm_id = T2.hadm_id\n    INNER JOIN prescriptions T3 ON T1.hadm_id = T3.hadm_id\n    WHERE T3.drug = 'nicotine patch' AND T3.starttime > '2100-01-01'\n    GROUP BY T1.hadm_id\n) T1;",
    "a1070d070dd65690e308619d": "SELECT MIN(t.total_cost) AS min_total_cost\nFROM (\n  SELECT c.subject_id, SUM(c.cost) AS total_cost\n  FROM cost c\n  INNER JOIN prescriptions p ON c.subject_id = p.subject_id AND c.hadm_id = p.hadm_id\n  WHERE p.drug = 'ezetimibe'\n  GROUP BY c.subject_id\n) t;",
    "064647795088c18c2eea104a": "SELECT MAX(T1.cost) AS max_total_price\nFROM cost AS T1\nJOIN prescriptions AS T2 ON T1.event_id = T2.row_id\nWHERE T2.drug = 'vial in 2100';",
    "e2dee747281ae9a00c1fc13f": "SELECT MAX(total_hospital_cost)\nFROM (\n    SELECT SUM(c.cost) AS total_hospital_cost\n    FROM admissions a\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN cost c ON a.hadm_id = c.hadm_id\n    WHERE d.icd_code IN (\n        SELECT icd_code FROM d_icd_diagnoses WHERE long_title = 'Esophageal Obstruction'\n    )\n) AS subquery;",
    "86af6dbec3fe033cc1dee870": "SELECT \n--   MAX(T2.cost) AS max_total_hospital_cost\n-- FROM \n--   diagnoses_icd AS T1\n-- INNER JOIN \n--   cost AS T2 ON T1.row_id = T2.event_id\n-- WHERE \n--   T1.icd_code = 'P23.2100' AND T2.event_type = 'postprocedural pneumothorax';",
    "416f64511f06e29fd379a373": "",
    "40314c9ace9e04fb7834c2b1": "SELECT MIN(T1.cost) AS total_cost\nFROM cost AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Cerebral artery occlusion, unspecified with cerebral infarction in 2100';",
    "fd9d2ad9b857f9d53588d882": "SELECT AVG(c.cost) AS average_hospital_cost\nFROM cost c\nWHERE c.event_type = 'postprocedural hypotension';",
    "ecd19094660d16b8b750e976": "SELECT \n  MAX(total_hospital_cost) AS max_hospital_cost\nFROM (\n  SELECT \n    a.subject_id,\n    SUM(c.cost) AS total_hospital_cost\n  FROM \n    admissions a\n  INNER JOIN \n    cost c ON a.hadm_id = c.hadm_id\n  INNER JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\n  WHERE \n    d.icd_code BETWEEN 'I10.00' AND 'I10.99'\n  GROUP BY \n    a.subject_id\n) AS total_costs;",
    "1d487033ea60fadd114b1b53": "SELECT MAX(total_cost) AS max_cost\nFROM (\n    SELECT subject_id, SUM(cost) AS total_cost\n    FROM cost\n    JOIN diagnoses_icd ON cost.event_id = diagnoses_icd.row_id\n    WHERE diagnoses_icd.icd_code = 'P34.1'\n      AND cost.event_type = 'hospital'\n      AND cost.chargetime > '2100-01-01'\n    GROUP BY subject_id\n) AS total_costs;",
    "93102b4334928d2d31c801fb": "",
    "0d43d9237d6c0f97e565e463": "",
    "e2beb6df478d6979ad0aa648": "WITH gout_patients AS (\n  SELECT \n    p.subject_id,\n    strftime('%Y-%m', d.charttime) AS month\n  FROM diagnoses_icd d\n  JOIN patients p ON d.subject_id = p.subject_id\n  WHERE d.icd_code = 'M11.0'  -- Gout, unspecified\n)\nSELECT \n  month,\n  COUNT(*) AS patient_count\nFROM gout_patients\nGROUP BY month\nORDER BY month;",
    "1cb58d36d8c6b931e631e3da": "WITH yearly_counts AS (\n  SELECT \n    strftime('%Y', dob) AS year,\n    COUNT(subject_id) AS patient_count\n  FROM diagnoses_icd\n  JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\n  JOIN patients ON diagnoses_icd.subject_id = patients.subject_id\n  WHERE d_icd_diagnoses.icd_code = 'I43.0' \n    AND strftime('%Y', dob) > '2100'\n  GROUP BY strftime('%Y', dob)\n)\nSELECT MIN(patient_count) AS min_yearly_count\nFROM yearly_counts;",
    "96da08df43f14b5424aed61f": "WITH acutely_chronic AS (\n    SELECT p.subject_id\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Acute on Chronic Diastolic Heart Failure'\n),\ndaily_counts AS (\n    SELECT strftime('%Y-%m-%d', a.admittime) AS admittime_day,\n           COUNT(ac.subject_id) AS patient_count\n    FROM acutely_chronic ac\n    INNER JOIN admissions a ON ac.subject_id = a.subject_id\n    GROUP BY admittime_day\n),\navg_daily_count AS (\n    SELECT AVG(patient_count) AS avg_patient_count\n    FROM daily_counts\n)\nSELECT avg_patient_count\nFROM avg_daily_count;",
    "799182af909a63e2da1ddacf": "WITH InsulinDiagnoses AS (\n    SELECT \n        d.subject_id,\n        strftime('%Y-%m', d.charttime) AS month\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        d_icd_diagnoses i ON d.icd_code = i.icd_code\n    WHERE \n        i.long_title LIKE '%insulin%'\n),\nMonthlyCounts AS (\n    SELECT \n        month,\n        COUNT(subject_id) AS monthly_count\n    FROM \n        InsulinDiagnoses\n    GROUP BY \n        month\n)\nSELECT \n    MIN(monthly_count) AS min_monthly_count\nFROM \n    MonthlyCounts;",
    "b720f1ba67b87fd98f11e04c": "SELECT \n    strftime('%Y-%m', charttime) AS month,\n    AVG(CASE WHEN valuenum BETWEEN 38.0 AND 38.9 THEN 1 ELSE 0 END) AS average_bmi_records\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    d_labitems.label = 'Body Mass Index' AND\n    labevents.charttime IS NOT NULL\nGROUP BY \n    strftime('%Y-%m', charttime)",
    "278f3690974261bfe1e57d23": "SELECT COUNT(DISTINCT subject_id) AS num_patients\nFROM patients\nWHERE dob > DATE('now', '-1 year');",
    "4c6b438bb57ca0920edd4e9c": "SELECT COUNT(*) AS total_released\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.discharge_location = 'Released' AND strftime('%Y', a.dischtime) = '2100';",
    "8ba9ec982c184a417b8e5f83": "SELECT COUNT(subject_id) AS total_released\nFROM admissions\nWHERE discharge_location = 'HOSPITAL'\nAND STRFTIME('%Y', dischtime) = STRFTIME('%Y', 'now');",
    "ebd67617c22beab016550006": "SELECT \n  COUNT(subject_id) AS num_discharged\nFROM \n  admissions\nWHERE \n  dischtime > datetime('now', '-1 year');",
    "199488cf0d6a538d41fdc01b": "SELECT COUNT(*) AS discharged_count\nFROM admissions\nWHERE strftime('%Y', dischtime) = '2100';",
    "6b1fd8208b249c9a3f399917": "SELECT COUNT(*) \nFROM admissions \nWHERE strftime('%Y', dischtime) = strftime('%Y', 'now');",
    "f92a9715af7d181a656d4998": "SELECT COUNT(subject_id) AS num_discharged_patients\nFROM patients\nWHERE strftime('%Y', dod) = strftime('%Y', 'now') - 1;",
    "521aab3060d8c38e0cfbfa52": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN icustays icu ON p.subject_id = icu.subject_id\nWHERE icu.first_careunit = 'MICU/SICU'\n  AND icu.intime >= DATE('now', 'start of year');",
    "2d8946a73f748f86fc32345c": "SELECT COUNT(DISTINCT T1.subject_id) AS total_vascular_stays\nFROM patients AS T1\nINNER JOIN icustays AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.last_careunit = 'vascular' AND T2.intime > DATE('now', '-1 year');",
    "b593bfbb3c11df43f547bfcc": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM admissions\nWHERE admission_location = 'Medicine/Cardiology'\n  AND admittime >= DATE('now', '-1 year');",
    "8ba1b2de9452cc1d23057b9f": "SELECT COUNT(DISTINCT icustays.subject_id) AS num_patients\nFROM icustays\nJOIN admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE icustays.first_careunit = 'neuro sicu'\n  AND admissions.dischtime > date('now', '-1 year');",
    "a85685397831a790ea2cc0a7": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.admission_location = 'med/surg/gyn'\nAND strftime('%H', a.admittime) >= '2100';",
    "04ceafe43c52472b3acaedb4": "SELECT COUNT(DISTINCT T1.subject_id) AS total_patients\nFROM admissions AS T1\nINNER JOIN icustays AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.admittime >= DATE('now', '-1 year') AND T2.first_careunit = 'med/surg';",
    "775f200f8927ed7b82f10ff9": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE a.admittime >= DATE('now', '-1 year')\nAND a.discharge_location = 'Discharge Lounge';",
    "97d71a4dfbda63c1b6544be6": "SELECT \n  COUNT(DISTINCT p.subject_id) AS number_of_patients\nFROM \n  patients p\n  INNER JOIN diagnoses_icd d1 ON p.subject_id = d1.subject_id\n  INNER JOIN diagnoses_icd d2 ON p.subject_id = d2.subject_id\nWHERE \n  d1.icd_code = 'S41.0'  -- Multiple fractures of ribs, left side, initial encounter for closed fracture in 2100\n  AND d2.icd_code = 'R47.0'  -- Patient room in hospital as the place of occurrence of the external cause within 2 months following the previous diagnosis\n  AND d1.charttime < d2.charttime\n  AND julianday(d2.charttime) - julianday(d1.charttime) <= 60",
    "72392c4da0fd16d899e4307e": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    diagnoses_icd d1 ON a.hadm_id = d1.hadm_id\nJOIN \n    d_icd_diagnoses d2 ON d1.icd_code = d2.icd_code\nJOIN \n    diagnoses_icd d3 ON a.hadm_id = d3.hadm_id\nJOIN \n    d_icd_diagnoses d4 ON d3.icd_code = d4.icd_code\nWHERE \n    d2.long_title = 'Bipolar I Disorder, most recent episode (or current) mixed, unspecified'\n    AND d4.long_title LIKE 'Hyperlipidemia in 2100, other and unspecified%';",
    "ddee5ac733d7dabd9130af5c": "",
    "d81467bbe205d33ca94ef61f": "WITH DiagnosedPatients AS (\n  SELECT \n    T1.subject_id, \n    T1.hadm_id, \n    T2.long_title AS diagnosis, \n    T1.charttime\n  FROM \n    diagnoses_icd T1\n  INNER JOIN \n    d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\n  WHERE \n    T2.long_title IN ('Tobacco use disorder', 'Diarrhea')\n    AND T1.charttime BETWEEN '2100-01-01' AND '2100-12-31'\n)\nSELECT \n  COUNT(DISTINCT subject_id) AS total_patients\nFROM \n  DiagnosedPatients DP1\nINNER JOIN \n  DiagnosedPatients DP2 ON DP1.hadm_id = DP2.hadm_id\nWHERE \n  DP1.diagnosis = 'Tobacco use disorder'\n  AND DP2.diagnosis = 'Diarrhea'\n  AND DP1.charttime < DP2.charttime;",
    "43c158cb01b2f2079157b719": "WITH PostproceduralFeverCTE AS (\n    SELECT \n        d.subject_id,\n        d.charttime AS fever_time\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Postprocedural Fever'\n      AND d.charttime >= '2100-01-01'\n),\nAorticValveDisorderCTE AS (\n    SELECT \n        d.subject_id,\n        d.charttime AS avd_time,\n        LAG(d.charttime) OVER (PARTITION BY d.subject_id ORDER BY d.charttime) AS prev_fever_time\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Aortic Valve Disorder'\n      AND d.charttime >= '2100-01-01'\n)\nSELECT \n    COUNT(DISTINCT av.subject_id) AS patient_count\nFROM AorticValveDisorderCTE av\nJOIN PostproceduralFeverCTE pf ON av.subject_id = pf.subject_id\nWHERE strftime('%Y-%m', av.avd_time) = strftime('%Y-%m', pf.fever_time)\n  AND strftime('%Y-%m', av.prev_fever_time) = strftime('%Y-%m', pf.fever_time);",
    "3e9064d2108a3ee8c6ae4ee2": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    diagnoses_icd icd1 ON a.hadm_id = icd1.hadm_id\nJOIN \n    diagnoses_icd icd2 ON a.hadm_id = icd2.hadm_id\nJOIN \n    d_icd_diagnoses d1 ON icd1.icd_code = d1.icd_code\nJOIN \n    d_icd_diagnoses d2 ON icd2.icd_code = d2.icd_code\nWHERE \n    d1.long_title = 'Unspecified disorder of kidney and ureter'\n    AND d2.long_title = 'Diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled'\n    AND icd1.charttime < icd2.charttime;",
    "f87b894e8644d660bf3e856f": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN diagnoses_icd d1 ON p.subject_id = d1.subject_id\nINNER JOIN diagnoses_icd d2 ON p.subject_id = d2.subject_id AND d1.hadm_id = d2.hadm_id\nWHERE d1.icd_code = 'N62.10' \nAND d2.icd_code = 'M80.1' \nAND d2.charttime > d1.charttime;",
    "dd686405621c04ac8522072e": "",
    "81a0501d514e4a4fa8672c08": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dicd ON d.icd_code = dicd.icd_code\nWHERE dicd.long_title = 'Body Mass Index, 19-24, Adult'\n  AND d.charttime >= '2100-01-01';",
    "9e655b0885b1141a8fcb1bb1": "SELECT \n    COUNT(DISTINCT p.subject_id) AS total_patients\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN \n    d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\nWHERE \n    ddi.icd_code = '210.00' \n    AND ddi.long_title = 'Major depressive disorder, single episode, unspecified';",
    "e843bc5ff21d749a06ab5bc3": "SELECT COUNT(DISTINCT T1.subject_id) AS do_not_resuscitate_count\nFROM patients AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'do not resuscitate'\nAND T2.charttime BETWEEN '2100-01-01' AND '2100-12-31';",
    "6708f1fa7b82536c05febcef": "SELECT COUNT(*) AS number_of_people\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title = 'Acute edema of lung, unspecified';",
    "6d5bb8b2a694bc9e91caea13": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Acute venous embolism and thrombosis of subclavian veins'\n  AND d.charttime >= DATE('now', '-1 year');",
    "9b08cb9ac92f27049de294fd": "SELECT COUNT(DISTINCT d.subject_id) \nFROM diagnoses_icd d\nJOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\nWHERE di.long_title = 'hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side';",
    "a2af82429c00976d404b6e5d": "SELECT \n    COUNT(DISTINCT CASE WHEN T1.icd_code = 'CECECTOMY OPEN' THEN T2.subject_id END) AS open_cecectomies,\n    COUNT(DISTINCT CASE WHEN T1.icd_code = 'CECECTOMY OTHER' THEN T2.subject_id END) AS other_cecectomies\nFROM \n    d_icd_procedures AS T1\nINNER JOIN \n    procedures_icd AS T2 ON T1.icd_code = T2.icd_code;",
    "d09c79e777148f87f0c15c92": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN procedures_icd pr ON p.subject_id = pr.subject_id \nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code \nWHERE d.long_title = 'Other electroshock therapy treatment' \nAND pr.charttime LIKE '2100%';",
    "c7bc7892dca1cc286f05887f": "SELECT COUNT(DISTINCT T1.subject_id) AS patient_count\nFROM procedures_icd AS T1\nINNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nWHERE T2.long_title = 'Other incision of brain'\nAND strftime('%Y', T1.charttime) = strftime('%Y', 'now');",
    "3fa5e54471bc2eac34ec48ed": "",
    "ea784a4b3ba382dd3a8dca8e": "SELECT COUNT(DISTINCT T1.subject_id) AS num_patients\nFROM procedures_icd AS T1\nINNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nWHERE T2.long_title LIKE '%aortography%';",
    "e39e837fb8cffe6bbe93bb60": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures di ON pr.icd_code = di.icd_code\nWHERE di.long_title = 'Bypass coronary artery, one artery from aorta with autologous venous tissue, open approach'\nAND pr.charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59';",
    "a8a7ae0b4b0cdddab9d4616d": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures dicd ON pr.icd_code = dicd.icd_code\nWHERE dicd.long_title LIKE '%excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure%'\n  AND pr.charttime BETWEEN '2100-01-01' AND '2100-12-31';",
    "af72aeed0e5cc61f2a10a8ed": "SELECT \n    p.subject_id AS patient_id\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    procedures_icd pr ON a.hadm_id = pr.hadm_id\nINNER JOIN \n    d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE \n    d.long_title = 'Insertion of infusion device into right atrium, percutaneous approach'\n    AND pr.charttime >= '2100-01-01'\nGROUP BY \n    p.subject_id\nHAVING \n    COUNT(pr.row_id) >= 2;",
    "225970019a185c7b566265ff": "SELECT COUNT(DISTINCT p.subject_id) AS total_subjects\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nINNER JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE a.admittime BETWEEN DATE('now', 'start of year') AND DATE('now', 'end of year')\nAND d.long_title = 'Excision of dental lesion of jaw'\nAND pr.charttime BETWEEN DATE('now', 'start of year') AND DATE('now', 'end of year')\nGROUP BY p.subject_id\nHAVING COUNT(pr.row_id) >= 2;",
    "a51c8d210fb99892e9c4157c": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title LIKE '%Angiocardiography of Left Heart Structures%'\n  AND a.admittime >= DATE('now', '-1 year')\nGROUP BY p.subject_id\nHAVING COUNT(pr.row_id) > 1;",
    "4f58f3a3dafa1f8cd4ff29a8": "",
    "3b064609e2c9c1d5192c303d": "SELECT \n    COUNT(DISTINCT T1.subject_id) AS patient_count\nFROM \n    patients T1\nINNER JOIN \n    diagnoses_icd T2 ON T1.subject_id = T2.subject_id\nINNER JOIN \n    d_icd_procedures T3 ON T2.icd_code = T3.icd_code\nWHERE \n    T3.long_title LIKE '%other computer assisted surgery procedure%'\n    AND T2.charttime >= DATE('now', '-1 year')\nGROUP BY \n    T1.subject_id\nHAVING \n    COUNT(T1.subject_id) > 1;",
    "3984301a9bd8a75a815b502a": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title LIKE '%excision of dental lesion of jaw two or more times%' \n  AND CAST(SUBSTR(a.admittime, 1, 4) AS INTEGER) > 2100;",
    "3ee1fa015c88d17b50ff62cb": "",
    "68483e4f1201b049144af718": "SELECT COUNT(DISTINCT p.subject_id) AS total_subjects\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN procedures_icd pr ON d.hadm_id = pr.hadm_id\nWHERE d.icd_code = 'O84.1'\nAND pr.icd_code = 'OA65'\nAND d.charttime < pr.charttime\nAND pr.charttime - d.charttime <= '2 months';",
    "1773166323d7822bd908fecf": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE d.icd_code = 'T86.9'\nAND pr.icd_code = 'S62.2';",
    "942ff36dd9b2fbe79fa75553": "WITH SepsisDiagnosis AS (\n    SELECT\n        d.subject_id,\n        d.hadm_id\n    FROM\n        diagnoses_icd d\n    INNER JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n    WHERE\n        ddi.long_title = 'Severe sepsis (2100)'\n),\nVentilationEvents AS (\n    SELECT\n        i.subject_id,\n        i.hadm_id,\n        i.itemid,\n        i.starttime,\n        i.stoptime,\n        d.totalamount,\n        d.totalamountuom\n    FROM\n        inputevents i\n    INNER JOIN d_items d ON i.itemid = d.itemid\n    WHERE\n        d.label = 'Continuous invasive mechanical ventilation'\n),\nQualifiedVentilation AS (\n    SELECT\n        ve.subject_id,\n        ve.hadm_id,\n        ve.itemid,\n        ve.starttime,\n        ve.stoptime,\n        ve.totalamount,\n        ve.totalamountuom,\n        COUNT(*) OVER (PARTITION BY ve.subject_id, ve.hadm_id ORDER BY ve.starttime) AS consecutive_hours\n    FROM\n        VentilationEvents ve\n)\nSELECT\n    COUNT(DISTINCT qv.subject_id)\nFROM\n    QualifiedVentilation qv\nINNER JOIN SepsisDiagnosis sd ON qv.subject_id = sd.subject_id AND qv.hadm_id = sd.hadm_id\nWHERE\n    qv.consecutive_hours >= 96;",
    "90b0586c4e17390d3684288d": "",
    "0179a63a9ea6811f17901566": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures ppr ON pr.icd_code = ppr.icd_code\nWHERE dd.long_title = 'Essential (primary) hypertension since 2100'\n  AND ppr.long_title = 'Excision of left internal mammary artery, percutaneous endoscopic approach'\n  AND pr.charttime BETWEEN d.charttime AND DATE(d.charttime, '+2 months');",
    "f770528a39adb96dadeb2ece": "SELECT COUNT(DISTINCT p.subject_id) AS number_of_patients\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures dp ON pr.icd_code = dp.icd_code\nWHERE dd.long_title LIKE '%iatrogenic pneumothorax%'\n  AND dp.long_title LIKE '%extracorporeal circulation auxiliary to open heart surgery%'\n  AND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', pr.charttime)\n  AND d.charttime >= '2100-01-01';",
    "59c016a2706b41628b2c89c5": "WITH CentralVenousCatheterCTE AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\n    INNER JOIN d_icd_procedures dp ON pr.icd_code = dp.icd_code\n    WHERE pr.charttime BETWEEN DATE('now', '-1 year') AND DATE('now')\n      AND pr.charttime >= a.admittime\n      AND dp.long_title = 'Central Venous Catheter Placement with Guidance'\n),\nDiagnosedPatientsCTE AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n    INNER JOIN d_icd_diagnoses dd ON di.icd_code = dd.icd_code\n    WHERE di.charttime BETWEEN DATE('now', '-1 year') AND DATE('now')\n      AND dd.long_title = 'Family History of Malignant Neoplasm of Trachea, Bronchus, and Lung'\n)\nSELECT COUNT(DISTINCT cvc.subject_id) AS total_patients\nFROM CentralVenousCatheterCTE cvc\nINNER JOIN DiagnosedPatientsCTE dp ON cvc.subject_id = dp.subject_id\nINNER JOIN admissions a ON cvc.subject_id = a.subject_id\nWHERE a.admittime BETWEEN DATE('now', '-1 year') AND DATE('now')\n  AND cvc.subject_id IN (\n    SELECT subject_id\n    FROM admissions\n    WHERE admittime BETWEEN DATE('now', '-1 year') AND DATE('now')\n      AND strftime('%Y-%m', admittime) = strftime('%Y-%m', cvc.subject_id)\n  );",
    "4fbf6bc24f6506d4e0648954": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Right heart cardiac catheterization'\n  AND p.charttime > '2100-01-01';",
    "399219ab0cecf87bb146bf4f": "SELECT COUNT(*) AS total_ultrasound_cases\nFROM diagnoses_icd\nWHERE icd_code = 'G90.01';",
    "b887f31e7adc13f9605b4ce5": "",
    "637392b0ddde6c01f3635914": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd pi\nJOIN d_icd_procedures dip ON pi.icd_code = dip.icd_code\nWHERE dip.long_title = 'Excision of left internal mammary artery, percutaneous endoscopic approach'\nAND strftime('%Y', pi.charttime) = '2100';",
    "888ffc67091ab77a0031df58": "WITH procedure_durations AS (\n    SELECT \n        p.hadm_id,\n        p.subject_id,\n        p.icd_code,\n        icu.intime,\n        icu.outtime,\n        (julianday(icu.outtime) - julianday(icu.intime)) * 24 AS duration_hours\n    FROM \n        procedures_icd p\n    INNER JOIN \n        icustays icu ON p.hadm_id = icu.hadm_id AND p.subject_id = icu.subject_id\n    WHERE \n        p.icd_code = 'R00.01'\n)\nSELECT \n    COUNT(*) AS total_procedures\nFROM \n    procedure_durations\nWHERE \n    duration_hours > 96;",
    "a7705b90ca7be8540a57b179": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd AS pr\nINNER JOIN d_icd_procedures AS dp ON pr.icd_code = dp.icd_code\nWHERE dp.long_title = 'Excision of right lower lung lobe, via natural or artificial opening endoscopic procedure'\nAND pr.charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59';",
    "5c2f1712b0944318f3f979b0": "SELECT COUNT(*) \nFROM procedures_icd \nWHERE icd_code = '00.11' \n  AND charttime >= DATE('now', 'start of year');",
    "4556ccee5b6838ef92b0563d": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug = 'nitroprusside sodium';",
    "8a2eb3b60c1ea3c2e4c41c3d": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'oxycodone (immediate release)' \n  AND pr.starttime LIKE '2100%';",
    "2e78bc9dfee6ec2d33d855e8": "",
    "66c7ab0996cecda175a87a37": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM prescriptions\nWHERE drug IN ('metformin', 'glucophage')\n  AND starttime >= '2023-01-01'\n  AND starttime < '2024-01-01';",
    "1e4019a7c27981289e8158a6": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM prescriptions\nWHERE drug = 'doxycycline hyclate';",
    "585481006142353555e7db6c": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug = 'phosphorus'\n  AND pr.starttime BETWEEN DATE('now', '-1 year') AND DATE('now');",
    "387e90582a0211b4f9b8baa0": "SELECT COUNT(DISTINCT subject_id) AS count_patients\nFROM prescriptions\nWHERE drug = 'fenofibrate';",
    "9fd92541abda6f41b7def429": "SELECT COUNT(*) AS total_quinidine_prescriptions\nFROM prescriptions\nWHERE drug = 'quinidine gluconate e.r.'\n  AND starttime >= DATE('now', '-1 year');",
    "f2f618df33524232a41e164a": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE drug LIKE 'heparin (crrt machine priming)'\nAND starttime >= '2100';",
    "12e5aa7d6e4aad370d1ec784": "SELECT COUNT(*) AS num_prescriptions\nFROM prescriptions\nWHERE drug = 'diltiazem extended-release';",
    "9629cd5b13741202a0e1dc2e": "SELECT COUNT(*) AS midodrine_count\nFROM prescriptions\nWHERE drug = 'MIDOXCRIN'\nAND starttime >= DATE('now', '-1 year');",
    "c0c458bde811f783bf9c0186": "SELECT COUNT(*) \nFROM prescriptions p \nWHERE p.drug = 'latanoprost 0.005% ophth. soln.' \nAND p.starttime > DATE('now', '-1 year');",
    "c62d48014cb74f4fc40d76b2": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'docusate';",
    "e278ba85bcbc856b575a2432": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'tramadol' \nAND starttime >= DATE('now', '-1 year');",
    "5bfb3ee348b0af2b550eb5fd": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN prescriptions ps ON a.hadm_id = ps.hadm_id\nWHERE ps.drug = 'ketorolac'\nAND pr.icd_code IN ('ICD10-CM-0001', 'ICD10-CM-0002')  -- Assuming these are the correct ICD codes for central venous catheter placement with guidance treatment\nAND d.icd_code IN ('ICD10-CM-0003', 'ICD10-CM-0004')  -- Assuming these are the correct ICD codes for central venous catheter placement with guidance treatment\nAND ps.starttime > '2100-01-01'\nAND ps.stoptime > '2100-01-01';",
    "77afb1ef1604c879a7c457e5": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN prescriptions ps ON a.hadm_id = ps.hadm_id\nWHERE pr.icd_code = '131.00'  -- Procedure for percutaneous abdominal drainage\nAND ps.drug = 'spironolactone'\nAND ps.starttime >= a.admittime\nAND ps.starttime <= a.dischtime;",
    "b155b30fab3d7945e185f841": "WITH ProcedureCTE AS (\n    SELECT\n        a.subject_id,\n        a.hadm_id,\n        p.charttime\n    FROM admissions a\n    INNER JOIN procedures_icd p ON a.hadm_id = p.hadm_id\n    INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n    WHERE d.long_title = 'Change feeding device in lower intestinal tract, external approach'\n      AND p.charttime >= '2100-01-01'\n),\nPrescriptionCTE AS (\n    SELECT\n        pr.subject_id,\n        pr.hadm_id,\n        pr.starttime\n    FROM prescriptions pr\n    WHERE pr.drug = 'Glucose Gel'\n      AND pr.starttime >= '2100-01-01'\n)\nSELECT\n    COUNT(DISTINCT p.subject_id) AS total_patients\nFROM ProcedureCTE p\nINNER JOIN PrescriptionCTE pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\nWHERE strftime('%Y-%m', p.charttime) = strftime('%Y-%m', pr.starttime);",
    "cdc0b49b39728980763c9830": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN prescriptions pr ON a.subject_id = pr.subject_id\nINNER JOIN procedures_icd p_icd ON a.hadm_id = p_icd.hadm_id\nINNER JOIN d_icd_procedures d_icd ON p_icd.icd_code = d_icd.icd_code\nWHERE a.admittime >= DATE('now', 'start of year')\nAND pr.drug = 'ketorolac'\nAND strftime('%Y-%m', a.admittime) = strftime('%Y-%m', pr.starttime)\nAND d_icd.long_title = 'Cardiac Output, Continuous Treatment';",
    "545884471d7fc70a0f8b1fce": "WITH pancreatic_cysts AS (\n  SELECT p.subject_id, d.charttime AS drainage_time\n  FROM patients p\n  JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE di.long_title = 'Pancreatic Cyst'\n),\nprescriptions_2_months_after AS (\n  SELECT pr.subject_id, pr.starttime AS prescription_time\n  FROM prescriptions pr\n  JOIN pancreatic_cysts pc ON pr.subject_id = pc.subject_id\n  WHERE pr.drug = 'Acetaminophen' AND pr.starttime > pc.drainage_time AND pr.starttime <= DATE(pc.drainage_time, '+2 month')\n)\nSELECT COUNT(DISTINCT subject_id) AS num_patients\nFROM prescriptions_2_months_after;",
    "8fdc820d61c609ac4f0bed57": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\n    INNER JOIN d_icd_procedures dpr ON pr.icd_code = dpr.icd_code\n    INNER JOIN inputevents i ON a.hadm_id = i.hadm_id\n    INNER JOIN d_items di ON i.itemid = di.itemid\nWHERE \n    dpr.long_title = 'Other endoscopy of small intestine'\n    AND i.itemid = (SELECT itemid FROM d_items WHERE label = '0.9% sodium chloride (mini bag plus)')\n    AND STRFTIME('%Y-%m', i.charttime) = STRFTIME('%Y-%m', DATE('2100-01-01', '+1 month'))\n    AND STRFTIME('%Y-%m', pr.charttime) = STRFTIME('%Y-%m', DATE('2100-01-01', '+1 month'))",
    "ef78694fed50bccd3e8eed2e": "",
    "4ae971e027ab0b11a6f1c018": "SELECT COUNT(DISTINCT le.subject_id) AS total_metamyelocytes_patients\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE li.label = 'Metamyelocytes'\nAND strftime('%Y', le.charttime) = strftime('%Y', 'now');",
    "de0718a1175887225e4a3701": "SELECT COUNT(DISTINCT T1.subject_id) AS patients_with_plasma_test\nFROM patients T1\nINNER JOIN admissions T2 ON T1.subject_id = T2.subject_id\nINNER JOIN icustays T3 ON T2.hadm_id = T3.hadm_id\nINNER JOIN chartevents T4 ON T3.stay_id = T4.stay_id\nINNER JOIN d_labitems T5 ON T4.itemid = T5.itemid\nINNER JOIN labevents T6 ON T4.stay_id = T6.hadm_id\nWHERE T5.label = 'Plasma Cells Test' AND T6.charttime >= DATE('now', '-1 year');",
    "db4ebf8381b39fb14b2f5dab": "SELECT COUNT(DISTINCT l.subject_id) AS num_patients\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE d.label LIKE '%Triglycerides%' \n  AND l.charttime > DATE('now', '-1 year');",
    "be7de3372a4c08b2ae411296": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN admissions a ON p.subject_id = a.subject_id \nJOIN labevents l ON a.hadm_id = l.hadm_id \nJOIN d_labitems d ON l.itemid = d.itemid \nWHERE d.label LIKE '%Epithelial Cells%' \nAND l.charttime BETWEEN DATE('now', '-1 year') AND DATE('now');",
    "0ab0e14edb41ec298e991c8c": "SELECT COUNT(DISTINCT subject_id) \nFROM microbiologyevents \nWHERE test_name = 'Uric Acid Test' \n  AND charttime LIKE '2100%';",
    "37c4dfeda91b7ea5c88a15b6": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM labevents\nWHERE itemid = (SELECT itemid FROM d_labitems WHERE label = 'Vitamin B12')\n  AND charttime >= '2100-01-01';",
    "ec12c483a1d7d0bf16b1fbc4": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN labevents l ON p.subject_id = l.subject_id\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.charttime > DATE('now', '-1 year')\nAND d.label = 'Rheumatoid Factor';",
    "9b6fff1f017a3163467fb155": "SELECT COUNT(DISTINCT p.subject_id) AS total_dextrose_patients\nFROM patients p\nJOIN inputevents i ON p.subject_id = i.subject_id\nWHERE i.itemid = (SELECT itemid FROM d_items WHERE label = 'Dextrose 50%')\n  AND strftime('%Y', i.starttime) = strftime('%Y', 'now');",
    "d9dc77e2a9eef59e0164883e": "SELECT COUNT(DISTINCT inputevents.subject_id) AS total_patients\nFROM inputevents\nINNER JOIN admissions ON inputevents.hadm_id = admissions.hadm_id\nINNER JOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE d_items.label = 'd5 1/2ns'\n  AND strftime('%Y', admissions.admittime) = strftime('%Y', 'now') - 1;",
    "e793c664c5790f8705865139": "SELECT COUNT(*) \nFROM inputevents \nWHERE totalamount = 2100 \nAND totalamountuom = 'units of free water';",
    "a36f72eb4bd75e8ee0def85f": "WITH ThisYearInput AS (\n  SELECT \n    subject_id,\n    hadm_id,\n    itemid,\n    starttime,\n    totalamount,\n    totalamountuom\n  FROM \n    inputevents\n  WHERE \n    strftime('%Y', starttime) = strftime('%Y', 'now')\n),\nPackedRedBloodCells AS (\n  SELECT \n    itemid\n  FROM \n    d_items\n  WHERE \n    label = 'Packed Red Blood Cells'\n)\nSELECT \n  COUNT(DISTINCT ti.subject_id) AS total_patients\nFROM \n  ThisYearInput ti\n  INNER JOIN PackedRedBloodCells prbc ON ti.itemid = prbc.itemid;",
    "07cfe6a604bc9ff70115ca01": "SELECT \n  COUNT(DISTINCT subject_id) AS patient_count\nFROM \n  inputevents\nWHERE \n  itemid = (SELECT itemid FROM d_items WHERE label = 'Fresh Frozen Plasma')\n  AND starttime >= DATE('now', '-1 year')\n  AND starttime < DATE('now');",
    "abef8d8c91bb576ba70341f2": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM prescriptions\nWHERE drug = 'promote with fiber (full)'\n  AND starttime >= DATE('now', '-1 year');",
    "07b458a4465bdc3893cd4d3b": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM inputevents\nWHERE totalamount > 0\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'Albumin 5%')\nAND starttime >= date('now', '-1 year');",
    "7ade7790a24e397e1e54a0a0": "SELECT icd_code, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd\nWHERE charttime LIKE '2100-%'\nGROUP BY icd_code\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "8b18506ab5223069c0701a48": "SELECT long_title\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE icd_code LIKE '2100%'\nGROUP BY long_title\nORDER BY COUNT(*) DESC\nLIMIT 4;",
    "be30cffa66ec6b8f274e5abc": "SELECT icd_code\nFROM diagnoses_icd\nWHERE charttime > '2100-01-01'\nGROUP BY icd_code\nORDER BY COUNT(icd_code) DESC\nLIMIT 5;",
    "4afbd97439436cbe90ee25f1": "WITH DiagnosisCounts AS (\n    SELECT icd_code, COUNT(*) AS count\n    FROM diagnoses_icd\n    WHERE charttime LIKE '2100%'\n    GROUP BY icd_code\n),\nRankedDiagnoses AS (\n    SELECT icd_code, count,\n           ROW_NUMBER() OVER (ORDER BY count DESC) AS rank\n    FROM DiagnosisCounts\n)\nSELECT icd_code, count\nFROM RankedDiagnoses\nWHERE rank <= 5;",
    "ad66076596714253fdd0da06": "SELECT d.long_title AS diagnosis, COUNT(*) AS count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.charttime >= '2100-01-01'\nGROUP BY d.long_title\nORDER BY count DESC\nLIMIT 5;",
    "70782f0b95270ba463ce4f33": "SELECT \n    d.icd_code,\n    COUNT(d.icd_code) AS frequency\nFROM \n    admissions a\nINNER JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\nWHERE \n    a.admittime >= date('now', 'start of year') AND a.admittime < date('now', 'start of year', '+1 year')\nGROUP BY \n    d.icd_code\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "6aaf71c0cfa396b28f225bc3": "WITH RecentDiagnoses AS (\n  SELECT\n    d.subject_id,\n    d.icd_code,\n    d.charttime\n  FROM diagnoses_icd d\n  INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n  WHERE a.admittime >= DATE('now', '-1 year')\n),\nDiagnosisCounts AS (\n  SELECT\n    icd_code,\n    COUNT(*) AS diagnosis_count\n  FROM RecentDiagnoses\n  GROUP BY icd_code\n),\nRankedDiagnoses AS (\n  SELECT\n    icd_code,\n    diagnosis_count,\n    ROW_NUMBER() OVER (ORDER BY diagnosis_count DESC) AS rank\n  FROM DiagnosisCounts\n)\nSELECT\n  icd_code,\n  diagnosis_count\nFROM RankedDiagnoses\nWHERE rank <= 3;",
    "4ea2037fa4bc87104f556c64": "WITH DiagnosesCTE AS (\n    SELECT \n        d.icd_code, \n        COUNT(*) AS diagnosis_count\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        admissions a ON d.hadm_id = a.hadm_id\n    INNER JOIN \n        patients p ON a.subject_id = p.subject_id\n    WHERE \n        p.dob <= DATE('now', '-60 years')\n        AND a.admittime >= DATE('now', 'start of year')\n    GROUP BY \n        d.icd_code\n),\nRankedDiagnoses AS (\n    SELECT \n        icd_code, \n        diagnosis_count,\n        RANK() OVER (ORDER BY diagnosis_count DESC) AS rank\n    FROM \n        DiagnosesCTE\n)\nSELECT \n    icd_code, \n    diagnosis_count\nFROM \n    RankedDiagnoses\nWHERE \n    rank <= 3;",
    "40d147343c07229976c1f711": "SELECT d.long_title, COUNT(*) as diagnosis_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE a.age >= 60\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "88bfa1913eb595bb2ec3e15e": "SELECT T2.long_title, COUNT(T1.hadm_id) AS diagnosis_count\nFROM diagnoses_icd AS T1\nJOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nJOIN admissions AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE T3.age BETWEEN 30 AND 39\nGROUP BY T2.long_title\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "6fcb390235190f852352ba02": "SELECT d.icd_code, COUNT(*) AS count\nFROM admissions a\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nWHERE strftime('%Y', a.admittime) = '2100'\n  AND a.age BETWEEN 20 AND 29\nGROUP BY d.icd_code\nORDER BY count DESC\nLIMIT 4;",
    "e3171ac111633770ec5fe8d0": "",
    "7f14fffc462f0b0f329a9639": "SELECT icd_code, COUNT(*) AS frequency\nFROM diagnoses_icd\nJOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id\nJOIN patients ON admissions.subject_id = patients.subject_id\nWHERE patients.dob >= DATE('now', '-1 year') AND patients.gender = 'M'\nGROUP BY icd_code\nORDER BY frequency DESC\nLIMIT 3;",
    "82f39085117b4eee63cfcbd8": "SELECT T2.long_title AS diagnosis, COUNT(*) AS num_diagnoses\nFROM diagnoses_icd T1\nJOIN d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\nJOIN admissions T3 ON T1.hadm_id = T3.hadm_id\nJOIN patients T4 ON T3.subject_id = T4.subject_id\nWHERE T4.dob LIKE '2100%' AND (strftime('%Y', T4.dob) - 30) = strftime('%Y', T3.admittime)\nGROUP BY T2.long_title\nORDER BY num_diagnoses DESC\nLIMIT 4;",
    "ed396de025aef41a12776f3d": "WITH ProcedurePatients AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN procedures_icd pi ON p.subject_id = pi.subject_id\n    JOIN d_icd_procedures d ON pi.icd_code = d.icd_code\n    WHERE d.long_title = 'Resection of vessel with replacement, thoracic vessels'\n      AND pi.charttime LIKE '2100-01%'\n),\nDiagnoses AS (\n    SELECT pi.subject_id, di.long_title AS diagnosis\n    FROM ProcedurePatients pp\n    JOIN diagnoses_icd pi ON pp.subject_id = pi.subject_id\n    JOIN d_icd_diagnoses di ON pi.icd_code = di.icd_code\n    WHERE pi.charttime LIKE '2100-01%'\n),\nDiagnosisCounts AS (\n    SELECT diagnosis, COUNT(*) AS count\n    FROM Diagnoses\n    GROUP BY diagnosis\n),\nRankedDiagnoses AS (\n    SELECT diagnosis, count,\n           ROW_NUMBER() OVER (ORDER BY count DESC) AS rank\n    FROM DiagnosisCounts\n)\nSELECT diagnosis, count\nFROM RankedDiagnoses\nWHERE rank <= 3;",
    "6fdd01eeff3d0426c273f13a": "SELECT d.long_title, COUNT(*) AS frequency\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN procedures_icd pi ON di.subject_id = pi.subject_id AND di.hadm_id = pi.hadm_id\nWHERE di.charttime >= '2100-01-01'\nAND pi.icd_code IN (\n    SELECT icd_code \n    FROM d_icd_procedures \n    WHERE long_title = 'Performance of cardiac output, continuous procedure'\n)\nGROUP BY d.long_title\nHAVING COUNT(*) > 1\nORDER BY frequency DESC\nLIMIT 4;",
    "47c10150fc2a7ef2316ffcd9": "WITH LaparoscopicLysis AS (\n    SELECT \n        p.subject_id,\n        a.hadm_id\n    FROM \n        patients p\n    INNER JOIN \n        admissions a ON p.subject_id = a.subject_id\n    INNER JOIN \n        procedures_icd pr ON a.hadm_id = pr.hadm_id\n    INNER JOIN \n        d_icd_procedures d ON pr.icd_code = d.icd_code\n    WHERE \n        d.long_title = 'Laparoscopic lysis of peritoneal adhesions'\n        AND a.dischtime > DATETIME('now', '-1 year')\n),\nRecentDiagnoses AS (\n    SELECT \n        pr.subject_id,\n        pr.hadm_id,\n        d.long_title AS diagnosis\n    FROM \n        LaparoscopicLysis ll\n    INNER JOIN \n        diagnoses_icd pr ON ll.hadm_id = pr.hadm_id\n    INNER JOIN \n        d_icd_diagnoses d ON pr.icd_code = d.icd_code\n    WHERE \n        pr.charttime BETWEEN ll.hadm_id.dischtime AND DATETIME(ll.hadm_id.dischtime, '+2 months')\n),\nDiagnosisCounts AS (\n    SELECT \n        diagnosis,\n        COUNT(*) AS count\n    FROM \n        RecentDiagnoses\n    GROUP BY \n        diagnosis\n)\nSELECT \n    diagnosis,\n    count\nFROM \n    DiagnosisCounts\nORDER BY \n    count DESC\nLIMIT 3;",
    "db3c11ffd16f4f7b363b7a95": "WITH hemodialysis AS (\n    SELECT subject_id\n    FROM admissions\n    WHERE admission_type = 'emerg' AND discharge_location = 'hemodialysis'\n    AND admittime >= '2023-01-01' AND admittime < '2024-01-01'\n),\ndiagnoses AS (\n    SELECT d.subject_id, d.icd_code, di.long_title, d.charttime\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE d.subject_id IN (SELECT subject_id FROM hemodialysis)\n)\nSELECT long_title AS diagnosis\nFROM diagnoses\nWHERE charttime >= '2023-01-01' AND charttime < '2024-01-01'\nAND charttime >= DATE('charttime', 'start of month')\nAND charttime < DATE('charttime', 'start of month', '+1 month')\nGROUP BY long_title\nORDER BY COUNT(long_title) DESC\nLIMIT 4;",
    "2a9d69b2f33ebef60868e9bd": "WITH RelevantProcedures AS (\n  SELECT p.hadm_id\n  FROM procedures_icd p\n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  WHERE d.long_title = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic'\n),\nDiagnosesWithin2Months AS (\n  SELECT d.*\n  FROM diagnoses_icd d\n  INNER JOIN RelevantProcedures rp ON d.hadm_id = rp.hadm_id\n  WHERE d.charttime BETWEEN (SELECT admittime FROM admissions WHERE hadm_id = rp.hadm_id)\n                         AND (SELECT admittime FROM admissions WHERE hadm_id = rp.hadm_id) + 60 * 60 * 24 * 2\n)\nSELECT d.icd_code, d.long_title, COUNT(*) as frequency\nFROM DiagnosesWithin2Months dwm\nINNER JOIN d_icd_diagnoses d ON dwm.icd_code = d.icd_code\nGROUP BY d.icd_code, d.long_title\nORDER BY frequency DESC\nLIMIT 3;",
    "cc3d7bf75c6a91650fa5a25b": "WITH LaparoscopicPartialCholecystectomy AS (\n    SELECT p.subject_id, p.hadm_id, p.charttime AS procedure_time\n    FROM procedures_icd p\n    INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n    WHERE d.icd_code = '00.06' AND d.long_title = 'Laparoscopic Partial Cholecystectomy'\n),\nDiagnosesWithin2Months AS (\n    SELECT d.subject_id, d.hadm_id, d.icd_code, d.charttime AS diagnosis_time\n    FROM diagnoses_icd d\n    INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n    WHERE a.subject_id IN (SELECT subject_id FROM LaparoscopicPartialCholecystectomy)\n      AND JULIANDAY(d.charttime) - JULIANDAY(a.admittime) BETWEEN 0 AND 60\n)\nSELECT icd_code, COUNT(*) AS diagnosis_count\nFROM DiagnosesWithin2Months\nGROUP BY icd_code\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "cd0f6d12276b6dd053848329": "SELECT icd.long_title AS diagnosis, COUNT(*) AS frequency\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nJOIN admissions a ON d.hadm_id = a.hadm_id\nJOIN patients p ON a.subject_id = p.subject_id\nJOIN procedures_icd p_i ON d.hadm_id = p_i.hadm_id\nJOIN d_icd_procedures d_p ON p_i.icd_code = d_p.icd_code\nWHERE p.dob > DATE('now', '-1 year')\n  AND d_p.long_title = 'Laparoscopic partial cholecystectomy'\n  AND d.charttime > a.admittime\n  AND d.charttime <= DATE(a.admittime, '+2 month')\nGROUP BY icd.long_title\nORDER BY frequency DESC\nLIMIT 5;",
    "f43d8c604807bcac934596ac": "WITH TreatmentFrequency AS (\n  SELECT \n    icd_code,\n    COUNT(*) AS treatment_count\n  FROM \n    procedures_icd\n  GROUP BY \n    icd_code\n),\nRankedTreatments AS (\n  SELECT \n    icd_code,\n    treatment_count,\n    ROW_NUMBER() OVER (ORDER BY treatment_count DESC) AS rank\n  FROM \n    TreatmentFrequency\n)\nSELECT \n  icd_code,\n  treatment_count\nFROM \n  RankedTreatments\nWHERE \n  rank <= 3;",
    "1f74b6c69a55bb5e16c32cba": "SELECT long_title, COUNT(*) AS procedure_count\nFROM d_icd_procedures\nJOIN procedures_icd ON d_icd_procedures.icd_code = procedures_icd.icd_code\nGROUP BY long_title\nORDER BY procedure_count DESC\nLIMIT 3;",
    "49d6f4a86b0609b109d0e3a1": "SELECT \n  T2.long_title,\n  COUNT(T1.icd_code) AS procedure_frequency\nFROM \n  procedures_icd AS T1\n  INNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nGROUP BY \n  T2.long_title\nORDER BY \n  procedure_frequency DESC\nLIMIT 5;",
    "591c758b0e137d7671f1af3e": "SELECT \n  p.long_title AS procedure_name, \n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd pr \n  JOIN d_icd_procedures p ON pr.icd_code = p.icd_code\nWHERE \n  pr.charttime >= '2100-01-01'\nGROUP BY \n  p.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 4;",
    "9a613ce39888ea07ffbd3a23": "Select the top three procedures based on frequency.",
    "715714e43d5b44633c2f88df": "WITH CurrentYearPrescriptions AS (\n    SELECT\n        drug\n    FROM\n        prescriptions\n    WHERE\n        strftime('%Y', starttime) = strftime('%Y', 'now')\n),\nDrugCounts AS (\n    SELECT\n        drug,\n        COUNT(*) AS drug_count\n    FROM\n        CurrentYearPrescriptions\n    GROUP BY\n        drug\n)\nSELECT\n    drug,\n    drug_count\nFROM\n    DrugCounts\nORDER BY\n    drug_count DESC\nLIMIT 4;",
    "2db144511074e195767dbef5": "WITH PatientsIn40s AS (\n    SELECT\n        subject_id\n    FROM\n        patients\n    WHERE\n        strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 40 AND 49\n        AND strftime('%Y', 'now') - strftime('%Y', dob) - (strftime('%m-%d', 'now') < strftime('%m-%d', dob)) < 41\n),\nProcedureCounts AS (\n    SELECT\n        icd_code,\n        COUNT(*) AS procedure_count\n    FROM\n        procedures_icd\n    JOIN\n        PatientsIn40s ON procedures_icd.subject_id = PatientsIn40s.subject_id\n    GROUP BY\n        icd_code\n)\nSELECT\n    long_title,\n    procedure_count\nFROM\n    ProcedureCounts\nJOIN\n    d_icd_procedures ON ProcedureCounts.icd_code = d_icd_procedures.icd_code\nORDER BY\n    procedure_count DESC\nLIMIT 5;",
    "852528505a7b6f035ae431de": "WITH TreatedPatients AS (\n    SELECT p.subject_id, a.age\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE a.admittime >= '2100-01-01' AND p.dod IS NULL\n    AND a.age >= 60\n),\nOrderedTreatments AS (\n    SELECT p.subject_id, i.itemid, d.label\n    FROM TreatedPatients p\n    INNER JOIN inputevents i ON p.subject_id = i.subject_id\n    INNER JOIN d_items d ON i.itemid = d.itemid\n),\nTreatmentCounts AS (\n    SELECT label, COUNT(*) as count\n    FROM OrderedTreatments\n    GROUP BY label\n)\nSELECT label\nFROM TreatmentCounts\nORDER BY count DESC\nLIMIT 3;",
    "61158e9ccd8015f7898cb6e8": "",
    "e6db613772003ec72d44ebe5": "SELECT \n  T1.icd_code,\n  COUNT(*) AS frequency\nFROM \n  diagnoses_icd T1\nINNER JOIN \n  admissions T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n  patients T3 ON T2.subject_id = T3.subject_id\nWHERE \n  T3.dob LIKE '2100%' AND \n  T2.admission_type = 'treatment' AND \n  T1.icd_code LIKE 'T%'\nGROUP BY \n  T1.icd_code\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "899575480ec0184f34a313b4": "SELECT \n  T2.label AS procedure_name,\n  COUNT(T1.subject_id) AS procedure_count\nFROM \n  procedures_icd AS T1\nINNER JOIN \n  d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nINNER JOIN \n  admissions AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE \n  T3.admittime BETWEEN '2100-01-01' AND '2100-12-31'\n  AND T3.age BETWEEN 30 AND 39\nGROUP BY \n  T2.label\nORDER BY \n  procedure_count DESC\nLIMIT 5;",
    "0f8875bf841f89f578f97551": "WITH RecentPatients AS (\n    SELECT subject_id, dob, gender\n    FROM patients\n    WHERE dob <= DATE('now', '-1 year') AND subject_id IN (\n        SELECT subject_id FROM patients WHERE dob <= DATE('now', '-1 year') GROUP BY gender HAVING COUNT(subject_id) >= 60\n    )\n),\nFilteredAdmissions AS (\n    SELECT a.subject_id, a.hadm_id\n    FROM admissions a\n    INNER JOIN RecentPatients rp ON a.subject_id = rp.subject_id\n    WHERE a.admittime > DATE('now', '-1 year')\n),\nProcedureCounts AS (\n    SELECT pi.icd_code, COUNT(*) AS procedure_count\n    FROM procedures_icd pi\n    INNER JOIN FilteredAdmissions fa ON pi.hadm_id = fa.hadm_id\n    GROUP BY pi.icd_code\n)\nSELECT d.long_title, pc.procedure_count\nFROM ProcedureCounts pc\nINNER JOIN d_icd_procedures d ON pc.icd_code = d.icd_code\nORDER BY pc.procedure_count DESC\nLIMIT 5;",
    "41610f36281d57ea3abb005b": "SELECT \n  d_items.label, \n  COUNT(inputevents.itemid) AS treatment_count\nFROM \n  inputevents\n  INNER JOIN d_items ON inputevents.itemid = d_items.itemid\n  INNER JOIN patients ON inputevents.subject_id = patients.subject_id\nWHERE \n  patients.dob >= '2100-01-01' AND patients.gender = 'F' \n  AND d_items.label NOT LIKE '%test%' \n  AND strftime('%Y', patients.dob) BETWEEN '1940' AND '1949'\nGROUP BY \n  d_items.label\nORDER BY \n  treatment_count DESC\nLIMIT 4;",
    "c8514097484be2c378e72761": "",
    "6ef0a4d357592b4eadc2b1b7": "WITH procedure_month AS (\n    SELECT \n        p.subject_id, \n        STRFTIME('%Y-%m', p.charttime) AS procedure_month\n    FROM procedures_icd pi\n    INNER JOIN d_icd_procedures d ON pi.icd_code = d.icd_code\n    INNER JOIN admissions p ON pi.hadm_id = p.hadm_id\n    WHERE d.long_title = 'Open Reduction of Fracture with Internal Fixation, Humerus'\n),\ntreatments AS (\n    SELECT \n        pr.subject_id, \n        pr.drug, \n        STRFTIME('%Y-%m', pr.starttime) AS treatment_month\n    FROM prescriptions pr\n    INNER JOIN admissions a ON pr.hadm_id = a.hadm_id\n    INNER JOIN procedure_month pm ON pr.subject_id = pm.subject_id\n    WHERE pm.procedure_month = treatment_month\n)\nSELECT \n    drug, \n    COUNT(*) AS treatment_count\nFROM treatments\nGROUP BY drug\nORDER BY treatment_count DESC\nLIMIT 4;",
    "7c6f2aa274207d68024f4cd4": "",
    "bbebbefb1d815b174837d57e": "SELECT \n    p.subject_id,\n    d.long_title AS procedure_name\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d1 ON a.hadm_id = d1.hadm_id\nJOIN d_icd_diagnoses d2 ON d1.icd_code = d2.icd_code\nJOIN diagnoses_icd d3 ON a.hadm_id = d3.hadm_id\nJOIN d_icd_diagnoses d4 ON d3.icd_code = d4.icd_code\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE \n    d2.long_title = ' Percutaneous Abdominal Drainage' AND \n    strftime('%Y-%m', a.admittime) = strftime('%Y-%m', pr.charttime)\nGROUP BY d.long_title\nORDER BY COUNT(*) DESC\nLIMIT 4;",
    "c5fa37f5342eb658b8fa6776": "SELECT \n    icd.icd_code, \n    COUNT(*) AS procedure_count\nFROM \n    diagnoses_icd icd\nJOIN \n    admissions adm ON icd.subject_id = adm.subject_id AND icd.hadm_id = adm.hadm_id\nJOIN \n    procedures_icd prc ON adm.subject_id = prc.subject_id AND adm.hadm_id = prc.hadm_id\nWHERE \n    icd.icd_code = 'K34.50' \n    AND icd.charttime BETWEEN '2023-01-01' AND '2023-12-31'\n    AND prc.charttime BETWEEN '2023-01-01' AND '2023-12-31'\n    AND prc.charttime >= DATE(icd.charttime, '+1 month')\n    AND prc.charttime < DATE(icd.charttime, '+2 month')\nGROUP BY \n    prc.icd_code\nORDER BY \n    procedure_count DESC\nLIMIT 3;",
    "a3a4751b104710cf0148a297": "",
    "a6ad56047cfb5ab47409c6a5": "SELECT \n    T1.drug \nFROM \n    prescriptions AS T1\n    INNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T2.icd_code = '2100' AND T1.drug != 'Not Otherwise Specified'\nGROUP BY \n    T1.drug\nORDER BY \n    COUNT(T1.drug) DESC\nLIMIT 5;",
    "46a6f6b786c670f60f62c369": "WITH diagnoses AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id,\n        d.charttime,\n        icd.long_title\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\n    WHERE icd.long_title = 'Long-term (current) use of opiate analgesic'\n),\nprescriptions_cte AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.drug,\n        p.dose_val_rx,\n        p.dose_unit_rx,\n        p.route,\n        p.starttime,\n        p.stoptime\n    FROM prescriptions p\n    WHERE p.starttime >= '2100-01-01'\n)\nSELECT \n    p.drug,\n    p.dose_val_rx,\n    p.dose_unit_rx,\n    p.route,\n    COUNT(*) AS num_prescriptions\nFROM diagnoses d\nINNER JOIN prescriptions_cte p ON d.subject_id = p.subject_id AND d.hadm_id = p.hadm_id\nGROUP BY p.drug, p.dose_val_rx, p.dose_unit_rx, p.route\nORDER BY num_prescriptions DESC\nLIMIT 4;",
    "53ae274dd031672e790039de": "WITH CandidalStomatitisDiagnoses AS (\n    SELECT \n        d.subject_id,\n        d.charttime AS diagnosis_time\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE \n        dd.long_title = 'Candidal Stomatitis'\n        AND d.charttime >= DATE('now', '-1 year')\n),\nRecentProcedures AS (\n    SELECT \n        p.subject_id,\n        p.charttime AS procedure_time,\n        p.icd_code\n    FROM \n        procedures_icd p\n    INNER JOIN \n        CandidalStomatitisDiagnoses c ON p.subject_id = c.subject_id\n    WHERE \n        p.charttime BETWEEN c.diagnosis_time AND DATE(c.diagnosis_time, '+2 months')\n),\nProcedureCounts AS (\n    SELECT \n        rp.icd_code,\n        COUNT(*) AS procedure_count\n    FROM \n        RecentProcedures rp\n    GROUP BY \n        rp.icd_code\n)\nSELECT \n    d.long_title,\n    pc.procedure_count\nFROM \n    ProcedureCounts pc\nINNER JOIN \n    d_icd_procedures d ON pc.icd_code = d.icd_code\nORDER BY \n    pc.procedure_count DESC\nLIMIT 5;",
    "23a42f7835688c75021035ac": "WITH DiagnosedPatients AS (\n    SELECT \n        p.subject_id,\n        a.hadm_id\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE ddi.long_title LIKE '%diaphragmatic hernia%' \n      AND ddi.long_title NOT LIKE '%obstruction%' \n      AND ddi.long_title NOT LIKE '%gangrene%'\n),\nProcedureCounts AS (\n    SELECT \n        dp.subject_id,\n        dp.hadm_id,\n        pr.icd_code,\n        COUNT(*) AS procedure_count\n    FROM DiagnosedPatients dp\n    INNER JOIN procedures_icd pr ON dp.hadm_id = pr.hadm_id\n    GROUP BY dp.subject_id, dp.hadm_id, pr.icd_code\n)\nSELECT \n    icd_code,\n    procedure_count\nFROM ProcedureCounts\nORDER BY procedure_count DESC\nLIMIT 4;",
    "1acf7fc31384e1c31147c768": "SELECT \n    d.long_title AS procedure_title,\n    COUNT(*) AS procedure_count\nFROM \n    admissions a\nINNER JOIN \n    diagnoses_icd d1 ON a.hadm_id = d1.hadm_id\nINNER JOIN \n    d_icd_diagnoses d2 ON d1.icd_code = d2.icd_code\nINNER JOIN \n    procedures_icd p ON a.hadm_id = p.hadm_id\nINNER JOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n    d2.long_title = 'Chronic atrial fibrillation'\n    AND a.admittime > '2100-01-01 00:00:00'\nGROUP BY \n    d.long_title\nORDER BY \n    procedure_count DESC\nLIMIT 3;",
    "71e45f1414e9c508d0f88b96": "SELECT \n  p.drug, \n  COUNT(p.drug) AS treatment_count\nFROM \n  prescriptions p\nJOIN \n  diagnoses_icd d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nJOIN \n  d_icd_diagnoses d_d ON d.icd_code = d_d.icd_code\nWHERE \n  d_d.long_title = 'Other and unspecified Escherichia coli [E. coli] in the same month'\nGROUP BY \n  p.drug\nORDER BY \n  treatment_count DESC\nLIMIT 4;",
    "1f8afcb7747a797d8e8f612a": "SELECT T2.long_title AS procedure_name,\n       COUNT(T2.long_title) AS procedure_count\nFROM diagnoses_icd T1\nINNER JOIN d_icd_procedures T2 ON T1.icd_code = T2.icd_code\nINNER JOIN procedures_icd T3 ON T1.subject_id = T3.subject_id AND T1.hadm_id = T3.hadm_id\nWHERE T1.icd_code = 'P23.1'\nAND strftime('%Y-%m', T1.charttime) = strftime('%Y-%m', T3.charttime)\nGROUP BY T2.long_title\nORDER BY procedure_count DESC\nLIMIT 3;",
    "a35a9346ab483d0db0f202ca": "WITH ESRD_Patients AS (\n    SELECT DISTINCT d.subject_id\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE di.long_title = 'end stage renal disease'\n),\nESRD_Patient_Procedures AS (\n    SELECT p.subject_id, p.icd_code\n    FROM procedures_icd p\n    INNER JOIN ESRD_Patients e ON p.subject_id = e.subject_id\n),\nProcedure_Counts AS (\n    SELECT icd_code, COUNT(*) AS procedure_count\n    FROM ESRRD_Patient_Procedures\n    GROUP BY icd_code\n),\nRanked_Procedures AS (\n    SELECT icd_code, procedure_count,\n           ROW_NUMBER() OVER (ORDER BY procedure_count DESC) AS rn\n    FROM Procedure_Counts\n)\nSELECT icd_code, procedure_count\nFROM Ranked_Procedures\nWHERE rn <= 5;",
    "2efdde96ce7011cebcfc05db": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 4;",
    "a9b38a0fdefc73e3b49a6266": "SELECT drug, COUNT(*) AS num_orders\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY num_orders DESC\nLIMIT 4;",
    "4960b6194d17e9d1c2ac34f2": "SELECT drug\nFROM prescriptions\nWHERE starttime >= '2100-01-01'\nGROUP BY drug\nORDER BY COUNT(*) DESC\nLIMIT 3;",
    "0f46ce74f036db898fe9d288": "",
    "5e50d8202a81e15b06471b88": "SELECT drug, COUNT(*) AS drug_count\nFROM prescriptions\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY drug\nORDER BY drug_count DESC\nLIMIT 4;",
    "06b9ac11749e295ddd6d0c34": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 3;",
    "e9a9b12dc29949b932dfcb92": "SELECT \n  drug, \n  COUNT(*) AS order_count\nFROM \n  prescriptions \nWHERE \n  starttime >= '2100-01-01'\nGROUP BY \n  drug\nORDER BY \n  order_count DESC\nLIMIT 3;",
    "421833b510b5ec197a16d68f": "WITH HydrocodonePrescriptions AS (\n  SELECT subject_id\n  FROM prescriptions\n  WHERE drug = 'Hydrocodone-acetaminophen (5mg-325mg)'\n    AND starttime > DATE('now', '-1 year')\n),\nRecentPrescriptions AS (\n  SELECT p.subject_id, p.drug\n  FROM prescriptions p\n  INNER JOIN HydrocodonePrescriptions h ON p.subject_id = h.subject_id\n  WHERE p.starttime > DATE('now', '-2 months')\n)\nSELECT drug, COUNT(*) AS prescription_count\nFROM RecentPrescriptions\nGROUP BY drug\nORDER BY prescription_count DESC\nLIMIT 5;",
    "44162aee19eabadbab9a0172": "SELECT \n    p.drug,\n    COUNT(*) AS count\nFROM \n    prescriptions p\nINNER JOIN \n    prescriptions p2 \n    ON p.subject_id = p2.subject_id \n    AND p.hadm_id = p2.hadm_id\nWHERE \n    p.drug = 'acd-a' AND \n    p2.drug != 'acd-a' AND \n    p.charttime < p2.charttime AND \n    julianday(p2.charttime) - julianday(p.charttime) BETWEEN 0 AND 60\nGROUP BY \n    p.drug\nORDER BY \n    count DESC\nLIMIT 4;",
    "5f2f54291860e0ab6a44e725": "WITH PlasmalytePatients AS (\n    SELECT DISTINCT subject_id\n    FROM prescriptions\n    WHERE drug = 'Plasmalyte' AND starttime >= '2100-01-01'\n),\nPrescriptionsInSameMonth AS (\n    SELECT p.subject_id, p.drug, p.starttime\n    FROM prescriptions p\n    JOIN PlasmalytePatients pp ON p.subject_id = pp.subject_id\n    WHERE p.starttime >= (SELECT DATE(starttime, 'start of month') FROM prescriptions WHERE subject_id = pp.subject_id AND drug = 'Plasmalyte')\n      AND p.starttime < (SELECT DATE(starttime, '+1 month') FROM prescriptions WHERE subject_id = pp.subject_id AND drug = 'Plasmalyte')\n),\nDrugCounts AS (\n    SELECT drug, COUNT(*) AS count\n    FROM PrescriptionsInSameMonth\n    GROUP BY drug\n)\nSELECT drug, count\nFROM DrugCounts\nORDER BY count DESC\nLIMIT 5;",
    "48e40b5c41147007595a5175": "WITH DrugPrescriptionsCTE AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.drug,\n        p.starttime AS starttime,\n        ROW_NUMBER() OVER (PARTION BY p.subject_id, p.hadm_id ORDER BY p.starttime) AS drug_rank\n    FROM prescriptions p\n    WHERE p.drug = 'donepezil'\n    AND p.starttime >= '2100-01-01'\n),\nFollowingDrugsCTE AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.drug,\n        p.starttime AS starttime\n    FROM prescriptions p\n    INNER JOIN DrugPrescriptionsCTE d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\n    WHERE p.starttime > d.starttime\n    AND p.starttime <= DATE(d.starttime, '+2 months')\n)\nSELECT \n    drug,\n    COUNT(*) AS drug_count\nFROM FollowingDrugsCTE\nGROUP BY drug\nORDER BY drug_count DESC\nLIMIT 3;",
    "7ec4445b22dfabb102812643": "SELECT T1.drug\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.drug = 'MICONAZOLE POWDER 2%' AND T2.icd_code = 'C57.2'\nAND T1.hadm_id IN (\n    SELECT hadm_id\n    FROM prescriptions\n    WHERE drug LIKE '%2%'\n    AND starttime >= '2100-01-01 00:00:00'\n)\nGROUP BY T1.drug\nORDER BY COUNT(T1.drug) DESC\nLIMIT 3;",
    "b85c5a437b3cb22920ce10fb": "SELECT drug, COUNT(*) AS count\nFROM prescriptions p1\nJOIN prescriptions p2 ON p1.hadm_id = p2.hadm_id AND p1.subject_id = p2.subject_id AND p1.row_id != p2.row_id\nWHERE p1.drug = 'Bupropion (sustained release)'\n  AND p2.drug != 'Bupropion (sustained release)'\n  AND p2.starttime >= DATE('now', '-1 year')\nGROUP BY p2.drug\nORDER BY count DESC\nLIMIT 5;",
    "757270424b26647955e34c40": "WITH vecuronium_prescriptions AS (\n  SELECT subject_id\n  FROM prescriptions\n  WHERE drug = 'vecuronium bromide' AND strftime('%Y-%m', starttime) = strftime('%Y-%m', 'now')\n),\nsubsequent_month_drugs AS (\n  SELECT T1.subject_id, T1.drug\n  FROM prescriptions T1\n  INNER JOIN vecuronium_prescriptions T2 ON T1.subject_id = T2.subject_id\n  WHERE strftime('%Y-%m', T1.starttime) = strftime('%Y-%m', 'now', '+1 month')\n)\nSELECT drug, COUNT(*) AS num_prescriptions\nFROM subsequent_month_drugs\nGROUP BY drug\nORDER BY num_prescriptions DESC\nLIMIT 4;",
    "4a03eabf717f99697bb5ba08": "SELECT p.drug, COUNT(*) AS count\nFROM prescriptions p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title = 'Endoscopic removal of stone(s) from biliary tract previously'\nAND p.starttime >= '2100-01-01'\nAND p.starttime <= '2100-02-28'\nGROUP BY p.drug\nORDER BY count DESC\nLIMIT 4;",
    "c8175712036320a9b391cf5f": "SELECT T2.drug\nFROM admissions AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.admittime > DATE('now', '-1 year')\nAND T2.starttime > T1.admittime\nAND T2.starttime <= DATE(T1.admittime, '+1 month')\nAND T2.drug LIKE '%hemodialysis%'\nGROUP BY T2.drug\nORDER BY COUNT(T2.drug) DESC\nLIMIT 5;",
    "7a3e856c5351161f228b56ea": "WITH RelevantAdmissions AS (\n    SELECT \n        subject_id,\n        hadm_id\n    FROM admissions\n    WHERE admittime >= '2100-01-01' \n      AND dischtime <= '2100-03-01'  -- Adjusted to ensure <= 2 months\n      AND admission_type = 'Emergency'\n      AND admission_location = 'ER'\n),\nRelevantPatients AS (\n    SELECT \n        p.subject_id\n    FROM patients p\n    JOIN RelevantAdmissions ra ON p.subject_id = ra.subject_id\n    JOIN diagnoses_icd d ON ra.hadm_id = d.hadm_id\n    JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE d2.long_title LIKE '%Extracorporeal Circulation Auxiliary to Open Heart Surgery%'\n),\nMedicationOrders AS (\n    SELECT \n        p.subject_id,\n        pr.drug,\n        pr.dose_val_rx,\n        pr.dose_unit_rx,\n        pr.route\n    FROM RelevantPatients p\n    JOIN prescriptions pr ON p.subject_id = pr.subject_id\n    WHERE pr.starttime >= '2100-01-01'\n      AND pr.stoptime <= '2100-03-01'\n),\nTopMedications AS (\n    SELECT \n        drug,\n        COUNT(*) AS order_count\n    FROM MedicationOrders\n    GROUP BY drug\n    ORDER BY order_count DESC\n    LIMIT 5\n)\nSELECT \n    drug\nFROM TopMedications;",
    "242455bec537f7c263ad40b0": "Select the top four most frequently prescribed drugs.**",
    "842e8f2f6e1757279aaf5fc9": "selection of the correct medications that followed the procedure. Let's correct and simplify the query.",
    "30f8a5d33eb7287c9cf8412a": "WITH DrainagePatients AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n    JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n    WHERE d.long_title = 'Drainage of pancreatic cyst by catheter'\n)",
    "4cfe2481c4220d5f42e7a66c": "SELECT \n  T2.drug\nFROM \n  procedures_icd AS T1\n  INNER JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n  T1.icd_code = 'R60.50'  \n  AND T2.starttime BETWEEN T1.charttime AND DATE(T1.charttime, '+2 months')  \nGROUP BY \n  T2.drug\nORDER BY \n  COUNT(T2.drug) DESC\nLIMIT 5;",
    "dbbf8af9c5e0fe77e81a2ecc": "WITH DiagnosedPatients AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id\n    FROM diagnoses_icd p\n    WHERE p.icd_code = 'K210' AND \n          strftime('%Y', p.charttime) = '2100'\n),\nMedicationOrders AS (\n    SELECT \n        pr.drug\n    FROM DiagnosedPatients dp\n    INNER JOIN prescriptions pr ON dp.subject_id = pr.subject_id AND dp.hadm_id = pr.hadm_id\n),\nMedicationFrequency AS (\n    SELECT \n        mo.drug, \n        COUNT(mo.drug) AS frequency\n    FROM MedicationOrders mo\n    GROUP BY mo.drug\n)\nSELECT \n    mf.drug, \n    mf.frequency\nFROM MedicationFrequency mf\nORDER BY mf.frequency DESC\nLIMIT 5;",
    "2f7d49a71a664a3c5367e8a7": "WITH \n  -- Step 1: Identify patients diagnosed with psoriasis in 2100\n  psoriasis_patients AS (\n    SELECT \n      T2.subject_id\n    FROM \n      diagnoses_icd T1\n      INNER JOIN patients T2 ON T1.subject_id = T2.subject_id\n    WHERE \n      T1.icd_code = 'P85.5' AND \n      STRFTIME('%Y', T1.charttime) = '2100'\n  ),\n  \n  -- Step 2: Identify prescriptions made to these patients in the same month after diagnosis\n  psoriasis_prescriptions AS (\n    SELECT \n      T1.drug, \n      COUNT(*) AS frequency\n    FROM \n      prescriptions T1\n      INNER JOIN psoriasis_patients T2 ON T1.subject_id = T2.subject_id\n    WHERE \n      T1.starttime >= (SELECT MIN(charttime) FROM diagnoses_icd WHERE icd_code = 'P85.5' AND STRFTIME('%Y', charttime) = '2100') AND\n      T1.starttime < (SELECT MIN(charttime) FROM diagnoses_icd WHERE icd_code = 'P85.5' AND STRFTIME('%Y', charttime) = '2101')\n    GROUP BY \n      T1.drug\n  )\n  \n-- Step 3: Retrieve the top four most frequent drugs\nSELECT \n  drug, \n  frequency\nFROM \n  psoriasis_prescriptions\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "9177cde69132a37cbac544ee": "WITH PatientDiagnoses AS (\n    SELECT \n        p.subject_id,\n        a.hadm_id\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE d2.long_title = 'Defibrination syndrome'\n    AND a.dischtime >= DATE('now', '-1 year')\n),\nPrescriptionsForDiagnosedPatients AS (\n    SELECT \n        pd.subject_id,\n        pd.hadm_id,\n        pr.drug,\n        pr.dose_val_rx,\n        pr.dose_unit_rx,\n        pr.route,\n        pr.starttime,\n        pr.stoptime\n    FROM PatientDiagnoses pd\n    JOIN prescriptions pr ON pd.subject_id = pr.subject_id AND pd.hadm_id = pr.hadm_id\n    WHERE pr.starttime >= DATE('now', '-2 months')\n),\nFrequentDrugs AS (\n    SELECT \n        pfp.drug,\n        COUNT(*) AS prescription_count\n    FROM PrescriptionsForDiagnosedPatients pfp\n    GROUP BY pfp.drug\n    ORDER BY prescription_count DESC\n    LIMIT 3\n)\nSELECT \n    drug,\n    prescription_count\nFROM FrequentDrugs;",
    "144cd6f1acfad4416003c26c": "WITH DiagnosedPatients AS (\n    SELECT DISTINCT p.subject_id, a.hadm_id\n    FROM patients p\n    JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    JOIN admissions a ON p.subject_id = a.subject_id AND d.hadm_id = a.hadm_id\n    WHERE dd.icd_code = 'Q73.0'  -- Mobitz (type) II atrioventricular block\n),\nPrescribedDrugs AS (\n    SELECT dp.subject_id, dp.hadm_id, pr.drug\n    FROM DiagnosedPatients dp\n    JOIN prescriptions pr ON dp.subject_id = pr.subject_id AND dp.hadm_id = pr.hadm_id\n),\nFrequentDrugs AS (\n    SELECT drug, COUNT(*) AS count\n    FROM PrescribedDrugs\n    GROUP BY drug\n    ORDER BY count DESC\n    LIMIT 4\n)\nSELECT drug\nFROM FrequentDrugs;",
    "aef8b935473950853a7d8448": "WITH HypoDiagnosisCTE AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        charttime\n    FROM \n        diagnoses_icd\n    WHERE \n        icd_code = 'E88'  -- Hypo-osmolality and hyponatremia\n),\nFilteredAdmissionsCTE AS (\n    SELECT \n        hadm_id,\n        subject_id,\n        admittime\n    FROM \n        admissions\n    WHERE \n        hadm_id IN (SELECT hadm_id FROM HypoDiagnosisCTE)\n        AND admittime >= DATE('now', '-1 year')\n),\nPrescriptionsCTE AS (\n    SELECT \n        T1.drug,\n        T1.dose_val_rx,\n        T1.dose_unit_rx\n    FROM \n        prescriptions T1\n    INNER JOIN \n        FilteredAdmissionsCTE T2 ON T1.hadm_id = T2.hadm_id\n    WHERE \n        T1.starttime >= (SELECT charttime FROM HypoDiagnosisCTE WHERE hadm_id = T2.hadm_id)\n        AND T1.starttime < DATE((SELECT charttime FROM HypoDiagnosisCTE WHERE hadm_id = T2.hadm_id), '+2 months')\n)\nSELECT \n    drug,\n    dose_val_rx,\n    dose_unit_rx,\n    COUNT(*) AS frequency\nFROM \n    PrescriptionsCTE\nGROUP BY \n    drug, dose_val_rx, dose_unit_rx\nORDER BY \n    frequency DESC\nLIMIT 3;",
    "2b134de41e611c4124b04f3b": "SELECT \n    p.drug,\n    COUNT(*) AS prescription_count\nFROM \n    diagnoses_icd d\nINNER JOIN \n    admissions a ON d.hadm_id = a.hadm_id\nINNER JOIN \n    prescriptions p ON p.hadm_id = a.hadm_id\nINNER JOIN \n    d_icd_diagnoses di ON d.icd_code = di.icd_code\nWHERE \n    di.long_title = 'Cardiogenic Shock' AND\n    p.starttime >= '2100-01-01' AND\n    strftime('%Y-%m', p.starttime) = strftime('%Y-%m', a.admittime)\nGROUP BY \n    p.drug\nORDER BY \n    prescription_count DESC\nLIMIT 3;",
    "48f94d76de26cca5b25ee77f": "SELECT drug\nFROM prescriptions\nWHERE hadm_id IN (\n    SELECT hadm_id\n    FROM diagnoses_icd\n    WHERE icd_code = 'O07.1'\n) \nAND starttime >= date('now', 'start of year')\nAND starttime < date('now', 'start of year', '+1 year')\nGROUP BY drug\nORDER BY COUNT(*) DESC\nLIMIT 3;",
    "f9dc2fa964b252fd6c5baac9": "SELECT \n  p.subject_id,\n  pr.drug,\n  COUNT(*) AS total_prescriptions\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n  INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n  INNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n  d.long_title = 'Esophageal Reflux'\n  AND p.age >= 60\n  AND pr.starttime > '2100-01-01 00:00:00'\nGROUP BY \n  p.subject_id, pr.drug\nHAVING \n  COUNT(*) > 1\nORDER BY \n  total_prescriptions DESC\nLIMIT 3;",
    "e55b54e06750117ab5f1a053": "SELECT T1.drug\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nINNER JOIN patients AS T4 ON T1.subject_id = T4.subject_id\nWHERE T3.long_title LIKE '%nonspecific elevation of levels of transaminase or lactic acid dehydrogenase%'\nAND strftime('%Y', T4.dob) BETWEEN '1950' AND '1959'\nAND T1.starttime LIKE strftime('%Y-%m', T2.charttime) || '-%'\nGROUP BY T1.drug\nORDER BY COUNT(T1.drug) DESC\nLIMIT 5;",
    "1eb7d8845e0439e31945047c": "WITH DiagnosedPatients AS (\n    SELECT \n        p.subject_id\n    FROM \n        patients p\n    JOIN \n        admissions a ON p.subject_id = a.subject_id\n    JOIN \n        diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN \n        d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE \n        d2.long_title LIKE '%acute pulmonary edema%'\n        AND p.dob <= DATE('now', '-1 year')\n        AND a.admittime >= DATE('now', '-1 year')\n),\nPrescribedDrugs AS (\n    SELECT \n        pr.subject_id,\n        pr.drug,\n        pr.starttime,\n        pr.stoptime\n    FROM \n        DiagnosedPatients dp\n    JOIN \n        prescriptions pr ON dp.subject_id = pr.subject_id\n    WHERE \n        pr.starttime >= DATE('now', '-1 year')\n        AND pr.stoptime <= DATE('now')\n        AND pr.starttime BETWEEN DATE('now', '-2 months') AND DATE('now')\n)\nSELECT \n    drug\nFROM \n    PrescribedDrugs\nGROUP BY \n    drug\nORDER BY \n    COUNT(*) DESC\nLIMIT 5;",
    "80d21b657d5ff088f889a360": "WITH diagnosed_patients AS (\n    SELECT p.subject_id, a.hadm_id\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN d_icd_diagnoses d_icd ON d.icd_code = d_icd.icd_code\n    WHERE p.gender = 'M' -- Assuming patients are male for age range 50s\n      AND (strftime('%Y', a.dischtime) - strftime('%Y', p.dob)) BETWEEN 50 AND 59\n      AND d_icd.long_title LIKE '%Pulmonary collapse%'\n),\ndrug_counts AS (\n    SELECT pr.drug, COUNT(*) as frequency\n    FROM diagnosed_patients dp\n    JOIN prescriptions pr ON dp.hadm_id = pr.hadm_id\n    GROUP BY pr.drug\n)\nSELECT drug, frequency\nFROM drug_counts\nORDER BY frequency DESC\nLIMIT 3;",
    "41cdc4c25b362c10ff183c0c": "WITH UnspecifiedAtrialFibrillation AS (\n  SELECT \n    p.subject_id,\n    a.hadm_id,\n    a.admittime\n  FROM \n    patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  WHERE \n    p.age >= 60\n    AND d.icd_code = 'I47'\n    AND a.admittime >= '2100-01-01'\n),\nRecentPrescriptions AS (\n  SELECT \n    pr.subject_id,\n    pr.hadm_id,\n    pr.drug,\n    pr.starttime,\n    pr.stoptime\n  FROM \n    prescriptions pr\n    INNER JOIN UnspecifiedAtrialFibrillation uaf ON pr.subject_id = uaf.subject_id AND pr.hadm_id = uaf.hadm_id\n  WHERE \n    pr.starttime >= uaf.admittime\n    AND pr.stoptime <= DATE(uaf.admittime, '+2 months')\n)\nSELECT \n  rp.drug,\n  COUNT(rp.drug) AS num_prescriptions\nFROM \n  RecentPrescriptions rp\nGROUP BY \n  rp.drug\nORDER BY \n  num_prescriptions DESC\nLIMIT 5;",
    "2666b04409be1528ae23a0f2": "WITH RelevantAdmissions AS (\n    SELECT\n        a.subject_id,\n        a.hadm_id,\n        a.admittime,\n        a.dischtime,\n        d.long_title AS diagnosis\n    FROM admissions a\n    JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n    JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE d.long_title LIKE '%esophageal reflux%' AND a.admittime > '2100-01-01'\n),\nFilteredPatients AS (\n    SELECT\n        r.subject_id,\n        r.hadm_id,\n        p.age\n    FROM RelevantAdmissions r\n    JOIN patients p ON r.subject_id = p.subject_id\n    WHERE p.age >= 60\n),\nPrescribedDrugs AS (\n    SELECT\n        fp.subject_id,\n        fp.hadm_id,\n        pr.drug\n    FROM FilteredPatients fp\n    JOIN prescriptions pr ON fp.hadm_id = pr.hadm_id\n    WHERE pr.starttime BETWEEN fp.hadm_id - 60 AND fp.hadm_id + 60\n)\nSELECT\n    drug,\n    COUNT(*) AS prescription_count\nFROM PrescribedDrugs\nGROUP BY drug\nORDER BY prescription_count DESC\nLIMIT 4;",
    "b37d67ade52f97c81e373d0a": "SELECT \n    pr.drug,\n    COUNT(pr.drug) AS frequency\nFROM prescriptions pr\nJOIN diagnoses_icd d ON pr.subject_id = d.subject_id AND pr.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d_diagnoses ON d.icd_code = d_diagnoses.icd_code\nWHERE d_diagnoses.long_title LIKE '%long-term use of anticoagulants%'\n    AND pr.starttime >= '2100-01-01'\n    AND pr.starttime <= DATE('2100-01-01', '+2 months')\n    AND strftime('%Y', pr.starttime) - strftime('%Y', p.dob) = 40\nGROUP BY pr.drug\nORDER BY frequency DESC\nLIMIT 5;",
    "d13e321a100730513005c82e": "SELECT label, COUNT(*) as count\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE strftime('%Y', labevents.charttime) >= '2100'\nGROUP BY label\nORDER BY count DESC\nLIMIT 4;",
    "af7e3057fad8f361ba5398f2": "SELECT d_labitems.label, COUNT(labevents.itemid) AS total_tests\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nGROUP BY d_labitems.label\nORDER BY total_tests DESC\nLIMIT 3;",
    "f84cee29b1ae0e5b38a4dad0": "SELECT label, COUNT(*) AS frequency\nFROM d_labitems\nGROUP BY label\nORDER BY frequency DESC\nLIMIT 5;",
    "1d528e1e56f65f65ff457076": "SELECT l.label, COUNT(le.itemid) AS test_count\nFROM labevents le\nINNER JOIN d_labitems l ON le.itemid = l.itemid\nWHERE strftime('%Y', le.charttime) = '2100'\nGROUP BY l.label\nORDER BY test_count DESC\nLIMIT 3;",
    "5fb01bc80ec79080b29a6120": "SELECT l.label, COUNT(*) AS count\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nWHERE strftime('%Y', le.charttime) = strftime('%Y', 'now')\nGROUP BY l.label\nORDER BY count DESC\nLIMIT 5;",
    "ce78082eae0149ee1ca4091e": "SELECT \n    labevents.itemid AS item_id,\n    d_labitems.label AS test_label,\n    COUNT(labevents.itemid) AS test_frequency\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.charttime > datetime('now', '-1 year')\nGROUP BY \n    labevents.itemid, d_labitems.label\nORDER BY \n    test_frequency DESC\nLIMIT 4;",
    "7bd6751dde3ebad15506d38c": "SELECT T2.label AS test_name, COUNT(T1.row_id) AS test_count\nFROM labevents T1\nINNER JOIN d_labitems T2 ON T1.itemid = T2.itemid\nGROUP BY T2.label\nORDER BY test_count DESC\nLIMIT 3;",
    "bf24656774e10abbee09d3cd": "select the top three lab tests.",
    "cef34f939a935672ef767a10": "SELECT \n    d_labitems.label AS lab_test,\n    COUNT(labevents.row_id) AS order_count\nFROM \n    labevents\nINNER JOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nINNER JOIN \n    admissions ON labevents.hadm_id = admissions.hadm_id\nINNER JOIN \n    patients ON admissions.subject_id = patients.subject_id\nWHERE \n    strftime('%Y', labevents.charttime) = '2100'\n    AND patients.age BETWEEN 30 AND 39\nGROUP BY \n    labevents.itemid\nORDER BY \n    order_count DESC\nLIMIT 3;",
    "d1d88ee5c7476300c168be49": "SELECT \n  dlab.label, \n  COUNT(*) AS test_count\nFROM \n  labevents lab\nJOIN \n  admissions adm ON lab.hadm_id = adm.hadm_id\nJOIN \n  d_labitems dlab ON lab.itemid = dlab.itemid\nWHERE \n  adm.age >= 60\nGROUP BY \n  dlab.label\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "a3ae25ab7f7d7f11e9ba773d": "SELECT \n  dlab.label AS lab_test, \n  COUNT(*) AS test_count\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN labevents l ON a.hadm_id = l.hadm_id\n  INNER JOIN d_labitems dlab ON l.itemid = dlab.itemid\nWHERE \n  strftime('%Y', '2100-01-01') - strftime('%Y', p.dob) = 40\nGROUP BY \n  dlab.label\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "d53c40ad49a43a529f6a58f1": "WITH RelevantLabEvents AS (\n    SELECT\n        le.subject_id,\n        le.charttime,\n        d.itemid,\n        d.label\n    FROM labevents le\n    JOIN d_labitems d ON le.itemid = d.itemid\n    WHERE le.charttime >= date('now', '-1 year')\n),\nFilteredPatients AS (\n    SELECT\n        p.subject_id\n    FROM patients p\n    WHERE p.gender = 'Male'\n    AND p.gender = 'Female'\n    AND p.age >= 30\n    AND p.age <= 39\n),\nRelevantLabEventsForAgeGroup AS (\n    SELECT\n        rle.subject_id,\n        rle.charttime,\n        rle.itemid,\n        rle.label\n    FROM RelevantLabEvents rle\n    JOIN FilteredPatients fp ON rle.subject_id = fp.subject_id\n),\nTopLabTests AS (\n    SELECT\n        rle.label,\n        COUNT(rle.subject_id) AS test_count\n    FROM RelevantLabEventsForAgeGroup rle\n    GROUP BY rle.label\n    ORDER BY test_count DESC\n    LIMIT 3\n)\nSELECT\n    tlt.label AS test_name,\n    tlt.test_count AS test_count\nFROM TopLabTests tlt;",
    "7057698bd91fd3229c372ff8": "SELECT lab.label AS test_name, COUNT(*) AS frequency\nFROM labevents le\nJOIN d_labitems lab ON le.itemid = lab.itemid\nJOIN patients p ON le.subject_id = p.subject_id\nWHERE le.charttime >= DATE('now', '-1 year')\nAND strftime('%Y', p.dob) BETWEEN strftime('%Y', DATE('now', '-1 year')) - 20 AND strftime('%Y', DATE('now', '-1 year')) - 10\nGROUP BY lab.label\nORDER BY frequency DESC\nLIMIT 3;",
    "66d3d7f7819e195408389a4b": "SELECT \n  l.itemid,\n  d.label,\n  COUNT(*) AS test_count\nFROM \n  labevents l\nJOIN \n  d_labitems d ON l.itemid = d.itemid\nJOIN \n  patients p ON l.subject_id = p.subject_id\nWHERE \n  strftime('%Y', p.dob) - strftime('%Y', p.dod) = 20\nGROUP BY \n  l.itemid, d.label\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "dd62c1497314b1bea83b2d03": "WITH MalignantNeoplasm AS (\n    SELECT \n        d.subject_id, \n        d.hadm_id\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE \n        di.long_title = 'Personal history of malignant neoplasm of other gastrointestinal tract'\n),\nLabTests AS (\n    SELECT \n        l.subject_id, \n        l.hadm_id, \n        l.itemid, \n        l.charttime\n    FROM \n        labevents l\n    INNER JOIN \n        MalignantNeoplasm mn ON l.subject_id = mn.subject_id AND l.hadm_id = mn.hadm_id\n)\nSELECT \n    l.itemid, \n    COUNT(*) AS test_count\nFROM \n    LabTests l\nGROUP BY \n    l.itemid\nORDER BY \n    test_count DESC\nLIMIT 3;",
    "1fe684c6e5b20d9ad964f6ac": "WITH InsomniaPatients AS (\n    SELECT p.subject_id\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    WHERE d.icd_code = 'G44.01'\n),\nLabTestsInSameMonth AS (\n    SELECT l.subject_id, l.itemid, l.charttime\n    FROM labevents l\n    INNER JOIN InsomniaPatients ip ON l.subject_id = ip.subject_id\n    WHERE l.charttime >= ip.charttime AND l.charttime <= DATE(ip.charttime, '+1 month')\n)\nSELECT l.label, COUNT(lt.subject_id) AS frequency\nFROM LabTestsInSameMonth lt\nINNER JOIN d_labitems l ON lt.itemid = l.itemid\nGROUP BY l.label\nORDER BY frequency DESC\nLIMIT 5;",
    "0bdfa86a31bd61b14767f632": "SELECT \n  d.label AS lab_test_label,\n  COUNT(*) AS lab_test_count\nFROM \n  d_labitems d\n  INNER JOIN labevents l ON d.itemid = l.itemid\n  INNER JOIN diagnoses_icd di ON l.hadm_id = di.hadm_id\n  INNER JOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE \n  l.charttime >= '2100-01-01' AND l.charttime < '2100-02-01'\n  AND di.icd_code = 'E32.0' \n  AND a.admittime BETWEEN l.charttime AND DATE(l.charttime, '+1 month')\nGROUP BY \n  d.label\nHAVING \n  COUNT(*) > 0\nORDER BY \n  lab_test_count DESC\nLIMIT 3;",
    "8cbd43defc418d1da88f21b2": "WITH BMIFiltered AS (\n    SELECT DISTINCT d.subject_id, d.hadm_id\n    FROM diagnoses_icd d\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title LIKE '%BMI 19-24%' AND d.charttime > date('now', '-1 year')\n),\nLabTests AS (\n    SELECT l.itemid, l.charttime\n    FROM BMIFiltered b\n    JOIN labevents l ON b.subject_id = l.subject_id AND b.hadm_id = l.hadm_id\n    WHERE l.charttime > date('now', '-1 year')\n),\nLabTestCounts AS (\n    SELECT itemid, COUNT(*) AS test_count\n    FROM LabTests\n    GROUP BY itemid\n),\nRankedLabTests AS (\n    SELECT itemid, test_count, RANK() OVER (ORDER BY test_count DESC) AS rank\n    FROM LabTestCounts\n)\nSELECT itemid\nFROM RankedLabTests\nWHERE rank <= 3;",
    "89a55d6a6cba3898d5b52d9c": "",
    "e874c2a103f4267d6ddfed15": "WITH diagnosed_patients AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id,\n        d.charttime AS diagnosis_time\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE \n        d2.long_title = 'Cerebral laceration and contusion, other and unspecified; contusion, without mention of open intracranial wound; loss of consciousness of unspecified duration'\n),\nlab_tests AS (\n    SELECT \n        l.subject_id,\n        l.hadm_id,\n        l.itemid,\n        l.charttime,\n        li.label AS lab_test_label\n    FROM \n        labevents l\n    INNER JOIN \n        d_labitems li ON l.itemid = li.itemid\n    INNER JOIN \n        diagnosed_patients dp ON l.subject_id = dp.subject_id AND l.hadm_id = dp.hadm_id\n    WHERE \n        l.charttime BETWEEN dp.diagnosis_time AND DATE(dp.diagnosis_time, '+1 month')\n)\nSELECT \n    lab_test_label,\n    COUNT(*) AS test_count\nFROM \n    lab_tests\nGROUP BY \n    lab_test_label\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "6d7e2ca9e692a3b833e8d4c2": "SELECT lab.label, COUNT(*) AS frequency\nFROM labevents lab\nINNER JOIN diagnoses_icd diag ON lab.hadm_id = diag.hadm_id\nINNER JOIN d_icd_diagnoses d ON diag.icd_code = d.icd_code\nWHERE d.long_title = 'Esophagitis, unspecified since 2100'\nGROUP BY lab.label\nORDER BY frequency DESC\nLIMIT 5;",
    "70826ed4c727196227cb1ef9": "WITH ThoracoscopicDecortication AS (\n  SELECT \n    p.subject_id\n  FROM patients p\n  JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n  JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n  WHERE d.long_title = ' Thoracoscopic decortication of lung'\n),\nLabTests AS (\n  SELECT \n    l.subject_id,\n    l.itemid,\n    l.charttime,\n    di.label AS test_label\n  FROM labevents l\n  JOIN d_labitems di ON l.itemid = di.itemid\n  JOIN ThoracoscopicDecortication td ON l.subject_id = td.subject_id\n  WHERE l.charttime > (\n    SELECT MIN(pr.charttime) \n    FROM procedures_icd pr \n    JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n    WHERE pr.subject_id = l.subject_id AND d.long_title = ' Thoracoscopic decortication of lung'\n  )\n  AND l.charttime < DATE(\n    (SELECT MIN(pr.charttime) \n     FROM procedures_icd pr \n     JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n     WHERE pr.subject_id = l.subject_id AND d.long_title = ' Thoracoscopic decortication of lung'\n    ), '+1 month'\n  )\n),\nTestCounts AS (\n  SELECT \n    test_label,\n    COUNT(*) AS test_count\n  FROM LabTests\n  GROUP BY test_label\n)\nSELECT \n  test_label\nFROM TestCounts\nORDER BY test_count DESC\nLIMIT 5;",
    "5a615775859c42b0cfc588b1": "WITH PatientsWithUltrasonography AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n    JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n    WHERE d.long_title = 'Ultrasonography of Superior Vena Cava, guidance in 2100'\n),\nLabTestsInSameMonth AS (\n    SELECT l.subject_id, l.itemid\n    FROM labevents l\n    JOIN PatientsWithUltrasonography p ON l.subject_id = p.subject_id\n    WHERE STRFTIME('%Y-%m', l.charttime) IN (\n        SELECT STRFTIME('%Y-%m', l.charttime)\n        FROM labevents l\n        JOIN PatientsWithUltrasonography p ON l.subject_id = p.subject_id\n        LIMIT 1\n    )\n)\nSELECT l.itemid, COUNT(*) AS test_count\nFROM LabTestsInSameMonth l\nGROUP BY l.itemid\nORDER BY test_count DESC\nLIMIT 5;",
    "96dabd861de92e31433a8552": "WITH AlcoholDetoxifiedPatients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n    WHERE pr.icd_code = 'W01.1' -- ICD code for alcohol detoxification\n),\nLabTestsAfterDetox AS (\n    SELECT \n        l.subject_id,\n        l.itemid,\n        l.charttime,\n        d.label AS lab_test\n    FROM labevents l\n    JOIN d_labitems d ON l.itemid = d.itemid\n    JOIN admissions a ON l.hadm_id = a.hadm_id\n    JOIN AlcoholDetoxifiedPatients adp ON l.subject_id = adp.subject_id\n    WHERE l.charttime > a.admittime\n      AND strftime('%Y-%m', l.charttime) = strftime('%Y-%m', a.admittime)\n),\nLabTestCounts AS (\n    SELECT \n        lab_test,\n        COUNT(*) AS test_count\n    FROM LabTestsAfterDetox\n    GROUP BY lab_test\n),\nRankedLabTests AS (\n    SELECT \n        lab_test,\n        test_count,\n        ROW_NUMBER() OVER (ORDER BY test_count DESC) AS rank\n    FROM LabTestCounts\n)\nSELECT lab_test\nFROM RankedLabTests\nWHERE rank <= 5;",
    "03a6a876fbcd2443f7f28749": "SELECT \n  labevents.itemid, \n  COUNT(labevents.itemid) AS num_tests\nFROM \n  labevents\nJOIN \n  procedures_icd ON labevents.subject_id = procedures_icd.subject_id AND labevents.hadm_id = procedures_icd.hadm_id\nWHERE \n  procedures_icd.icd_code = 'T08.1'\n  AND strftime('%Y-%m', labevents.charttime) = strftime('%Y-%m', 'now')\n  AND strftime('%Y', labevents.charttime) = strftime('%Y', 'now')\nGROUP BY \n  labevents.itemid\nORDER BY \n  num_tests DESC\nLIMIT 4;",
    "7af6e600c77232304b81e62d": "WITH icu_procedures AS (\n  SELECT subject_id, hadm_id\n  FROM procedures_icd\n  WHERE icd_code = 'P12.2'\n  AND charttime >= DATE('now', '-1 year')\n),\nlab_tests AS (\n  SELECT subject_id, hadm_id, itemid\n  FROM labevents\n  WHERE hadm_id IN (SELECT hadm_id FROM icu_procedures)\n),\ntest_frequencies AS (\n  SELECT itemid, COUNT(*) AS frequency\n  FROM lab_tests\n  GROUP BY itemid\n)\nSELECT dlab.label, tf.frequency\nFROM test_frequencies tf\nJOIN d_labitems dlab ON tf.itemid = dlab.itemid\nORDER BY tf.frequency DESC\nLIMIT 3;",
    "91b9ca43bd8f11ad31a158c7": "WITH RelevantAdmissions AS (\n    SELECT DISTINCT a.hadm_id\n    FROM admissions a\n    JOIN procedures_icd p ON a.hadm_id = p.hadm_id\n    WHERE p.icd_code IN ('R00', 'R01')\n),\nRelevantLabTests AS (\n    SELECT l.subject_id, l.hadm_id, d.label\n    FROM labevents l\n    JOIN d_labitems d ON l.itemid = d.itemid\n    JOIN RelevantAdmissions r ON l.hadm_id = r.hadm_id\n)\nSELECT label, COUNT(*) AS frequency\nFROM RelevantLabTests\nGROUP BY label\nORDER BY frequency DESC\nLIMIT 4;",
    "43bc1abffacc510680225ed9": "WITH ProcedurePatients AS (\n    SELECT \n        p.subject_id,\n        pr.charttime AS procedure_time\n    FROM \n        patients p\n    JOIN \n        procedures_icd pr ON p.subject_id = pr.subject_id\n    JOIN \n        d_icd_procedures d ON pr.icd_code = d.icd_code\n    WHERE \n        d.long_title = 'Reposition left maxilla with external fixation device, percutaneous approach'\n        AND pr.charttime > date('now', '-1 year')\n),\nLabTests AS (\n    SELECT \n        l.subject_id,\n        l.itemid,\n        l.charttime AS lab_time\n    FROM \n        ProcedurePatients pp\n    JOIN \n        labevents l ON pp.subject_id = l.subject_id\n    WHERE \n        l.charttime BETWEEN pp.procedure_time AND date(pp.procedure_time, '+1 month')\n)\nSELECT \n    d.label AS lab_test,\n    COUNT(*) AS count\nFROM \n    LabTests lt\nJOIN \n    d_labitems d ON lt.itemid = d.itemid\nGROUP BY \n    d.label\nORDER BY \n    count DESC\nLIMIT 3;",
    "ecea3263ba9f3a57a309a2e0": "SELECT spec_type_desc\nFROM microbiologyevents\nWHERE charttime >= DATE('now', '-1 year')\nGROUP BY spec_type_desc\nORDER BY COUNT(spec_type_desc) DESC\nLIMIT 3;",
    "edfa0b11933920062d92aacd": "SELECT \n  spec_type_desc AS specimen_test,\n  COUNT(*) AS test_count\nFROM \n  microbiologyevents\nWHERE \n  strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY \n  spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "26803d48dd00e769e38ea0c9": "SELECT \n  spec_type_desc,\n  COUNT(*) AS frequency\nFROM \n  microbiologyevents\nWHERE \n  charttime >= DATE('now', '-1 year')\nGROUP BY \n  spec_type_desc\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "9e48890388b483b0f182a90f": "",
    "1be9f21ac47235a697190eda": "SELECT test_name, COUNT(*) AS total_events\nFROM microbiologyevents\nWHERE charttime >= DATE('now', 'start of year')\nGROUP BY test_name\nORDER BY total_events DESC\nLIMIT 3;",
    "ebbeed93dad8985ba95cce74": "SELECT spec_type_desc, COUNT(*) AS specimen_count\nFROM microbiologyevents\nGROUP BY spec_type_desc\nORDER BY specimen_count DESC\nLIMIT 3;",
    "dbc4399f5a3526b4598df3ef": "SELECT spec_type_desc AS specimen_description, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = '2100'\nGROUP BY specimen_description\nORDER BY test_count DESC\nLIMIT 4;",
    "bbd60f29527c9ff438a314a7": "SELECT test_name\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = '2100'\nGROUP BY test_name\nORDER BY COUNT(test_name) DESC\nLIMIT 5;",
    "1fc44208dad68f8a906cda39": "SELECT test_name, COUNT(*) as test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "4a3678f63c0a0b08ed66585f": "SELECT test_name\nFROM microbiologyevents\nGROUP BY test_name\nORDER BY COUNT(test_name) DESC\nLIMIT 5;",
    "d2e2315a6ae7e509d95f1cdd": "SELECT \n  test_name, \n  COUNT(*) AS test_count\nFROM \n  microbiologyevents\nWHERE \n  strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY \n  test_name\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "4fcb903cb5d317c791dae3af": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE charttime > '2100-01-01'\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "4fd7632b17c70b416ebcfdda": "WITH MicrobiologyTestsCTE AS (\n  SELECT test_name, COUNT(*) AS test_count\n  FROM microbiologyevents\n  WHERE charttime >= DATE('now', 'start of year')\n  GROUP BY test_name\n)\nSELECT test_name, test_count\nFROM MicrobiologyTestsCTE\nORDER BY test_count DESC\nLIMIT 3;",
    "bf89f78810c2095c0e36f24b": "SELECT test_name\nFROM microbiologyevents\nGROUP BY test_name\nORDER BY COUNT(test_name) DESC\nLIMIT 4;",
    "433a98b0bf77207fccd6fb2f": "SELECT spec_type_desc\nFROM (\n    SELECT spec_type_desc, COUNT(*) AS count\n    FROM microbiologyevents\n    WHERE hadm_id IN (\n        SELECT hadm_id\n        FROM diagnoses_icd\n        WHERE icd_code = 'T85.1'\n    )\n    GROUP BY spec_type_desc\n) AS subquery\nORDER BY count DESC\nLIMIT 5;",
    "9e193ae2615e441e04331514": "SELECT \n  spec_type_desc, \n  COUNT(spec_type_desc) AS spec_test_count\nFROM \n  (SELECT \n    T2.subject_id, \n    T2.spec_type_desc \n   FROM \n    admissions T1 \n   INNER JOIN \n    microbiologyevents T2 ON T1.hadm_id = T2.hadm_id \n   WHERE \n    T1.dischtime IS NOT NULL \n    AND T1.dischtime > datetime(T2.charttime, '-2 months') \n    AND T2.charttime > datetime(T2.charttime, '-2 months')\n   ) T1 \nGROUP BY \n  T1.spec_type_desc \nHAVING \n  COUNT(T1.spec_type_desc) > 1 \nORDER BY \n  spec_test_count DESC \nLIMIT 3;",
    "65d676a4636cc2e1592ca2c0": "WITH NeoplasmDiagnosis AS (\n    SELECT d.subject_id\n    FROM diagnoses_icd d\n    WHERE d.icd_code = '2100'\n),\nSpecimenTests AS (\n    SELECT m.subject_id, m.spec_type_desc, m.charttime\n    FROM NeoplasmDiagnosis nd\n    INNER JOIN microbiologyevents m ON nd.subject_id = m.subject_id\n    WHERE m.charttime >= nd.subject_id.admittime\n      AND m.charttime < nd.subject_id.admittime + interval '1 month'\n)\nSELECT st.spec_type_desc, COUNT(*) AS test_count\nFROM SpecimenTests st\nGROUP BY st.spec_type_desc\nORDER BY test_count DESC\nLIMIT 4;",
    "5fc8a96c9b2c962520c2667f": "SELECT \n  t1.spec_type_desc\nFROM \n  patients p\nJOIN \n  admissions a ON p.subject_id = a.subject_id\nJOIN \n  diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN \n  microbiologyevents t1 ON a.hadm_id = t1.hadm_id\nWHERE \n  d.icd_code = 'C18.2' AND \n  t1.charttime > DATE('now', '-1 year') AND \n  t1.spec_type_desc IS NOT NULL\nGROUP BY \n  t1.spec_type_desc\nORDER BY \n  COUNT(t1.spec_type_desc) DESC\nLIMIT 4;",
    "925dc1173f6122d67b2847c7": "WITH OliguriaAnuriaPatients AS (\n    SELECT \n        d1.subject_id, \n        d1.charttime AS first_diagnosis_time, \n        d2.charttime AS second_diagnosis_time\n    FROM diagnoses_icd d1\n    JOIN diagnoses_icd d2 ON d1.subject_id = d2.subject_id\n    JOIN d_icd_diagnoses dicd1 ON d1.icd_code = dicd1.icd_code\n    JOIN d_icd_diagnoses dicd2 ON d2.icd_code = dicd2.icd_code\n    WHERE (dicd1.long_title LIKE '%oliguria%' OR dicd1.long_title LIKE '%anuria%')\n      AND (dicd2.long_title LIKE '%oliguria%' OR dicd2.long_title LIKE '%anuria%')\n      AND strftime('%Y', d1.charttime) = strftime('%Y', d2.charttime)\n      AND strftime('%m', d1.charttime) = strftime('%m', d2.charttime)\n      AND strftime('%Y', d1.charttime) = strftime('%Y', 'now')\n),\nSpecimenFrequencies AS (\n    SELECT \n        me.subject_id, \n        me.spec_type_desc,\n        COUNT(*) AS frequency\n    FROM OliguriaAnuriaPatients op\n    JOIN microbiologyevents me ON op.subject_id = me.subject_id\n    WHERE me.charttime BETWEEN op.first_diagnosis_time AND op.second_diagnosis_time\n    GROUP BY me.subject_id, me.spec_type_desc\n)\nSELECT \n    sf.subject_id, \n    sf.spec_type_desc, \n    sf.frequency\nFROM SpecimenFrequencies sf\nORDER BY sf.frequency DESC\nLIMIT 4;",
    "325e6c5f09459a46cc53281b": "WITH ChronicLymphocyticLeukemia AS (\n  SELECT p.subject_id\n  FROM patients p\n  JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  WHERE d.icd_code = 'C91.00'\n  UNION\n  SELECT p.subject_id\n  FROM patients p\n  JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  WHERE d.icd_code = 'C91.01'\n),\nSpecimensTested AS (\n  SELECT m.spec_type_desc\n  FROM ChronicLymphocyticLeukemia cll\n  JOIN diagnoses_icd d ON cll.subject_id = d.subject_id\n  JOIN admissions a ON d.subject_id = a.subject_id\n  JOIN microbiologyevents m ON a.hadm_id = m.hadm_id\n)\nSELECT spec_type_desc, COUNT(*) AS frequency\nFROM SpecimensTested\nGROUP BY spec_type_desc\nORDER BY frequency DESC\nLIMIT 5;",
    "50cfc25b33dbf1f04dd32e42": "SELECT \n  T2.spec_type_desc,\n  COUNT(T2.spec_type_desc) AS num_tests\nFROM \n  admissions AS T1\n  INNER JOIN diagnoses_icd AS T4 ON T1.hadm_id = T4.hadm_id\n  INNER JOIN d_icd_diagnoses AS T3 ON T4.icd_code = T3.icd_code\n  INNER JOIN microbiologyevents AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T3.long_title = 'Hematuria, unspecified; previously diagnosed'\n  AND T2.charttime > DATE('now', '-1 year')\nGROUP BY \n  T2.spec_type_desc\nORDER BY \n  num_tests DESC\nLIMIT 4;",
    "7a8ffac3b4d9276671a4aa1f": "SELECT \n  T2.subject_id, \n  T2.test_name, \n  COUNT(T2.test_name) AS frequency\nFROM \n  diagnoses_icd AS T1\nINNER JOIN \n  microbiologyevents AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.icd_code = 'E900' \n  AND T2.charttime > DATE(T1.charttime, '+2 month')\nGROUP BY \n  T2.subject_id, T2.test_name\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "10c4954997c7b5eab9c3c231": "WITH RenalDialysisAdmissions AS (\n    SELECT a.subject_id, a.hadm_id, a.admittime\n    FROM admissions a\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE di.long_title LIKE '%Noncompliance with Renal Dialysis%'\n),\nFilteredMicrobiologyEvents AS (\n    SELECT m.subject_id, m.hadm_id, m.charttime, m.test_name\n    FROM microbiologyevents m\n    JOIN RenalDialysisAdmissions rda ON m.subject_id = rda.subject_id AND m.hadm_id = rda.hadm_id\n    WHERE m.charttime BETWEEN rda.admittime AND DATE(rda.admittime, '+2 months')\n),\nTestFrequency AS (\n    SELECT test_name, COUNT(*) AS test_count\n    FROM FilteredMicrobiologyEvents\n    GROUP BY test_name\n    ORDER BY test_count DESC\n)\nSELECT test_name\nFROM TestFrequency\nLIMIT 5;",
    "ff5188901ba8d46da87b9474": "WITH IschemicCardiomyopathyPatients AS (\n    SELECT p.subject_id\n    FROM patients p\n    INNER JOIN diagnoses_icd di ON p.subject_id = di.subject_id\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE d.long_title = 'Ischemic cardiomyopathy'\n),\nMicrobiologyTests AS (\n    SELECT m.subject_id, m.test_name\n    FROM IschemicCardiomyopathyPatients icp\n    INNER JOIN microbiologyevents m ON icp.subject_id = m.subject_id\n    WHERE strftime('%Y-%m', m.charttime) = (SELECT strftime('%Y-%m', m.charttime)\n                                            FROM IschemicCardiomyopathyPatients icp2\n                                            INNER JOIN microbiologyevents m2 ON icp2.subject_id = m2.subject_id\n                                            WHERE m2.charttime = m.charttime\n                                            LIMIT 1)\n)\nSELECT test_name\nFROM MicrobiologyTests\nGROUP BY test_name\nORDER BY COUNT(*) DESC\nLIMIT 4;",
    "e63613e89815854b2cdf338c": "WITH HemoperitoneumDiagnoses AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id,\n        d.charttime AS diagnosis_time,\n        d.icd_code\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE di.long_title LIKE '%Hemoperitoneum%' AND d.charttime > '2100-01-01'\n),\nMicrobiologyTests AS (\n    SELECT \n        m.subject_id,\n        m.hadm_id,\n        m.charttime AS test_time,\n        m.test_name,\n        ROW_NUMBER() OVER (PARTITION BY m.subject_id, m.hadm_id ORDER BY m.charttime) AS test_rank\n    FROM microbiologyevents m\n    INNER JOIN HemoperitoneumDiagnoses h ON m.subject_id = h.subject_id AND m.hadm_id = h.hadm_id\n)\nSELECT \n    test_name\nFROM MicrobiologyTests\nWHERE test_rank <= 3;",
    "26c5ef7c7c93262038e4d7d0": "SELECT \n    m.test_name, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents m\nJOIN \n    diagnoses_icd d ON m.hadm_id = d.hadm_id\nJOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n    d2.long_title LIKE '%malignant neoplasm of intra-abdominal lymph nodes%'\n    AND m.charttime BETWEEN (SELECT admittime FROM admissions WHERE hadm_id = d.hadm_id) AND (SELECT dischtime FROM admissions WHERE hadm_id = d.hadm_id)\nGROUP BY \n    m.test_name\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "e62be6f32c868f298911cc1e": "SELECT T3.test_name\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN diagnoses_icd AS T4 ON T2.hadm_id = T4.hadm_id\nINNER JOIN d_icd_diagnoses AS T5 ON T4.icd_code = T5.icd_code\nINNER JOIN microbiologyevents AS T3 ON T2.subject_id = T3.subject_id\nWHERE T5.long_title = 'Supermarket, store or market as the place of occurrence of the external cause'\nAND strftime('%Y-%m', T3.charttime) = strftime('%Y-%m', T2.admittime)\nGROUP BY T3.test_name\nORDER BY COUNT(T3.test_name) DESC\nLIMIT 4;",
    "10f5ecdf9123785c95f2bff6": "SELECT \n  m.spec_type_desc AS SpecimenType,\n  COUNT(*) AS TestCount\nFROM \n  transfers t\nJOIN \n  admissions a ON t.subject_id = a.subject_id AND t.hadm_id = a.hadm_id\nJOIN \n  microbiologyevents m ON a.hadm_id = m.hadm_id\nWHERE \n  t.eventtype = 'Dependent on Respirator'\n  AND t.outtime >= '2100-01-01'\n  AND m.charttime >= t.outtime\n  AND m.charttime < DATE(t.outtime, '+1 month')\nGROUP BY \n  m.spec_type_desc\nORDER BY \n  TestCount DESC\nLIMIT 5;",
    "ed1c971e6bd14f5788256c98": "SELECT p.subject_id, d.spec_type_desc, COUNT(*) as specimen_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d_ip ON pr.icd_code = d_ip.icd_code\nJOIN d_icd_diagnoses d_icd ON pr.icd_code = d_icd.icd_code\nJOIN labevents l ON a.hadm_id = l.hadm_id\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE d_ip.long_title LIKE '%Diagnostic Ultrasound of Digestive System%'\nGROUP BY p.subject_id, d.spec_type_desc\nORDER BY specimen_count DESC\nLIMIT 3;",
    "f5b5e126ecc950d4e5b6eb18": "SELECT \n    T1.spec_type_desc AS Specimen,\n    COUNT(*) AS Frequency\nFROM \n    microbiologyevents T1\nINNER JOIN \n    procedures_icd T2 ON T1.subject_id = T2.subject_id\nWHERE \n    T2.icd_code = 'R10.10' \n    AND T1.charttime BETWEEN DATE('now', '-1 year') AND DATE('now', '-2 month')\nGROUP BY \n    T1.spec_type_desc\nORDER BY \n    Frequency DESC\nLIMIT 5;",
    "7d987252b086db272f8e0751": "WITH SpecimensTested AS (\n    SELECT \n        m.spec_type_desc,\n        COUNT(*) AS test_count\n    FROM \n        microbiologyevents m\n    INNER JOIN \n        procedures_icd p ON m.subject_id = p.subject_id AND m.hadm_id = p.hadm_id\n    INNER JOIN \n        d_icd_procedures d ON p.icd_code = d.icd_code\n    WHERE \n        d.long_title = 'Drainage of peritoneal cavity, percutaneous approach previously'\n        AND m.charttime >= '2100-01-01'\n        AND m.charttime < '2101-01-01'\n    GROUP BY \n        m.spec_type_desc\n    ORDER BY \n        test_count DESC\n)\nSELECT \n    spec_type_desc,\n    test_count\nFROM \n    SpecimensTested\nLIMIT 3;",
    "f9e732b63b0f86d15d3ab6be": "SELECT\n  T1.spec_type_desc AS Specimen_Type,\n  COUNT(*) AS Specimen_Count\nFROM\n  microbiologyevents AS T1\nJOIN\n  diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nWHERE\n  T2.icd_code = '00.01' \n  AND T1.charttime BETWEEN (SELECT admittime FROM admissions WHERE subject_id = T1.subject_id) AND \n  (SELECT dischtime FROM admissions WHERE subject_id = T1.subject_id) \n  AND T1.charttime >= DATE((SELECT admittime FROM admissions WHERE subject_id = T1.subject_id), '+2 months')\nGROUP BY\n  T1.spec_type_desc\nORDER BY\n  Specimen_Count DESC\nLIMIT 5;",
    "2ee9bfe879e3910ff859b7cc": "SELECT \n    m.spec_type_desc AS most_common_specimens\nFROM \n    procedures_icd p\nJOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nJOIN \n    admissions a ON p.hadm_id = a.hadm_id\nJOIN \n    patients pt ON a.subject_id = pt.subject_id\nJOIN \n    microbiologyevents m ON a.subject_id = m.subject_id\nWHERE \n    d.long_title = 'Dilation of left external iliac vein, with intraluminal device, percutaneous approach since 2100'\n    AND m.charttime >= a.dischtime\n    AND m.charttime <= DATE(a.dischtime, '+2 months')\nGROUP BY \n    m.spec_type_desc\nORDER BY \n    COUNT(*) DESC\nLIMIT 4;",
    "aec06629971fa88ed8810ca9": "SELECT spec_type_desc, COUNT(*) AS count\nFROM microbiologyevents me\nJOIN diagnoses_icd di ON me.hadm_id = di.hadm_id\nJOIN d_icd_diagnoses did ON di.icd_code = did.icd_code\nWHERE did.long_title = 'Destruction of right main bronchus, via natural or artificial opening endoscopic'\n  AND me.charttime >= DATE('now', 'start of year')\n  AND me.charttime < DATE('now', 'start of year', '+2 months')\nGROUP BY spec_type_desc\nORDER BY count DESC\nLIMIT 5;",
    "4ba8cbb501d0444c977e72d0": "WITH SpecificProcedure AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id\n    FROM \n        procedures_icd p\n    JOIN \n        d_icd_procedures d ON p.icd_code = d.icd_code\n    WHERE \n        d.long_title = 'Introduction of nutritional substance into central vein, percutaneous approach'\n        AND p.charttime BETWEEN '2100-01-01' AND '2100-12-31'\n),\nSpecimensTested AS (\n    SELECT \n        l.subject_id,\n        l.hadm_id,\n        l.itemid,\n        l.charttime,\n        d.label AS specimen_label\n    FROM \n        labevents l\n    JOIN \n        d_labitems d ON l.itemid = d.itemid\n    WHERE \n        l.charttime BETWEEN '2100-01-01' AND '2100-12-31'\n        AND EXISTS (SELECT 1 FROM SpecificProcedure sp WHERE sp.subject_id = l.subject_id AND sp.hadm_id = l.hadm_id)\n)\nSELECT \n    specimen_label,\n    COUNT(*) AS specimen_count\nFROM \n    SpecimensTested\nGROUP BY \n    specimen_label\nORDER BY \n    specimen_count DESC\nLIMIT 5;",
    "be6fb8ffe49a397f297313f4": "SELECT itemid, COUNT(*) AS input_count\nFROM inputevents\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY itemid\nORDER BY input_count DESC\nLIMIT 5;",
    "bd78210b53ac66e8ca86ce3a": "SELECT itemid, COUNT(*) AS input_count\nFROM inputevents\nWHERE starttime > '2100-01-01'\nGROUP BY itemid\nORDER BY input_count DESC\nLIMIT 4;",
    "f3977e7e8ae83d49d9e455e4": "SELECT \n  itemid,\n  COUNT(*) AS event_count\nFROM \n  inputevents\nWHERE \n  starttime >= DATE('now', '-1 year')\nGROUP BY \n  itemid\nORDER BY \n  event_count DESC\nLIMIT 5;",
    "66479b0a7f2004d265bf0c60": "SELECT \n    itemid, \n    COUNT(*) AS frequency\nFROM \n    inputevents\nWHERE \n    starttime >= '2100-01-01'\nGROUP BY \n    itemid\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "95f221c0f7e5b86fbfb2ff79": "SELECT itemid, COUNT(*) AS event_count\nFROM inputevents\nWHERE starttime >= DATE('now', 'start of year')\nGROUP BY itemid\nORDER BY event_count DESC\nLIMIT 4;",
    "daa34761c136dbde698516a2": "SELECT \n    i.itemid, \n    COUNT(*) AS total_events \nFROM \n    inputevents i \nWHERE \n    i.starttime LIKE '2100%' \nGROUP BY \n    i.itemid \nORDER BY \n    total_events DESC \nLIMIT 4;",
    "e1f8cb5aaff18c51a75dbced": "SELECT itemid, COUNT(*) as frequency\nFROM inputevents\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY itemid\nORDER BY frequency DESC\nLIMIT 5;",
    "2a77f183135d862ea4731d6a": "SELECT itemid, COUNT(*) AS output_count\nFROM outputevents\nWHERE charttime > '2100-01-01'\nGROUP BY itemid\nORDER BY output_count DESC\nLIMIT 3;",
    "fdafa588e078b95229c79d45": "SELECT value, valueuom, COUNT(*) as frequency\nFROM outputevents\nGROUP BY value, valueuom\nORDER BY frequency DESC\nLIMIT 5;",
    "9d45b985bd7bacacbf80b3c2": "WITH OutputEventCounts AS (\n  SELECT \n    oe.itemid, \n    COUNT(*) AS event_count\n  FROM \n    outputevents oe\n  GROUP BY \n    oe.itemid\n),\nRankedOutputEvents AS (\n  SELECT \n    itemid, \n    event_count,\n    ROW_NUMBER() OVER (ORDER BY event_count DESC) AS rank\n  FROM \n    OutputEventCounts\n)\nSELECT \n  d_items.label AS output_label,\n  RankedOutputEvents.event_count\nFROM \n  RankedOutputEvents\nINNER JOIN \n  d_items ON RankedOutputEvents.itemid = d_items.itemid\nWHERE \n  RankedOutputEvents.rank <= 3;",
    "6537f5be5f67a433fed84ca7": "SELECT value, COUNT(*) as frequency\nFROM outputevents\nWHERE valueuom = '2100'\nGROUP BY value\nORDER BY frequency DESC\nLIMIT 4;",
    "6730aa47b18b0105eb3dd8a2": "SELECT event_type, COUNT(*) as event_count\nFROM cost\nWHERE chargetime >= '2023-01-01'\nGROUP BY event_type\nORDER BY event_count DESC\nLIMIT 3;",
    "9fb8afdaaf96b44431b66905": "SELECT valueuom, COUNT(*) as count\nFROM outputevents\nWHERE charttime > DATE('now', '-1 year')\nGROUP BY valueuom\nORDER BY count DESC\nLIMIT 5;",
    "34c567a447d41ec8f026b6e3": "WITH recent_events AS (\n  SELECT event_type\n  FROM cost\n  WHERE chargetime >= DATE('now', '-1 year')\n)\nSELECT event_type, COUNT(*) AS frequency\nFROM recent_events\nGROUP BY event_type\nORDER BY frequency DESC\nLIMIT 3;",
    "7bdfe013186f828667928905": "SELECT phone_number\nFROM dr_phones\nWHERE dr_id = (\n    SELECT dr_id\n    FROM dr_patient_assignment\n    WHERE patient_id = 28447\n);",
    "2a929f4140fa128b102740cd": "SELECT label \nFROM d_labitems \nWHERE label LIKE '%tanning beds%' AND label LIKE '%fetus%';",
    "83ec5f2878ea0c3503d1e17b": "",
    "f268157490484fd392fc3625": "SELECT 'Software' AS software;",
    "293a491c440d62e67c686f47": "WITH drug_counts AS (\n    SELECT\n        drug,\n        COUNT(*) AS drug_count\n    FROM\n        prescriptions\n    GROUP BY\n        drug\n)\nSELECT\n    MAX(drug_count) AS max_drug_count,\n    drug AS drug_with_max_count\nFROM\n    drug_counts;",
    "66849fb36f1b3833ece51450": "SELECT 'Does it rain much in borneo?' AS answer;",
    "003f7650b1ad418ca111edc9": "SELECT 'The train going to EBT' AS train_info;",
    "f0d34937f5d41dd42fe0b372": "SELECT long_title\nFROM d_icd_diagnoses\nWHERE long_title = 'depress psychosis-unspec'\nORDER BY row_id DESC\nLIMIT 10;",
    "f0058451e642bc79081d5500": "SELECT DISTINCT d.long_title AS symptom\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.icd_code = 'K85.0';",
    "c1d459523b1199c08ad0e0bc": "SELECT \n    T.eventtype\nFROM \n    transfers T\nINNER JOIN \n    patients P ON T.subject_id = P.subject_id\nWHERE \n    (strftime('%Y', P.dob) - strftime('%Y', P.dod)) < 18\nGROUP BY \n    T.eventtype\nORDER BY \n    COUNT(T.eventtype) DESC\nLIMIT 1;",
    "81998505a14291319bd54753": "SELECT label \nFROM d_labitems \nWHERE label LIKE '%engineer%';",
    "6762712ae8423c26a0745d35": "SELECT T1.drug AS common_allergies\nFROM prescriptions AS T1\nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nJOIN icustays AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE T3.first_careunit = 'MICU'\nGROUP BY T1.drug\nHAVING COUNT(T1.drug) > 10\nORDER BY COUNT(T1.drug) DESC;",
    "1bef0c762add8a8a0a693e94": "WITH MissingLanguage AS (\n    SELECT subject_id, admittime\n    FROM admissions\n    WHERE language IS NULL\n),\nPatientInfo AS (\n    SELECT p.subject_id, p.gender, p.dob\n    FROM patients p\n    JOIN MissingLanguage ml ON p.subject_id = ml.subject_id\n),\nImputedLanguage AS (\n    SELECT \n        ml.subject_id,\n        ml.admittime,\n        CASE\n            WHEN pi.gender = 'Male' AND (pi.dob - ml.admittime) / 365.25 > 60 THEN 'English'\n            WHEN pi.gender = 'Female' AND (pi.dob - ml.admittime) / 365.25 > 55 THEN 'Spanish'\n            ELSE 'Unknown'\n        END AS imputed_language\n    FROM MissingLanguage ml\n    JOIN PatientInfo pi ON ml.subject_id = pi.subject_id\n)\nSELECT \n    a.subject_id,\n    a.hadm_id,\n    a.admittime,\n    a.dischtime,\n    a.admission_type,\n    a.admission_location,\n    a.discharge_location,\n    a.insurance,\n    a.language,\n    a.marital_status,\n    a.age,\n    il.imputed_language\nFROM admissions a\nLEFT JOIN ImputedLanguage il ON a.subject_id = il.subject_id AND a.admittime = il.admittime;",
    "d06e1b6a44abb8c2d06f5c31": "SELECT procedure_name, COUNT(*) as procedure_count\nFROM (\n  SELECT icd_code, long_title as procedure_name\n  FROM d_icd_procedures\n  WHERE icd_code IN (\n    SELECT icd_code\n    FROM procedures_icd\n  )\n) AS procedure_list\nGROUP BY procedure_name\nORDER BY procedure_count DESC\nLIMIT 10;",
    "84c0a3f1d8f6eba51c9d5bee": "SELECT AVG(T1.valueuom) AS average_speed\nFROM chartevents AS T1\nINNER JOIN icustays AS T2 ON T1.stay_id = T2.stay_id\nINNER JOIN admissions AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE T1.itemid = 6943 -- Assuming itemid 6943 corresponds to speed measurements\nAND T3.admittime >= DATE('now', '-3 months');",
    "b61cbedd599810345dbf4e51": "SELECT gender, dob\nFROM patients\nWHERE subject_id = 'PFC Deglopper';",
    "9e1673ff38efcb44fd73240c": "SELECT \n    os.label AS os_label,\n    COUNT(*) AS os_count\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    icustays icu ON a.hadm_id = icu.hadm_id\nJOIN \n    chartevents ce ON icu.stay_id = ce.stay_id\nJOIN \n    d_items os ON ce.itemid = os.itemid\nWHERE \n    icu.first_careunit = 'micu' AND os.label = 'Operating System'\nGROUP BY \n    os.label\nORDER BY \n    os_count DESC\nLIMIT 1;",
    "a024d0f2f669a49d6d23c3cb": "SELECT \n  long_title, \n  icd_code\nFROM \n  d_icd_diagnoses\nWHERE \n  long_title LIKE '%esophageal reflux%'\nORDER BY \n  icd_code DESC\nLIMIT 10;",
    "30e2f83874ad5cfcfad469ae": "SELECT AVG(area_size) AS average_icu_area_size\nFROM icustays;",
    "85e3fca57790810bb1784334": "SELECT DISTINCT m.spec_type_desc AS \"Test Type\"\nFROM microbiologyevents m\nINNER JOIN d_icd_diagnoses d ON m.spec_type_desc = d.long_title\nWHERE m.subject_id = 55360\nAND DATE(m.charttime) = DATE('now');",
    "2421e3311f43427ac609f160": "SELECT subject_id, hadm_id, admittime, dischtime, admission_type, admission_location, discharge_location, insurance, language, marital_status, age\nFROM admissions\nWHERE admission_location = '\u7259\u79d1\u75c5\u623f';",
    "216188fe302509bfcf221465": "SELECT marital_status\nFROM patients\nWHERE gender = 'Female'\nAND subject_id IN (SELECT subject_id FROM patients WHERE gender = 'Female')\nAND marital_status = 'Married';",
    "ca5022461fd46823f66c73e1": "",
    "da729a26fea20170777e7a67": "SELECT DISTINCT drug\nFROM prescriptions\nWHERE drug IN ('ibuprofen', 'paracetamol');",
    "56677fd269582e66886924c8": "WITH DrugCounts AS (\n    SELECT\n        drug,\n        COUNT(*) AS prescription_count\n    FROM prescriptions\n    GROUP BY drug\n)\nSELECT\n    drug,\n    prescription_count\nFROM DrugCounts\nORDER BY prescription_count DESC;",
    "f1735f59888dc5e92a980156": "SELECT T2.valueuom\nFROM patients AS T1\nJOIN labevents AS T2 ON T1.subject_id = T2.subject_id\nWHERE T1.gender = 'M'\nGROUP BY T2.valueuom\nORDER BY COUNT(T2.valueuom) DESC\nLIMIT 1;",
    "bc11ae111fd50da24024a238": "SELECT T2.phonenumber AS doctor_phonenumber\nFROM patients AS T1\nINNER JOIN admissions AS T3 ON T1.subject_id = T3.subject_id\nINNER JOIN transfers AS T4 ON T3.hadm_id = T4.hadm_id\nINNER JOIN doctors AS T5 ON T4.careunit = T5.unit\nINNER JOIN doctor_info AS T2 ON T5.doc_id = T2.doc_id\nWHERE T1.subject_id = 4326 AND T4.eventtype = 'Doctor In Charge';",
    "e6b1ea98e579fc0b9bbaf0da": "SELECT p.gender\nFROM patients p\nINNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'fentanyl citrate';",
    "48f1e69154c4643e5a5b35d5": "SELECT \n  CASE \n    WHEN a.discharge_location = a.admission_location AND a.discharge_location != '' THEN 'Yes'\n    ELSE 'No'\n  END AS transfer_plan\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE p.subject_id = 3745 AND a.discharge_location IS NOT NULL;",
    "adc65ada307e86fe87be278f": "SELECT label\nFROM d_labitems\nWHERE label LIKE '%singer%' AND abbreviation = 'M';",
    "00d3e734f6e0469592eee929": "SELECT \n    p.subject_id,\n    d.long_title AS diagnosis,\n    pr.long_title AS procedure,\n    prs.drug\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    diagnoses_icd dgd ON a.hadm_id = dgd.hadm_id\nINNER JOIN \n    d_icd_diagnoses d ON dgd.icd_code = d.icd_code\nINNER JOIN \n    procedures_icd prd ON a.hadm_id = prd.hadm_id\nINNER JOIN \n    d_icd_procedures pr ON prd.icd_code = pr.icd_code\nINNER JOIN \n    prescriptions prs ON a.hadm_id = prs.hadm_id\nWHERE \n    d.long_title LIKE '%Hypertension%' AND\n    pr.long_title LIKE '%Relief of headache%' AND\n    prs.drug LIKE '%medication%'\nORDER BY \n    p.subject_id;",
    "14bb6c7bed022d576caf2a44": "SELECT p.route, COUNT(p.row_id) AS prescription_count\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.age < 30 AND p.route LIKE '%alternative%'\nGROUP BY p.route\nORDER BY prescription_count DESC\nLIMIT 1;",
    "a4fb3217af375fa0143a8cbf": "SELECT \n    subject_id\nFROM \n    admissions\nWHERE \n    subject_id = 26817 \n    AND discharge_location = 'Other Departments'\n    AND admission_type = 'Elective';",
    "e1f71e2a39e7ce12a6a21ad9": "SELECT \n    d.label AS test_name,\n    l.valuenum AS lab_value\nFROM \n    labevents l\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.valuenum = 63.5;",
    "5a5c4c6d198bda6e1670161f": "SELECT COUNT(DISTINCT p.row_id) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nJOIN prescriptions pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\nWHERE pr.drug LIKE '%anesthesia%'\nAND p.charttime >= DATE('now', '-1 month')\nAND p.charttime < DATE('now');",
    "a9c7e7917e0b8969446e33a7": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE p.dob LIKE '%France%' AND strftime('%Y', a.admittime) = strftime('%Y', 'now');",
    "c9dd0d430bbf3d22e3f3e059": "SELECT p.gender\nFROM prescriptions pr\nJOIN patients p ON pr.subject_id = p.subject_id\nWHERE pr.drug = 'Bisacodyl';",
    "8769c33294b067dafbe858b1": "-- The database schema does not contain a field or table that stores companion information.\n-- Therefore, it is not possible to retrieve the companion number for patient 18866.",
    "2024e435133e2efe817fdc1a": "SELECT ce.charttime\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 25814 AND di.label = 'MRI Scan'\nORDER BY ce.charttime ASC\nLIMIT 1;",
    "7244f2d8e5c70022f4884696": "SELECT phone_number\nFROM doctors\nWHERE subject_id = 30826;",
    "f29c341f04a2ef448f0cc363": "WITH discharge_admission AS (\n  SELECT\n    a1.subject_id,\n    a1.dischtime AS discharge_time,\n    LEAD(a2.admittime) OVER (PARTITION BY a1.subject_id ORDER BY a1.dischtime) AS next_admission_time\n  FROM\n    admissions a1\n  LEFT JOIN\n    admissions a2 ON a1.subject_id = a2.subject_id AND a2.admittime > a1.dischtime\n)\nSELECT\n  AVG(JULIANDAY(next_admission_time) - JULIANDAY(discharge_time)) AS average_days_between\nFROM\n  discharge_admission\nWHERE\n  next_admission_time IS NOT NULL;",
    "5497eb668de1ff020fd4e774": "SELECT \n    icustays.first_careunit AS ICU_Name,\n    d_items.label AS Equipment_Name,\n    icustays.subject_id AS Patient_ID,\n    icustays.stay_id AS ICU_Stay_ID,\n    icustays.intime AS Equipment_Usage_Time,\n    icustays.outtime AS Equipment_Usage_End_Time,\n    d_items.abbreviation AS Equipment_Short_Name,\n    d_items.linksto AS Equipment_Category\nFROM icustays\nJOIN inputevents ON icustays.stay_id = inputevents.stay_id\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE d_items.itemid IN (\n    SELECT itemid FROM d_items WHERE label LIKE '%equipment%'\n);",
    "c8912477d5181d9a93846c73": "",
    "052a50039b6037274420dd8f": "WITH FirstAdmission AS (\n    SELECT \n        a.subject_id,\n        MIN(a.admittime) AS first_admittime\n    FROM admissions a\n    GROUP BY a.subject_id\n),\nSubsequentAdmissions AS (\n    SELECT \n        a.subject_id,\n        a.admittime,\n        a.dischtime\n    FROM admissions a\n    INNER JOIN FirstAdmission fa ON a.subject_id = fa.subject_id\n    WHERE julianday(a.admittime) - julianday(fa.first_admittime) BETWEEN 1 AND 30\n),\nAnesthesiaDuration AS (\n    SELECT \n        sa.subject_id,\n        julianday(sa.dischtime) - julianday(sa.admittime) AS anesthesia_duration\n    FROM SubsequentAdmissions sa\n)\nSELECT \n    AVG(anesthesia_duration) AS average_anesthesia_duration\nFROM AnesthesiaDuration;",
    "8d80b1b9e406fe7a5a097ec2": "SELECT dose_val_rx || ' ' || dose_unit_rx AS recommended_dose\nFROM prescriptions\nWHERE subject_id = 10128 AND starttime = '2104-1106 00:00:00';",
    "7669405a2a1666ecbfff8817": "SELECT COUNT(DISTINCT T2.subject_id) \nFROM transfers AS T1 \nINNER JOIN patients AS T2 \nON T1.subject_id = T2.subject_id \nWHERE T1.eventtype = 'Copy Prescription';",
    "98b8b345de9b31cd2668b9b2": "",
    "8bada17662a355a51ea59bda": "WITH MaritalStatusCounts AS (\n    SELECT \n        a.marital_status, \n        COUNT(p.subject_id) AS patient_count\n    FROM \n        patients p\n    INNER JOIN \n        admissions a ON p.subject_id = a.subject_id\n    GROUP BY \n        a.marital_status\n)\nSELECT \n    JSON_GROUP_ARRAY(JSON_OBJECT('marital_status', marital_status, 'patient_count', patient_count)) AS pie_chart_data\nFROM \n    MaritalStatusCounts;",
    "1b1eb68d8eca94f1888c01df": "SELECT label FROM d_items WHERE label LIKE '%insulin%' AND label LIKE '%fast-acting%';",
    "20dc30c77f1b416cf280b62b": "SELECT \n  t.test_name\nFROM \n  microbiologyevents t\nWHERE \n  t.subject_id = 17667 \n  AND DATE(t.charttime) = DATE('now');",
    "c232e6794bf8d1dbf9ff6a31": "SELECT doctor_phone_number\nFROM doctors\nWHERE doctor_id = (SELECT doctor_id FROM patient_doctors WHERE patient_id = 18866);",
    "b4308f599ae4e9243b96c815": "SELECT p.gender AS PatientName\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE (strftime('%Y', 'now') - strftime('%Y', p.dob) - (strftime('%m-%d', 'now') < strftime('%m-%d', p.dob))) > 50;",
    "0ffa12eb413fe198d8ad5615": "SELECT \n    dl.label AS test_name,\n    le.charttime AS timestamp,\n    le.valuenum AS value,\n    le.valueuom AS unit\nFROM \n    labevents le\nJOIN \n    d_labitems dl ON le.itemid = dl.itemid\nWHERE \n    dl.label LIKE '%Insulin%' OR le.valueuom LIKE '%Insulin%'\nORDER BY \n    le.charttime DESC\nLIMIT 10;",
    "6d276e472515f3a34e65d3c0": "SELECT \n  'Recorded Meeting of Physicians Discussing Complex Case: ' || \n  di.label || ' on ' || \n  ce.charttime AS meeting_summary\nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  di.label = 'Meeting of Physicians Discussing Complex Case'\nORDER BY \n  ce.charttime DESC\nLIMIT 1;",
    "c82edfa2a6b5736bd0ba574c": "WITH AlcoholUsePatients AS (\n  SELECT \n    a.subject_id,\n    (julianday(a.dischtime) - julianday(a.admittime)) AS days_in_hospital\n  FROM \n    admissions a\n  JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\n  WHERE \n    d.icd_code IN ('K66', 'K67', 'K68', 'K69') -- Codes for alcohol use\n  UNION\n  SELECT \n    a.subject_id,\n    (julianday(a.dischtime) - julianday(a.admittime)) AS days_in_hospital\n  FROM \n    admissions a\n  JOIN \n    prescriptions p ON a.hadm_id = p.hadm_id\n  WHERE \n    p.drug LIKE '%alcohol%' OR p.drug LIKE '%ethyl%' OR p.drug LIKE '%methyl%'\n),\nNoAlcoholUsePatients AS (\n  SELECT \n    a.subject_id,\n    (julianday(a.dischtime) - julianday(a.admittime)) AS days_in_hospital\n  FROM \n    admissions a\n  WHERE \n    a.subject_id NOT IN (SELECT subject_id FROM AlcoholUsePatients)\n)\nSELECT \n  AVG(days_in_hospital) AS avg_days_with_alcohol_use\nFROM \n  AlcoholUsePatients\nUNION ALL\nSELECT \n  AVG(days_in_hospital) AS avg_days_without_alcohol_use\nFROM \n  NoAlcoholUsePatients;",
    "4eb570ece07f38aa85107fcf": "SELECT \n    le.charttime\nFROM \n    labevents le\nJOIN \n    d_labitems li ON le.itemid = li.itemid\nWHERE \n    le.subject_id = 77676 AND li.label = 'MRI'\nORDER BY \n    le.charttime ASC\nLIMIT 1;",
    "cdcda008dc7819a1b0327522": "SELECT COUNT(*) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.age > 60 AND a.language = 'russian';",
    "c7f3fe77ea11f0bbf111258c": "SELECT \n    CASE \n        WHEN COUNT(labevents.row_id) - COUNT(chartevents.row_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_tests_before_discharge\nFROM \n    patients\nLEFT JOIN \n    admissions ON patients.subject_id = admissions.subject_id\nLEFT JOIN \n    labevents ON admissions.hadm_id = labevents.hadm_id AND labevents.charttime < admissions.dischtime\nLEFT JOIN \n    chartevents ON labevents.row_id = chartevents.row_id\nWHERE \n    patients.subject_id = 7742;",
    "bdec7c306774d6d605d4da77": "WITH icu_stays AS (\n    SELECT \n        s.subject_id,\n        (strftime('%J', s.outtime) - strftime('%J', s.intime)) AS icu_stay_length\n    FROM icustays s\n),\ncosts AS (\n    SELECT \n        c.subject_id,\n        CASE \n            WHEN c.event_type = 'payment' THEN c.cost \n            ELSE 0 \n        END AS payment_cost\n    FROM cost c\n),\npayment_status AS (\n    SELECT \n        c.subject_id,\n        CASE \n            WHEN SUM(c.payment_cost) > 0 THEN 'paid'\n            ELSE 'not paid'\n        END AS payment_status\n    FROM costs c\n    GROUP BY c.subject_id\n),\nfinal_status AS (\n    SELECT \n        ps.subject_id,\n        CASE \n            WHEN ps.payment_status = 'paid' THEN 'completed'\n            ELSE 'delayed'\n        END AS final_status\n    FROM payment_status ps\n)\nSELECT \n    SUM(CASE WHEN fs.final_status = 'completed' THEN icu_stays.icu_stay_length ELSE 0 END) - \n    SUM(CASE WHEN fs.final_status = 'delayed' THEN icu_stays.icu_stay_length ELSE 0 END) AS difference_in_icu_stay_length\nFROM icu_stays\nJOIN final_status fs ON icu_stays.subject_id = fs.subject_id;",
    "3edd4a4d0001415835f3d941": "",
    "e63445c44aa8a8b69bdfb8eb": "SELECT subject_id AS patient_id\nFROM patients\nWHERE subject_id = 29666;",
    "db942f82c8b54c6c40b1d995": "SELECT label, abbreviation\nFROM d_items\nWHERE abbreviation = 'Insulin-Rapid';",
    "6019c6cfa331a76747e3e179": "",
    "fa5955074cefb8227fce847c": "SELECT LEAD(starttime) OVER (ORDER BY starttime) AS next_event_time\nFROM inputevents\nWHERE subject_id = 18866 AND totalamountuom = 'MRI'\nORDER BY starttime;",
    "2221c6ca4b7bdd6b39d061ab": "SELECT p.gender, COUNT(*) AS num_patients\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'Buprenorphine'\nGROUP BY p.gender;",
    "8ed214a3b37b99e4b939b91a": "SELECT \n    p.subject_id, \n    d.long_title AS diagnosis, \n    pr.drug, \n    pr.dose_val_rx, \n    pr.dose_unit_rx, \n    pr.route, \n    COUNT(*) AS prescription_count\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nINNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE d.long_title LIKE '%hypertension%' \nGROUP BY p.subject_id, d.long_title, pr.drug, pr.dose_val_rx, pr.dose_unit_rx, pr.route\nORDER BY prescription_count DESC;",
    "c8eb4a1719c5627ddf87792c": "SELECT * FROM \"Windows embedded standard e sku\";",
    "427d21d4ec4e4df52e74038b": "",
    "9ed9ea6427a74331f8c0ae9f": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN diagnoses_icd d ON p.subject_id = d.subject_id \nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code \nWHERE d2.long_title LIKE '%hypertension%' \n  AND p.gender = 'Male' \n  AND p.dob LIKE '%, LA, USA%' \n  OR p.gender = 'Female' \n  AND p.dob LIKE '%, LA, USA%'",
    "f046767dd9ee27d2e46f089a": "SELECT translate(microbiologyevents.spec_type_desc, 'en', 'hi') AS translated_spec_type_desc,\n       translate(microbiologyevents.test_name, 'en', 'hi') AS translated_test_name,\n       translate(microbiologyevents.org_name, 'en', 'hi') AS translated_org_name\nFROM microbiologyevents\nJOIN patients ON microbiologyevents.subject_id = patients.subject_id\nWHERE patients.subject_id = 269;",
    "3c5224fd3b9805031e6c563b": "SELECT dob \nFROM patients \nWHERE insurance = 'Medicaid';",
    "531d0af347664f410627a0fc": "SELECT COUNT(DISTINCT subject_id) AS number_of_patients\nFROM prescriptions;",
    "03f31ef366447668d469435e": "SELECT 'denver' AS town_area;",
    "970880ac21066f749bba19ad": "SELECT \n  admission_location, \n  discharge_location\nFROM \n  admissions;",
    "cae9f75aaa264530ca43f2d8": "SELECT DISTINCT \n  'Procedure ' || p.long_title || ' scheduled for patient ' || pa.gender || ' ' || pa.dob || ' on ' || DATE(s.starttime) AS note\nFROM \n  inputevents s\nINNER JOIN \n  d_items i ON s.itemid = i.itemid\nINNER JOIN \n  procedures_icd p ON s.hadm_id = p.hadm_id\nINNER JOIN \n  patients pa ON s.subject_id = pa.subject_id\nWHERE \n  i.label = 'Surgery Schedule';",
    "4a543d7a5a2b445c6d3832f4": "SELECT e.charttime AS mri_exam_time, e.value AS mri_exam_result\nFROM outputevents e\nJOIN d_items i ON e.itemid = i.itemid\nWHERE e.subject_id = 59049 AND i.label = 'MRI Exam';",
    "5b125ca978768d6d90c96817": "",
    "868f55abba5b9b51520d27e4": "SELECT T1.subject_id, T1.icd_code, T2.label, T1.charttime, T1.valuenum\nFROM procedures_icd AS T1\nJOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nJOIN labevents AS T3 ON T1.subject_id = T3.subject_id AND T1.hadm_id = T3.hadm_id\nJOIN d_labitems AS T4 ON T3.itemid = T4.itemid\nWHERE T4.label = 'Anesthesia Duration'\n  AND T3.charttime >= DATE('now', '-1 month')\nORDER BY T1.valuenum DESC\nLIMIT 1;",
    "1c7aab76fcd16c27eb23677e": "SELECT DISTINCT drug\nFROM prescriptions\nWHERE drug LIKE '%Fast Acting Insulin%';",
    "35e213805db89bbf446e5831": "SELECT value, valueuom\nFROM outputevents\nWHERE subject_id = 32163 AND test_name = 'MRI';",
    "6a969b626da94022cd09b496": "SELECT title\nFROM articles\nWHERE subject = 'patient privacy in hospitals' AND date >= '2023-01-01';",
    "54d266747ccc80d0ed29f19e": "SELECT *\nFROM chartevents\nWHERE subject_id = 1242;",
    "bbb7101ab70e7712f9d01ec7": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_pet_ct\nFROM \n  labevents L\n  INNER JOIN d_labitems D ON L.itemid = D.itemid\nWHERE \n  L.subject_id = 19412 \n  AND D.label = 'PET-CT';",
    "ff8528ddb6bb24fd4ac86a40": "SELECT \n  'Play energetic music for a physical therapy session.' AS activity;",
    "ef75f75beef8f335b9baa3da": "SELECT d.long_title, a.admittime\nFROM d_icd_diagnoses d\nJOIN diagnoses_icd di ON d.icd_code = di.icd_code\nJOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE d.long_title LIKE '%mental health%'\nORDER BY a.admittime DESC;",
    "e9075a46d6776298a18655db": "",
    "1d9f34f734a17a488fefeebe": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 728;",
    "fc91b305e4be2838d4a5b0c5": "WITH PotassiumChloridePrescriptions AS (\n    SELECT \n        pr.subject_id,\n        pr.hadm_id,\n        pr.drug,\n        pr.dose_val_rx,\n        pr.dose_unit_rx,\n        pr.route\n    FROM \n        prescriptions pr\n    WHERE \n        pr.drug = 'potassium chloride (powder)'\n),\nGenderPrescriptions AS (\n    SELECT \n        p.gender,\n        pcp.subject_id,\n        pcp.hadm_id,\n        pcp.drug,\n        pcp.dose_val_rx,\n        pcp.dose_unit_rx,\n        pcp.route\n    FROM \n        PotassiumChloridePrescriptions pcp\n    INNER JOIN \n        patients p ON pcp.subject_id = p.subject_id\n)\nSELECT \n    gender,\n    COUNT(DISTINCT hadm_id) AS num_hadm_ids\nFROM \n    GenderPrescriptions\nGROUP BY \n    gender;",
    "235c0b04c31a09d7781e4dac": "WITH PrescriptionGrowthRates AS (\n  SELECT\n    p.subject_id,\n    p.hadm_id,\n    p.starttime,\n    p.stoptime,\n    m.charttime,\n    m.valueuom,\n    m.org_name,\n    CASE\n      WHEN m.charttime < p.starttime THEN 'Before'\n      ELSE 'After'\n    END AS growth_rate_period\n  FROM\n    prescriptions p\n  INNER JOIN\n    microbiologyevents m ON p.subject_id = m.subject_id AND p.hadm_id = m.hadm_id\n  WHERE\n    m.valueuom = 'Organism Growth Rate'\n),\nAverageGrowthRates AS (\n  SELECT\n    subject_id,\n    hadm_id,\n    growth_rate_period,\n    AVG(valueuom) AS avg_growth_rate\n  FROM\n    PrescriptionGrowthRates\n  GROUP BY\n    subject_id,\n    hadm_id,\n    growth_rate_period\n),\nGrowthRateDifferences AS (\n  SELECT\n    subject_id,\n    hadm_id,\n    MAX(CASE WHEN growth_rate_period = 'After' THEN avg_growth_rate ELSE NULL END) -\n    MAX(CASE WHEN growth_rate_period = 'Before' THEN avg_growth_rate ELSE NULL END) AS growth_rate_diff\n  FROM\n    AverageGrowthRates\n  GROUP BY\n    subject_id,\n    hadm_id\n)\nSELECT\n  subject_id,\n  hadm_id,\n  growth_rate_diff\nFROM\n  GrowthRateDifferences\nORDER BY\n  growth_rate_diff DESC\nLIMIT 1;",
    "930950b0e61480275d875940": "SELECT T1.subject_id, T1.gender\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nWHERE T1.dod IS NOT NULL\nAND T1.dod = DATE('now', '-3 days')",
    "48889ad5f102d84349096d62": "SELECT eventtype \nFROM transfers \nWHERE hadm_id = (SELECT hadm_id FROM icustays WHERE stay_id = 239118)\nAND careunit = 'MICU';",
    "246f8359ba09e783f4e449b4": "SELECT \n    p.gender\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    pr.drug = 'spironolactone'\nGROUP BY \n    p.gender;",
    "14a66c48aae42d8235db66d6": "",
    "6142ac809b4e6d03dc0b2fbc": "SELECT AVG(p.age) AS average_age\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title LIKE '%hypertension%';",
    "5ac240bc6491d1ec78be8ab3": "",
    "ec9f9a82be39ce9a1b98770f": "SELECT DISTINCT p.gender, p.dob\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN icustays i ON a.hadm_id = i.hadm_id\nWHERE a.admittime > datetime('now', '-3 years')",
    "92f2bfda6464ad834b3d3668": "",
    "77fa89ae38c8c39f7c81d4b7": "SELECT le.valuenum\nFROM labevents le\nJOIN d_labitems di ON le.itemid = di.itemid\nWHERE di.label = 'CT Scan' AND le.subject_id = 15447;",
    "c6b1da83d4b63322c4b4c6a9": "SELECT \n    spec_type_desc, \n    test_name, \n    org_name\nFROM \n    microbiologyevents\nWHERE \n    charttime = (SELECT MAX(charttime) FROM microbiologyevents);",
    "6713cf24d007377d7e869099": "",
    "4d3a84d5c5ed76fcb4951341": "",
    "1501ae8d8efab085f519b248": "-- The provided schema does not include any information about squirrels.\n-- Therefore, it is not possible to write a query to answer this question.",
    "c8ba34fa5105957a68d936fa": "WITH PatientCosts AS (\n    SELECT\n        c.subject_id,\n        AVG(c.cost) AS average_cost\n    FROM cost c\n    GROUP BY c.subject_id\n)\nSELECT\n    subject_id,\n    average_cost\nFROM PatientCosts\nORDER BY average_cost;",
    "43dd6a535818b9817b393135": "",
    "c1b6430d833cda363c07e4a4": "SELECT COUNT(*) AS expected_admissions\nFROM admissions\nWHERE strftime('%Y-%m', dischtime) = strftime('%Y-%m', 'now', '+1 month');",
    "ace343c8a0e67cd244b3d081": "WITH procedure_durations AS (\n    SELECT \n        p.subject_id,\n        p.gender,\n        p.dob,\n        pr.long_title,\n        CAST(strftime('%s', a.dischtime) - strftime('%s', prd.charttime) AS REAL) / 60 AS procedure_duration\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN procedures_icd prd ON a.hadm_id = prd.hadm_id\n    INNER JOIN d_icd_procedures pr ON prd.icd_code = pr.icd_code\n)\nSELECT \n    subject_id,\n    gender,\n    dob,\n    long_title,\n    procedure_duration\nFROM (\n    SELECT \n        subject_id,\n        gender,\n        dob,\n        long_title,\n        procedure_duration,\n        ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY procedure_duration) AS rn\n    FROM procedure_durations\n) AS subquery\nWHERE rn = 1;",
    "a77018c703503d0e6e17cf18": "SELECT T1.subject_id, T2.label, T1.valuenum, T1.valueuom\nFROM chartevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 66015 AND T2.label = 'CT Scan';",
    "fe862ff2d922e1153830a746": "WITH PatientsUnder18 AS (\n    SELECT subject_id\n    FROM patients\n    WHERE (julianday('now') - julianday(dob)) / 365 < 18\n),\nFilteredPrescriptions AS (\n    SELECT p.subject_id, pr.drug\n    FROM PatientsUnder18 p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\n)\nSELECT SUBSTR(drug, INSTR(drug, ' ') + 1) AS manufacturer, COUNT(*) AS frequency\nFROM FilteredPrescriptions\nGROUP BY manufacturer\nORDER BY frequency DESC\nLIMIT 1;",
    "f0d4fd4f9ef83a84556038a0": "SELECT AVG(T1.cost) AS average_cost\nFROM cost AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.insurance = 'medicare' AND T1.event_type = 'pending';",
    "3767ecc6700c56b7e24069df": "SELECT \n  d.label,\n  c.value,\n  c.valueuom\nFROM \n  chartevents c\n  INNER JOIN d_items d ON c.itemid = d.itemid\nWHERE \n  c.subject_id = 18877\n  AND d.label LIKE '%covid 19 test%';",
    "29f11be3511916b829d232f1": "SELECT ielts\nFROM ielts;",
    "52c617e596accfe965a74a66": "SELECT \n  d_icd_procedures.long_title AS procedure_name, \n  SUM(cost.cost) AS total_cost\nFROM \n  cost\nJOIN \n  procedures_icd ON cost.event_id = procedures_icd.row_id\nJOIN \n  d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nJOIN \n  admissions ON procedures_icd.hadm_id = admissions.hadm_id\nWHERE \n  cost.event_type = 'procedure' AND\n  cost.chargetime BETWEEN DATE('now', 'start of year') AND DATE('now') AND\n  admissions.insurance = 'anthem'\nGROUP BY \n  d_icd_procedures.long_title\nORDER BY \n  total_cost DESC\nLIMIT 5;",
    "51f107a86832910517f841d1": "SELECT \n  T1.charttime AS next_mri\nFROM \n  procedures_icd T1\n  INNER JOIN d_icd_procedures T2 ON T1.icd_code = T2.icd_code\nWHERE \n  T1.subject_id = 24894 \n  AND T2.long_title = 'MRI'\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "1d6044d33845efb3cb927bac": "",
    "d1fadb6c8dd5eec6647e6a16": "SELECT \n    p.subject_id\nFROM \n    prescriptions p\nJOIN \n    chartevents ce ON p.subject_id = ce.subject_id\nJOIN \n    d_labitems li ON ce.itemid = li.itemid\nWHERE \n    li.label = 'TV Appearance';",
    "24eb409247f4e7e43aba26bc": "WITH ProcedureCTE AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        d.long_title\n    FROM \n        procedures_icd p\n    INNER JOIN \n        d_icd_procedures d ON p.icd_code = d.icd_code\n)\nSELECT \n    (CAST(SUM(CASE WHEN long_title LIKE '%Anesthesia%' THEN 1 ELSE 0 END) AS REAL) / COUNT(subject_id)) * 100 AS percentage_anesthesia_procedures\nFROM \n    ProcedureCTE;",
    "f3232c5aa9f8ce5cb43f0a9c": "WITH ICUStayUnits AS (\n    SELECT\n        subject_id,\n        hadm_id,\n        stay_id,\n        first_careunit,\n        last_careunit,\n        ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY stay_id) AS stay_order\n    FROM icustays\n),\nDistanceCalculation AS (\n    SELECT\n        subject_id,\n        hadm_id,\n        stay_id,\n        first_careunit,\n        last_careunit,\n        stay_order,\n        LEAD(last_careunit) OVER (PARTITION BY subject_id ORDER BY stay_order) AS next_last_careunit,\n        CASE\n            WHEN LEAD(last_careunit) OVER (PARTITION BY subject_id ORDER BY stay_order) IS NOT NULL THEN\n                ABS(last_careunit - LEAD(last_careunit) OVER (PARTITION BY subject_id ORDER BY stay_order))\n            ELSE NULL\n        END AS distance_between_units\n    FROM ICUStayUnits\n)\nSELECT\n    AVG(distance_between_units) AS average_distance_between_units\nFROM DistanceCalculation\nWHERE distance_between_units IS NOT NULL;",
    "3086cebf36c3aeee27dd03d9": "SELECT eventtype\nFROM transfers\nGROUP BY eventtype\nHAVING COUNT(*) > (SELECT AVG(total_cases) FROM (\n    SELECT COUNT(*) as total_cases\n    FROM transfers\n    GROUP BY eventtype\n))",
    "ce0d216f4703f4417b14ea58": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_mri_readings\nFROM \n  labevents le\nJOIN \n  d_labitems di ON le.itemid = di.itemid\nWHERE \n  le.subject_id = 18866 AND di.label LIKE '%MRI%';",
    "ff24e91af68e8cab47eac8d5": "SELECT T2.label, COUNT(T1.subject_id) AS patient_count\nFROM patients T1\nJOIN d_items T2 ON T1.gender = T2.label\nWHERE T1.gender = 'White' AND T2.label IN ('Windows', 'Mac', 'Linux')\nGROUP BY T2.label\nHAVING COUNT(T1.subject_id) > 10;",
    "0e0d0ac51d0e88111f25178e": "SELECT \n    m.spec_type_desc, \n    m.test_name, \n    m.org_name\nFROM \n    microbiologyevents m\nWHERE \n    m.subject_id = 15257;",
    "817fdd991bf061d43a6caf77": "SELECT \n  L.charttime, \n  L.subject_id, \n  L.hadm_id, \n  L.itemid, \n  L.valuenum, \n  L.valueuom, \n  D.label\nFROM \n  labevents L \n  INNER JOIN d_labitems D \n  ON L.itemid = D.itemid \nWHERE \n  D.label LIKE '%retropharyngeal abscess%' \nORDER BY \n  L.charttime DESC \nLIMIT 1;",
    "1c7189f64663b34996998446": "WITH PatientAdmissionDurations AS (\n  SELECT\n    p.subject_id,\n    p.gender,\n    p.dob AS date_of_birth,\n    STRFTIME('%J', a.dischtime) - STRFTIME('%J', a.admittime) AS admission_days\n  FROM patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n)\nSELECT\n  'Place of Birth: ' || date_of_birth AS place_of_birth\nFROM PatientAdmissionDurations\nORDER BY admission_days DESC\nLIMIT 1;",
    "a3af29b331f6bb117e33572a": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1\n      FROM patients p\n      JOIN admissions a ON p.subject_id = a.subject_id\n      JOIN labevents l ON a.hadm_id = l.hadm_id\n      JOIN d_labitems d ON l.itemid = d.itemid\n      WHERE p.subject_id = 27964 AND d.label = 'Covid-19 Test Result'\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS covid_test_reported;",
    "d3c3b021182c355c4e1b80bb": "SELECT \n  t2.spec_type_desc, \n  t2.test_name, \n  t2.org_name \nFROM \n  patients AS t1 \n  JOIN transfers AS t3 ON t1.subject_id = t3.subject_id \n  JOIN microbiologyevents AS t2 ON t3.hadm_id = t2.hadm_id \nWHERE \n  t1.subject_id = 8016 \n  AND t2.test_name = 'MRI';",
    "b1408a3b1d78fe9f3e66a6b6": "WITH WhitePatients AS (\n  SELECT subject_id\n  FROM patients\n  WHERE gender = 'White'\n),\nPaymentTypes AS (\n  SELECT DISTINCT insurance AS payment_type\n  FROM admissions\n  WHERE subject_id IN (SELECT subject_id FROM WhitePatients)\n)\nSELECT payment_type, COUNT(*) AS payment_type_count\nFROM PaymentTypes\nGROUP BY payment_type\nORDER BY payment_type_count DESC\nLIMIT 1;",
    "cf7020f0a35629a60da14b9f": "SELECT \n     p.gender AS religion, \n     COUNT(*) AS total_patients\n   FROM \n     patients p \n     INNER JOIN admissions a ON p.subject_id = a.subject_id\n   WHERE \n     a.airport = 'JFK'\n   GROUP BY \n     p.gender\n   ORDER BY \n     total_patients DESC\n   LIMIT 1;",
    "fac90dfbb66690536c40e070": "SELECT last_careunit AS furthest_care_unit\nFROM (\n    SELECT DISTINCT last_careunit\n    FROM icustays\n    WHERE first_careunit = 'SICU'\n) AS care_units\nORDER BY last_careunit DESC\nLIMIT 1;",
    "1b07c4e732cbd5943a9075f4": "SELECT itemid, label FROM d_labitems WHERE label = 'In what type of bond are valence electrons shared between two atoms?';",
    "180f8faf4d285fb9cacfa8db": "SELECT \n  p.subject_id,\n  p.gender,\n  p.dob,\n  p.dod\nFROM patients p\nWHERE p.subject_id = 27463;",
    "33d9a5f72eefb71b319b35b0": "SELECT drug || ' ' || dose_val_rx || ' ' || dose_unit_rx || ' ' || route AS prescription_instructions\nFROM prescriptions\nWHERE drug = 'atenolol';",
    "fe69454584acd2f3b66e4d04": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.route = 'Hospital';",
    "199b2e2acc64428f7e798c47": "SELECT valueuom, COUNT(*) AS count\nFROM inputevents\nGROUP BY valueuom\nORDER BY count DESC\nLIMIT 1;",
    "6d1fb25832dab886945dd8f4": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1\n            FROM transfers t\n            JOIN admissions a ON t.hadm_id = a.hadm_id\n            WHERE a.subject_id = 10425\n            AND t.intime > a.dischtime\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS has_next_visit\nFROM admissions a\nWHERE a.subject_id = 10425\nAND a.dischtime IS NOT NULL;",
    "dec6c9f45523ef859e8d0977": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_appointments\nFROM \n  cost\nWHERE \n  subject_id = 28443 AND\n  event_type = 'appointment' AND\n  chargetime > DATE('now');",
    "7b472b0ae9e47179115926d5": "SELECT starttime, stoptime \nFROM prescriptions \nWHERE drug = 'Alcohol Anonymous';",
    "4c6f37b09e9230a451cda980": "SELECT DISTINCT icustays.first_careunit\nFROM icustays\nJOIN patients ON icustays.subject_id = patients.subject_id\nJOIN admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE icustays.first_careunit = 'micu' AND \n      strftime('%Y-%m', admissions.admittime) = strftime('%Y-%m', 'now', '-1 month')",
    "9109c1477507cea3a56bc3ea": "SELECT AVG(p.age) AS average_age\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN d_icd_diagnoses did ON d.icd_code = did.icd_code\nWHERE did.long_title LIKE '%Alcohol Use%'",
    "0e4f2f4885ba4659c994247b": "WITH admission_costs AS (\n    SELECT \n        a.subject_id,\n        a.insurance,\n        SUM(c.cost) AS total_spent\n    FROM admissions a\n    JOIN cost c ON a.hadm_id = c.hadm_id\n    GROUP BY a.subject_id, a.insurance\n)\nSELECT \n    insurance,\n    total_spent\nFROM admission_costs\nGROUP BY insurance, total_spent\nORDER BY insurance, total_spent;",
    "289e5edadc5007d6fa2e4a8b": "SELECT COUNT(DISTINCT T1.subject_id) AS Total_Patients\nFROM patients T1\nJOIN admissions T2 ON T1.subject_id = T2.subject_id\nJOIN transfers T3 ON T2.subject_id = T3.subject_id\nWHERE T3.eventtype = 'copy prescription';",
    "2882cabf6e0939d1a7ecca52": "WITH LastMonthAdmissions AS (\n    SELECT\n        p.subject_id,\n        p.gender,\n        p.dob,\n        a.admittime,\n        a.dischtime,\n        ROW_NUMBER() OVER (PARTITION BY p.subject_id ORDER BY a.admittime) AS admission_order\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE a.admittime >= DATE('now', 'start of month', '-1 month')\n),\nFirstAdmission AS (\n    SELECT\n        subject_id,\n        gender,\n        dob,\n        admittime,\n        dischtime\n    FROM LastMonthAdmissions\n    WHERE admission_order = 1\n),\nAgeAtAdmission AS (\n    SELECT\n        subject_id,\n        gender,\n        (strftime('%J', admittime) - strftime('%J', dob)) / 365.25 AS age_at_admission\n    FROM FirstAdmission\n)\nSELECT\n    AVG(age_at_admission) AS median_age\nFROM (\n    SELECT age_at_admission\n    FROM AgeAtAdmission\n    ORDER BY age_at_admission\n    LIMIT 2 - (SELECT COUNT(*) FROM AgeAtAdmission) % 2\n    OFFSET (SELECT (COUNT(*) - 1) / 2 FROM AgeAtAdmission)\n)",
    "6e638207c190b2bfc104c8ce": "SELECT T1.subject_id, T1.gender, T2.hadm_id\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN diagnoses_icd AS T3 ON T2.hadm_id = T3.hadm_id\nINNER JOIN d_icd_diagnoses AS T4 ON T3.icd_code = T4.icd_code\nWHERE T4.long_title LIKE '%Hypertension%'\nAND T1.gender = 'Female';",
    "9813253dbdee465b9e47ac5e": "SELECT long_title\nFROM d_icd_procedures\nWHERE long_title LIKE '%idea of an international organization for food%';",
    "aaded7e531d63261d7e08157": "SELECT T1.route AS route\nFROM prescriptions AS T1\nJOIN patients AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.gender = 'Female' OR T2.gender = 'Male'\nAND T2.dob < '2010-01-01'\nGROUP BY T1.route\nORDER BY COUNT(*) DESC\nLIMIT 1;",
    "201669edbbf8a7370e1a5bf6": "SELECT drug \nFROM prescriptions \nWHERE drug = 'Celestone';",
    "5d8d44474b013c5673581998": "SELECT DISTINCT careunit\nFROM icustays\nWHERE careunit LIKE '%area size larger than 1000 square feet%';",
    "7bc817217b3da62394e8dec8": "SELECT MIN(age) AS min_age\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures p2 ON pr.icd_code = p2.icd_code\nWHERE p.gender = 'Male'\n  AND p2.long_title = 'Prochlorperazine maleate'\n  AND d2.long_title = 'Prochlorperazine maleate';",
    "b5704c126bc27a7b3e42628a": "SELECT t.value AS companion_telephone_number\nFROM d_labitems d\nJOIN labevents t ON d.itemid = t.itemid\nJOIN patients p ON t.subject_id = p.subject_id\nWHERE p.subject_id = 273 AND d.label = 'Companion Telephone Number';",
    "8ef1358c8e787e3b1ea7fad0": "SELECT gender AS major FROM patients WHERE dod IS NULL;",
    "b5f3104776346d61b316a145": "SELECT admission_type\nFROM admissions\nWHERE admission_location = 'micu'\nGROUP BY admission_type\nORDER BY COUNT(admission_type) DESC\nLIMIT 1;",
    "179bf167c286b5f0fde2a9af": "SELECT label FROM d_labitems LIMIT 1;`. However, the question \"Which label was that?\" is ambiguous and can be interpreted in multiple ways. For the sake of this task, we will assume that the question is asking for a specific label from the `d_labitems` table, but without additional context, it's impossible to determine which specific label is being referred to. Therefore, we will provide a query that retrieves all labels from the `d_labitems` table for the user to choose from.",
    "62351eb9c74c2c464077bb48": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd AS p\nJOIN icustays AS i ON p.hadm_id = i.hadm_id\nWHERE i.last_careunit = 'Neuro ICU';",
    "706b02d8754a0238a2b818aa": "SELECT label\nFROM d_labitems\nWHERE label LIKE '%pediatric care%' OR label LIKE '%advancements%';",
    "5e79f764b9533eb69c07c4d0": "SELECT DISTINCT event_type\nFROM cost;",
    "5c02f7ac0c5c557d72d6fe5f": "SELECT *\nFROM patients\nWHERE subject_id = 1;",
    "420bccb119240479b01959f1": "SELECT inventor\nFROM PlayStationInventors\nORDER BY year\nLIMIT 1;",
    "2036c83624be19f6568997c6": "SELECT subject_id, gender, dob\nFROM patients\nWHERE gender = 'Female'\nAND LOWER(dob) LIKE '%seattle%'\nORDER BY dob DESC\nLIMIT 1;",
    "241237199afd4ab0bf19fa11": "SELECT \n  drug,\n  COUNT(*) AS total_prescriptions\nFROM \n  prescriptions\nWHERE \n  strftime('%Y', starttime) = strftime('%Y', 'now')\nGROUP BY \n  drug\nORDER BY \n  total_prescriptions DESC\nLIMIT 1;",
    "619c0d97069b2720eecadf4c": "",
    "f1e94bfbd8a4acb2b97f0185": "SELECT \n    DISTINCT insurance\nFROM \n    admissions\nWHERE \n    insurance = 'Non-technical';",
    "1d40c79522236fb151c0465a": "SELECT title\nFROM publications\nWHERE title LIKE '%ac on chrn grft-vs-host%'\nORDER BY title DESC\nLIMIT 10;",
    "d259847dbbc43592b3e84f39": "SELECT \n  'Health Insurance Card' AS document_type,\n  'Identification Card' AS document_type,\n  'Release of Information Form' AS document_type;",
    "b15ea4eb1bb9661e3b9dd6d0": "",
    "2bfbfac869d7a901aa75a0e7": "SELECT DISTINCT currency \nFROM patients p \nJOIN cost c ON p.subject_id = c.subject_id \nWHERE p.dob < '2070-01-01' \nAND c.event_type = 'Currency'; -- Assuming there's an event_type indicating currency usage in the cost table",
    "5d836a81b5ce8992269a142c": "SELECT p.gender\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug = 'oseltamivir';",
    "91962d52a73615ffad6e748c": "",
    "065b020277adeeaf7b2334bf": "WITH patient_demographics AS (\n    SELECT \n        p.subject_id,\n        p.gender,\n        p.dob,\n        p.dod,\n        a.admittime,\n        a.dischtime,\n        a.admission_type,\n        a.admission_location,\n        a.discharge_location,\n        a.insurance,\n        a.language,\n        a.marital_status,\n        a.age\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n),\ntop_procedures AS (\n    SELECT \n        d_icd_procedures.long_title,\n        COUNT(*) AS procedure_count\n    FROM procedures_icd\n    INNER JOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\n    GROUP BY d_icd_procedures.long_title\n    ORDER BY procedure_count DESC\n    LIMIT 5\n)\nSELECT \n    pd.subject_id,\n    pd.gender,\n    pd.dob,\n    pd.dod,\n    pd.admittime,\n    pd.dischtime,\n    pd.admission_type,\n    pd.admission_location,\n    pd.discharge_location,\n    pd.insurance,\n    pd.language,\n    pd.marital_status,\n    pd.age,\n    tp.long_title,\n    tp.procedure_count\nFROM patient_demographics pd\nCROSS JOIN top_procedures tp;",
    "1e4e8dd0ff34ae33dcd8af9c": "WITH DiagnosisCounts AS (\n    SELECT icd_code, COUNT(*) AS diagnosis_count\n    FROM diagnoses_icd\n    GROUP BY icd_code\n),\nTop10Diagnoses AS (\n    SELECT icd_code, diagnosis_count\n    FROM DiagnosisCounts\n    ORDER BY diagnosis_count DESC\n    LIMIT 10\n),\nTotalDiagnoses AS (\n    SELECT SUM(diagnosis_count) AS total_count\n    FROM DiagnosisCounts\n)\nSELECT \n    icd_code,\n    diagnosis_count,\n    (diagnosis_count * 100.0 / total_count) AS percentage\nFROM Top10Diagnoses, TotalDiagnoses;",
    "acc0c0cdef161a9284612252": "WITH DiagnosisCounts AS (\n    SELECT \n        hadm_id,\n        COUNT(DISTINCT icd_code) AS diagnosis_count\n    FROM diagnoses_icd\n    GROUP BY hadm_id\n),\nAnesthesiaDurations AS (\n    SELECT \n        hadm_id,\n        SUM(\n            CASE \n                WHEN itemid = (SELECT itemid FROM d_items WHERE label = 'Anesthesia Duration')\n                    THEN valuenum \n                ELSE 0 \n            END\n        ) AS total_anesthesia_duration\n    FROM chartevents\n    GROUP BY hadm_id\n)\nSELECT \n    AVG(ad.total_anesthesia_duration) AS average_anesthesia_duration\nFROM AnesthesiaDurations ad\nINNER JOIN DiagnosisCounts dc ON ad.hadm_id = dc.hadm_id\nWHERE dc.diagnosis_count > 10;",
    "c9c78d7791bc4da8fbbd4eaa": "SELECT \n    p.subject_id,\n    p.gender,\n    p.dob,\n    p.dod,\n    a.hadm_id,\n    a.admittime,\n    a.dischtime,\n    a.admission_type,\n    a.admission_location,\n    a.discharge_location,\n    a.insurance,\n    a.language,\n    a.marital_status,\n    a.age,\n    c.charttime AS feedback_time,\n    c.itemid,\n    c.valuenum,\n    c.valueuom,\n    d.label AS feedback_label\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    chartevents c ON a.hadm_id = c.hadm_id\nJOIN \n    d_items d ON c.itemid = d.itemid\nWHERE \n    c.itemid = 12345; -- Assuming 12345 is the itemid for audio feedback",
    "a24c812c12df25630c3e42a2": "SELECT 'pharaoh' AS pharaoh, 'neighbor' AS neighbor;",
    "1d55a2cb2075c095159fdcf5": "WITH LabItemTests AS (\n  SELECT \n    l.itemid,\n    COUNT(l.charttime) AS test_count\n  FROM \n    labevents l\n  GROUP BY \n    l.itemid\n)\nSELECT \n  l.itemid,\n  l.test_count,\n  CASE \n    WHEN l.test_count <= 10 THEN 'Low'\n    WHEN l.test_count BETWEEN 11 AND 50 THEN 'Medium'\n    ELSE 'High'\n  END AS test_frequency_cluster\nFROM \n  LabItemTests l;",
    "dcb81ae72e1d1a8401a39e97": "SELECT DISTINCT d.long_title\nFROM diagnoses_icd i\nINNER JOIN d_icd_diagnoses d ON i.icd_code = d.icd_code\nWHERE d.long_title LIKE '%hypertension%'\nAND d.long_title IS NOT NULL;",
    "7850fd4718ef0345b66f16ee": "WITH PatientAge AS (\n    SELECT \n        p.subject_id,\n        CAST((julianday(p.dod) - julianday(p.dob)) / 365.25 AS REAL) AS age\n    FROM patients p\n),\nPatientPrescriptions AS (\n    SELECT \n        pr.subject_id,\n        pr.drug\n    FROM prescriptions pr\n),\nPatientCluster AS (\n    SELECT \n        pa.subject_id,\n        pa.age,\n        pp.drug,\n        NTILE(4) OVER (ORDER BY pp.drug, pa.age) AS cluster_id\n    FROM PatientAge pa\n    JOIN PatientPrescriptions pp ON pa.subject_id = pp.subject_id\n)\nSELECT \n    subject_id,\n    age,\n    drug,\n    cluster_id\nFROM PatientCluster\nORDER BY cluster_id, age, drug;",
    "6b38a2ea311d353bab0db4b1": "SELECT COUNT(p.hadm_id) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.age > 65\n  AND d.long_title LIKE '%anesthesia%'\n  AND (julianday(p.charttime) - julianday(a.admittime)) > 2;",
    "e8057790cfb3bf1907c60c42": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nWHERE \n    a.subject_id IN (\n        SELECT \n            subject_id\n        FROM \n            admissions\n        GROUP BY \n            subject_id\n        HAVING \n            COUNT(hadm_id) > 1\n    )\n    AND p.gender = 'Male' -- Assuming the question meant to filter by gender, as the reference solution was incorrect in using a gender filter\n;",
    "e6a16146de655c76e0a5a66e": "SELECT AVG(T1.cost) AS average_cost\nFROM cost AS T1\nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.language = 'boston' AND T1.event_type = 'procedure';",
    "4d790b43564658ab3b4e0d03": "SELECT COUNT(*) \nFROM procedures_icd AS pi \nINNER JOIN admissions AS a ON pi.hadm_id = a.hadm_id \nINNER JOIN d_icd_procedures AS dicd ON pi.icd_code = dicd.icd_code \nWHERE strftime('%Y', a.admittime) = strftime('%Y', 'now') \nAND dicd.long_title = 'Cardiac Cath Lab' \nAND pi.charttime IS NOT NULL;",
    "9472d82ca22999ff5c901966": "SELECT \n    gender \nFROM \n    patients \nWHERE \n    gender = 'Male';",
    "ea02cf51a42cf529313b5bcc": "SELECT valueuom\nFROM (\n    SELECT valueuom\n    FROM chartevents\n    INNER JOIN admissions ON chartevents.hadm_id = admissions.hadm_id\n    WHERE strftime('%Y', admissions.admittime) = strftime('%Y', 'now')\n    GROUP BY chartevents.subject_id, valueuom\n    HAVING COUNT(*) > 2\n)\nGROUP BY valueuom\nORDER BY COUNT(*) DESC\nLIMIT 1;",
    "6e494bdfe5023a25242b95f9": "SELECT d.phone_number\nFROM patients p\nINNER JOIN doctor_patients dp ON p.subject_id = dp.subject_id\nINNER JOIN doctors d ON dp.doctor_id = d.doctor_id\nWHERE p.subject_id = 57023;",
    "2336788b39320ddc3aab7dfd": "SELECT long_title\nFROM d_icd_procedures\nWHERE long_title LIKE '%fast-acting insulin%';",
    "721452586d364928353c1138": "SELECT MIN(starttime) AS next_mri_time\nFROM inputevents\nWHERE subject_id = 17462\n  AND itemid = 12345;",
    "73fb93b17e794549d7aefcf1": "SELECT T1.subject_id, T1.emergency_contact\nFROM patients AS T1\nJOIN diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nJOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Pneumonia';",
    "1920549178d2063f406d999f": "SELECT \n    SUBSTR(p.drug, 1, INSTR(p.drug, ' ') - 1) AS drug_manufacturer,\n    COUNT(*) AS total_prescriptions\nFROM prescriptions p\nWHERE strftime('%Y', p.starttime) = strftime('%Y', 'now')\nGROUP BY SUBSTR(p.drug, 1, INSTR(p.drug, ' ') - 1)\nORDER BY total_prescriptions DESC\nLIMIT 5;",
    "346a6b1c95d407dd60ff4583": "SELECT AVG(T2.valuenum) AS average_blood_glucose_level\nFROM patients AS T1\nINNER JOIN admissions AS T3 ON T1.subject_id = T3.subject_id\nINNER JOIN labevents AS T2 ON T3.hadm_id = T2.hadm_id\nINNER JOIN d_labitems AS T4 ON T2.itemid = T4.itemid\nWHERE T1.gender = 'M' AND T4.label LIKE '%Blood Glucose%';",
    "d2b91a51e6ef4727feef548d": "SELECT MAX(child_age) AS oldest_first_child_age\nFROM AgeOfFirstChild;",
    "ab60620a256593c8855554f9": "SELECT \n  drug,\n  COUNT(*) AS frequency\nFROM \n  prescriptions\nWHERE \n  dose_val_rx = '0.5'\n  OR dose_val_rx = '1'\n  OR dose_val_rx = '1.5'\n  OR dose_val_rx = '2'\n  OR dose_val_rx = '4'\n  OR dose_val_rx = '8'\nGROUP BY \n  drug\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "5ff822748f260f0d813bfe27": "",
    "0c7166b81fe901725b7eb628": "SELECT SUM(T1.cost) AS total_cost\nFROM cost AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.admission_type = 'expected'\nAND T2.admittime >= DATE('now')\nAND T2.admittime < DATE('now', '+1 month')\nORDER BY T2.admittime DESC;",
    "8597515e0287991c861f671c": "",
    "6d76715f3b8643d188af9795": "SELECT DISTINCT p.gender\nFROM prescriptions pr\nINNER JOIN patients p ON pr.subject_id = p.subject_id\nWHERE pr.drug = 'lidocaine-prilocaine';",
    "c31cb18da6bbbe1066aeb6be": "SELECT AVG(strftime('%J', T2.outtime) - strftime('%J', T2.intime)) AS average_stay_length\nFROM patients AS T1\nINNER JOIN icustays AS T2 ON T1.subject_id = T2.subject_id\nWHERE strftime('%Y-%m', T2.outtime) = strftime('%Y-%m', 'now')\nGROUP BY T1.subject_id\nHAVING COUNT(T2.stay_id) > 1;",
    "dfd68a634cff11f0c7c9dbce": "SELECT 'I am not sure why they were not happy with it.';",
    "056fb750773e90aa030e9950": "SELECT\n    'asian' AS race,\n    COUNT(*) AS patient_count\nFROM\n    patients\nWHERE\n    gender = 'asian';",
    "a596ed8ea35947b5f68e0e42": "SELECT AVG(area_size) AS average_area_size\nFROM patients p\nINNER JOIN transfers t ON p.subject_id = t.subject_id\nWHERE t.eventtype = 'language spoken' AND t.careunit = 'English';",
    "536ee0098a55182b75db4447": "WITH procedures_with_cancer AS (\n    SELECT p.subject_id, \n           pr.icd_code, \n           pr.charttime AS procedure_time,\n           d.long_title AS procedure_name\n    FROM patients p\n    JOIN diagnoses_icd d_i ON p.subject_id = d_i.subject_id\n    JOIN d_icd_diagnoses d ON d_i.icd_code = d.icd_code\n    JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n    WHERE d.long_title = 'Cancer'\n)\nSELECT MAX(julianday(pwcd.procedure_time) - julianday(pwcd.procedure_time)) AS max_procedure_duration\nFROM procedures_with_cancer pwcd;",
    "b50c0b91629c3e1eb8c1e1bf": "SELECT \n  T1.label AS mri_result\nFROM \n  labevents AS T2\n  INNER JOIN d_labitems AS T1 ON T2.itemid = T1.itemid\nWHERE \n  T2.subject_id = 11823 \n  AND T1.label LIKE '%MRI%';",
    "6cf1b55a68678674858c540c": "SELECT\n    language,\n    marital_status,\n    COUNT(*) AS admission_count\nFROM\n    admissions\nGROUP BY\n    language,\n    marital_status\nORDER BY\n    language,\n    marital_status;",
    "3c480ed464a8bb7f48ac6ad3": "",
    "a56ff0957a284d651e7e8abc": "SELECT DISTINCT label\nFROM d_labitems\nWHERE label IN ('Insurance Information', 'Discharge Instructions', 'Patient Handover Form');",
    "fde3bbc35e10c13131806d0b": "SELECT \n    p.gender, \n    COUNT(pr.subject_id) AS prescription_count\nFROM \n    prescriptions pr\nJOIN \n    patients p ON pr.subject_id = p.subject_id\nWHERE \n    pr.drug = 'magnesium sulfate'\nGROUP BY \n    p.gender;",
    "706174ad5a8f8d55b224dbdf": "SELECT COUNT(*) AS total_transfers\nFROM transfers\nWHERE eventtype LIKE 'complication%';",
    "de4cad0d0244ec1d5096631b": "WITH diabetes_patients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    WHERE d.icd_code LIKE 'E11%'\n)\nSELECT pr.drug, m.manufacturer, COUNT(dp.subject_id) AS patient_count\nFROM diabetes_patients dp\nINNER JOIN prescriptions pr ON dp.subject_id = pr.subject_id\nLEFT JOIN manufacturers m ON pr.drug = m.drug\nGROUP BY pr.drug, m.manufacturer\nHAVING patient_count > 0;",
    "35fbd2bb7e73dec7b0390bfd": "SELECT \n    p.subject_id,\n    a.hadm_id,\n    p.gender,\n    a.admission_type,\n    a.admission_location,\n    a.discharge_location\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id;",
    "c8423168c30a91e86bd3a8fa": "",
    "7d1731d972d68642a1d92376": "",
    "7e49fe05e122e02f7b4dbc43": "SELECT 'No' AS appointment\nFROM patients p\nWHERE p.subject_id = 64983;",
    "6f03fb45abf03355fdf2ebe5": "SELECT AVG(T1.age) AS average_age\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN diagnoses_icd AS T3 ON T2.hadm_id = T3.hadm_id\nINNER JOIN d_icd_diagnoses AS T4 ON T3.icd_code = T4.icd_code\nWHERE T4.long_title LIKE '%hypertension%'\nAND T1.gender = 'F';",
    "b10d95d377e7fd96548c50cd": "SELECT \n       subject_id \n   FROM \n       admissions \n   WHERE \n       insurance = 'Medicaid';",
    "04ed4b01566a9c408fc5f3cc": "SELECT p.dob\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title = 'Computer Science';",
    "e6233b691d261b0b5d750d60": "SELECT \n  l.valuenum,\n  l.valueuom\nFROM labevents l\nINNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 20066\nAND d.label = 'petct';",
    "542be8111ffc89db7639ec01": "",
    "5feeffebbdb00685b21e88a4": "SELECT \n  subject_id \nFROM \n  patients \nWHERE \n  dob < '1900-01-01' AND \n  gender = 'Male';",
    "c98c060929248bcba6628b8e": "SELECT \n  discharge_location\nFROM \n  admissions\nWHERE \n  subject_id = 72909;",
    "b7b46d74fb37a9539786e740": "SELECT \n  CASE \n    WHEN NOT EXISTS (SELECT 1 FROM labevents WHERE subject_id = 17667 AND charttime IS NOT NULL)\n    AND NOT EXISTS (SELECT 1 FROM outputevents WHERE subject_id = 17667 AND charttime IS NOT NULL)\n    AND NOT EXISTS (SELECT 1 FROM chartevents WHERE subject_id = 17667 AND charttime IS NOT NULL)\n    AND NOT EXISTS (SELECT 1 FROM inputevents WHERE subject_id = 17667 AND starttime IS NOT NULL)\n    THEN 'Pending'\n    ELSE 'All Tests Completed'\n  END AS test_status;",
    "1eac08ba1f265c3c327b62c1": "",
    "e4af8f1ba3897fc0635abfa6": "SELECT labevents.valuenum\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE d_labitems.label = 'Telephone Number of Companion'\nAND labevents.subject_id = 25312;",
    "14dfee8ea5e8f46e6c25dd3b": "SELECT long_title FROM d_icd_diagnoses WHERE icd_code = '01170' AND long_title = 'Diagnosis Description';",
    "429abe1449551a068765e97e": "SELECT long_title\nFROM d_icd_diagnoses\nWHERE icd_code IN (\n  SELECT icd_code \n  FROM diagnoses_icd\n  WHERE subject_id IN (\n    SELECT subject_id \n    FROM admissions\n    WHERE admission_type = 'discharge'\n  )\n);",
    "ba6ba59aff69aa182b6e11ff": "SELECT AVG(1.0 * CAST(valueuom AS REAL) / CAST(valuenum AS REAL)) AS avg_speed_knots\nFROM chartevents\nINNER JOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE d_items.label = 'Speed' AND d_items.valueuom = 'mph' AND chartevents.stay_id IN (\n    SELECT stay_id\n    FROM icustays\n    WHERE last_careunit = 'csru'\n);",
    "601cdbff25250c54ae7b604d": "",
    "da0649deb95e705d44b3a6bd": "SELECT 'How to make bake potato in oven' AS query;",
    "9c12b1908eecc96921e5b09d": "SELECT COUNT(DISTINCT subject_id)\nFROM admissions\nWHERE language = 'English';",
    "dcd918b9b383d4c8b82d525a": "",
    "39de5025dda78c678bc23c91": "",
    "d2195d39e2bb7f411ae6ced6": "SELECT DISTINCT drug\nFROM prescriptions;",
    "542d6858a652ca64dd64426b": "",
    "47b01aea87ca3478567aeb58": "SELECT \n    admission_location AS least_common_airport,\n    COUNT(*) AS patient_count\nFROM \n    admissions\nWHERE \n    marital_status = 'Married' AND\n    insurance = 'Hispanic or Latino' AND\n    language = 'English'\nGROUP BY \n    admission_location\nORDER BY \n    patient_count ASC\nLIMIT 1;",
    "068adca6e566c9ea7450afd5": "SELECT telephone_number\nFROM patients\nWHERE subject_id = 22449;",
    "0577cc7be3dde491281e4ffb": "SELECT \n    CASE \n        WHEN p.insurance = 'Medicaid' THEN '\u039c\u03b5\u03c4\u03b1\u03c6\u03c5\u03c3\u03b9\u03ba\u03cc'\n        WHEN p.insurance = 'Private' THEN '\u0399\u03b4\u03b9\u03c9\u03c4\u03b9\u03ba\u03cc'\n        ELSE '\u0386\u03bb\u03bb\u03bf'\n    END AS insurance_greek\nFROM patients p\nWHERE p.subject_id = 370;",
    "682cc16deee208a0bbd263a1": "SELECT T1.gender\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN prescriptions AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE T3.drug LIKE 'multivitamin iv'\nGROUP BY T1.gender;"
}