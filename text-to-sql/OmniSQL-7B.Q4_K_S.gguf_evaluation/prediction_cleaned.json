{
    "b9bf51c5e3af21242ac2e487": "Select the label and abbreviation columns, as these will provide information about how the medication is delivered.\n3. Filter the results to only include the item with the label 'Potassium Chl 40 Meq/1000 Ml D5NS'.",
    "71085ce4beef02dd87ed0ae5": "SELECT route\nFROM prescriptions\nWHERE drug = 'amoxicillin';",
    "14282f53339c46daadec3a20": "SELECT 'Standard Method' AS standard_method;",
    "776a4927e962a0f0d91d35e7": "SELECT \n  d_items.label\nFROM \n  d_items\nINNER JOIN inputevents ON d_items.itemid = inputevents.itemid\nWHERE \n  d_items.label = 'citrate dextrose 3% (acd-a) crrt'\nORDER BY \n  inputevents.starttime DESC\nLIMIT 1;",
    "e80f4420e687a67930a3fe82": "SELECT route\nFROM prescriptions\nWHERE drug = 'tamoxifen citrate';",
    "76e23fd708f338036f1db3a5": "SELECT DISTINCT T2.drug, T2.route\nFROM admissions T1\nINNER JOIN prescriptions T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.drug LIKE '%tramadol%'",
    "1a02966a7807415ea5d44f3e": "SELECT DISTINCT label\nFROM d_labitems\nWHERE label LIKE '%midodrine%';",
    "6360cf590c61b892d228aec3": "SELECT c.cost\nFROM cost c\nJOIN procedures_icd p ON c.event_id = p.row_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Other incision of brain';",
    "fbcce2387805995ccfb14da7": "SELECT \n    T2.cost \nFROM \n    d_icd_procedures AS T1 \nINNER JOIN \n    procedures_icd AS T3 \n    ON T1.icd_code = T3.icd_code \nINNER JOIN \n    cost AS T2 \n    ON T3.hadm_id = T2.hadm_id \nWHERE \n    T1.long_title = 'Left Heart Catheterization';",
    "5d3fdd6cfa3395ed7d31a509": "SELECT SUM(cost) AS total_cost\nFROM cost\nJOIN diagnoses_icd ON cost.event_id = diagnoses_icd.row_id\nJOIN d_icd_procedures ON diagnoses_icd.icd_code = d_icd_procedures.icd_code\nWHERE d_icd_procedures.long_title = 'Alcohol Detoxification';",
    "ea5ae93b3e09584a70590863": "",
    "3dad9658c00a426a28cd032a": "",
    "23f5cb31ebe9cc2a949960b0": "",
    "7c477af3b36987109db0d925": "",
    "6fd97088e685ba9d993b674a": "SELECT COUNT(*) AS drug_count\nFROM prescriptions\nWHERE drug = 'acetaminophen-caff-butalbital';",
    "e24decfb710d3c3dc6eab1d8": "SELECT dose_unit_rx AS price\nFROM prescriptions\nWHERE drug = 'multivitamin iv';",
    "3cf3b888f16e871e3f5f181c": "",
    "a69dfee809d4c6a558d663e8": "SELECT T2.cost\nFROM prescriptions AS T1\nINNER JOIN cost AS T2 ON T1.hadm_id = T2.event_id\nWHERE T1.drug = 'ferrous sulfate (liquid)';",
    "3a42a1f5b0ab7a9b081c5484": "SELECT T2.cost \nFROM prescriptions AS T1 \nINNER JOIN cost AS T2 ON T1.hadm_id = T2.hadm_id \nWHERE T1.drug = 'lactulose';",
    "451285f64c11d4d19cbf2a11": "SELECT drug, dose_unit_rx AS price\nFROM prescriptions\nWHERE drug = 'vitamin e';",
    "ab2b79aa3faaaa7c9d7f7f40": "SELECT cost \nFROM cost\nWHERE drug = 'buspirone';",
    "a635207e9ad6b0adfff52120": "SELECT SUM(c.cost) \nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title = 'Secondary malignant neoplasm of bone and bone marrow';",
    "37d5cb2d101d086c45aae957": "SELECT \n    c.cost \nFROM \n    cost c \nINNER JOIN \n    diagnoses_icd d \nON \n    c.event_id = d.row_id \nINNER JOIN \n    d_icd_diagnoses ddiag \nON \n    d.icd_code = ddiag.icd_code \nWHERE \n    c.event_type = 'Diagnosis' \n    AND ddiag.long_title = 'Personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits';",
    "a8225cc86d80b3c2bcb42899": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nINNER JOIN diagnoses_icd di ON c.event_id = di.row_id\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title = 'Splenomegaly';",
    "6e81a82c2e87daa57c7ae655": "SELECT c.cost\nFROM cost AS c\nJOIN diagnoses_icd AS d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses AS di ON d.icd_code = di.icd_code\nWHERE di.long_title = 'Dependence on respirator [ventilator] status';",
    "1c82eecbdc0ba4bcb2d34047": "SELECT SUM(T1.cost)\nFROM cost AS T1\nJOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nJOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Other primary cardiomyopathies';",
    "fc0f5148afa412b85497beb3": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Septicemia due to Escherichia coli (E. coli)';",
    "6594b2ea56fc3dde1c9203af": "SELECT c.cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title = 'Candidiasis of mouth';",
    "cc2d0e8abf70d2897312faf2": "SELECT gender FROM patients WHERE subject_id = 10014078;",
    "caf2ed4e7d85cf6d0cba15f8": "SELECT gender\nFROM patients\nWHERE subject_id = 10005866;",
    "7a8719784f36b469832da18e": "SELECT gender\nFROM patients\nWHERE subject_id = 10014078;",
    "0e38c978a69e475449c84fee": "SELECT gender\nFROM patients\nWHERE subject_id = 10037975;",
    "cc30aba23d4b59298a12f192": "SELECT gender \nFROM patients \nWHERE subject_id = 10038933;",
    "261994390f6de9839143e6eb": "selecting only the gender column and filtering by the `subject_id`.",
    "2d6aa3feeed3bfeb72da5fb2": "SELECT gender\nFROM patients\nWHERE subject_id = 10005348;",
    "cd552ac1f210bf943008ccac": "",
    "7e1617588226f306caaf252b": "SELECT dob \nFROM patients \nWHERE subject_id = 10007928;",
    "11f75d0b44ffab8233b7f684": "SELECT dob\nFROM patients\nWHERE subject_id = 10022281;",
    "16247191e328f040590ae2fc": "SELECT dob\nFROM patients\nWHERE subject_id = 10019568;",
    "d395d70704b10b00a4f7f1af": "SELECT dob\nFROM patients\nWHERE subject_id = 10019172;",
    "eddba4d41895f6e1c03c2a52": "SELECT dob\nFROM patients\nWHERE subject_id = 10022017;",
    "9b7032c149a5ae595cfcdf73": "SELECT dob\nFROM patients\nWHERE subject_id = 10004457;",
    "28df618041d9cc5a95d8c30d": "SELECT \n        valuenum AS weight,\n        charttime",
    "ac3aa786885a117e774dc77c": "SELECT \n    MAX(CASE WHEN rn = 1 THEN valuenum END) - MIN(CASE WHEN rn = 1 THEN valuenum END) AS weight_difference\nFROM FirstWeightMeasurements\nWHERE rn <=",
    "97a564727fd229d0a1d9c3ba": "",
    "10e5776d6866e2b43f77a084": "WITH PatientWeightCTE AS (\n    SELECT \n        p.subject_id,\n        l.charttime,\n        l.valuenum,\n        LAG(l.valuenum) OVER (PARTITION BY p.subject_id ORDER BY l.charttime) AS previous_value\n    FROM patients p\n    JOIN labevents l ON p.subject_id = l.subject_id\n    JOIN d_labitems d ON l.itemid = d.itemid\n    WHERE p.subject_id = 10018081 AND d.label = 'Weight (kg)'\n)\nSELECT \n    subject_id,\n    (valuenum - previous_value) AS weight_shift\nFROM PatientWeightCTE\nWHERE charttime = '2100-12-31 00:00:00';",
    "350e7b3e88e232febb94440c": "",
    "dc7482ecedbaea3e549bc140": "",
    "9fee7ced768b7c2b796af2ce": "SELECT\n    charttime,",
    "922e1796a0883763c0252e8b": "SELECT hadm_id \n      FROM admissions \n      WHERE",
    "efb37b1f8299f18af10b51ec": "WITH LastHospitalVisit AS (\n  SELECT \n    subject_id,\n    MAX(hadm_id) AS last_hadm_id\n  FROM \n    admissions\n  WHERE \n    subject_id = 10019568\n  GROUP BY \n    subject_id\n),\nFirstAndSecondCreatinineValues AS (\n  SELECT \n    c.subject_id,\n    c.charttime,\n    c.valuenum,\n    ROW_NUMBER() OVER (PARTITION BY c.subject_id ORDER BY c.charttime) AS row_num\n  FROM \n    chartevents c\n  INNER JOIN \n    d_items d ON c.itemid = d.itemid\n  INNER JOIN \n    LastHospitalVisit l ON c.subject_id = l.subject_id AND c.hadm_id = l.last_hadm_id\n  WHERE \n    d.label = 'Creatinine'\n)\nSELECT \n  second.valuenum - first.valuenum AS creatinine_difference\nFROM \n  FirstAndSecondCreatinineValues first\nINNER JOIN \n  FirstAndSecondCreatinineValues second ON first.subject_id = second.subject_id\nWHERE \n  first.row_num = 1 AND second.row_num = 2\nLIMIT 1;",
    "57c595ed27d732fb9989f76d": "SELECT \n    MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10038999) THEN ce.valuenum ELSE 0 END) - \n    MIN(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10038999) THEN ce.valuenum ELSE 0 END) AS difference\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE di.label = 'Monos' AND ce.subject_id = 10038999;",
    "f0713b333180377cd4e7a5ef": "WITH FirstVisit AS (\n    SELECT MIN(hadm_id) AS first_hadm_id\n    FROM admissions\n    WHERE subject_id = 10015272\n),\nFirstValue AS (\n    SELECT valuenum AS first_valuenum\n    FROM labevents\n    WHERE subject_id = 10015272\n    AND hadm_id = (SELECT first_hadm_id FROM FirstVisit)\n    AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Alkaline Phosphatase')\n    ORDER BY charttime ASC\n    LIMIT 1\n),\nSecondValue AS (\n    SELECT valuenum AS second_valuenum\n    FROM labevents\n    WHERE subject_id = 10015272\n    AND hadm_id = (SELECT first_hadm_id FROM FirstVisit)\n    AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Alkaline Phosphatase')\n    ORDER BY charttime DESC\n    LIMIT 1\n)\nSELECT \n    (second_valuenum - first_valuenum) AS difference_in_alp\nFROM \n    FirstValue, SecondValue;",
    "01b66115a27e8ec4031d99ba": "WITH LastAdmission AS (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10025612\n    ORDER BY admittime DESC\n    LIMIT 1\n)",
    "beba7369b04f1b191db5f12e": "",
    "7e5e17dca306a105f47f9bb7": "",
    "eed5de84751262898d675c22": "SELECT c.subject_id, c.hadm_id, c",
    "6b3760b9b37e0bb8f9e647f8": "SELECT MAX(charttime)\n      FROM chartevents\n      WHERE subject_id = 10014729\n        AND itemid = 22670",
    "a2438ede03e572f4af4fcd58": "SELECT itemid FROM d_items WHERE",
    "941095e5c2a9df6746e4a383": "",
    "b5ddccb2652019203e02c96e": "",
    "9ea8c0016a33c461c3a77f56": "SELECT d_items.itemid\n        FROM d_items",
    "5ae9eba9c11262b3bc8961b7": "selecting the top row.\n\n2. **Retrieve the last and second-to-last systolic blood pressure values for the last ICU stay**:\n   - We need to join the `chartevents` table with the `d_items` table to filter for the label 'Systolic Blood Pressure'.\n   - We then order the results by `charttime` in descending order to get the most recent values",
    "617d9b7140ffa467be53e5b8": "",
    "769ea1c5d6c42c47ac9a1735": "",
    "ffc47b7e01463f229eb09bce": "SELECT \n  CASE\n    WHEN MAX(CASE WHEN charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10021487 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Calcium, urine')) THEN valuenum END) > \n         MAX(CASE WHEN charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10021487 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Calcium, urine')) THEN valuenum END) \n    THEN 1 \n    ELSE 0 \n  END AS result\nFROM chartevents\nWHERE subject_id = 10021487 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Calcium, urine');",
    "ac19aaffd02ad22588a7a6e7": "",
    "fd2b88c449aa3147d9ef22a9": "SELECT \n    CASE \n        WHEN T1.valuenum > T2.valuenum THEN 'Yes'\n        ELSE 'No'\n    END AS comparison_result\nFROM \n    labevents AS T1\nINNER JOIN \n    labevents AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10004733 AND T1.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10004733)\n    AND T1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Protein')\n    AND T1.charttime > T2.charttime\n    AND T2.charttime = (SELECT MIN(charttime) FROM labevents WHERE subject_id = T1.subject_id AND hadm_id = T1.hadm_id AND itemid = T1.itemid);",
    "06ed0a3cc8ab3dc7839b7919": "",
    "96a829af0978aeef2a29366b": "SELECT \n    CASE \n        WHEN sm.valuenum < fm.valuenum THEN 'true'\n        ELSE 'false'",
    "b45fe4ea7ffaf00e84199e79": "SELECT \n    ce.charttime,\n    ce.valuenum\n  FROM chartevents ce\n  JOIN LatestICUStay lis ON ce.stay_id = lis.stay_id\n  JOIN d_items",
    "0845eda9197d9666e0b3a017": "SELECT stay_id FROM icustays WHERE subject_id",
    "7a1c80e590227785f1b6c6a6": "SELECT stay_id\n    FROM icustays\n    WHERE subject_id =",
    "a4067779dc66a630f0290603": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10019385 AND itemid = 226709) THEN ce.valuenum END) > \n             MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10019385 AND itemid = 226709 AND charttime < (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10019385 AND itemid = 226709)) THEN ce.valuenum END) \n        THEN 'greater' \n        ELSE 'not greater' \n    END AS comparison_result\nFROM chartevents ce\nWHERE ce.subject_id = 10019385 AND ce.itemid = 226709;",
    "5defc394d5a39a4bee811cf5": "SELECT \n    MAX(CASE WHEN ce.charttime = last_icu_visit THEN ce.valuenum ELSE NULL END) AS last_systolic_blood_pressure,\n    MAX(CASE WHEN ce.charttime = first_icu_visit THEN ce.valuenum ELSE NULL END) AS first_systolic_blood_pressure\nFROM \n    chartevents ce\nJOIN \n    icustays i ON ce.stay_id = i.stay_id\nWHERE \n    ce.subject_id = 10011398\n    AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Arterial Blood Pressure (Systolic)')\n    AND ce.charttime BETWEEN i.intime AND i.outtime\n    AND i.outtime = (SELECT MAX(outtime) FROM icustays WHERE subject_id = 10011398)\n    AND i.intime = (SELECT MIN(intime) FROM icustays WHERE subject_id = 10011398);",
    "18712984cf426bc265ef3c86": "SELECT itemid FROM d_items WHERE label = 'O2 saturation pulseoxymetry'\n            )\n            AND ce.subject_id = 10010",
    "49096da9fc4db23df0c9ca94": "SELECT\n    CASE\n        WHEN lm1.valuenum > lm2.valuenum THEN 'Yes'\n        ELSE 'No'\n    END AS is_greater\nFROM\n    LatestMeasurements lm",
    "0aaf715cd38172a3fec8d22f": "SELECT age\nFROM admissions\nWHERE subject_id = 10022281\nORDER BY admittime DESC\nLIMIT 1;",
    "a5dc36ab0d9765ac8ab2b0be": "SELECT age\nFROM admissions\nWHERE subject_id = 10038992\nORDER BY admittime DESC\nLIMIT 1;",
    "6a0426303656887491909d29": "",
    "8f9bd64fc45fb2e7efce6e09": "Select the necessary fields from the `admissions` table**:\n   - We need the `age` of the patient during the last hospital visit.\n   - We also need the `subject_id` to filter for the specific patient.\n\n2. **Filter by the specific `subject_id`**:\n   - We use `WHERE subject_id = 10031757` to filter for the specific patient.\n\n3. **Order by the hospital admission time to find the last visit**:\n   - We use `ORDER BY admittime DESC` to sort the admissions in descending order by the admission time.\n   - This ensures the last admission is at the top.\n\n4. **Limit the results to the last admission**:\n   - We use `LIMIT 1` to get only the last admission.\n\nHere is the final",
    "7181a0d2584214c798eeebfb": "SELECT age\nFROM admissions\nWHERE subject_id = 10000032\nORDER BY admittime ASC\nLIMIT 1;",
    "cf80e026f450ba3b1f34afca": "selects the age of the patient with `subject_id` 10035185 from the `admissions` table, orders the results by `dischtime` in descending order to get the latest admission, and limits the result to one row.\n\nHere is the step-by-step reasoning for the query:\n\n1. **Identify the Target Table**: The `admissions` table contains the `age` of the patient and the `dischtime` which indicates the time of discharge. This is the primary table we will query.\n2. **Filter by Patient ID**: The question specifies `subject_id` 10035185. We will use this ID to filter the records.\n3. **Order by Discharge Time**: To get the age from the last hospital encounter, we need to order the records by `dischtime` in descending order, so the most recent encounter is first.\n4. **Limit to One Record**: We only need the",
    "d0fede74514340f1c6713467": "",
    "f34840d2e5d80b70e76bfdec": "SELECT T1.insurance\nFROM admissions AS T1\nWHERE T1.subject_id = 10004422\nORDER BY T1.admittime DESC\nLIMIT 1;",
    "33eb641aa295e6631d41c5b9": "",
    "695375d6c1fa9fdcc62343bd": "Select the insurance information from the `admissions` table.\n3. Use `LIMIT 1` to ensure we get the first hospital encounter.",
    "cbb82c6ae494381e1e693100": "SELECT \n    insurance\nFROM \n    admissions\nWHERE \n    subject_id = 10006053\nORDER BY \n    admittime DESC\nLIMIT 1;",
    "8166e7dd802e75a9bb516018": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10022017\nAND admittime = (\n    SELECT MIN(admittime)\n    FROM admissions\n    WHERE subject_id = 10022017\n);",
    "f6b19667a6aead364aac15bf": "",
    "6938ea8746e5138601dbdae7": "SELECT \n  PERCENT_RANK() OVER (ORDER BY T2.valuenum) AS percentile_rank\nFROM \n  patients AS T1\nJOIN \n  admissions AS T3 ON T1.subject_id = T3.subject_id\nJOIN \n  labevents AS T2 ON T3.hadm_id = T2.hadm_id\nWHERE \n  T1.subject_id = 10035185 AND \n  T2.itemid = (SELECT itemid FROM d_labitems WHERE label = 'UREA NITROGEN') AND \n  T2.valuenum = 38.0 AND \n  T3.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10035185 ORDER BY admittime LIMIT 1);",
    "b88b37ae5acfee6df9247dfb": "",
    "f90fbe1a6c278c3d4b3d2829": "WITH PatientAge AS (\n    SELECT age\n    FROM admissions\n    WHERE hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10023117 ORDER BY admittime DESC LIMIT 1)\n),\nPatientEvents AS (\n    SELECT e.subject_id, e.itemid, e.charttime, e.valuenum\n    FROM chartevents e\n    INNER JOIN d_items i ON e.itemid = i.itemid\n    WHERE i.label LIKE '%magnesium%' AND e.charttime IN (\n        SELECT admittime FROM admissions WHERE hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10023117 ORDER BY admittime DESC LIMIT 1)\n    )\n),\nRankedEvents AS (\n    SELECT subject_id, itemid, charttime, valuenum,\n           PERCENT_RANK() OVER (ORDER BY valuenum) AS percentile\n    FROM PatientEvents\n)\nSELECT percentile\nFROM RankedEvents\nWHERE valuenum = 2.0;",
    "01f54f272e5f4a9bc0a7232d": "SELECT age FROM",
    "325f8e14568068a880720cc4": "",
    "1039ad255c53fd49a3e45f2f": "SELECT \n    PERCENT_RANK() OVER (ORDER BY l.valuenum) AS percentile\nFROM \n    labevents l\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nINNER JOIN \n    admissions a ON l.hadm_id = a.hadm_id\nWHERE \n    l.subject_id = 10015931 \n    AND l.charttime = (\n        SELECT MAX(charttime) \n        FROM labevents \n        WHERE subject_id = 10015931\n    )\n    AND d.label = 'Glucose'\n    AND l.valuenum = 186.0;",
    "7dc8ffd1359d41d1da9da63c": "",
    "b1f43697c74666c4701854b3": "SELECT \n    (julianday(icustays.outtime) - julianday(admissions.admittime)) * 24 AS hours_in_icu\nFROM \n    admissions\nINNER JOIN \n    icustays ON admissions.hadm_id = icustays.hadm_id\nWHERE \n    admissions.subject_id = 10018081\n    AND icustays.outtime IS NOT NULL;",
    "a4601ccbd52ea5048219a13a": "SELECT \n  julianday('now') - julianday(i.intime) AS days_since_icu_admission\nFROM \n  icustays i\nWHERE \n  i.subject_id = 1001808",
    "90eb2c78447a14389410b63f": "SELECT \n  (strftime('%s', CURRENT_TIMESTAMP) - strftime('%s', icustays.intime)) / 3600.0 AS hours_since_icu_admission\nFROM \n  icustays\nWHERE \n  icustays.subject_id = 10039831;",
    "3444c5918e4cc5369449a9b3": "",
    "ab9f098a63937bcf7a768bee": "SELECT \n  (strftime('%s', 'now') - strftime('%s', icu.intime)) / 3600.0 AS hours_since_admission\nFROM \n  icustays icu\nWHERE \n  icu.subject_id = 10018081;",
    "a08cb35b715a295797129d6f": "SELECT \n    strftime('%s', i.outtime) - strftime('%s', i.intime) AS elapsed_hours\nFROM icustays i\nJOIN admissions a ON i.hadm_id = a.hadm_id\nWHERE a.subject_id = 10039831;",
    "12c4448b67fe5aedbc6c32e2": "SELECT\n    (julianday(icu.outtime) - julianday(icu.intime)) AS days_since_admission\nFROM\n    icustays icu\nJOIN\n    admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE\n    adm.subject_id =",
    "2322a6ff73f6c9d85f8b5a42": "SELECT \n  (julianday('now') - julianday(MIN(intime))) * 24 AS elapsed_hours\nFROM \n  icustays\nWHERE \n  subject_id = 10021487 AND careunit = 'med/surg/trauma';",
    "55734b9319f9dd143aa308ee": "SELECT \n  (julianday('now') - julianday(T2.intime)) * 24 AS hours_since_first_stay\nFROM \n  admissions T1\n  INNER JOIN icustays T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.subject_id = 10004733 AND \n  T2.first_careunit = 'neurology' AND\n  T1.hadm_id = (\n    SELECT hadm_id \n    FROM icustays \n    WHERE subject_id = 10004733 \n    AND first_careunit = 'neurology'\n    ORDER BY intime ASC\n    LIMIT 1\n  );",
    "aedafdf56773a3d83e728b07": "SELECT \n    julianday('now') - MIN(icustays.intime) AS days_since_last_stay\nFROM \n    icustays\nINNER JOIN \n    admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE \n    admissions.subject_id = 10021487 \n    AND icustays.last_careunit = 'emergency';",
    "14cbab955b0cd896876914ae": "SELECT \n        ic.*\n    FROM icustays ic\n    INNER JOIN LastAdmissionCTE a ON ic.hadm_id = a",
    "43896dd8714c99844b172005": "",
    "468c08e2b6a2ad56c3a4b7ce": "",
    "66efbf3af38673128432f1ca": "",
    "5c76a4f60142e53facaaad36": "SELECT \n  (julianday('now') - julianday(d.charttime)) * 24 AS hours",
    "e02703e99cca2a83c3ce8360": "SELECT \n  (strftime('%s', T3.dischtime) - strftime('%s', T2.charttime)) / 3600 AS hours_since_diagnosis\nFROM \n  diagnoses_icd T1\n  INNER JOIN d_icd_diagnoses T4 ON T1.icd_code = T4.icd_code\n  INNER JOIN admissions T3 ON T1.hadm_id = T3.h",
    "5ba5d822e1cd7d6ea2e879f5": "SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10018081\n    ) AND icd_code = 'I10'",
    "84abf7eeac8648121f34613c": "WITH \n    FirstDiagnosis AS (\n        SELECT \n            MIN(charttime) AS first_diagnosis_time\n        FROM diagnoses_icd d\n        INNER JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\n        INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n        WHERE d.subject_id = 10018081 AND icd.long_title = 'Severe Sepsis'\n    )\n\nSELECT \n    (julianday('now') - julianday(fd.first_diagnosis_time)) * 24 AS hours_since_diagnosis\nFROM FirstDiagnosis fd;",
    "851fcf327081528d82ce552c": "",
    "b9f5b0364513fe3fe10ac23e": "WITH LastDiagnosis AS (\n    SELECT MAX(di.charttime) AS last_diagnosis_time\n    FROM diagnoses_icd di\n    INNER JOIN admissions ad ON di.hadm_id = ad.hadm_id\n    WHERE di.icd_code = 'E12' AND ad.subject_id = 10004733\n),\nNowTime AS (\n    SELECT 'now' AS current_time\n)\nSELECT \n    (SELECT JULIANDAY((SELECT last_diagnosis_time FROM LastDiagnosis), 'localtime')) - \n    (SELECT JULIANDAY((SELECT current_time FROM NowTime), 'localtime')) AS days_since_diagnosis;",
    "dcc1a24e525aca42e0faa8ad": "SELECT \n  (julianday('now') - julianday(d.charttime)) * 24 AS hours_since_diagnosis\nFROM \n  diagnoses_icd d\n  INNER JOIN d_icd_diagnoses dis ON d.icd_code = dis.icd_code\nWHERE \n  d.subject_id = 10021487\n  AND dis.long_title = 'Acute vascular insufficiency of intestine'\nORDER BY \n  d.charttime DESC\nLIMIT 1;",
    "b037cad3311b5d427cda5306": "WITH BasophilsTest AS (\n    SELECT\n        le.subject_id,\n        le.charttime\n    FROM labevents le\n    JOIN d_labitems li ON le.itemid = li.itemid\n    WHERE li.label = 'Basophils'\n)\nSELECT\n    MAX(julianday(bt.charttime) - julianday(a.admittime)) AS days_since_admission\nFROM BasophilsTest bt\nJOIN admissions a ON bt.subject_id = a.subject_id\nWHERE bt.subject_id = 10018081;",
    "fc9243a5cde088d80aaae29a": "SELECT \n  (strftime('%s', T1.charttime) - strftime('%s', T2.admittime)) / 3600.0 AS hours_since_admission\nFROM \n  labevents T1\nINNER JOIN \n  admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.subject_id = 10021487 \n  AND T1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'AST')\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "90b5ca0a939ce91e8678e9e2": "SELECT \n    JULIANDAY('now') - JULIANDAY(T1.charttime) AS days_since_test\nFROM",
    "b2aa7e4ded1cb22312719f24": "SELECT \n  (julianday('now') - julianday(MIN(charttime))) * 24 AS hours_since_test\nFROM \n  labevents\nWHERE \n  subject_id =",
    "de82a5b21bc173cb82992e90": "SELECT \n    julianday(e.charttime) - julianday(a.admittime) AS days_since_admission\nFROM \n    admissions a\nJOIN \n    labevents e ON a.hadm_id = e.hadm_id\nJOIN \n    d_labitems i ON e.itemid = i.itemid\nWHERE \n    a.subject_id = 10021487\n    AND i.label = 'Amylase, Pleural'",
    "e76832974c5806793c6d4c8a": "",
    "23dd8572482a3b9ef2437c37": "SELECT itemid FROM d_labitems",
    "b9271c00a9f5d1cda644a8f7": "",
    "56d7f83c3d047987d4f5ad6a": "",
    "d5598306e9ea4771b948f856": "",
    "86522357b4bc14150a100527": "SELECT icu.*\n    FROM icustays icu\n    JOIN admissions adm ON icu.hadm_id = adm.hadm_id",
    "b3f250788370221cd33bdb7b": "SELECT hadm_id FROM icustays WHERE subject_id = 10018081\n    )\n  ORDER BY\n    inputevents.starttime ASC",
    "a19d8f8790ee9cc3b62ce290": "SELECT \n    MIN(T1.starttime) AS first_input",
    "8fa5e7278b3b5b9b839b6135": "",
    "653e63e266f88f5e4752d092": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10020740\nORDER BY admittime ASC\nLIMIT 1;",
    "129654f0722de6dae2867660": "SELECT \n  admission_type\nFROM \n  admissions\nWHERE \n  subject_id = 10018423\nORDER BY \n  admittime ASC\nLIMIT 1;",
    "6fd5e2805d0a42a23c2787ff": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10018081\nORDER BY admittime\nLIMIT 1;",
    "68c085ad9374a9c886e43355": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10019917\nORDER BY admittime DESC\nLIMIT 1;",
    "60f8d59c27fe673230ac2a83": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10006053 \nLIMIT 1;",
    "94cd2d4043d712084245bed1": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10020740\nORDER BY admittime ASC\nLIMIT 1;",
    "8df120a9e3e8d73de47c1a11": "SELECT \n    admission_type \nFROM \n    admissions \nWHERE \n    subject_id = 10011398 \nORDER BY \n    admittime DESC \nLIMIT 1;",
    "1b6f72d94895e62f9e279e35": "",
    "b82dba86a4b2a808ab2cef89": "SELECT MAX(charttime) AS last_measurement_time,valuenum AS last_weight\nFROM chartevents\nWHERE subject_id = 10011398\n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\n  AND charttime >= DATE('now', '-30 months')",
    "63359ce4687532a538d1238d": "SELECT\n  p.subject_id,\n  p.gender,\n  d.valueuom,\n  d.valueuom AS weight_unit,\n  d.charttime,\n  d.valuenum AS weight\nFROM\n  patients p\n  INNER JOIN chartevents d ON p.subject_id = d.subject_id\n  INNER JOIN d_items di ON d.itemid = di.itemid\nWHERE\n  p.subject_id = 10009628\n  AND di.label = 'Weight'\n  AND d.charttime > DATE('now', '-25 months')\nORDER BY\n  d.charttime DESC\nLIMIT 1;",
    "27ce9933ce0b1542c2dd468c": "SELECT \n  c.valuenum\nFROM \n  chartevents c\nJOIN \n  d_items i ON c.itemid = i.itemid\nWHERE \n  c.subject_id = 10036156\n  AND i.label = 'Weight'\nORDER BY \n  c.charttime ASC\nLIMIT 1;",
    "9cd37fc842ad70310d54ee58": "SELECT valuenum, valueuom\nFROM chartevents\nWHERE subject_id = 10027602\n  AND itemid = (SELECT row_id FROM d_items WHERE label = 'Weight')\n  AND charttime > DATE('now', '-5 months')\nORDER BY charttime\nLIMIT 1;",
    "689684471cdf1a2cea58ca7c": "SELECT itemid FROM d_labitems WHERE label = 'Weight')\n  AND A",
    "5b70769cdf8e342b6b7432c8": "",
    "84ffe2eecf94db13c293cd18": "SELECT \n  d.long_title AS diagnosis_title\nFROM \n  diagnoses_icd di\n  INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n  di.subject_id = 10006580\n  AND di.charttime > DATE('now', '-1 year')\nORDER BY \n  di.charttime DESC\nLIMIT 1;",
    "531d3b5c9daeaf625b709381": "SELECT d.long_title\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE a.subject_id = 10025612\nAND di.charttime > DATE('now', '-1 year')\nORDER BY di.charttime DESC\nLIMIT 1;",
    "c382285cc641ffefb4754fec": "",
    "a68a8f7c8f9c51d21140fbb2": "SELECT \n  d_diagnoses.long_title AS diagnosis\nFROM \n  diagnoses_icd icd\nJOIN \n  d_icd_diagnoses d_diagnoses ON icd.icd_code = d_diagnoses.icd_code\nWHERE \n  icd.subject_id = 10020740 \n  AND icd.charttime >= '2100-01-01'\nORDER BY \n  icd.charttime ASC\nLIMIT 1;",
    "480b667942347b982307f45c": "Select the first diagnosis**: We need to find the first diagnosis in 2100 for the patient. The `diagnoses_icd` table contains the diagnosis codes, and the `charttime` field indicates when the diagnosis was made. We will use the `MIN` function to find the earliest diagnosis.\n\n2. **Join the necessary tables**: We will join the `patients`, `admissions`, and `diagnoses_icd` tables to get the required information. The `patients` table will help us filter by the patient ID, the `admissions` table will help us filter by the year, and the `diagnoses_icd` table will provide the diagnosis information.\n\n3. **Apply filters**: We will apply filters to ensure we are looking at the correct patient and the correct year.\n\nHere is the",
    "19013f71186dd94c3663224d": "SELECT \n    d.long_title AS diagnosis\nFROM \n    diagnoses_icd icd\nINNER JOIN \n    d_icd_diagnoses d ON icd.icd_code = d.icd_code\nWHERE \n    icd.subject_id = 10029291 \n    AND icd.charttime >= '2100-01-01'\nORDER BY \n    icd.charttime ASC\nLIMIT 1;",
    "b389e224ed07b11a553f0329": "",
    "882e179f26d1d73b14ec8e40": "selecting the top one.\n\n3. **Filter by Route and Patient ID**: We need to filter the prescriptions by the route 'nu' and the patient ID 10035185.\n\n4. **Extract the Drug Name**: Finally, we need to extract the drug name from the most recent prescription.",
    "0df69b82de6a35ad5bdec3d3": "",
    "c1b92eb9d2e4ceedd614efe5": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10029291 \nAND starttime LIKE '%03/%/this_year%' \nAND route = 'iv' \nORDER BY starttime ASC \nLIMIT 1;",
    "ad08e146a6e37e3a138c8c78": "SELECT pr.drug\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE p.subject_id = 10020944\n  AND pr.route =",
    "5bb6c677596960ca463e9a0c": "SELECT drug, route, dose_unit_rx\nFROM prescriptions\nWHERE subject_id = 10038933\n  AND hadm_id = (SELECT MIN(hadm_id) FROM admissions WHERE subject_id = 10038933)\n  AND route = 'td'\n  AND starttime = (SELECT MAX(starttime) FROM prescriptions WHERE subject_id = 10038933 AND hadm_id = (SELECT MIN(hadm_id) FROM admissions WHERE subject_id = 10038933) AND route = 'td');",
    "727a314e82ff330ad11ea76a": "",
    "86aa92cf8b22de77c9f101da": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10007818\nAND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10007818 ORDER BY admittime ASC LIMIT 1)\nAND route = 'replace'\nORDER BY starttime ASC\nLIMIT 1;",
    "b1230a6aa17968195ee8b217": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10003400 AND starttime > DATE('now', '-26 months')\nORDER BY starttime ASC\nLIMIT 1;",
    "779440f275cacfb10aac9cd9": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10001725\nAND starttime >= DATE('now', '-28 months')\nORDER BY starttime ASC\nLIMIT 1;",
    "db9cfb9fbfbda61eb399064e": "SELECT T1.drug\nFROM prescriptions T1\nJOIN admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.subject_id = 10022041\nORDER BY T1.starttime DESC\nLIMIT 1;",
    "03dfaec9b60c0b6d9aa52f8a": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10021118 \nAND hadm_id IN (\n    SELECT hadm_id \n    FROM admissions \n    WHERE admittime >= '2021-12-01' \n    AND admittime < '2022-01-01'\n)\nORDER BY starttime DESC \nLIMIT 1;",
    "fe2d6c0f694f5a4cc2357932": "Select the Drug**: We are interested in the `drug` column from the `prescriptions` table.\n2. **Join with Patients Table**: We need to join the `prescriptions` table with the `patients` table on the `subject_id` column to ensure we are filtering by the correct patient.\n3. **Filter by Patient ID**: We add a `WHERE",
    "a0db7ff03e5bff5fb4b04f91": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10007818\n  AND hadm_id = (SELECT MAX(hadm_id) FROM prescriptions WHERE subject_id = 10007818)\nORDER BY starttime DESC\nLIMIT 1;",
    "1bc55cd8f6d690799f8c4047": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10020306\nAND starttime >= date('now', '-13 months')\nORDER BY starttime ASC\nLIMIT 1;",
    "d668bffcab5e2672863cb63b": "",
    "59e904000d52c139e656f371": "SELECT p.drug\nFROM diagnoses_icd AS d\nJOIN prescriptions AS p ON d.hadm_id = p.hadm_id\nWHERE d.subject_id = 10018081\n  AND d.icd_code IN ('E11.5', 'E11.6') -- Hyposmolality and Hyponatremia ICD-10 codes\n  AND d.charttime > (strftime('%s', 'now') - 3 * 30 * 24 * 60 * 60) * 1",
    "084bc1062af3fecf71b004b8": "SELECT DISTINCT T1.drug\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10022281\nAND T2.icd_code = 'E11.900'\nAND T1.starttime >= '2006-06-21'\nAND T1.starttime < '2006-06-22';",
    "edc9d546d2286562d9028ba2": "SELECT \n  p.subject_id,\n  d.long_title,\n  pr.drug\nFROM \n  patients p\n  INNER JOIN diagnoses_icd ddi ON p.subject_id = ddi.subject_id\n  INNER JOIN d_icd_diagnoses d ON ddi.icd_code = d.icd_code\n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  p.subject_id = 10020306\n  AND d.long_title = 'family history of malignant neoplasm of breast'\n  AND pr.starttime >= DATE('now', '-1 month')\n  AND pr.starttime < DATE('now')\n  AND pr.starttime >= ddi.charttime;",
    "188165b0d15bdb552ff80f78": "SELECT p.drug\nFROM prescriptions p\nJOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE p.subject_id = 10015931\nAND d2.long_title = 'Long term (current) use of insulin'\nAND p.starttime >= '2022-12-01'\nAND p.starttime <= '2022-12-03';",
    "274b0d1304fb6e07afcfbbda": "SELECT p.drug, p.dose_val_rx\nFROM prescriptions p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE p.subject_id = 10021487\nAND p.starttime BETWEEN d.charttime AND datetime(d.charttime, '+2 days')\nAND d2.long_title = 'Traumatic hemothorax without mention of open wound into thorax this month';",
    "fb06199e01e940e2278f83e6": "SELECT charttime FROM diagnoses_icd WHERE subject_id = 10011398 AND icd_code = 'I20' AND strftime('%Y-%m",
    "d7d06c5202d42d089c98cbcb": "",
    "0e6e7e38aaec3a977e832859": "SELECT drug\nFROM prescriptions\nWHERE hadm_id = (\n  SELECT hadm_id\n  FROM procedures_icd\n  INNER JOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\n  WHERE d_icd_procedures.long_title = 'Excision of dental lesion of jaw'\n  AND subject_id = 10019172\n)\nAND subject_id = 10019172;",
    "7e34d3539103f069ec358935": "",
    "72035c7e697aebbd36cc9933": "SELECT T1.drug\nFROM prescriptions AS T1\nJOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\nJOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10027602\nAND T2.charttime > date('now', '-1 month')\nAND T3.long_title LIKE '%endovascular (total) embolization or occlusion of head and neck vessels%'\nAND T1.hadm_id = (SELECT hadm_id FROM procedures_icd WHERE icd_code = T2.icd_code LIMIT 1)",
    "812c6c46b3324a53a45d2aeb": "SELECT p.drug\nFROM patients pat\nJOIN procedures_icd pr ON pat.subject_id = pr.subject_id\nJOIN prescriptions p ON pat.subject_id = p.subject_id\nWHERE pat.subject_id = 10027602\nAND pr.icd_code = 'L54.1'\nAND p.starttime > pr.charttime\nAND p.starttime <= DATE(pr.charttime, '+2 days')\nAND strftime('%Y-%m', p.starttime) = strftime('%Y-%m', 'now')",
    "2a11db69d8090e01bd8a342f": "",
    "7de6b061dc649d1607951286": "",
    "73f7afc22d0bf51b0967f477": "SELECT \n  p.subject_id,\n  p.hadm_id,\n  p.starttime,\n  p.drug,\n  p.dose_val_rx,\n  p.dose_unit_rx,\n  p.route\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10006053\n  AND p.starttime >= '10/2100'\n  AND p.drug = '0.9% sodium chloride'\n  ORDER BY \n    p.starttime\nLIMIT 1;",
    "0d67d0933db06596007b915d": "SELECT T1.drug, T1.dose_val_rx, T1.dose_unit_rx\nFROM prescriptions AS T1\nWHERE T1.subject_id = 10005909\n  AND T1.drug = 'phenazopyridine",
    "011101a7eeb61bc7e999e5d0": "SELECT MAX(prescriptions.row_id) AS last_prescription_row_id\nFROM prescriptions\nINNER JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id\nWHERE admissions.subject_id = 10014078\n  AND prescriptions.drug = 'ibuprofen suspension'\n  AND prescriptions.stoptime = (\n      SELECT MAX(admissions.dischtime)\n      FROM admissions\n      WHERE admissions.subject_id = 10014078\n  )\nLIMIT 1;",
    "8ddf87626d2c76b0babbc0d9": "SELECT \n    T1.subject_id,\n    T1.drug,\n    T1.dose_val_rx,\n    T1.dose_unit_rx,\n    T1.starttime,\n    T1.stoptime,\n    T2.label AS drug_label\nFROM \n    prescriptions T1\nINNER JOIN \n    d_items T2 ON T1.drug = T2.itemid\nWHERE \n    T1.subject_id = 10007795\n    AND T2.label = 'tamoxifen citrate'\nORDER BY \n    T1.starttime DESC\nLIMIT 1;",
    "28fd166cd9efc2ab844c870d": "",
    "7db7fa4ecb7523dc29380f8c": "SELECT \n    drug, \n    dose_val_rx, \n    dose_unit_rx, \n    route, \n    starttime, \n    stoptime \nFROM \n    prescriptions \nWHERE \n    subject_id = 10031757 \n    AND drug = 'acetaminophen' \n    AND dose_unit_rx = 'mg' \n    AND route = 'IV' \nORDER BY \n    starttime ASC \nLIMIT 1;",
    "63e4dddc1461b7b4506f3036": "SELECT MAX(T4.hadm_id)\n                    FROM admissions AS",
    "652c13b3ffbd655d3934525f": "SELECT SUM(T1.dose_val_rx) AS total_dose\nFROM prescriptions AS T1\nINNER JOIN patients AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.subject_id = 10020187 AND T1.drug = 'OXYCODONE (IMMEDIATE RELEASE)';",
    "ff8338b63365f7592e0f5601": "SELECT dose_val_rx\nFROM prescriptions\nWHERE subject_id = 10014354 AND drug = 'Glucose Gel';",
    "89c2d37bc8253b4bbe4a7c48": "SELECT SUM(p.dose_val_rx) AS total_pregabalin_dose\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10020944 AND a.hadm_id = 1 AND p.drug = 'pregabalin';",
    "c342b5e4b0e92d9e4a863516": "SELECT T1.dose_val_rx, T1.dose_unit_rx\nFROM prescriptions AS T1\nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.subject_id = 10011398 \nAND T1.starttime >= '2000-07-21 00:00:00' \nAND T1.drug = 'glucagon';",
    "5d1a36d000cf036649466742": "SELECT SUM(p.dose_val_rx) AS total_simvastatin_dose\nFROM prescriptions p\nWHERE p.subject_id = 10025463 AND p.drug = 'simvastatin' AND p.starttime > '2011-11-21';",
    "372eebaf1307d345c3c26b97": "",
    "21a26369d82d30e8f8036663": "SELECT SUM(CASE WHEN drug = 'Levetiracetam' THEN dose_val_rx ELSE 0 END) AS total_dose\nFROM prescriptions\nWHERE subject_id = 10016742 AND starttime > '01/2100';",
    "91c672fcc248e33a4019dadc": "SELECT drug\n  FROM prescriptions\n  WHERE subject_id = 10004733",
    "cf5ba52470d99772c0cfb0ff": "SELECT \n      drug",
    "5b8ffff4e21d176e195d9c35": "WITH TodayPrescriptions AS (\n  SELECT p.drug\n  FROM prescriptions p\n  INNER JOIN admissions a ON p.hadm_id = a.hadm_id\n  WHERE a.subject_id = 10004733 AND DATE(p.starttime) = DATE('now')\n),\nYesterdayPrescriptions AS (\n  SELECT p.drug\n  FROM prescriptions p\n  INNER JOIN admissions a ON p.hadm_id = a.hadm_id\n  WHERE a.subject_id = 10004733 AND DATE(p.starttime) = DATE('now', '-1 day')\n)\nSELECT \n  tp.drug AS today_drug,\n  yp.drug AS yesterday_drug\nFROM TodayPrescriptions tp\nFULL OUTER JOIN YesterdayPrescriptions yp ON tp.drug = yp.drug;",
    "5dc8c9a7928cb067f4b75d12": "WITH today_prescriptions AS (\n  SELECT p.row_id, p.subject_id, p.hadm_id, p.starttime, p.stoptime, p.drug, p.dose_val_rx, p.dose_unit_rx, p.route\n  FROM prescriptions p\n  WHERE p.subject_id = 10039831\n    AND DATE(p.starttime) = DATE('now')\n),\nyesterday_prescriptions AS (\n  SELECT p.row_id, p.subject_id, p.hadm_id, p.starttime, p.stoptime, p.drug, p.dose_val_rx, p.dose_unit_rx, p.route\n  FROM prescriptions p\n  WHERE p.subject_id = 10039831\n    AND DATE(p.starttime) = DATE('now', '-1 day')\n)\nSELECT tp.row_id, tp.subject_id, tp.hadm_id, tp.starttime, tp.stoptime, tp.drug, tp.dose_val_rx, tp.dose_unit_rx, tp.route\nFROM today_prescriptions tp\nLEFT JOIN yesterday_prescriptions yp ON tp.row_id = yp.row_id\nWHERE yp.row_id IS NULL;",
    "6675b86607ae8420ab26bdba": "SELECT drug\n    FROM prescriptions\n    WHERE subject_id = 10039831\n      AND starttime >= DATE('now', '-1",
    "50a2de2aeac213e640ee8dfc": "SELECT drug\n    FROM prescriptions\n    WHERE subject_id = 1001",
    "28d1d61838e9ab66ccc8ae3c": "SELECT \n    t1.drug AS \"Newly Prescribed Medication\",\n    t2.drug AS \"Medication Prescribed Yesterday\"\nFROM \n    prescriptions t1\n    LEFT JOIN prescriptions t2 ON t1.subject_id = t2.subject_id AND t1.hadm_id = t2.hadm_id AND t1.starttime >= DATE('now', '-1 day') AND t1.starttime < DATE('now') AND t2.starttime >= DATE('now', '-2 day') AND t2.starttime < DATE('now', '-1 day')\nWHERE \n    t1.subject_id = 10004733 \n    AND t1.starttime >= DATE('now', '-1 day') \n    AND t1.starttime < DATE('now');",
    "e5441310205bb859e8ca31ba": "SELECT\n    valuenum\nFROM HemoglobinReadings\nORDER BY charttime\nLIMIT 1;",
    "4710d3c9173e3759cd533b86": "SELECT \n    MIN(labevents.charttime) AS first_charttime,\n    labevents.valuenum AS first_platelet_count\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10016742\n    AND d_labitems.label = 'PLATELET COUNT'\n    AND strftime('%Y-%m', labevents.charttime) = '2000-08'\nORDER BY \n    labevents.charttime ASC\nLIMIT 1;",
    "32dc827809f2f3b381144bfc": "",
    "95de1cbfea9cbbf15a57c2e4": "SELECT first_value(value) OVER (ORDER BY charttime) AS first_value\nFROM chartevents\nWHERE subject_id = 10008454\nAND charttime LIKE '%12/%'\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'eag');",
    "bebec164cfe1ff0dced197be": "SELECT \n    l.charttime AS lab_charttime,\n    d.label AS lab_label\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10018423\n    AND d.label LIKE '% potassium, whole blood%'\nORDER BY \n    l.charttime\nLIMIT 1;",
    "0eeb80895de2cb7f545f7953": "SELECT le.valuenum\nFROM labevents le\nINNER JOIN d_labitems dli ON le.itemid = dli.itemid\nWHERE le.subject_id = 10019917\nAND le.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10019917\n    ORDER BY admittime DESC\n    LIMIT 1\n)\nAND dli.label = 'Hematocrit'\nORDER BY le.charttime\nLIMIT 1;",
    "0252bfa6857e8fa392627cbf": "",
    "4be18d3033fa1bac9d4c0223": "",
    "bda2d1d92535f2f380e83c31": "SELECT DISTINCT T1.label\nFROM d_labitems AS T1\nJOIN labevents AS T2 ON T1.itemid = T2.itemid\nWHERE T2.subject_id = 10022017\nAND T2.charttime >= '04/2100'\nORDER BY T2.charttime ASC\nLIMIT 1;",
    "22e094ace74f0664f5a0629e": "SELECT label \nFROM d_labitems \nWHERE itemid = (\n    SELECT itemid \n    FROM labevents \n    WHERE subject_id = 10023239 \n    AND strftime('%Y-%m', charttime) = '2000-06' \n    ORDER BY charttime ASC \n    LIMIT 1\n);",
    "d8d340c85d29c3512cdffb03": "",
    "1f1e33683e0ff2f0510efc21": "SELECT labevents.charttime, d_labitems.label\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10002428\nAND strftime('%m/%Y', labevents.charttime) = '07/2100'\nORDER BY labevents.charttime\nLIMIT 1;",
    "1a72596befd361ee133771b0": "SELECT d_labitems.label\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10015931 AND labevents.charttime >= '2000-05-21'\nORDER BY labevents.charttime\nLIMIT 1;",
    "ecd65c3d262d3e34018c162c": "SELECT label, charttime\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE subject_id = 10001725 \nAND charttime > DATE('now', '-9 month')\nORDER BY charttime DESC\nLIMIT 1;",
    "bd3ba61db07a88f7a5920ac6": "SELECT AVG(T2.valuenum) AS average_potassium_value\nFROM patients AS T1\nJOIN labevents AS T2 ON T1.subject_id = T2.subject_id\nJOIN d_labitems AS T3 ON T2.itemid = T3.itemid\nWHERE T1.subject_id = 10037975\nAND T3.label = 'Potassium, Whole Blood in 02/2100'\nAND T2.valueuom = 'meq/L';",
    "0c93a24758fe815a4f4bf747": "SELECT hadm_id\n    FROM labevents\n    WHERE subject_id = 10004235\n    ORDER BY hadm_id DESC\n    LIMIT 1\n) AS T2\nON T1.hadm",
    "9f0ee496296456e6f48a49a6": "",
    "89f4e7daebe9b4f5c0d96263": "SELECT \n    MAX(T1.valuenum) AS max_mchc_value\nFROM \n    chartevents AS T1\nJOIN \n    d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.subject_id = 10026354\n    AND T2.label = 'mchc'\n    AND T1.charttime BETWEEN '2022-11-01 00:00:00' AND '2022-11-30 23:59:59';",
    "a19666f04f957b696244b895": "SELECT AVG(t1.valuenum) AS avg_magnesium\nFROM labevents t1\nINNER JOIN d_labitems t2 ON t1.itemid = t2.itemid\nWHERE t1.subject_id = 10006580\n  AND t2.label = 'Magnesium'\n  AND t1.hadm_id = (\n    SELECT hadm_id FROM admissions \n    WHERE subject_id = 10006580 \n    ORDER BY admittime ASC \n    LIMIT 1\n  );",
    "aba8c9a560d7ec87a020f638": "SELECT \n  AVG(T1.value) AS average_value\nFROM \n  outputevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10021487\n  AND T1.charttime >= '2010-08-01'\n  AND T2.label IN ('Bilirubin', 'Total', 'Ascites')",
    "9941ca19aa20b45f0d59bc93": "",
    "c3edbb8f5bd0cfd4858c41be": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10027602\nAND hadm_id = 122100\nAND spec_type_desc LIKE '%Mini-bal%'\nORDER BY charttime DESC\nLIMIT 1;",
    "f6c2ec0da1bf93fc0c8595c0": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10029291\n  AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10029291\n    ORDER BY admittime\n    LIMIT 1\n  )\n  AND spec_type_desc = 'Sputum'\n  AND charttime = (\n    SELECT MIN(charttime)\n    FROM microbiologyevents\n    WHERE subject_id = 10029291\n      AND hadm_id = (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10029291\n        ORDER BY admittime\n        LIMIT 1\n      )\n      AND spec_type_desc = 'Sputum'\n  );",
    "f2be9084ce59ddbf5372d16a": "SELECT org_name \nFROM microbiologyevents \nWHERE subject_id = 10019172 \nAND test_name = 'Urine Test' \nAND charttime > DATE('now', '-1 month') \nORDER BY charttime DESC \nLIMIT 1;",
    "bbef3c6dded10fa7874540f2": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10016742 AND charttime > '2008-01-21' AND spec_type_desc = 'Sputum'\nORDER BY charttime DESC\nLIMIT 1;",
    "dd880129ab0eb4dc203813f8": "SELECT hadm_id \n    FROM",
    "f5f185ff5f7901dc7c4dd711": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10037861\nAND charttime >= '2005-01-01'\nAND spec_type_desc = 'Urine'\nAND test_name = 'First Urine Test'\nORDER BY charttime ASC\nLIMIT 1;",
    "ee3ef44107690c988c06c3e4": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10007818\n  AND charttime > '07/2100'\n  AND spec_type_desc = 'Bronchoalveolar Lavage'\n  AND test_name = 'First Culture';",
    "441abc9cec7ed48c4b29a5c3": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10002495\n  AND charttime LIKE '2100-06-%'\nORDER BY charttime ASC\nLIMIT 1;",
    "c309a617ea1462d56fdac6d2": "SELECT MIN(charttime) AS first_charttime, spec_type_desc\nFROM microbiologyevents\nWHERE subject_id = 10018501 AND charttime > '04/2100'\nGROUP BY spec_type_desc\nORDER BY first_charttime\nLIMIT 1;",
    "7782eddef35c5010b9b90ac3": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10036156\n  AND charttime > '2000-06-01'\nORDER BY charttime ASC\nLIMIT 1;",
    "38447d52a601457cc529a5b1": "",
    "2d7404fcfff0b855a4fb2fe9": "SELECT MIN(T3.charttime)\n  FROM microbiologyevents AS T3\n  WHERE T3.subject_id = 10011398\n  AND T3.h",
    "2e8d527ae93a03ae76d66369": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10007795\nAND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10007795\n    ORDER BY admittime\n    LIMIT 1\n)\nORDER BY charttime\nLIMIT 1;",
    "9720cb4a260b30525538f8b2": "SELECT \n    MIN(test_name) AS first_test_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10022281 \n    AND charttime BETWEEN '2000-06-01' AND '2000-06-30';",
    "bd164a06951b24d9fbb32e90": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10008454\n  AND strftime('%Y-%m', charttime) = strftime('%Y-%m', 'now')\nORDER BY charttime DESC\nLIMIT 1;",
    "c03994e0de214c507a8f8002": "SELECT \n  T1.charttime,\n  T1.spec_type_desc,\n  T1.test_name\nFROM \n  microbiologyevents T1\nJOIN \n  admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T2.subject_id = 10018845\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "a49efc1cdf3ebbe617aa7d26": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10008454\n  AND strftime('%Y-%m', charttime) = '2023-12'\nORDER BY charttime DESC\nLIMIT 1;",
    "fd2461146ec138678719d7e3": "SELECT T1.test_name\nFROM microbiologyevents AS T1\nINNER JOIN (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10002495\n  ORDER BY hadm_id DESC\n  LIMIT 1\n) AS T2 ON T1.hadm_id = T2.hadm_id\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "c68bc6d51b04677c09432ee6": "SELECT \n    t1.test_name AS MicrobiologyTest\nFROM \n    patients t0\nINNER JOIN \n    admissions t1 ON t0.subject_id = t1.subject_id\nINNER JOIN \n    microbiologyevents t2 ON t1.hadm_id = t2.hadm_id\nWHERE \n    t0.subject_id = 10004235\n    AND t1.hadm_id = (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10004235\n        ORDER BY admittime\n        LIMIT 1\n    )\n    AND t2.charttime = (\n        SELECT MIN(charttime)\n        FROM microbiologyevents\n        WHERE hadm_id = t1.hadm_id\n    );",
    "d738acddca870a290c446af4": "",
    "677aa66bc6c493237c9e78ee": "SELECT \n      hadm_id \n    FROM \n      admissions \n    WHERE \n      subject",
    "21f4165a3f8a7a30e0b78f54": "SELECT d_items.label\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 10009049\nAND inputevents.starttime = (SELECT MAX(starttime)\n                             FROM inputevents\n                             WHERE subject_id = 10009049\n                             AND strftime('%Y-%m-%d', starttime) = '2023-06-13')",
    "ac033d9ef9eacbfbf6ddce05": "SELECT \n    i.itemid, \n    i.totalamount, \n    i.totalamountuom\nFROM \n    inputevents i\nWHERE \n    i.subject_id = 10021487\n    AND i.starttime >= '2021-06-22'\nORDER BY",
    "0265a95e555d0c4a8c1f3d50": "select the first one.",
    "674bcd311bac8e9ec3bcdba0": "SELECT \n    d_items.label AS item_name\nFROM \n    inputevents\nINNER JOIN \n    d_items ON inputevents.itemid = d_items.itemid\nWHERE \n    inputevents.subject_id = 10020786\n    AND inputevents.starttime = '07/02/2100'\nORDER BY \n    inputevents.starttime DESC\nLIMIT 1;",
    "45ecebf7e481e6c14fdc01cd": "SELECT \n  itemid,\n  totalamount\nFROM \n  PatientInputEvents\nORDER",
    "18bf32ca58ea6def07157a60": "SELECT \n  inputevents.itemid,\n  d_items.label,\n  inputevents.totalamount,\n  inputevents.totalamountuom,\n  inputevents.starttime\nFROM \n  inputevents\nJOIN \n  icustays ON inputevents.stay_id = icustays.stay_id\nWHERE \n  inputevents.subject_id = 10029291\n  AND icustays.subject_id = 10029291\nORDER BY \n  inputevents.starttime DESC\nLIMIT 1;",
    "6f1d4f9ac8b86db76c98d50f": "SELECT d_items.label\nFROM inputevents AS ie\nINNER JOIN d_items AS di ON ie.itemid = di.itemid\nWHERE ie.subject_id = 10011398 AND ie.starttime > '2021-07-20'\nORDER BY ie.starttime ASC\nLIMIT 1;",
    "6b01b95b07df8e89058e4862": "SELECT SUM(totalamount) AS total_intake_amount\nFROM inputevents\nWHERE subject_id = 10021312\nAND starttime >= '2010-01-01' -- This date range is incorrect and should be removed.\nAND starttime < '2010-01-02' -- This date range is incorrect and should be removed.\nAND totalamountuom = 'mL';",
    "61044fc8b56af395d27bc3ca": "SELECT SUM(totalamount) AS total_amount\nFROM inputevents\nWHERE subject_id = 10006053\nAND starttime LIKE '2022-11-16%'\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'Cryoprecipitate');",
    "654af28177758d29e5368635": "SELECT totalamount\nFROM inputevents\nWHERE subject_id = 10004235\nAND starttime >= '2021-03-20'\nAND starttime < '2021-03-21'\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'lr');",
    "9e06157df2f8d7330094763f": "SELECT SUM(totalamount) AS total_amount_administered\nFROM inputevents\nWHERE subject_id = 10019917\nAND starttime >= '2023-01-28 00:00:00'\nAND starttime < '2023-01-29 00:00:00';",
    "4bc83d6264e9674296907cec": "SELECT \n  SUM(ie.totalamount) AS total_amount\nFROM \n  inputevents ie\n  INNER JOIN d_items di ON ie.itemid = di.itemid\nWHERE \n  ie.subject_id = 10027602\n  AND di.label = 'Gastric Meds'\n  AND ie.starttime LIKE '2021-11-29%';",
    "9b1a61e9a3cf7261a416c001": "SELECT SUM(totalamount) \nFROM inputevents \nWHERE subject_id = 10022017 \n  AND itemid IN (SELECT itemid FROM d_items WHERE label = 'KCL (Bolus)') \n  AND starttime LIKE '%10/03/2023%';",
    "62b637c8df8e9435c243a84a": "SELECT \n  SUM(totalamount) AS total_rbc_intake\nFROM \n  inputevents\nWHERE \n  subject_id = 10039831 AND \n  itemid = (SELECT itemid FROM d_items WHERE abbreviation = 'RBC') AND \n  starttime >= '2021-10-06';",
    "6136c38332507c02dfcc394d": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10010471 AND starttime >= '2008-06-08';",
    "032b87119c5b76d8394a9373": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10021487\n  AND starttime >= '2010-12-20 00:00:00'\n  AND starttime < '2010-12-21 00:00:00';",
    "7868c1035a69f54e888cb24c": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10020740\nAND starttime LIKE '2100-04-11%';",
    "5e583d5affb4e1b0f6e62364": "SELECT SUM(totalamount) AS total_input\nFROM inputevents\nWHERE subject_id = 10011398 AND starttime >= '2021-10-15';",
    "1652f9d26e284f0b715c9070": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10018081 AND starttime >= '2021-12-01 00:00:00';",
    "852fe0f9eab141f83e933cfd": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10018501 AND starttime = '08/10/2100';",
    "8e819ca96ee526f42389d521": "",
    "be9406622ce9314da8536fea": "SELECT \n    subject_id,\n    charttime,\n    value,\n    valueuom\nFROM \n    outputevents",
    "f6e8b06dc6af06677ce3573e": "",
    "ae9a06614595aba70dc8365e": "SELECT value \nFROM outputevents \nWHERE subject_id = 10010471 AND charttime >= '04/01/2100' \nORDER BY charttime ASC \nLIMIT 1;",
    "59e0af10bd7f401a8e0193db": "SELECT \n  T1.valueuom AS output_units,\n  T1.value AS output_value,\n  T1.charttime AS output_time\nFROM outputevents T1\nWHERE T1.subject_id = 10019172\n  AND T1.charttime >= '2003-12-21 00:00:00'\nORDER BY T1.charttime ASC\nLIMIT 1;",
    "9381ef3a83219886a02144fc": "",
    "193315d3d4b5326e56e84b77": "SELECT \n  itemid, \n  charttime, \n  value, \n  valueuom\nFROM \n  outputevents\nWHERE \n  subject_id = 10035185\n  AND charttime LIKE '2023-05-18%'\nORDER BY \n  charttime ASC\nLIMIT 1;",
    "2766c75e65819b7cf9c0fba2": "selections. The query should be simplified to focus on the output events table and filter based on the patient ID and the date.",
    "1dd5f6600a1779d3902b0c74": "SELECT SUM(ie.totalamount) AS total_blakemore_amount\nFROM inputevents ie\nJOIN d_items di ON ie.itemid = di.itemid\nWHERE ie.subject_id = 100",
    "e4f78cd53a4a70e9d10c4eea": "SELECT SUM(o.value) AS total_output\nFROM outputevents o\nINNER JOIN admissions a ON o.hadm_id = a.hadm_id\nWHERE a.subject_id = 10015931\n  AND o.charttime > '2006-12-06'\n  AND o.valueuom = 'ml'\n  AND o.charttime >= '2021-06-12';",
    "c99300a7ea88ef7b82951b42": "SELECT SUM(value) AS total_cerebral_ventricular_output\nFROM outputevents\nWHERE subject_id = 10027602 \n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Cerebral Ventricular #1 Output')\n  AND DATE(charttime) = '2023-01-27';",
    "2821799cf4699b6d8e3e4c43": "SELECT value\nFROM outputevents\nWHERE subject_id =",
    "e0ef594aee8d798aff512963": "SELECT SUM(totalamount) AS total_tf_residual_output_amount\nFROM inputevents\nWHERE itemid = (SELECT itemid FROM d_items WHERE label = 'Total Tf Residual')\nAND subject_id = 10021487\nAND DATE(starttime) = '12/16/2100';",
    "7594a1fd06d38d2b7a869964": "SELECT \n  SUM(T.totalamount) AS total_foley_volume \nFROM \n  inputevents T\nWHERE \n  T.itemid = (SELECT itemid FROM d_items WHERE label = 'Foley catheter drainage')\n  AND T.subject_id = 10004733 \n  AND T.starttime >= '2021-12-07 00:00:00';",
    "98a679829a4f28ba76a5e3dc": "SELECT \n  SUM(T1.totalamount) AS total_tf_residual_amount\nFROM \n  inputevents AS T1\nJOIN \n  d_items AS T2\nON \n  T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10007818\n  AND T2.label = 'tf residual'\n  AND T1.starttime >= '2001-01-23 00:00:00';",
    "184fc5e11e0bfc9be1a0263c": "SELECT charttime, value\nFROM outputevents\nWHERE subject_id = 10020944\n  AND DATE(charttime) =",
    "9f044b75ba284f6e96d21088": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10010471 AND charttime >= '04/11/2100';",
    "06d531ccb4fb7b80b892121f": "",
    "67c2dbeaea4791e0feb0a69b": "SELECT \n    SUM(oe.value) AS total_output\nFROM \n    outputevents oe\nWHERE \n    oe.subject_id = 10007058\n    AND oe.charttime >= '2021-10-05'",
    "b71409d570252fbb7bc7ecd0": "SELECT SUM(totalamount) AS total_output_amount\nFROM outputevents\nWHERE subject_id = 10007058\nAND charttime > '2021-03-20 00:00:00';",
    "9cb9aa60b28077c70929769c": "SELECT SUM(oe.value) AS total_output\nFROM outputevents oe\nJOIN icustays icu ON oe.stay_id = icu.stay_id\nWHERE icu.subject_id = 10018501\nAND icu.outtime = (\n    SELECT MAX(outtime)\n    FROM icustays\n    WHERE subject_id = 10018501\n);",
    "8cf47ff1a1ec5cf642c7ff41": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10020740 AND DATE(charttime) = '04/06/2100';",
    "8223111c9b4bc944555d36a9": "SELECT \n    SUM(i.totalamount) - SUM(o.value) AS net_volume\nFROM inputevents i\nJOIN outputevents o ON i.subject_id = o.subject_id AND i.hadm_id = o.hadm_id AND i.stay_id = o.stay_id\nWHERE i.subject_id = 10020944 \nAND i.starttime >= '2021-07-03 00:00:00';",
    "cfc51c8ede5f274642cc55f4": "SELECT \n    SUM(inputevents.totalamount) - SUM(outputevents.value) AS difference\nFROM \n    inputevents\nJOIN \n    outputevents \nON \n    inputevents.subject_id = outputevents.subject_id\nWHERE \n    inputevents.subject_id = 10031404 \n    AND outputevents.subject_id = 10031404\n    AND inputevents.starttime >= '06/05/2100'\n    AND outputevents.charttime >= '06/05/2100';",
    "1f2e5b03343f0c4f90575af1": "SELECT \n  (SELECT SUM(totalamount) \n   FROM inputevents \n   WHERE subject_id = 10038999 \n     AND DATE(starttime) = '2023-05-31') \n   - \n   (SELECT SUM(value) \n    FROM outputevents \n    WHERE subject_id = 10038999 \n      AND DATE(charttime) = '2023-05-31') AS difference;",
    "714cfbc303feb382801e761a": "SELECT \n    (SUM(I.totalamount) - SUM(O.value)) AS difference\nFROM \n    inputevents I\n    INNER JOIN outputevents O ON I.subject_id = O.subject_id AND I.hadm_id = O.hadm_id\nWHERE \n    I.subject_id = 10021487 \n    AND I.starttime >= '2100-07-21 00:00:00';",
    "9e01feccdfca373aaed464f2": "SELECT \n    SUM(CASE WHEN ie.itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%input%') THEN ie.totalamount ELSE 0 END) - \n    SUM(CASE WHEN ie.itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%output%') THEN ie.totalamount ELSE 0 END) AS difference\nFROM inputevents ie\nJOIN admissions a ON ie.hadm_id = a.hadm_id\nWHERE ie.subject_id = 10021666 AND ie.starttime >= '03/27/2100';",
    "1f2b5a242cc55bb7ebee0365": "SELECT \n    SUM(i.totalamount) - SUM(o.value) AS difference\nFROM \n    inputevents i\nJOIN \n    outputevents o ON i.subject_id = o.subject_id\nWHERE \n    i.subject_id = 10015272 \n    AND i.starttime >= '02/08/2100'\n    AND o.charttime >= '02/08/2100';",
    "e64af8ed53f80505d1cf19e3": "SELECT \n    (SELECT SUM(totalamount) \n     FROM inputevents \n     WHERE subject_id = 10021312 \n       AND starttime >= (julianday('now') - 155)) \n    - \n    (SELECT SUM(value) \n     FROM outputevents \n     WHERE subject_id = 10021312 \n       AND charttime >= (julianday('now') - 155)) \nAS difference;",
    "34c6a8eeee0902700d4a2885": "SELECT \n    ce.valuenum AS respiratory_rate_value\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10004422\n    AND di.label = 'Respiratory Rate'\n    AND ce.charttime = (\n        SELECT MAX(ce2.charttime)\n        FROM chartevents ce2\n        WHERE ce2.subject_id = 10004422\n        AND di.label = 'Respiratory Rate'\n        AND ce2.charttime LIKE '2023-01-22%'\n    )\nLIMIT 1;",
    "ea6a1b775d7a1387dac35ee2": "SELECT \n  ce.charttime,\n  ce.valuenum,\n  ce.valueuom\nFROM \n  chartevents ce\nJOIN \n  icustays i ON ce.stay_id = i.stay_id\nWHERE \n  i.subject_id = 10003046 \n  AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Arterial Blood Pressure Systolic')\n  AND i.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10003046)\nORDER BY \n  ce.charttime DESC\nLIMIT 1;",
    "3e69a6b789c8a2c74de0771d": "SELECT T1.valuenum \nFROM chartevents AS T1\nINNER JOIN d_items",
    "550a6a2fb0ecbf40e74fdb86": "",
    "34320356e0e8b8b03cfb94be": "",
    "880392e9b0ba16e0c00356d2": "SELECT MAX(T1.charttime) AS last_charttime, T1.valuenum AS last_respiratory_rate\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T2.label = 'Respiratory Rate'\nAND T1.subject_id =",
    "0e13e0edf9b3f935d475fa33": "SELECT \n    ce.charttime, \n    ce.valuenum\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10025612 \n    AND di.label = 'o2 saturation pulseoxymetry'\n    AND ce.charttime BETWEEN '2023-10-01 00:00:00' AND '2023-10-01 23:59:59'\nORDER BY \n    ce.charttime DESC\nLIMIT 1;",
    "068a6fbca2eb611746f77955": "",
    "8f13d57ff126b0360f9b38a9": "SELECT MIN(T1.valuenum) AS min_SpO2\nFROM chartevents T1\nINNER JOIN d_items T2 ON T1.itemid = T2.itemid\nINNER JOIN patients T3 ON T1.subject_id = T3.subject_id\nWHERE T3.subject_id = 10037975\nAND T1.charttime LIKE '2023-02-10%'\nAND T2.label = 'SpO2 (Desaturation) - Monitoring';",
    "7b7e0d370650fe79de5ab188": "",
    "fdc3e0fe626d90707f9b9320": "SELECT MAX(valuenum) AS max_heart_rate\nFROM chartevents\nWHERE subject_id = 10029291\nAND itemid IN (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'HEART RATE'\n);",
    "ec946af2d91d7d53d35312e6": "SELECT MAX( valuenum ) AS max_SpO2\nFROM labevents\nWHERE subject_id = 10019568 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'SpO2');",
    "c002c7dd1abbdad1014192e2": "SELECT \n    AVG(CASE WHEN de.valueuom = 'mmHg' THEN de.valuenum ELSE NULL END) AS avg_diastolic_bp\nFROM \n    chartevents de\n    JOIN icustays icu ON de.hadm_id = icu.hadm_id AND de.stay_id = icu.stay_id\nWHERE \n    de.subject_id = 10013049 AND\n    icu.outtime = (SELECT MAX(outtime) FROM icustays WHERE subject_id = 10013049);",
    "c4e3a7be2d01b9b7351a661d": "SELECT MAX(T1.value) AS max_systolic_bp\nFROM chartevents AS T1\nJOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T2.label = 'Mean Blood Pressure'\n  AND T1.charttime >= '2021-08-11'\n  AND T1.subject_id = 10005817;",
    "a5253b5b458dbf9c057541b0": "SELECT \n    MAX(admittime) AS last_admission_time\nFROM \n    admissions\nWHERE \n    subject_id = 10011398;",
    "f03270451ac730c92efdd5b1": "",
    "609e844629d62f94381a53ef": "SELECT MAX(admittime) AS last_admission_time\nFROM admissions\nWHERE subject_id = 10002495;",
    "82fed921fe732e9851109fa0": "SELECT MAX(admittime) AS last_admission_time\nFROM admissions\nWHERE subject_id = 10016150;",
    "c9887571dd618b516d5a3741": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10003046\nORDER BY admittime\nLIMIT 1;",
    "b357f1cf8213ef5655a20b3b": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10014729\nORDER BY admittime ASC\nLIMIT 1;",
    "6a0f9787ca51fccbc44a087c": "SELECT \n    MAX(admittime) AS last_admission_time\nFROM \n    admissions\nWHERE \n    subject_id = 10021938",
    "44e4b4d97cbe90cf626c4424": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10014729 AND admission_type = 'physician referral'\nORDER BY admittime DESC\nLIMIT 1;",
    "138fe3a23beda4b897c27c94": "SELECT T1.admittime\nFROM admissions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10004457 AND T3.long_title = 'Procedure Site';",
    "a3b2c1bfc83f38e441791752": "",
    "145d13b35f2fd6558b0a9b99": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10007795 AND admission_type = 'transfer from hospital'\nORDER BY admittime ASC\nLIMIT 1;",
    "d21ad3ab275f6cb81643201e": "",
    "be0c83bb4816c62c521f4f19": "SELECT MIN(admittime) AS first_admission_time\nFROM admissions\nWHERE subject_id = 10025612\nAND admission_type = 'physician referral';",
    "b20d40188481222bfbb9b02f": "SELECT \n  MIN(admittime) AS first_admission_time\nFROM \n  admissions\nWHERE \n  subject_id = 10014078\n  AND admission_location = 'Emergency Room';",
    "eaf50bee63448bac98063353": "SELECT dischtime\nFROM admissions\nWHERE subject_id = 10029484\nORDER BY dischtime DESC\nLIMIT 1;",
    "8264ca08e450da03c5c58c2a": "SELECT dod\nFROM patients\nWHERE subject_id = 10012552;",
    "2cdba5b8a95c49f552fbdf57": "SELECT dischtime\nFROM admissions\nWHERE subject_id = 10004235\nORDER BY dischtime DESC\nLIMIT 1;",
    "7e8d5196747ac83500ed63a2": "SELECT MIN(adm.dischtime) AS first_discharge_time\nFROM admissions adm\nWHERE adm.subject_id = 10036156;",
    "4d5c298e863a86919a4a499a": "SELECT dischtime\nFROM admissions\nWHERE subject_id = 10015860\nORDER BY admittime\nLIMIT 1;",
    "be1e758721f63febd66af577": "",
    "d6ea3d8ed946d219e8c6b546": "SELECT MAX(dischtime) AS last_discharge_time\nFROM admissions\nWHERE subject_id = 10029291;",
    "1300c7d483802a1d509ca6f4": "SELECT \n    (julianday(i.outtime) - julianday(i.intime)) AS icu_days\nFROM \n    icustays i\nJOIN \n    admissions a ON i.hadm_id = a.hadm_id\nWHERE \n    i.subject_id = 10019777\n    AND a.admittime = (SELECT MIN(admittime) FROM admissions WHERE subject_id = 10019777);",
    "01c32ce2101e22b2dfea210b": "SELECT \n  JULIANDAY(icustays.outtime) - JULIANDAY(icustays.intime) AS days_in_icu\nFROM \n  icustays\nWHERE \n  icustays.subject_id = 10016810\nORDER BY \n  icustays.intime DESC\nLIMIT 1;",
    "f632d74fbbe2ef65a5547997": "WITH LastICUStay AS (\n    SELECT \n        stay_id,\n        intime,\n        outtime\n    FROM \n        icustays\n    WHERE \n        subject_id = 10006580\n    ORDER BY \n        intime DESC\n    LIMIT 1\n)\nSELECT \n    (julianday(outtime) - julianday(intime)) AS duration_days\nFROM \n    LastICUStay;",
    "e366e701723a7868b82006d6": "SELECT \n    (julianday(i.outtime) - julianday(i.intime)) AS length_of_stay_days\nFROM \n    patients p\nJOIN \n    icustays i ON p.subject_id = i.subject_id\nWHERE \n    p.subject_id = 1002561",
    "07e1885e41d9b6a449fd69a5": "selected record.\n\n5. **Cast the result to a real number**: To ensure",
    "461b2614afff7dfabc033d6e": "SELECT \n  (julianday(lis.outtime) - julianday(lis.intime)) AS length_of_stay\nFROM LastICUStay lis\nWHERE lis",
    "4c25e26fad35ddcb5d7e1eb0": "SELECT\n    (strftime('%s', outtime) - strftime('%s', intime)) / 86400.0 AS length_of_stay_in_days\nFROM\n    icustays\nWHERE\n    subject_id = 10001725\nORDER BY\n    intime DESC",
    "c06d5f1b8c8e4396f73f77c8": "SELECT \n  MIN(T2.charttime) AS first_prescription_time\nFROM \n  patients AS T1\n  INNER JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.subject_id = 10014729",
    "953fa6166e8ed2ab67753af8": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10008287 AND starttime > '01/2100';",
    "73924b9389e02ce45d9e3c48": "",
    "994ebca608bc1b2f8b1bb1c7": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10016742\nAND starttime LIKE '2023-08-%';",
    "0f107c9e56d31b410f4f045c": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10020740\n  AND hadm_id IN (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10020740\n    ORDER BY admittime\n    LIMIT 1\n  );",
    "199101dc32631127e35693a6": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10013049 AND starttime > '02/2100';",
    "f5baeb5fd7062bd570005226": "WITH first_hadm AS (\n  SELECT MIN(hadm_id) AS hadm_id\n  FROM admissions\n  WHERE subject_id = 10027602\n)\nSELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions p\nJOIN first_hadm fh ON p.hadm_id = fh.hadm_id\nWHERE p.subject_id = 10027602;",
    "d4f2dc48d747e43282e99fc7": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10025463 \n  AND drug = 'quinidine gluconate e.r.' \n  AND hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10025463 \n    ORDER BY admittime \n    LIMIT 1\n  );",
    "9ff61e95883c730111d063bb": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10010471\nAND drug = '5% dextrose'\nAND starttime >= '2010-10-21';",
    "448d117f9de70ed2d4dc414e": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10019172\nAND drug = 'metoprolol tartrate'\nAND hadm_id = 10/2100;",
    "42a6e5d9d3862cee91a004d2": "SELECT \n    MAX(T2.starttime) AS last_prescribed_time\nFROM \n    patients T1\nINNER JOIN \n    prescriptions T2 ON T1",
    "1763cfe655f1ba381ad8e71e": "SELECT MAX(T1.starttime) AS last_prescription_time\nFROM prescriptions AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10008454\nAND T1.drug = 'CIPROFLUOXACIN HCL'\nAND T2.admittime = (\n    SELECT MAX(admittime)\n    FROM admissions\n    WHERE subject_id = 10008454\n);",
    "28cf75715d1cf3411a84ca65": "SELECT \n    MIN(starttime) AS first_prescription_time\nFROM \n    prescriptions\nWHERE \n    subject_id = 10004720 AND drug = 'citalopram';",
    "92d6c5d899dfa362deb44658": "SELECT MIN(starttime) \nFROM prescriptions \nWHERE subject_id = 10021487 \nAND drug = 'heparin' \nAND starttime >= '2023-12-01' \nAND starttime < '2023-13-01';",
    "2a8fea2a00fcd986cf1b8067": "SELECT \n    MIN(p.starttime) AS first_prescription_time\nFROM \n    prescriptions p\nINNER JOIN \n    admissions a ON p.hadm_id = a.hadm_id\nINNER JOIN \n    patients pt ON a.subject_id = pt.subject_id\nWHERE \n    pt.subject_id = 10018423\n    AND p.drug IN ('vancomycin', 'ondansetron')\n    AND p.starttime = (\n        SELECT \n            p2.starttime \n        FROM \n            prescriptions p2\n        INNER JOIN \n            admissions a2 ON p2.hadm_id = a2.hadm_id\n        INNER JOIN \n            patients pt2 ON a2.subject_id = pt2.subject_id\n        WHERE \n            pt2.subject_id = 10018423\n            AND p2.drug IN ('vancomycin', 'ondansetron')\n        GROUP BY \n            p2.starttime\n        HAVING \n            COUNT(DISTINCT p2.drug) = 2\n    );",
    "df18089e3b87a2aa47f39d54": "SELECT \n    MAX(T1.starttime) AS last_prescription_time\nFROM \n    prescriptions AS T1\nWHERE \n    T1.subject_id = 10005817\n    AND T1.starttime >= DATE('now', 'start of month')\n    AND T1.starttime < DATE('now', 'start of month', '+1 month')\n    AND T1.drug IN ('Insulin', 'Glucagon')\nGROUP BY \n    DATE(T1.starttime)\nHAVING \n    COUNT(DISTINCT T1.drug) = 2\nORDER BY \n    last_prescription_time DESC\nLIMIT 1;",
    "d570690bd00855db57f1e385": "SELECT MIN(p.starttime) AS first_prescription_time\nFROM prescriptions p\nWHERE p.subject_id = 10007058\nAND p.drug IN ('Heparin', '5% Dextrose')\nGROUP BY p.subject_id\nHAVING COUNT(DISTINCT p.drug) = 2;",
    "21a6fcf7e340c9ff6f9e4eda": "SELECT MAX(starttime) AS latest_prescription_time\nFROM prescriptions\nWHERE subject_id = 10019172\n  AND drug IN ('0.9% sodium chloride', 'docusate sodium (liquid)')\n  AND starttime >= DATE('now', '-1 month');",
    "380a7bc3779d96acb5543281": "SELECT \n      hadm_id, \n      MIN(hadm_id) AS first_hadm_id\n    FROM \n      admissions\n    WHERE \n      subject_id = 10020306\n    GROUP BY \n      hadm_id\n  ) p\nINNER JOIN",
    "50ba43b1b326c73868a72835": "SELECT p1.subject_id, p1.starttime\nFROM prescriptions p1\nJOIN prescriptions p2 ON p1.subject_id = p2.subject_id AND p1.starttime = p2.starttime\nWHERE p1.subject_id = 10021118\n  AND p1.drug = 'ketorolac'\n  AND p2.drug = 'acetaminophen'\n  AND p1.route = 'iv'\n  AND p2.route =",
    "9333b4860f452a4674c02cbc": "SELECT MIN(T1.starttime) AS earliest_starttime\nFROM prescriptions T1\nINNER JOIN prescriptions T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id AND T1.starttime = T2.starttime\nWHERE T1.subject_id = 10021118\n  AND T1.drug = 'Insulin'\n  AND T2.drug = 'Glucose Gel'\n  AND T1.starttime >= '2000-03-21';",
    "f75de59a1a66905c8e18c843": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10006580\n  AND starttime >= DATE('now', '-26 months')\n  AND route = 'im';",
    "bf8aee434927ad78efbb9c37": "",
    "ba85b4185b40acf102f505e5": "SELECT MAX(starttime)\nFROM prescriptions\nWHERE subject_id = 10022880\n  AND starttime LIKE '03/2100%'\n  AND route = 'iv';",
    "9c36c694493cc1a4533c0e35": "SELECT MAX(starttime)\nFROM prescriptions\nWHERE subject_id = 10010471\nAND starttime >= '08/2100'\nAND route = 'iv';",
    "9db8bd8eeca37c40ce0282d9": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10038081 AND route = 'neb';",
    "0184b4b16596dc35beb98cfd": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10001217\nAND route = 'po/ng'\nAND starttime BETWEEN '2023-12-01' AND '2023-12-31';",
    "4ec0747fdc64218ae8ffc26d": "SELECT MIN(starttime) AS first_pr_starttime\nFROM prescriptions\nWHERE subject_id = 10019172\n  AND route = 'pr'\n  AND starttime >= DATE('now', '-1 month');",
    "314c43e484535c98944bc116": "SELECT \n    MIN(labevents.charttime) AS earliest_charttime\nFROM \n    labevents\nWHERE \n    labevents.subject_id = 10005817\n    AND labevents.charttime > '2008-08-21'",
    "649fd348e56a70012edf8781": "SELECT MAX(charttime) AS last_lab_test_time\nFROM labevents\nWHERE subject_id = 10009628 AND charttime LIKE '2023-10-%';",
    "a991a62ce361a4375831ca50": "SELECT MAX(charttime) AS last_test_time\nFROM labevents\nWHERE subject_id = 10031404\n  AND hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10031404);",
    "a79380b2785aa5ce66c4b881": "SELECT \n    MAX(labevents.charttime) AS last_test_time\nFROM \n    labevents\nJOIN \n    admissions ON labevents.hadm_id = admissions.hadm_id\nWHERE \n    admissions.subject_id = 10036156\n    AND labevents.charttime >= '07/2100';",
    "f7e273153edfeb72b98bd9c7": "SELECT MAX(T2.charttime) AS last_test_time\nFROM patients AS T1",
    "5a5fd081d30e9927c3c6dad4": "",
    "8e40479dcfc63f5443fa3003": "SELECT \n    MAX(charttime) AS last_test_time\nFROM \n    labevents\nWHERE \n    subject_id = 10006053\n    AND charttime > '2100-01-01';",
    "9ae67f8f87f7be444b601b61": "SELECT MIN(l.charttime) AS first_charttime\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10021118\n  AND d.label = 'Bilirubin, Total';",
    "c03885ae374eb4c770e9069a": "SELECT MAX(charttime) AS last_charttime\nFROM labevents\nWHERE subject_id = 10031757 AND itemid IN (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label = 'Alkaline Phosphatase'\n);",
    "d495fd8395126c8eb2bfc70f": "SELECT \n  MIN(t1.charttime) AS first_test_time \nFROM \n  labevents t1 \n  JOIN d_labitems t2 ON t1.itemid = t2.itemid \nWHERE \n  t1.subject_id = 10022880 \n  AND t2.label = 'Chloride' \n  AND strftime('%Y-%m', t1.charttime) = '2023-04'",
    "576e916cf4beca47606878ba": "SELECT MAX(charttime) AS LastTestTime\nFROM microbiologyevents\nWHERE subject_id = 10016742 \n  AND spec_type_desc = 'pt test';",
    "7dc3347edeff0be3bfeb2b14": "SELECT MIN(t.charttime) AS first_time\nFROM labevents t\nJOIN admissions h ON t.hadm_id = h.hadm_id\nWHERE h.subject_id = 10022880 AND t.itemid = 10000365 AND t.charttime = (\n  SELECT MAX(t.charttime)\n  FROM labevents t\n  JOIN admissions h ON t.hadm_id = h.hadm_id\n  WHERE h.subject_id = 10022880 AND t.itemid = 10000365\n)",
    "fd8916330e9d2c2e5b150852": "",
    "528d495934e0aadbd47ad1b6": "SELECT \n    charttime AS rdw_test_time\nFROM \n    labevents le\nJOIN \n    d_labitems di ON le.itemid = di.itemid\nWHERE \n    le.subject_id = 10021312\n    AND di.label = 'rdw'\nORDER BY \n    charttime\nLIMIT 1;",
    "c80160c40fe40760c9ce27b2": "SELECT MIN(l.charttime) AS first_max_charttime\nFROM labevents l\nJOIN d_lab",
    "d2063048958d7402567becbf": "SELECT MIN(T1.charttime) AS first_charttime\nFROM chartevents AS T1\nJOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10037928\nAND T1.charttime >= '04/2100'\nAND T2.label = 'Chloride'\nAND T1.valuenum = (\n  SELECT MAX(T1.valuenum)\n  FROM chartevents AS T1\n  JOIN d_items AS T2 ON T1.itemid = T2.itemid\n  WHERE T1.subject_id = 10037928\n  AND T1.charttime >= '04/2100'\n  AND T2.label = 'Chloride'\n);",
    "3701159d655f47f5724c7180": "SELECT \n    mle.subject_id,\n    mle.charttime,\n    mle.valuenum\nFROM \n    MonocytesLabEvents",
    "0bf8b08208180cf560844cba": "",
    "f49e8d99f34677375d3e576d": "SELECT item",
    "327eb60e80b925374560c88e": "SELECT charttime \nFROM chartevents \nWHERE subject_id = 10039708 \n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Ferritin') \n  AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10039708 AND discharge_location = '11/2100') \nORDER BY charttime DESC \nLIMIT 1;",
    "9078d39386848fe27cef5f31": "SELECT \n    ne.subject_id,\n    ne.charttime,\n    ne.valuenum\n  FROM \n    neutrophil_events ne\n  INNER JOIN \n    max_neutrophil mn ON ne.subject_id = mn.subject_id AND ne.valuenum = mn.max_valuenum",
    "494282796f9c3fdde2f7b727": "SELECT MIN(charttime) AS first_microbiology_test\nFROM microbiologyevents\nWHERE subject_id = 10013049 AND charttime >= '2021-05-21';",
    "56ca21bbb266b349bca3f6e5": "SELECT MIN(charttime) AS first_chart_time\nFROM microbiologyevents\nWHERE subject_id = 10000032 AND charttime >= '2021-05-21';",
    "073f2bf50f7338fb5c3bb42b": "SELECT MAX(charttime) AS last_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10039997\nAND charttime BETWEEN '2023-09-01 00:00:00' AND '2023-09-30 23:59:59';",
    "eeeb5ecc1778f72724d0534d": "SELECT \n  MIN(charttime) AS first_microbiology_test\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10010471 AND charttime > '2006-01-01';",
    "885642fd5ea14ba51403e397": "SELECT MAX(charttime) AS last_microbiology_test\nFROM microbiologyevents\nWHERE subject_id = 10001725;",
    "499518ffdd4562209632b0e7": "SELECT MAX(charttime) AS last_microbiology_test\nFROM microbiologyevents\nWHERE subject_id = 10002495 AND charttime > '02/21/2000';",
    "f99580261637ffba691a9a72": "SELECT \n  MIN(ce.charttime) AS first_microbiology_test\nFROM \n  chartevents ce\n  INNER JOIN admissions a ON ce.hadm_id = a.hadm_id\nWHERE \n  ce.subject_id = 10010471 \n  AND ce.charttime > datetime('now', '-1 month')\n  AND ce.itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%microbiology%')",
    "21765b418ac742a54e95ff43": "SELECT MIN(charttime) AS first_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10021487 AND test_name = 'Pleural Fluid' AND charttime > '2000-07-21';",
    "031ff26b606f0d58d734256c": "",
    "8fc30d6e91b22c5fbe1a138b": "SELECT charttime\nFROM microbiologyevents\nWHERE subject_id = 1",
    "76a9a991435e9dfbb0590490": "SELECT MAX(charttime) AS last_test_time\nFROM microbiologyevents\nWHERE subject_id = 10019777\n  AND charttime BETWEEN '2003-01-01' AND '2003-12-31'\n  AND spec_type_desc = 'mrsa screen';",
    "58f0822239c07b746c5df6fc": "SELECT MIN(charttime) AS first_mrsa_screen_time\nFROM microbiologyevents\nWHERE org_name = 'MRSA Screen'\n  AND test_name = 'MRSA Screen'\n  AND subject_id = 10022041\n  AND charttime LIKE '%/06/%';",
    "689c016c32621989ea39ef0c": "SELECT\n    MIN(e.charttime) AS first_mrsa_screen_time\nFROM\n    patients p\nJOIN\n    admissions a ON p.subject_id = a.subject_id\nJOIN\n    microbiologyevents e ON a.hadm_id = e.hadm_id\nWHERE\n    p.subject_id = 10008454 AND\n    e.spec_type_desc = 'MRSA Screen'",
    "a88028190c05dd2074203820": "SELECT MAX(charttime) AS last_test_time\nFROM microbiologyevents\nWHERE subject_id = 10005817\nAND test_name = 'Staph Aureus Swab';",
    "c503cb58dc8455398570f4a4": "",
    "8ef3a4c7569d9db7872c7fde": "SELECT \n  MIN(starttime) AS first_dose_time\nFROM \n  inputevents\nWHERE \n  subject_id = 10010471\n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'nacl 0.9%')\n  AND starttime = '2021-12-20 00:00:00';",
    "5b97eeb5e63797ee9185b85c": "",
    "bf8bff577fb09a8df5d3e544": "SELECT \n  MIN(starttime) AS first_intake_time\nFROM \n  inputevents\nWHERE \n  subject_id = 10027445\n  AND totalamount > 0\n  AND totalamountuom = 'mL'\n  AND starttime LIKE '2023-09-09%';",
    "7b8dd010ac6d51609aa93314": "SELECT MAX(starttime) AS last_multivitamin_time\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 10038933\nAND d_items.label = 'Multivitamins';",
    "7c188f76017d685690e33f58": "SELECT itemid\n    FROM d_items\n    WHERE abbreviation IN ('H', 'C')\n  )\n  AND starttime > '12/31/2100",
    "55c38b5362bf49397a27774e": "SELECT starttime \nFROM inputevents \nWHERE subject_id = 10027602 \nAND starttime LIKE '%11/30%' \nAND itemid = (SELECT itemid FROM d_items WHERE label = 'NaCl 0.45%');",
    "9bbe2a60bf98d234e5825b6d": "select the `starttime` of the first input event that matches the above criteria.",
    "9bdee5cb67ac4e91e5b630da": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10008454\n  AND starttime >= '2023-04-01'\n  AND starttime < '2023-05-01';",
    "5d9fd7530f8b7c30df604ea3": "SELECT \n    MIN(starttime) AS first_input_time\nFROM \n    inputevents\nWHERE \n    subject_id = 10004733\n    AND DATE(starttime) = DATE('2023-12-28');",
    "4d8649af3dbd396df7c0075b": "",
    "3e3acb412956feade24cf02d": "",
    "3eb33ba93f9cf1fe30f6a3de": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10026354 AND starttime > '2021-07-14 00:00:00';",
    "b6f5c8c63479dc0c781f71d3": "SELECT \n  MIN(starttime) AS first_input_time\nFROM \n  inputevents \nWHERE \n  subject_id = 10005817 AND starttime >= '2021-12-21'",
    "234ef243bc79fbeeafde9f09": "",
    "f54a4c50ee67f5dbec1add73": "SELECT MAX(charttime) AS last_measurement\nFROM chartevents\nWHERE subject_id = 10020740 \n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\n  AND DATE(charttime) = '2021-03-24';",
    "176c4a282a56f000735207f8": "SELECT \n  MIN(T1.charttime) AS first_reading_time\nFROM \n  chartevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10010471\n  AND T2.label = 'Heart Rate'\n  AND strftime('%Y-%m', T1.charttime) = '2019-01';",
    "ae02dd831bcaea6f356e18cb": "",
    "ec5c2b153da669ee108c8957": "SELECT l.charttime\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id =",
    "9395b479ccae72fb9bd102d3": "SELECT \n    ce.charttime\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10019568 AND",
    "e5d7989d4180e49d445f9388": "SELECT \n    chartevents.subject_id,\n    chartevents.charttime",
    "53761ebb18ac5c642c4f2006": "SELECT MIN(T1.charttime) AS first_charttime\nFROM chartevents AS T1",
    "7af68876628a4636df61cbce": "SELECT ce.charttime AS last_charttime\nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nINNER JOIN icustays icu ON ce.hadm_id = icu.hadm_id\nWHERE di.label LIKE '%respiratory rate%'\nAND ce.subject_id = 10021487\nAND ce.valuenum > 16.0\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "aba2a9f835c596686850b00a": "SELECT \n  c.charttime AS last_heart_rate_measurement\nFROM \n  chartevents c\nJOIN \n  d_items i ON c.itemid = i.itemid\nWHERE \n  c.subject_id = 10007818 AND \n  c.stay_id =",
    "687e1ab45a6ab29b54c44861": "SELECT \n  MIN(ce.charttime) AS first_icu_visit_time\nFROM \n  chartevents ce\nINNER JOIN \n  icustays icu ON ce.hadm_id = icu.hadm_id\nWHERE \n  ce.subject_id = 10038999\n  AND ce.itemid = 44244  -- itemid for SpO2\n  AND ce.valuenum < 96.0\n  AND icu.stay_id = 1;",
    "cb2576703363b2124ae28f7c": "SELECT \n  MIN(charttime) AS first_time\nFROM \n  chartevents\nWHERE \n  subject_id = 10010471\n  AND charttime BETWEEN '2023-12-20 00:00:00' AND '2023-12-20 23:59:59'\n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')\n  AND valuenum < 27.0\n  AND valueuom = 'breaths per minute';",
    "dcfff42d3b4e18800ea55074": "SELECT \n  charttime\nFROM \n  chartevents\nWHERE \n  subject_id = 10007818\n  AND itemid = (SELECT row_id FROM d_items WHERE label = 'Heart Rate')\n  AND charttime < '2021-07-05 23:59:59'\nORDER BY \n  charttime DESC\nLIMIT 1;",
    "29145deb2421f340268f6323": "SELECT charttime",
    "b862c7be7085f5768ab9bd66": "SELECT MAX(T1.charttime) AS last_charttime\nFROM chartevents AS T1\nJOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10035185\nAND T1.valuenum IS NOT NULL\nAND T2.label = 'Mean Blood Pressure';",
    "b52f4e22cdd27322676517fc": "SELECT MIN(charttime) AS first_time_max_diastolic_bp\nFROM (\n    SELECT charttime, valuenum\n    FROM chartevents\n    WHERE subject_id = 10004235\n      AND itemid = 226735\n      AND stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10004235 ORDER BY outtime DESC LIMIT 1)\n) AS max_diastolic_bp_chartevents\nWHERE valuenum = (\n    SELECT MAX(valuenum)\n    FROM chartevents\n    WHERE subject_id = 10004235\n      AND itemid = 226735\n      AND stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10004235 ORDER BY outtime DESC LIMIT 1)\n)",
    "c0b00ebc518d168b79f08eb4": "SELECT \n  charttime\nFROM \n  chartevents\nWHERE \n  subject_id = 10023239 AND \n  itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate') AND\n  DATE(charttime) = '2021-06-29'\nORDER BY \n  charttime DESC\nLIMIT 1;",
    "9ec14e1d25e50dd996d4e3a7": "",
    "565bd442b074a6efca2e0887": "SELECT MIN(charttime) AS first",
    "b65ad812aa58a875e2d64890": "SELECT \n        ce.subject_id,\n        ce.charttime,\n        ce.valuenum AS heart_rate\n    FROM \n        chartevents ce\n    INNER JOIN \n        d_items di ON ce.itemid = di.itemid\n    WHERE \n        ce.subject_id = 10038999 AND\n        di.label = 'Heart Rate' AND\n        ce.charttime > '2002-02-26'\n),",
    "e799539afbf0b691d6a01724": "SELECT\n    MAX(mean_blood_pressure) AS max_mean_blood_pressure",
    "7cf6accf1943c04c3021431d": "SELECT \n  CASE \n    WHEN p.subject_id IS NOT NULL THEN 'Yes'\n    ELSE 'No'\n  END AS has_been_to_hospital\nFROM patients p\nWHERE p.subject_id = 10004422\nAND p.dob >= DATE('now', '-1 year');",
    "fbf6757b5a77304084ba36d9": "select the `subject_id` column. If the patient has been hospitalized, this column will contain the `subject_id` value.\n\n5. **Use DISTINCT",
    "d012dd1a0c9587638828166b": "SELECT \n    CASE \n        WHEN p.subject_id IS NOT NULL THEN 'Yes'\n        ELSE 'No'\n    END AS has_had_visit\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nWHERE \n    p.subject_id = 10015272 AND a.admittime >= '2100-01-01';",
    "44877f8ac388426e512417e3": "SELECT \n  CASE \n    WHEN COUNT(hadm_id) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS has_been_hospitalized\nFROM \n  admissions\nWHERE \n  subject_id = 10021118 AND admittime >= '2100-01-01 00:00:00';",
    "c73dd80145bee718f2bf509b": "SELECT` statement to count the number of admissions that meet the conditions.\n   - We",
    "6699cff955e99112f866a2d5": "SELECT\n    CASE\n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS was_hospitalized\nFROM admissions\nWHERE subject_id = 10020740\n  AND admittime >= DATE('now', 'start of year');",
    "33c6e26e755a5e0efb3a25b9": "SELECT \n    CASE \n        WHEN admission_location = 'Emergency Room' THEN 'Y'\n        ELSE 'N'\n    END AS in_emergency\nFROM \n    admissions\nWHERE \n    subject_id = 10019568\n    AND admittime = (\n        SELECT MIN(admittime)\n        FROM admissions\n        WHERE subject_id = 10019568\n    );",
    "b422362f19ca6957cfa3fb02": "SELECT \n  CASE \n    WHEN COUNT(T1.subject_id) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS has_er_admission\nFROM \n  admissions T1\nWHERE \n  T1.subject_id = 10007795 \n  AND T1.admission_type = 'emergency'\n  AND T1.admittime >= DATE('now', '-1 year');",
    "c3c3a56dc8cd277bd5826031": "SELECT \n    CASE \n        WHEN SUM(CASE WHEN T2.admission_location = 'E.R.' THEN 1 ELSE 0 END) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS went_to_er\nFROM patients T1\nINNER JOIN admissions T2 ON T1.subject_id = T2.subject_id\nWHERE T1.subject_id = 10007928\nAND T2.admittime BETWEEN DATE('now', '-1 year') AND DATE('now');",
    "461ed0b2f30a1fe2a7aca6e3": "",
    "38b8d432b6882df96340f954": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS admitted_to_er\nFROM admissions\nWHERE subject_id = 10008454 AND admission_location = 'Emergency Room' AND strftime('%Y', admittime) = '2100';",
    "f020778ee34bfe4318ed4bde": "",
    "18827b43fd9e61dcfc5d9388": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS came_to_er\nFROM \n  admissions \nWHERE \n  subject_id = 10016810 \n  AND admission_location = 'ER' \n  AND admittime BETWEEN '2022-01-01 00:00:00' AND '2022-12-31 23:59:59';",
    "e62cc504176c8533a1e60738": "SELECT subject_id\nFROM procedures_icd\nWHERE subject_id = 10018328;",
    "3376a341796a02ddf1d1814f": "SELECT 'Yes' AS result\nFROM procedures_icd\nWHERE subject_id = 10021666\n  AND charttime > '2100-01-01'\nUNION ALL\nSELECT 'No' AS result\nFROM procedures_icd\nWHERE subject_id = 10021666\n  AND charttime > '2100-01-01'\nLIMIT 1;",
    "0c85596eb9a5ce81b6fb531c": "SELECT \n    COUNT(*) \nFROM \n    procedures_icd\nWHERE \n    subject_id = 10005909 \n    AND icd_code IN (\n        SELECT icd_code \n        FROM d_icd_procedures \n        WHERE long_title LIKE '%procedure%'\n    );",
    "36178f6bba63163826d1292a": "SELECT \n  p.subject_id\nFROM \n  procedures_icd pr\n  INNER JOIN admissions p ON pr.hadm_id = p.hadm_id\nWHERE \n  p.subject_id = 10007795\n  AND pr.charttime >= DATE('now', '-1 year')\nLIMIT",
    "7fbb236187007480210be707": "SELECT hadm_id\nFROM admissions\nWHERE subject_id = 10023117\nLIMIT 1;",
    "d081d7e2db7e69a70b388b51": "",
    "10fd1a4b2a07afed251f289a": "SELECT \n    CASE \n        WHEN COUNT(p.hadm_id) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS has_procedure\nFROM \n    patients p\nJOIN \n    procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10022017;",
    "bd8736e59f3b5eb724910a84": "SELECT \n    CASE \n        WHEN COUNT(p.subject_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS procedure_occurred\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE p.subject_id = 10005909\nAND pr.icd_code = 'T96.100'\nAND pr.charttime >= DATE('now', '-1 year');",
    "889ee571402af73523bd702b": "",
    "0018b73b2eda7611f63bee38": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_procedure\nFROM \n  procedures_icd p\n  INNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE \n  a.subject_id = 10029291 AND \n  p.icd_code = 'T00.591' AND \n  a.hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10029291 \n    ORDER BY admittime ASC \n    LIMIT 1\n  );",
    "05a8454a6a71435a557db2cc": "SELECT \n  p.subject_id, \n  a.hadm_id, \n  i.itemid, \n  d.label AS treatment_label\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN chartevents i ON a.hadm_id = i.hadm_id\n  INNER JOIN d_items d ON i.itemid = d.itemid\nWHERE \n  p.subject_id = 10004733 \n  AND d.label = 'Central Venous Catheter Placement with Guidance';",
    "7ab5610ee5258787397017e1": "select the `subject_id` and `icd_code` to confirm the performance",
    "c8af28411a3f128722567f9e": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN p.subject_id = 10023117 THEN p.subject_id ELSE NULL END) IS NOT NULL THEN 'Yes'\n        ELSE 'No'\n    END AS procedure_performed\nFROM \n    admissions a\nJOIN \n    procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN \n    d_icd_procedures p ON pr.icd_code = p.icd_code\nWHERE \n    a.subject_id = 10023117\n    AND p.long_title = 'Cardiac Resynchronization Defibrillator, Total System (CRT-D) Implantation';",
    "75ad6fb522538101f974da54": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'",
    "6cf60ddb53c69a32d984068c": "SELECT p.drug, COUNT(p.drug)",
    "fcfa89f08cd7518cc467a635": "SELECT T3.long_title AS procedure_name\nFROM patients AS T1\nINNER JOIN procedures_icd AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10002495\nAND T2.charttime > '2000-06-21'\nGROUP BY T3.long_title\nHAVING COUNT(T2.row_id) > 1;",
    "2bd36cdf648a73c1405bc0bd": "SELECT d_icd_procedures.long_title AS procedure_name\nFROM diagnoses_icd\nINNER JOIN d_icd_procedures ON diagnoses_icd.icd_code = d_icd_procedures.icd_code\nWHERE diagnoses_icd.subject_id = 10007795\nAND diagnoses_icd.charttime >= '01/2100'\nGROUP BY diagnoses_icd.icd_code\nHAVING COUNT(diagnoses_icd.icd_code) > 1;",
    "68e68711b24f4ee363da9739": "SELECT t1.long_title\nFROM d_icd_procedures AS t1\nINNER JOIN procedures_icd AS t2 ON t1.icd_code = t2.icd_code\nWHERE t2.subject_id = 10027602\nGROUP BY t1.long_title\nHAVING COUNT(t2.subject_id) = 2;",
    "080005219b1bf48862540ed2": "WITH LastAdmission AS (\n    SELECT \n        a.subject_id, \n        a.hadm_id, \n        a.admittime, \n        a.dischtime\n    FROM admissions a\n    WHERE a.subject_id = 10015860\n    ORDER BY a.admittime DESC\n    LIMIT 1\n),\nTreatments AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id, \n        p.itemid, \n        p.totalamount\n    FROM inputevents p\n    INNER JOIN LastAdmission la ON p.hadm_id = la.hadm_id\n)\nSELECT \n    d.label AS treatment\nFROM Treatments t\nINNER JOIN d_items d ON t.itemid = d.itemid\nGROUP BY t.itemid, d.label\nHAVING COUNT(t.itemid) > 1;",
    "641bf23b0701d0025cafd597": "SELECT T2.long_title\nFROM admissions T1\nINNER JOIN procedures_icd T3 ON T1.hadm_id = T3.hadm_id\nINNER JOIN d_icd_procedures T2 ON T3.icd_code = T2.icd_code\nWHERE T1.subject_id = 10002495\nAND T2.long_title IS NOT NULL\nAND T1.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10002495\n    ORDER BY admittime\n    LIMIT 1\n)\nGROUP BY T2.long_title\nHAVING COUNT(T2.long_title) >= 2;",
    "a868ec00f8a5fa468855f6fd": "SELECT \n    p.subject_id,\n    pr.icd_code,\n    pr.charttime AS procedure_date\nFROM \n    patients p\nINNER JOIN \n    procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10021312\n    AND pr.charttime >= DATE('now', '-10 months')\nGROUP BY \n    pr.icd_code\nHAVING \n    COUNT(pr.icd_code) > 1;",
    "cc4d6ffe4f9c497d114ffb8f": "SELECT \n    CASE \n        WHEN COUNT(T2.icd_code) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_diagnosis\nFROM \n    patients T1\nLEFT JOIN \n    diagnoses_icd T2 ON T1.subject_id = T2.subject_id\nWHERE \n    T1.subject_id = 10036156;",
    "c5110fc62fc9ba15034f6482": "",
    "eda3c6670454f65cad04f15c": "SELECT DISTINCT d.long_title\nFROM diagnoses_icd AS di\nJOIN d_icd_diagnoses AS d ON di.icd_code = d.icd_code\nWHERE di.subject_id = 10012552;",
    "56765c70e8dbcc6a5ecdaca5": "SELECT COUNT(*) AS num_diagnoses\nFROM diagnoses_icd\nWHERE subject_id = 10007818 AND charttime >= '2100-01-01';",
    "c73288aeb0cfc184ac029f56": "SELECT MIN(admittime) FROM admissions WHERE subject_id = 10017",
    "f209b8c081219def0ef4ace5": "SELECT \n    CASE \n        WHEN d.subject_id IS NOT NULL THEN 'Yes'\n        ELSE 'No'\n    END AS received_diagnosis\nFROM patients p\nLEFT JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nWHERE p.subject_id = 10022041\nLIMIT 1;",
    "b11b1fc29cb6a59522daeb8d": "SELECT \n    d.long_title AS diagnosis\nFROM \n    patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    p.subject_id = 10004733\n    AND a.dischtime = (SELECT MAX(a2.dischtime) FROM admissions a2 WHERE a2.subject_id = p.subject_id);",
    "81233148fcdb550533d311a4": "SELECT \n    d.long_title\nFROM \n    diagnoses_icd di\nJOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    di.subject_id = 10014354\n    AND di.charttime >= DATE('now', '-1 year')\n    AND d.long_title = 'Polyneuropathy, unspecified';",
    "eaddbd134c399ccf75e4f24e": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS ReceivedSubduralHemorrhage\nFROM \n    diagnoses_icd di\nJOIN \n    d_icd_diagnoses did ON di.icd_code = did.icd_code\nWHERE \n    di.subject_id = 10018845 \n    AND did.long_title LIKE '%Subdural Hemorrhage, following injury, without open intracranial wound, unspecified state of consciousness%'\n    AND di.charttime LIKE '2100-%';",
    "ad475c1d5ff7b04c88a96e2c": "SELECT hadm_id\n    FROM admissions\n    WHERE admittime LIKE '2100%'\n  );",
    "f39c38465d2dfe0e93701a52": "SELECT p",
    "50b2a084d9984e05d63230db": "SELECT \n    d.icd_code, \n    d.long_title\nFROM \n    diagnoses_icd i\nJOIN \n    d_icd_diagnoses d ON i.icd_code = d.icd_code\nWHERE \n    i.subject_id = 10018081 AND \n    i.charttime >= '2100-01-01';",
    "23aeb815d2db0889eb0f2b24": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS received_encounter\nFROM diagnoses_icd \nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE diagnoses_icd.subject_id = 10015931 \n  AND d_icd_diagnoses.long_title = 'Encounter for examination for normal comparison and control in clinical research program'\n  AND diagnoses_icd.charttime >= '2100-01-01';",
    "48fcb0d1e3395d14eae1e8b2": "",
    "605dc49bacfb0b462cf31880": "SELECT \n    CASE \n        WHEN COUNT(p.subject_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS received_drug\nFROM prescriptions p\nJOIN patients pat ON p.subject_id = pat.subject_id\nWHERE p.drug IN ('Docusate Sodium', '5% Dextrose', 'Polyethylene Glycol')\nAND p.starttime >= '2023-11-2100'\nAND p.subject_id = 10021118;",
    "2e4d054961ab8dd569126be6": "SELECT \n    p.subject_id,\n    pr.drug,\n    pr.hadm_id\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10021487 AND pr.drug IN ('acetazolamide', 'bisacodyl', '5% dextrose');",
    "c6e32087897377afc707821c": "SELECT \n    CASE \n        WHEN p.drug = 'heparin' OR p.drug = 'iso-osmotic dextrose' OR p.drug = 'milk of magnesia' THEN 'Yes'\n        ELSE 'No'\n    END AS is_prescribed\nFROM \n    prescriptions p\nJOIN \n    patients pa ON p.subject_id = pa.subject_id\nWHERE \n    pa.subject_id = 10022880 AND p.starttime > '2100-01-01';",
    "03aa2747a4bbb38e1e9ccb85": "SELECT \n  CASE \n    WHEN p1.drug = 'lisinopril' THEN 'Lisinopril prescribed'\n    WHEN p1.drug = 'vitamin d' THEN 'Vitamin D prescribed'\n    WHEN p1.drug = 'lenalidomide (revlimide)15mg' THEN 'Lenalidomide (Revlimide) 15mg prescribed'\n    ELSE 'No matching drug prescribed'\n  END AS drug_prescription_result\nFROM \n  prescriptions p1\nWHERE \n  p1.subject_id = 10003400 \n  AND p1.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10003400 LIMIT 1);",
    "977a6055c6232b7e550211d6": "SELECT \n    CASE \n        WHEN p.subject_id = 10011398 \n        AND pr.starttime >= '2012-12-21' \n        AND pr.stoptime <= '2021-12-31' \n        AND pr.drug IN ('ibuprofen', 'ondansetron', 'insulin human regular')",
    "8575a4d0318c42ed703a89a1": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS received_medications\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10015931 \n  AND p.drug IN ('5% dextrose', 'glucose gel', 'ondansetron');",
    "b66ed8145c0b562f96f32f22": "SELECT \n    CASE \n        WHEN drug = '0.9% Sodium Chloride' THEN 'Sodium Chloride'\n        WHEN drug = 'Levetiracetam' THEN 'Levetiracetam'\n        WHEN drug = 'Bag' THEN 'Bag'\n        ELSE NULL\n    END AS drug_ordered\nFROM prescriptions\nWHERE subject_id = 10038933\nAND starttime >= '2100-01-01'\nAND drug IN ('0.9% Sodium Chloride', 'Levetiracetam', 'Bag');",
    "9a16562e6c22fbc3ecf55004": "",
    "d60412f228f0e3b6df5b6d8c": "SELECT \n    T1.subject_id, \n    T2.drug, \n    T2.starttime \nFROM \n    patients AS T1 \nINNER JOIN \n    admissions AS T3 ON T1.subject_id = T3.subject_id \nINNER JOIN \n    prescriptions AS T2 ON T3.hadm_id = T2.hadm_id \nWHERE \n    T1.subject_id = 10021312 \nAND \n    T2.starttime > '2003-03-21' \nAND \n    T2.drug IS NOT NULL;",
    "b07f1b0cf6f5838302e27ea2": "WITH LastAdmission AS (\n    SELECT MAX(hadm_id) AS last_hadm_id\n    FROM admissions\n    WHERE subject_id = 10005866\n)\nSELECT CASE\n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS has_prescriptions\nFROM prescriptions p\nJOIN LastAdmission la ON p.hadm_id = la.last_hadm_id;",
    "407ffa4fc0b1f6b83c6a90e4": "SELECT \n    CASE\n        WHEN COUNT(p.subject_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_received_medication\nFROM \n    prescriptions p\nJOIN \n    patients pt ON p.subject_id = pt.subject_id\nWHERE \n    p.subject_id = 10027445\n    AND p.starttime > DATE('now', '-17 month');",
    "6b7a85cc61dd82548ef2f988": "SELECT p.subject_id, pr.drug\nFROM patients p\nINNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE p.subject_id = 10040025\nAND pr.starttime >= '2021-04-01'\nAND pr.stoptime <= '2022-03-31';",
    "fdc9e1c2af088aa194e9faa5": "Select the relevant table**: The `prescriptions` table contains the information about medication administrations.\n2. **Filter by patient ID**: We need to filter the records where `subject_id` is 10005817.\n3. **Filter by date**: We need to filter the records where `starttime` is in April of the previous year. We can use `strftime` to",
    "7e472b43cb7c281ea7ad2326": "WITH LastHadmId AS (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10016150\n    ORDER BY admittime DESC\n    LIMIT 1\n)\nSELECT CASE\n    WHEN COUNT(*) > 0 THEN 'Medication was given'\n    ELSE 'No medication'\nEND AS MedicationStatus\nFROM prescriptions\nJOIN LastHadmId ON LastHadmId.hadm_id = prescriptions.hadm_id;",
    "ab2aad38b2169268cce19216": "SELECT DISTINCT p.subject_id\nFROM prescriptions p\nWHERE p.subject_id = 10019172 AND p.drug = 'midazolam';",
    "732ddbd8735aa1ef150a5da1": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS lidocaine_provided\nFROM \n    prescriptions p\nJOIN \n    admissions a ON p.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10004733 \n    AND p.drug = 'lidocaine 1%';",
    "cc187d8a2ecb0abb9fd2ff92": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS \"Prescribed\"\nFROM \n  prescriptions\nWHERE \n  subject_id = 10004733\n  AND drug = 'clonidine patch 0.3 mg/24 hr'\n  AND starttime >= '2021-12-21'\n  AND stoptime <= '2022-01-01';",
    "dab078420665e61aa6883a1d": "",
    "b3baba0d3d4a30996c8d7040": "SELECT \n    p.subject_id, \n    pr.drug\nFROM \n    patients p\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10020944\n    AND pr.drug = 'glucose gel'\n    AND pr.starttime >= '2000-03-21'\n    AND pr.stoptime <= '2000-03-21';",
    "29ea8f3acec04ab1a79ac191": "SELECT \n  CASE \n    WHEN p.subject_id IS NOT NULL THEN 'Y'\n    ELSE 'N'\n  END AS InsulinPrescribed\nFROM \n  patients p\n  LEFT JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  p.subject_id = 10020740\n  AND pr.drug = 'Insulin'\n  AND pr.starttime >= '03/2100' \n  AND pr.stoptime <= '03/2100';",
    "f4d19ba764d6773617847b52": "",
    "2b3268beab056ff505b05347": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_tested\nFROM labevents\nWHERE subject_id = 10029291 AND charttime > '01/2100';",
    "d2926f4a0d345771d9cecb6a": "",
    "d9f1d82756382ceba0364eb7": "SELECT CASE WHEN COUNT(*) > 0 THEN 'Yes' ELSE 'No' END AS has_undergone_test\nFROM labevents\nWHERE subject_id = 10020786 AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "9957eec4f3658a2214f701c9": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Y'\n        ELSE 'N'\n    END AS test_performed\nFROM labevents \nWHERE subject_id = 10007795 AND strftime('%m', charttime) = '08' AND strftime('%Y', charttime) = '2000';",
    "82c55832a756019258539f9d": "",
    "1a8e264083c39ca2b5c9bc74": "SELECT \n    subject_id,\n    MAX(charttime) AS last_lab_charttime\nFROM \n    labevents\nWHERE \n    subject_id = 10018423\n    AND charttime > DATETIME('now', '-1 year')\nGROUP BY \n    subject_id;",
    "be808f9b9ff6628170faba78": "SELECT \n    CASE \n        WHEN COUNT(labevents.subject_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_tested\nFROM \n    labevents\nWHERE \n    subject_id = 10019172 \n    AND charttime LIKE '11/%/2023%';",
    "7c0a9c949c9ec7ff63c270ae": "SELECT \n    l.subject_id, \n    l.charttime, \n    d.label AS test_name\nFROM \n    labevents l\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10009628 \n    AND l.charttime LIKE '%10/2100%' \n    AND d.label = 'Total CO2 Test';",
    "4ec3447b9f00804b8d0a3da0": "SELECT COUNT(*) \nFROM labevents\nWHERE subject_id = 10014729 \nAND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Base Excess')\nAND charttime > '2100-01-01 21:00:00';",
    "d68bcea40377baf01b112ced": "SELECT \n  p.subject_id,\n  l.charttime,\n  l.valuenum,\n  d.label AS lab_item\nFROM",
    "f53166032d928995607d2fc9": "",
    "97a7eba99e8adfa9dfe8aaca": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_tested\nFROM \n  labevents AS le\n  INNER JOIN d_labitems AS di ON le.itemid = di.itemid\nWHERE \n  le.subject_id = 10005817 AND\n  di.label = 'Free Calcium' AND\n  le.charttime >= '2020-10-01';",
    "6f9ec204cf2995a0808955b7": "SELECT CASE \n    WHEN COUNT(DISTINCT l.itemid) > 0 THEN 'Yes' \n    ELSE 'No' \nEND AS is_ck_mb_tested\nFROM labevents l\nJOIN admissions a ON l.subject_id = a.subject_id AND l.hadm_id = a.hadm_id\nWHERE l.subject_id = 10029291 AND l.charttime = (\n    SELECT MIN(charttime) \n    FROM labevents \n    WHERE subject_id = 10029291\n) AND l.itemid IN (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label = 'CK-MB Index'\n);",
    "26fa750dccd4c284472ecb48": "",
    "c8c821f2bce77aa592def2d7": "SELECT \n  CASE \n    WHEN COUNT(microbiologyevents.subject_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS recent_test_results\nFROM \n  microbiologyevents\nWHERE \n  microbiologyevents.subject_id = 10005348\n  AND DATE(microbiologyevents.charttime) >= DATE('now', '-24 months');",
    "c0193e5f3d01df8825ae0a53": "select records from the `microbiologyevents` table where the `subject_id` matches the patient ID and the `charttime` is greater than or equal to the specified date.\n\n4. **Construct the Query**:\n   - Use an `INNER JOIN` to link the `microbiologyevents` table with the `admissions` table on the `hadm_id` to ensure we are looking at the correct admissions for the patient.\n   - Use the `WHERE` clause to filter the results based on the patient ID and the date condition.\n\nHere is the final SQL query:",
    "6e5cae3a2758b55ff0bbfc87": "SELECT \n    CASE \n        WHEN MAX(charttime) > DATE('now', '-1 year') THEN 'Yes'\n        ELSE 'No'\n    END AS recent_microbiology_test\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10039997;",
    "4a8bec0e16a11e2197448c3b": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS microbe_test\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10038933\n    AND charttime >= '2023-08-01' \n    AND charttime < '2024-08-01';",
    "adfdf07d99e741f927fb639b": "SELECT \n    MAX(m.charttime) AS last_microbio_test\nFROM \n    microbiologyevents m\nJOIN \n    admissions a ON m.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10011398\n    AND m.charttime >= DATE('now', '-2 months')",
    "1abc175490e91fdbe78482fb": "Select the `subject_id` to identify the patient.\n3. Check if the `charttime` falls within the current year using a date comparison.\n4. Use `strftime` to extract the year from `charttime` and compare it with the current year.",
    "1c70ab701577302fd7bec691": "SELECT \n    subject_id, \n    MIN(charttime) AS earliest_test_time\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10006053 AND \n    charttime >= '2009-09-21'\nGROUP BY \n    subject_id;",
    "4f4a3bef12490dacc3837b15": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS has_organism\nFROM \n  microbiologyevents \nWHERE \n  subject_id = 10002495 \n  AND charttime LIKE '%/%/06%' \n  AND spec_type_desc = 'First urine test' \n  AND org_name IS NOT NULL;",
    "987c4c9f04e411a9be21bae2": "",
    "128670f0128422d00c359ab0": "WITH RecentMicrobioEvents AS (\n    SELECT \n        subject_id,\n        spec_type_desc,\n        org_name,\n        charttime,\n        ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY charttime ASC) AS event_rank\n    FROM \n        microbiologyevents\n    WHERE \n        subject_id = 10005348\n        AND charttime > DATE('now', '-1 year')\n        AND spec_type_desc = 'Blood Culture'\n)\nSELECT \n    CASE \n        WHEN MAX(event_rank) > 0 AND MAX(org_name) IS NOT NULL THEN 'Yes'\n        ELSE 'No'\n    END AS has_organism\nFROM \n    RecentMicrobioEvents;",
    "2001cff617f1e7a9c0034942": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS found\nFROM \n    microbiologyevents\nWHERE \n    subject_id =",
    "1478b8ca5010dfa67a0ce559": "SELECT CASE \n         WHEN COUNT(m.org_name) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS has_organism\nFROM microbiologyevents m\nJOIN admissions a ON m.hadm_id = a.hadm_id\nWHERE a.subject_id = 10007928\nAND m.charttime = (\n  SELECT MAX(charttime)\n  FROM microbiologyevents\n  WHERE hadm_id = a.hadm_id\n  AND spec_type_desc = 'Serology/Blood Test'\n);",
    "ec96517b92997f0de9c0bbbe": "SELECT \n    MIN(m.charttime) AS earliest_charttime\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    microbiologyevents m ON a.hadm_id = m.hadm_id\nWHERE \n    p.subject_id = 10002428  \n    AND m.charttime >= DATE('now', '-1 year')\n    AND m.spec_type_desc = 'Blood Culture'\n    AND m.org_name IS NOT NULL;",
    "623a4a91b019a3f07aa9fbb9": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_microorganism\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10012552\n  AND charttime LIKE '04/%/2023%' \n  AND spec_type_desc = 'Staph Aureus Swab'\n  AND org_name IS NOT NULL;",
    "8ad3bd73b83b2ac224da4fdb": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS administered\nFROM \n    inputevents\nWHERE \n    subject_id = 10007058 \n    AND starttime >= '2021-10-01';",
    "422b6f9b75c44635d538e4ce": "SELECT MAX(totalamount) AS po_intake\nFROM inputevents\nWHERE subject_id = 10018845 AND starttime >= '2021-03-19 00:00:00' AND itemid IN (\n    SELECT itemid\n    FROM d_items\n    WHERE abbreviation = 'PO'\n)",
    "e53e5f3db28341b88fe8d653": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 1\n        ELSE 0\n    END AS has_input_events\nFROM inputevents\nJOIN FirstICUStay ON inputevents.stay_id = FirstICUStay.stay",
    "561e8b21d83aed1d199886d6": "SELECT \n    p.subject_id,\n    pr.drug,\n    pr.starttime\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n    p.subject_id = 10027602\n    AND pr.drug = 'dextrose 5%'\n    AND pr.starttime >= '2002-02-21';",
    "e84f32d4fad193387ab842e2": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10007818 AND starttime >= '2000-06-21' AND drug = 'STERILE WATER';",
    "e6ac4f454e0ced3ae3ac6332": "",
    "f67fb672b995cf406d9a11a1": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN iu.itemid = 227412 THEN iu.totalamount ELSE 0 END) > 0 \n      AND MAX(CASE WHEN iu.itemid = 225829 THEN iu.totalamount ELSE 0 END) > 0 \n      AND iu.stay_id = (\n        SELECT MIN(stay_id) \n        FROM icustays \n        WHERE subject_id = 10035185\n      ) \n    THEN 'Yes' \n    ELSE 'No' \n  END AS or_crystalloid_administered\nFROM icustays icu\nJOIN inputevents iu ON icu.stay_id = iu.stay_id\nWHERE icu.subject_id = 10035185;",
    "58a8117dba6b4ae43b573d05": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_occurred\nFROM \n    outputevents\nWHERE \n    subject_id = 10026354 \n    AND charttime >= '2021-10-04' \n    AND itemid IN (\n        SELECT \n            itemid \n        FROM \n            d_items \n        WHERE \n            label = 'Urine Output'\n    );",
    "66226330040dffdd0d5fd903": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_foley\nFROM \n    inputevents ie\nJOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    ie.subject_id = 10015931 \n    AND di.label = ' Foley Catheter'\n    AND ie.starttime LIKE '2022-12-09%';",
    "471c207da5409f3275cc20cb": "SELECT DISTINCT e.eventtype\nFROM transfers e\nWHERE e.subject_id = 10011398 AND e.eventtype = 'chest tube #1';",
    "e58ee0e5c472679a4d86b25e": "SELECT \n  CASE \n    WHEN totalamountuom = ' Foley' AND totalamount > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS had_foley\nFROM inputevents\nWHERE subject_id = 10022017 AND starttime >= '2023-10-03' AND starttime < '2023-10-04';",
    "0c5849747818dd64e3090cd8": "SELECT CASE WHEN COUNT(*) > 0 THEN 'Yes' ELSE 'No' END AS emesis_occurred\nFROM outputevents\nWHERE subject_id = 10025612\nAND charttime = '2023-10-02'\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'Emesis');",
    "cea5a40f3d9844b4ee58041d": "",
    "40de69e222a145027e4f2169": "SELECT \n    CASE \n        WHEN d.valueuom = 'mmHg' AND d.valuenum > 90 AND d.valuenum <= 120 THEN 'Normal'\n        ELSE 'Abnormal'\n    END AS blood_pressure_status\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    chartevents c ON a.hadm_id = c.hadm_id\nJOIN \n    d_items d ON c.itemid = d.itemid\nWHERE \n    p.subject_id = 10029291 AND d.label = 'Blood Pressure' AND c.charttime LIKE '%03/21%';",
    "41e5c617af3a91492dc2e3d0": "SELECT \n    l.charttime AS event_time,\n    l.valueuom AS unit,\n    l.valuenum AS value,\n    CASE \n        WHEN l.valuenum > 95 THEN 'Normal'\n        ELSE 'Abnormal'\n    END AS SpO2_status\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10016742\n    AND d.label = 'SpO2'\nORDER BY \n    l.charttime DESC\nLIMIT 1;",
    "97551740a3b364d8e2b6214c": "",
    "b23b961d0f2fe2cf1eec5a22": "",
    "9a2f8970fbd241c4a1994704": "",
    "9e463af82f31adb188a12310": "",
    "b8e813ddf11159fa6c4ca4ca": "SELECT \n    (CASE \n        WHEN c.valuenum BETWEEN 90 AND 100 THEN 'Within Normal Range'\n        ELSE 'Outside Normal Range'\n     END) AS SpO2_Range\nFROM chartevents c\nJOIN d_items d ON c.itemid = d.itemid\nJOIN patients p ON c.subject_id = p.subject_id\nWHERE p.subject_id = 10007818 \n  AND c.charttime BETWEEN '2023-07-08 00:00:00' AND '2023-07-08 23:59:59'\n  AND d.label = 'SpO2';",
    "d90596b35371ba4a84a1a128": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10020187;",
    "2fe2de5ecc04ecf656ea58f3": "SELECT a.admittime\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.subject_id = 10023117 AND a.admittime >= DATE('now', '-1 year');",
    "0980045acad692ba2a8996db": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10016742 AND admittime >= '2100-01-01';",
    "05ac3a771a3724d766be2218": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10018423 AND SUBSTR(hadm_id, 1, 4) = '2100';",
    "89880a69f1f260cad697501f": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10038999 \nAND admittime >= '2023-01-01';",
    "fcb5ab40c54f3bce352480bc": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10020740 AND hadm_id = 2100;",
    "bee55ba67d6da489306ff469": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10035185;",
    "b9c136c1e1d19649caabdeb4": "",
    "ab28063625f4ba14b3379479": "SELECT STRFTIME",
    "abd48dc45ba90022382e02c9": "SELECT \n    strftime('%Y-%m', c.charttime) AS month,\n    AVG(c.valuenum) AS average_creatinine\nFROM \n    chartevents c\nJOIN \n    d_items d ON c.itemid = d.itemid\nWHERE \n    d.label = 'Creatinine, urine in 2100' AND c.subject_id = 10021666\nGROUP BY \n    month\nORDER BY \n    month;",
    "4ea43bff9e1b8d9f142a816d": "SELECT strftime('%Y', ce.charttime) AS year, MIN(ce.valuenum) AS min_mcv\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN chartevents ce ON a.hadm_id = ce.hadm_id\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE p.subject_id = 10021118\n  AND ce.charttime >= '10/2100'\n  AND di.label = 'MCV'\nGROUP BY strftime('%Y', ce.charttime);",
    "7a60c2c50fa3345765a83271": "WITH MonthlyData AS (\n  SELECT\n    strftime('%Y-%m', charttime) AS month,\n    MIN(valuenum) AS min_value\n  FROM labevents\n  WHERE subject_id = 10038999\n    AND itemid = 2100\n  GROUP BY month\n)\nSELECT\n  month,\n  min_value\nFROM MonthlyData\nORDER BY month;",
    "acc9bade197c3728c67fcdd7": "SELECT \n    strftime('%Y-%m-%d', l.charttime) AS day,\n    MIN(l.valuenum) AS min_bilirubin_direct\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10021487 AND\n    d.label = 'Bilirubin, Direct",
    "249619a43d4c7fe7add673f1": "SELECT MAX(T2.valuenum) AS max_ld\nFROM patients AS T1\nJOIN labevents AS T2 ON T1.subject_id = T2.subject_id\nJOIN d_labitems AS T3 ON T2.itemid = T3.itemid\nWHERE T1.subject_id = 10038933\n  AND T3.label = 'ld'\n  AND T2.charttime >= '2100-01-01'\nGROUP BY strftime('%Y', T2.charttime);",
    "c0faf3e95f2c2000bdda5a2e": "SELECT \n  strftime('%Y-%m', charttime) AS month,\n  AVG(T1.valuenum) AS average_weight\nFROM \n  chartevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\n  INNER JOIN admissions AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE \n  T2.label = 'Weight (kg)'\n  AND T3.subject_id = 10036156\n  AND T3.hadm_id",
    "fa0c00e540e79ae2f208cdee": "SELECT AVG(T1.valuenum) AS average_weight\nFROM chartevents AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.subject_id = 10038933\nAND T1.itemid = (\n  SELECT itemid\n  FROM d_items\n  WHERE label = 'Weight'\n)\nAND T1.charttime BETWEEN T2.admittime AND T2.dischtime;",
    "996258522002126afaf5a3c0": "SELECT \n    MIN(valuenum) AS min_weight\nFROM \n    chartevents\nWHERE \n    subject_id = 10027445 \n    AND itemid = 73 \n    AND charttime >= '2100-01-01' \n    AND charttime < '2100-12-31';",
    "42d490e9dcc8cd200649d0ff": "SELECT MIN(valuenum) AS min_monthly_weight\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE di.label = 'Weight'\n  AND ce.charttime LIKE '2100-%'\n  AND ce.subject_id = 10014729\n  AND di.valueuom = 'kg';",
    "e8a376ca7f202983221786bd": "SELECT \n    DATE(ce.charttime) AS chart_date,\n    MAX(ce.valuenum) AS max_weight\nFROM \n    chartevents ce\nJOIN \n    patients p ON ce.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10018081 AND\n    ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\nGROUP BY \n    chart_date\nHAVING \n    chart_date >= '2022-11-21'\nORDER BY \n    chart_date;",
    "b029fa60f795c16ffec2ddf9": "WITH PatientWeightCTE AS (\n    SELECT\n        c.subject_id,\n        c.charttime,\n        c.valuenum AS weight,\n        c.valueuom AS unit\n    FROM\n        chartevents c\n    INNER JOIN\n        d_items i ON c.itemid = i.itemid\n    WHERE\n        i.label = 'Weight'\n        AND c.subject_id = 10021487\n        AND c.charttime >= DATE('now', '-16 months')\n),\nDailyWeightCTE AS (\n    SELECT\n        subject_id,\n        DATE(charttime) AS date,\n        AVG(weight) AS avg_weight\n    FROM\n        PatientWeightCTE\n    GROUP BY\n        subject_id, date\n)\nSELECT\n    AVG(avg_weight) AS daily_average_weight\nFROM\n    DailyWeightCTE;",
    "230b50a3e6a330e4047ecfd0": "SELECT \n    AVG(t.valueuom) AS average_weight\nFROM \n    chartevents t\nJOIN \n    d_items d ON t.itemid = d.itemid\nWHERE \n    t.subject_id = 10014729 \n    AND t.charttime LIKE '%2003-21%'\n    AND d.label = 'Patient Weight'",
    "8a5a5d29e1a51c172836525e": "",
    "c37d80a17e1432e62f2c945c": "SELECT \n    i.subject_id,\n    i.hadm_id,\n    i.itemid,\n    i.starttime,\n    i.totalamount,\n    i.totalamountuom\n  FROM inputevents i\n  JOIN First",
    "4811bca64998a864d6db6bc5": "SELECT date(starttime) AS date_of_intake, MAX(totalamount) AS max_totalamount\nFROM inputevents\nWHERE subject_id = 10000032 AND totalamountuom = 'po'\nGROUP BY date(starttime)\nORDER BY date_of_intake;",
    "53d67e5afb0eef3231919c0e": "SELECT \n  MAX(CASE WHEN T2.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10019172 AND hadm_id = T1.hadm_id) THEN T2.valuenum END) AS max_kcl_input\nFROM \n  admissions T1\n  INNER JOIN chartevents T2 ON T1.hadm_id = T2.hadm_id\n  INNER JOIN d_items T3 ON T2.itemid = T3.itemid\nWHERE \n  T1.subject_id = 10019172 AND\n  T3.label = 'Bolus KCL Input'",
    "5edb24fc6b54aabb2e6f6f5c": "Select Relevant Columns**: The relevant columns are `subject_id`, `starttime`, and `totalamount`.\n\nGiven these requirements, the SQL query should:\n\n- Filter records by `subject_id = 10039831`.\n- Filter records by `starttime` greater than or equal to `12/05/2100`.\n- Group the",
    "4e02c94268e273ceadb20be5": "SELECT\n    strftime('%Y-%m', T1.starttime) AS month,\n    MIN(T1.dose_val_rx",
    "e9a0e7111e770b55741de154": "SELECT \n  strftime('%Y-%m', P.starttime) AS month_year,\n  AVG(P.dose_val_rx) AS average_dose\nFROM \n  prescriptions P\nWHERE \n  P.subject_id = 100",
    "8a0c7a7faca024a1eb4dd993": "SELECT \n    DATE(e.charttime) AS date,\n    MAX(e.valuenum) AS max_value\nFROM \n    chartevents e\nJOIN \n    patients p ON e.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10010471\n    AND e.itemid = 1249\n    AND e.charttime >= DATE('now', '-14 days')\nGROUP BY \n    DATE(e.charttime);",
    "2783cbb5eccb2b4d0c78a1e0": "SELECT\n  DATE(e.charttime) AS date,\n  MAX(e.valuenum) AS max_systolic_bp\nFROM\n  labevents e\n  INNER JOIN d_labitems d ON e.itemid = d.itemid\n  INNER JOIN admissions a ON e.hadm_id = a.hadm_id\n  INNER JOIN patients p ON a.subject_id = p.subject_id\nWHERE\n  p.subject_id = 10003046\n  AND d.label = 'Systolic Blood Pressure'\nGROUP BY\n  DATE(e.charttime);",
    "dca7f0863bc05ed189b1b292": "",
    "e1d0b53beabc24ec45e07b2d": "SELECT \n    STRFTIME('%Y-%m', ce.charttime) AS month,\n    AVG(ce.valuenum) AS average_respiratory_rate\nFROM \n    chartevents ce\nINNER JOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10038999 \n    AND ce.hadm_id = 1 \n    AND di.label = 'Respiratory Rate'\nGROUP BY \n    month\nORDER BY \n    month;",
    "f5f18cb5c4dd940a95ec5360": "SELECT\n    DATE(charttime) AS date,\n    MAX(valuenum) AS max_temp\n  FROM\n    BodyTemperatureMeasurements\n  GROUP",
    "0d7f97f7f014369165ccb406": "SELECT\n    l.charttime,\n    MAX(l.valuenum) AS max_systolic_blood_pressure\nFROM\n    patients p\nJOIN\n    labevents l ON p.subject_id = l.subject_id\nWHERE\n    p.subject_id = 10005817\n    AND l.itemid = 584\n    AND l.charttime >= date('now', '-14 months')\nGROUP BY\n    l.charttime\nORDER BY\n    l.charttime ASC;",
    "2c5b0c8baa3288cd5ae25871": "",
    "5e1e03c6f5228f110a137a50": "SELECT \n    COUNT(*) AS total_visits\nFROM \n    admissions a\nWHERE \n    a.subject_id = 10023117 \n    AND a.dischtime >= '2100-01-01' \n    AND a.dischtime < '2101-01-01';",
    "cfd45a15a268ad1a89df54dd": "SELECT COUNT(*) AS total_hospitalizations\nFROM admissions\nWHERE subject_id = 10020944\nAND admittime > DATE('now', '-1 year');",
    "93181a0681785a3fc636f0c0": "",
    "1565b3431aebbecefff6df1d": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10018501;",
    "97aace30ba0ffdefe43a92fd": "SELECT COUNT(DISTINCT hadm_id) AS visit_count\nFROM admissions\nWHERE subject_id = 10014729;",
    "2e777a27e1019908bf9c76e0": "SELECT COUNT(*) AS total_hospital_visits\nFROM admissions\nWHERE subject_id = 10003400 AND admittime >= DATE('now', '-1 year');",
    "bb96274f7d0903a6f3ad4e76": "",
    "c6ef8b615b48c60724e2636d": "SELECT COUNT(*) AS icu_stay_count\nFROM icustays\nWHERE subject_id = 10022880;",
    "6065fc09f8cb8ae10fb76e62": "WITH FirstAdmissionCTE AS (\n  SELECT subject_id, MIN(hadm_id) AS first_hadm_id\n  FROM admissions\n  WHERE subject_id = 10038081\n  GROUP BY subject_id\n)\nSELECT COUNT(icu.stay_id) AS total_icu_stays\nFROM icustays icu\nJOIN FirstAdmissionCTE fa ON icu.hadm_id = fa.first_hadm_id;",
    "3476f7a1daff51acd412b499": "SELECT COUNT(DISTINCT stay_id) AS icu_visits\nFROM icustays icu\nJOIN admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE icu.subject_id = 10029291\nAND icu.intime >= datetime('now', '-1 year');",
    "2e1336e1727d7e40e18f93c4": "SELECT COUNT(*) AS icu_visits\nFROM icustays icu\nINNER JOIN admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE icu.subject_id = 10037975 AND adm.subject_id = 10037975\n  AND adm.admittime = (\n    SELECT MAX(admittime) \n    FROM admissions \n    WHERE subject_id = 10037975\n  );",
    "c25b681b346061f536aabbe6": "",
    "2b28101243e3c66e8678625b": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10021938 AND SUBSTR(outtime, 1, 4) = '2100';",
    "4a84bbe324a00742f9bdfa52": "SELECT COUNT(*) \nFROM icustays \nWHERE hadm_id = (\n  SELECT hadm_id \n  FROM admissions \n  WHERE subject_id = 10004720 \n  ORDER BY admittime DESC \n  LIMIT 1\n);",
    "72f9afe9d7752f2079ec4df1": "SELECT COUNT(DISTINCT drug) AS total_drugs_prescribed\nFROM prescriptions\nWHERE subject_id = 10024043 AND starttime >= '2100-01-01';",
    "9db928d9e5f6893e61f4f006": "SELECT \n    COUNT(DISTINCT drug) AS unique_drugs\nFROM \n    prescriptions\nWHERE \n    subject_id = 10007818\n    AND starttime >= '2023-07-01 00:00:00'\n    AND starttime < '2023-08-01 00:00:00';",
    "ba5d2c366e08023fec9bfbe5": "SELECT COUNT(DISTINCT drug) \nFROM prescriptions \nWHERE subject_id = 10000032 AND starttime >= DATE('now', '-10 month');",
    "5861ef095f4c08ad236ab8c5": "select `subject_id` and `drug` from the `prescriptions` table.\n- We need to join the `patients` and `prescriptions` tables on `subject_id` to ensure we are filtering for the correct patient.\n- We filter the records where `subject_id` is `10005909` and `starttime` is on or after `2010-10-01`.\n- Finally, we count the distinct `drug",
    "8db871c52022d633a9f58b11": "SELECT COUNT(DISTINCT drug)\nFROM prescriptions\nWHERE subject_id = 10004720\n  AND starttime >= '2021-11-21 00:00:00';",
    "81a5e45699cfa054a335726f": "SELECT COUNT(DISTINCT drug) \nFROM prescriptions \nWHERE subject_id = 10009628 \nAND starttime >= '2023-09-01 00:00:00' \nAND starttime < '2023-10-01 00:00:00';",
    "99420e9ae112f93bdf6f421a": "SELECT COUNT(DISTINCT drug) AS number_of_distinct_drugs_prescribed\nFROM prescriptions\nWHERE subject_id = 10021938 AND starttime > DATE('now', '-2 months');",
    "b0c1e2c1046cc6dad14ddbe4": "SELECT COUNT(p.subject_id) \nFROM prescriptions p\nWHERE p.drug = 'chlorhexidine gluconate 0.12% oral rinse in 03/2100'\nAND p.subject_id = 10020740;",
    "3290627f36487b94ca743ca3": "SELECT COUNT(*) AS num_prescriptions\nFROM prescriptions\nWHERE subject_id = 10018081\n  AND drug = '5% dextrose'\n  AND starttime >= '2023-12-01'\n  AND starttime < '2024-01-01';",
    "f737cdc1f727761a17f22b7d": "select the count of prescriptions matching the criteria.",
    "0035d27329064c6e313badd1": "SELECT \n  COUNT(*) AS total_milk_of_magnesia_prescriptions\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10005348 \n  AND p.drug = 'milk of magnesia' \n  AND p.starttime >= '2023-09-01' \n  AND p.starttime < '2023-10-01';",
    "75f2ab4d9c265d10a7c0876f": "",
    "76ddecbe56caba3073d76d2d": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions p\nWHERE p.subject_id = 10038933\n  AND p.drug = 'LEVITIRACETAM ORAL SOLUTION (LEVITIRACETAM)'\n  AND p.route = 'ORAL SOLUTION (09/2100)';",
    "70280353be78e0850355e08c": "SELECT COUNT(*) AS num_prescriptions\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.drug = 'famotidine' \nAND a.subject_id = 10016810 \nAND a.hadm_id = (\n    SELECT MAX(hadm_id) \n    FROM admissions \n    WHERE subject_id = 10016810\n);",
    "bca12dbeb197151809e62874": "SELECT COUNT(*) AS number_of_ast_tests\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10009628\nAND d_labitems.label = 'AST';",
    "18804b0230296456eb7bf9f3": "SELECT COUNT(*) AS hemoglobin_test_count\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10039831\nAND d.label = 'HEMOGLOBIN';",
    "e46aecc50872e5e43f5dec8b": "SELECT COUNT(labevents.row_id) AS count\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10038999 AND d_labitems.label = 'Lipase';",
    "da0d0d0112db58fa527f189f": "SELECT COUNT(*) \nFROM labevents \nWHERE subject_id = 10015931 \n  AND itemid = (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label = 'Osmolality, Urine'\n  ) \n  AND valueuom = '2100';",
    "6b5cff60f50561310ed8c3c2": "SELECT \n  COUNT(*) AS total_plt_count_tests\nFROM \n  labevents l\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10011398\n  AND d.label = 'PLATELET COUNT'\n  AND l.charttime >= DATE('now', '-1 year",
    "d535c91e21f7926fb37d3dd8": "SELECT COUNT(*) \nFROM labevents le\nJOIN d_labitems di ON le.itemid = di.itemid\nWHERE le.subject_id = 10018845\n  AND di.label = 'Hemoglobin'\n  AND le.charttime >= '07/2100';",
    "272b7419a6f4ac420aae5839": "SELECT COUNT(*) \nFROM labevents AS le \nJOIN d_labitems AS li ON le.itemid = li.itemid \nWHERE li.label = 'Bicarbonate Test' \nAND le.subject_id = 10002428 \nAND le.charttime BETWEEN '2023-07-01' AND '2023-07-31';",
    "f9e651bab94c8b0cbc349c8a": "",
    "42133f6ce3b196288d44b9b7": "",
    "822fb5a81c6aa96e17079981": "SELECT COUNT(*) AS current_patients_count\nFROM patients\nWHERE dod IS NULL;",
    "adeec8d4eea99ded1a136fb0": "SELECT COUNT(*) AS current_patient_count\nFROM patients;",
    "b4e5170ce76c3fd49390d922": "",
    "b9dd758d1b4184744da4955b": "select patients who are alive, which means they have a `dob` (date of birth) but no `dod` (date of death). This can be achieved by using a `WHERE` clause to check for the presence of `dob` and the absence of `dod`.\n\n2. **Calculate Age**: To determine if a patient is in their 30s, we need to calculate their age. The age can be calculated by subtracting the year of birth from the current year. We can use SQLite's `STRFTIME` function to extract the year from the `dob` and the current date. The formula for age would be:",
    "87df01ff8e5b34782b6f1bab": "",
    "29c1d5e3303ae477c836d0a2": "SELECT COUNT(*) \nFROM patients \nWHERE gender = 'Unknown' AND dob IS NOT NULL AND (dod IS NULL OR dod > CURRENT_DATE);",
    "87157dc1a0c697225e9e5356": "SELECT COUNT(*) AS current_age_50_59\nFROM patients\nWHERE strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 50 AND 59;",
    "466f29187cd0639b0ab5a25c": "SELECT COUNT(*) AS total_current_40s_age_group\nFROM patients\nWHERE gender = 'Current'\nAND strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 40 AND 49;",
    "1408ef03b015c82da341f94f": "SELECT COUNT(*) \nFROM patients \nWHERE strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 30 AND 39 \n  AND dod IS NULL;",
    "06766659b8f16c2233c677bd": "SELECT \n        p.subject_id,\n        CASE \n            WHEN p.dod IS NULL THEN 1\n            ELSE",
    "84cb84cd44b575f06211c452": "",
    "6292671bc40ee6988cb71e1f": "WITH AlteplasePatients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    INNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\n    WHERE d.icd_code = 'F20' \n      AND pr.drug = 'alteplase'\n),\nSurvivalRate AS (\n    SELECT p.subject_id,\n           CASE \n               WHEN p.dod IS NULL THEN 1\n               ELSE 0\n           END AS survived_3_months\n    FROM patients p\n    INNER JOIN AlteplasePatients ap ON p.subject_id = ap.subject_id\n    WHERE p.dod IS NOT NULL AND p.dod - p.dob <= 90\n)\nSELECT AVG(survived_3_months) AS three_month_survival_rate\nFROM SurvivalRate;",
    "0c87ffd881def44ba1a584a4": "SELECT dt.subject_id, dt.hadm_id, dt.diagnosis_time, pt.prescription_time,\n           julianday(pt.prescription_time",
    "67fe7f95e308db2d9fe6ec8f": "",
    "f92a0c61488b57aa3f7e3ab1": "SELECT\n    p.subject_id\n  FROM prescriptions p",
    "6db6baede71203bbf3781655": "",
    "bb7f918822ae905cff9cc39e": "WITH mortality_rate AS (\n  SELECT \n    d1.icd_code,\n    COUNT(*) AS mortality_count\n  FROM diagnoses_icd d1\n  JOIN admissions a ON d1.hadm_id = a.hadm_id\n  WHERE a.dischtime IS NOT NULL AND \n        a.dischtime > (a.admittime + 3 * 30 * 24 * 60 * 60) \n  GROUP BY d1.icd_code\n),\ntop_mortality_rate AS (\n  SELECT icd_code, mortality_count\n  FROM mortality_rate\n  ORDER BY mortality_count DESC\n  LIMIT 4\n)\nSELECT \n  d1.icd_code,\n  d2.long_title,\n  t1.mortality_count\nFROM top_mortality_rate t1\nJOIN d_icd_diagnoses d2 ON t1.icd_code = d2.icd_code\nJOIN diagnoses_icd d1 ON t1.icd_code = d1.icd_code;",
    "808dfe41dea511c9420e7b88": "Select the top 5 diagnoses**:\n   - We will use the `ORDER BY` clause to sort the diagnoses by their 6-month mortality rate in descending order.\n   - We will use the `",
    "7cc086ff238e8366912ab6a9": "WITH \nDiagnosisMortality AS (\n    SELECT \n        icd_code,\n        COUNT(*) AS mortality_count\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        admissions a ON d.subject_id = a.subject_id AND d.hadm_id = a.hadm_id\n    WHERE \n        a.dischtime > DATE('now', '-6 months')\n    GROUP BY \n        icd_code\n),\nTopDiagnoses AS (\n    SELECT \n        icd_code,\n        mortality_count\n    FROM \n        DiagnosisMortality\n    ORDER BY \n        mortality_count DESC\n    LIMIT 4\n)\nSELECT \n    icd_code\nFROM \n    TopDiagnoses;",
    "66e468b8ba6fe6d332363ba2": "SELECT \n        d.subject_id,\n        d.hadm_id,\n        d.icd_code,\n        d.charttime,\n        a.admittime,\n        a.dischtime,\n        p.dod,\n        CASE\n            WHEN p.dod IS NOT NULL AND julianday(p.dod) -",
    "561a6f6df9ce2b72802718f6": "select the top three.",
    "4b624ad8a3b82ed7e3e29dc3": "",
    "33531c8f62b92bd9245b9217": "",
    "18df7b68a00300388686a82b": "",
    "c818322213949df55b14a582": "SELECT \n        T1.hadm_id, \n        SUM(T3.cost) AS total_cost\n    FROM \n        procedures_icd T1\n    INNER JOIN \n        d_icd_procedures T2 ON T1.icd_code = T2.icd",
    "719bc524af77a513ee6e0aa0": "WITH total_cost AS (\n    SELECT\n        c.subject_id,\n        SUM(c.cost) AS total_cost\n    FROM\n        cost c\n    INNER JOIN\n        diagnoses_icd d ON c.event_id = d.row_id AND c.event_type = 'Diagnosis'\n    INNER JOIN\n        d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE\n        d2.long_title LIKE 'Insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)'\n    GROUP BY\n        c.subject_id\n)\nSELECT\n    MAX(total_cost) AS max_total_cost\nFROM\n    total_cost;",
    "37edc3b1fd1e40d2f63d5c01": "SELECT AVG(T2.cost) AS avg_total_cost\nFROM diagnoses_icd AS T1\nINNER JOIN cost AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.icd_code = 'L41.00' AND T2.event_type = 'Hospital';",
    "29fabfc4794a216ba5bf1993": "",
    "778832d66a9a3b3ebeb51d39": "SELECT AVG(T2.cost) AS average_total_cost\nFROM diagnoses_icd T1\nJOIN cost T2 ON T1.hadm_id = T2.hadm_id\nJOIN d_icd_diagnoses T3 ON T1.icd_code = T3.icd_code\nWHERE T3.long_title = 'Extirpation of matter from lung lingula, via natural or artificial opening endoscopic';",
    "7bc94deacf6c02cba88f38e5": "SELECT AVG(T1.cost) \nFROM cost AS T1 \nINNER JOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id \nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code \nWHERE T3.long_title = 'Other Bronchoscopy in 2100';",
    "5dc4ad2f2838085f7c4b9af3": "selects the maximum. However, the question specifically asks about the maximum overall hospital cost when it includes a phenytoin lab test since 2100. This implies that we should filter the lab events to include only those with phenytoin tests since 2100 and then calculate the total cost for those patients. Let's write the correct query.",
    "e684deacbe9f8050fb9c2537": "SELECT \n    c.hadm_id,\n    SUM(c.cost) AS total_cost\n  FROM cost c\n  INNER JOIN lab",
    "d91ba5c2ed88034e0a2b3870": "SELECT d_labitems.itemid\n        FROM d_lab",
    "f25934f599ad692e3d1cd779": "WITH hemoglobin_tests AS (\n  SELECT \n    l.subject_id,\n    l.charttime,\n    l.itemid,\n    d.label\n  FROM \n    labevents l\n    JOIN d_labitems d ON l.itemid = d.itemid\n  WHERE \n    d.label LIKE '%hemoglobin%' \n    AND l.charttime >= DATE('now', '-1 year')\n)\nSELECT \n  MIN(total_cost)\nFROM (\n  SELECT \n    SUM(c.cost) AS total_cost\n  FROM \n    hemoglobin_tests h\n    JOIN cost c ON h.subject_id = c.subject_id \n               AND h.charttime = c.chargetime\n  GROUP BY \n    h.subject_id\n)",
    "8a678e5db3bbbe38b320aa96": "SELECT \n    MAX(T1.cost) AS max_cost\nFROM \n    cost T1\nINNER JOIN \n    labevents T2 ON T1.event_id = T2.row_id\nINNER JOIN \n    d_labitems T3 ON T2.itemid = T3.itemid\nWHERE \n    T3.label = 'lactate dehydrogenase' \n    AND T2.charttime >= '2100-01-01'\n    AND T1.event_type = 'lab'\n    AND T1.cost > 0;",
    "688e0f542dd5995fefbabee6": "SELECT MIN(T1.cost) AS min_cost\nFROM cost AS T1\nINNER JOIN labevents AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_labitems AS T3 ON T2.itemid = T3.itemid\nWHERE T3.label = 'Lipase' AND T1.event_type = 'charge';",
    "8b08fcfc0a63eadbb17b7167": "",
    "b0ded0fa2296a8f7a4d0926b": "SELECT AVG(c.cost) AS average_total_cost\nFROM cost c\nJOIN prescriptions p ON c.event_id = p.row_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title LIKE '%sulfameth/trimethoprim ss%' AND c.chargetime >= DATE('now', '-1 year');",
    "ee519753d2c9f939d5fb4219": "SELECT AVG(T3.cost) AS average_total_cost\nFROM admissions T1\nJOIN prescriptions T2 ON T1.hadm_id = T2.hadm_id\nJOIN cost T3 ON T1.hadm_id = T3.hadm_id\nWHERE T2.drug = 'neomycin-polymyxin-bacitracin' AND T3.event_type = 'hospital';",
    "3017014a16809262a247bee7": "SELECT \n  AVG(c.cost) AS average_total_cost\nFROM \n  cost c\n  INNER JOIN admissions a ON c.hadm_id = a.hadm_id\n  INNER JOIN prescriptions p ON a.hadm_id = p.hadm_id\nWHERE \n  c.event_type = 'medication'\n  AND p.drug = 'phenazopyridine'\n  AND STRFTIME('%Y', c.chargetime) = STRFTIME('%Y', 'now');",
    "6b5d224a0e7421bcf92afd3c": "WITH HospitalVisitsWithCarvedilol AS (\n  SELECT p.subject_id, p.hadm_id\n  FROM prescriptions p\n  WHERE p.drug = 'carvedilol' AND p.dose_val_rx = '2100'\n),\nTotalCostPerVisit AS (\n  SELECT c.subject_id, c.hadm_id, SUM(c.cost) AS total_cost\n  FROM cost c\n  JOIN HospitalVisitsWithCarvedilol hv ON c.subject_id = hv.subject_id AND c.hadm_id = hv.hadm_id\n  GROUP BY c.subject_id, c.hadm_id\n)\nSELECT MAX(total_cost) AS max_total_cost\nFROM TotalCostPerVisit;",
    "a1e65b03fe2b7016b885dc09": "SELECT \n        a.hadm_id\n    FROM \n        admissions a\n    JOIN \n        prescriptions p ON a.hadm_id = p.hadm_id\n    WHERE \n        p.drug = 'nicotine patch'\n        AND p.starttime > '21",
    "a1070d070dd65690e308619d": "SELECT MIN(T2.cost) AS minimum_total_cost\nFROM prescriptions AS T1\nINNER JOIN cost AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.drug = 'ezetimibe';",
    "064647795088c18c2eea104a": "SELECT \n  MAX(total_price) AS max_total_price\nFROM (\n  SELECT \n    SUM(c.cost) AS total_price\n  FROM prescriptions p\n  INNER JOIN cost c ON p.hadm_id = c.hadm_id\n  WHERE p.drug = 'vial in 2100'\n    AND c.event_type = 'Medication'\n  GROUP BY p.hadm_id\n) AS subquery;",
    "e2dee747281ae9a00c1fc13f": "SELECT MAX(T1.cost) AS total_hospital_cost\nFROM cost AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title LIKE '%esophageal obstruction%';",
    "86af6dbec3fe033cc1dee870": "WITH TotalCostCTE AS (\n    SELECT \n        event_type,\n        SUM(cost) AS total_cost\n    FROM \n        cost\n    WHERE \n        event_type = 'Postprocedural Pneumothorax in 2100'\n    GROUP BY \n        event_type\n)\nSELECT \n    MAX(total_cost) AS max_total_cost\nFROM \n    TotalCostCTE;",
    "416f64511f06e29fd379a373": "SELECT MIN(T1.cost) AS minimum_total_hospital_cost\nFROM cost AS T1\nJOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nJOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Unspecified mood [affective] disorder in 2100';",
    "40314c9ace9e04fb7834c2b1": "SELECT T1.hadm_id, SUM(T1.cost) AS total_cost\n    FROM cost T1\n    INNER JOIN diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\n    INNER JOIN d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\n    WHERE T3.long_title = 'Cerebral artery occlusion, unspecified with cerebral infarction in 2100",
    "fd9d2ad9b857f9d53588d882": "SELECT AVG(c.cost) AS average_cost\nFROM cost c\nINNER JOIN diagnoses_icd d ON c.event_id = d.row_id\nINNER JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title = 'Postprocedural Hypotension';",
    "ecd19094660d16b8b750e976": "",
    "1d487033ea60fadd114b1b53": "",
    "93102b4334928d2d31c801fb": "SELECT \n    strftime('%Y', T2.dob) AS year,\n    COUNT(T1.subject_id) AS number_of_records\nFROM \n    patients AS T1\nINNER JOIN \n    diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n    T2.icd_code = 'V07.0' \n    AND strftime('%Y', T2.charttime) >= '2100'\nGROUP BY \n    year\nORDER BY \n    number_of_records DESC\nLIMIT 1;",
    "0d43d9237d6c0f97e565e463": "SELECT \n    strftime('%Y-%m', T2.charttime) AS month,\n    COUNT(T2.subject_id) AS max_records\nFROM \n    diagnoses_icd AS T1\nJOIN \n    admissions AS T2 ON T1.hadm_id = T2.hadm_id\nJOIN \n    d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nWHERE \n    T3.long_title = 'Other Reconstructive Surgery'\n    AND T1.charttime > '2100-01-01'\nGROUP BY \n    month\nORDER BY \n    month DESC;",
    "e2beb6df478d6979ad0aa648": "SELECT \n  MAX(monthly_count) AS max_monthly_gout_patients\nFROM (\n  SELECT \n    COUNT(DISTINCT p.subject_id) AS monthly_count\n  FROM patients p\n  JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE di.long_title = 'Gout, unspecified since 2100'\n    AND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', p.dob)\n  GROUP BY strftime('%Y-%m', d.charttime)\n) AS monthly_counts;",
    "1cb58d36d8c6b931e631e3da": "SELECT MIN(yearly_number) AS min_yearly_number\nFROM (\n    SELECT \n        strftime('%Y', c.chargetime) AS year, \n        COUNT(DISTINCT p.subject_id) AS yearly_number\n    FROM cost c\n    INNER JOIN patients p ON c.subject_id = p.subject_id\n    INNER JOIN diagnoses_icd d ON c.hadm_id = d.hadm_id\n    WHERE d.icd_code = 'K57.0'  \n    AND c.chargetime > '2100-01-01'\n    GROUP BY year\n) AS yearly_counts;",
    "96da08df43f14b5424aed61f": "SELECT\n  AVG(daily_patient_count",
    "799182af909a63e2da1ddacf": "",
    "b720f1ba67b87fd98f11e04c": "SELECT\n        strftime('%Y-%m', charttime) AS month,\n        COUNT(*) AS record_count\n    FROM\n        RelevantRecords\n    GROUP BY",
    "278f3690974261bfe1e57d23": "SELECT COUNT(DISTINCT subject_id) AS patient_count\nFROM admissions\nWHERE dischtime > DATE('now', '-1 year');",
    "4c6b438bb57ca0920edd4e9c": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.admission_location = 'ER' AND a.discharge_location = 'Home' AND strftime('%Y', a.dischtime) = '2100';",
    "8ba9ec982c184a417b8e5f83": "SELECT COUNT(DISTINCT p.subject_id) AS released_patients\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE strftime('%Y', a.dischtime) = strftime('%Y', 'now');",
    "ebd67617c22beab016550006": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.dischtime > DATETIME('now', '-1 year');",
    "199488cf0d6a538d41fdc01b": "SELECT COUNT(DISTINCT subject_id) AS total_discharged\nFROM admissions\nWHERE strftime('%Y', disch",
    "6b1fd8208b249c9a3f399917": "SELECT COUNT(*) \nFROM patients \nWHERE strftime('%Y', dob) = strftime('%Y', 'now');",
    "f92a9715af7d181a656d4998": "SELECT COUNT(DISTINCT subject_id) AS NumberOfPatientsDischargedLastYear\nFROM admissions\nWHERE discharge_location = 'hospital'\nAND dischtime >= DATE('now', '-1 year');",
    "521aab3060d8c38e0cfbfa52": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM patients p\nJOIN icustays icu ON p.subject_id = icu.subject_id\nWHERE strftime('%Y', icu.outtime) = strftime('%Y', 'now')\nAND icu.last_careunit = 'micu/sicu';",
    "2d8946a73f748f86fc32345c": "SELECT COUNT(DISTINCT icu.subject_id) AS patient_count\nFROM icustays icu\nJOIN admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE icu.last_careunit = 'vascular'\nAND adm.admittime >= DATE('now','-1 year');",
    "b593bfbb3c11df43f547bfcc": "WITH \n  PatientsInICU AS (\n    SELECT \n      icustays.subject_id,\n      icustays.intime\n    FROM \n      icustays\n    WHERE \n      icustays.first_careunit = 'Medicine/Cardiology'\n  )\nSELECT \n  COUNT(DISTINCT PatientsInICU.subject_id) AS total_patients\nFROM \n  PatientsInICU\nWHERE \n  PatientsInICU.intime >= DATE('now', '-1 year');",
    "8ba1b2de9452cc1d23057b9f": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN icustays icu ON p.subject_id = icu.subject_id\nWHERE icu.first_careunit = 'neuro sicu' AND icu.intime >= DATE('now', '-1 year');",
    "a85685397831a790ea2cc0a7": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nINNER JOIN admissions a ON p.subject_id = a.subject_id \nWHERE a.admission_location = 'med/surg/gyn' AND a.admittime >= '2100-01-01';",
    "04ceafe43c52472b3acaedb4": "SELECT COUNT(DISTINCT T1.subject_id) AS total_patients\nFROM admissions AS T1\nJOIN icustays AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2",
    "775f200f8927ed7b82f10ff9": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN icustays i ON a.hadm_id = i.hadm_id\nWHERE a.dischtime >= DATE('now', '-1 year')\nAND i.last_careunit = 'discharge lounge';",
    "97d71a4dfbda63c1b6544be6": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d1 ON a.hadm_id = d1.hadm_id\nJOIN diagnoses_icd d2 ON a.hadm_id = d2.hadm_id\nWHERE d1.icd_code = 'P42.00'\n  AND d2.icd_code = 'P42.01'\n  AND d1.charttime < d2.charttime\n  AND a.dischtime BETWEEN d1.charttime AND DATE(d1.charttime, '+2 months');",
    "72392c4da0fd16d899e4307e": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN admissions a ON d.hadm_id = a.hadm_id\nWHERE d.icd_code = 'G92.10'\nAND a.admittime BETWEEN '2100-01-01' AND '2100-12-31'\nAND EXISTS (\n    SELECT 1\n    FROM diagnoses_icd d2\n    WHERE d2.subject_id = p.subject_id\n    AND d2.hadm_id = a.hadm_id\n    AND d2.icd_code = 'R19.90'\n);",
    "ddee5ac733d7dabd9130af5c": "",
    "d81467bbe205d33ca94ef61f": "SELECT",
    "43c158cb01b2f2079157b719": "",
    "3e9064d2108a3ee8c6ae4ee2": "",
    "f87b894e8644d660bf3e856f": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title = 'Collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture in 2100'\nAND a.admission_location = 'Patient Room (H)'\nAND a.admission_type = 'External Cause, Same Hospital Visit';",
    "dd686405621c04ac8522072e": "SELECT COUNT(T1.subject_id)\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nWHERE T2.long_title = '",
    "81a0501d514e4a4fa8672c08": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id \nINNER JOIN d_icd_diagnoses dicd ON d.icd_code = dicd.icd_code \nWHERE dicd.long_title = 'Body Mass Index (BMI) 19-24, Adult' \nAND p.dob > '2100-01-01';",
    "9e655b0885b1141a8fcb1bb1": "SELECT \n    COUNT(DISTINCT p.subject_id) AS total_number_of_patients\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN \n    d_icd_diagnoses d1 ON d.icd_code = d1.icd_code\nWHERE \n    d1.long_title = 'Major depressive disorder, single episode, unspecified';",
    "e843bc5ff21d749a06ab5bc3": "",
    "6708f1fa7b82536c05febcef": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.icd_code = 'R10.12' AND d2.long_title = 'Acute edema of lung, unspecified';",
    "6d5bb8b2a694bc9e91caea13": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Acute venous embolism and thrombosis of subclavian veins'\nAND d.charttime > DATE('now', '-1 year');",
    "9b08cb9ac92f27049de294fd": "",
    "a2af82429c00976d404b6e5d": "",
    "d09c79e777148f87f0c15c92": "",
    "c7bc7892dca1cc286f05887f": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN diagnoses_icd d ON p.subject_id = d.subject_id \nJOIN d_icd_procedures di ON d.icd_code = di.icd_code \nWHERE di.long_title = 'Other incision of brain' \nAND strftime('%Y', d.charttime) = strftime('%Y', 'now');",
    "3fa5e54471bc2eac34ec48ed": "",
    "ea784a4b3ba382dd3a8dca8e": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pi ON a.hadm_id = pi.hadm_id\nJOIN d_icd_procedures dip ON pi.icd_code = dip.icd_code\nWHERE dip.long_title = 'Aortography';",
    "e39e837fb8cffe6bbe93bb60": "WITH bypass_procedure AS (\n  SELECT subject_id\n  FROM procedures_icd p\n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  WHERE d.long_title = 'Bypass coronary artery, one artery from aorta with autologous venous tissue, open approach'\n    AND strftime('%Y', p.charttime) = '2100'\n)\nSELECT COUNT(*) AS total_patients\nFROM bypass_procedure;",
    "a8a7ae0b4b0cdddab9d4616d": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE pr.charttime BETWEEN '2100-01-01' AND '2100-12-31'\n  AND d.long_title = 'Excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure';",
    "af72aeed0e5cc61f2a10a8ed": "SELECT COUNT(DISTINCT T1.subject_id) AS patient_count\nFROM procedures_icd AS T1\nJOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nWHERE T2.long_title = 'insertion of infusion device into right atrium, percutaneous approach'\nAND T1.charttime >= '2100-01-01'\nGROUP BY T1.subject_id\nHAVING",
    "225970019a185c7b566265ff": "SELECT COUNT(DISTINCT subject_id)\nFROM procedures_icd\nWHERE icd_code IN ('T06.8', 'T06.9') AND charttime >= '2022-01-01';",
    "a51c8d210fb99892e9c4157c": "",
    "4f58f3a3dafa1f8cd4ff29a8": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title = 'Other excision or destruction of lesion or tissue of pancreas or pancreatic duct'\nAND pr.charttime >= DATE('now', '-1 year');",
    "3b064609e2c9c1d5192c303d": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE pr.charttime > DATE('now', '-1 year')\n  AND d.long_title LIKE '%Computer assisted surgery%'\n  AND pr.hadm_id IN (\n    SELECT hadm_id\n    FROM procedures_icd\n    WHERE icd_code = pr.icd_code\n      AND charttime > DATE('now', '-1 year')\n    GROUP BY hadm_id\n    HAVING COUNT(hadm_id) > 1\n  );",
    "3984301a9bd8a75a815b502a": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\nJOIN d_icd_procedures dicp ON di.icd_code = dicp.icd_code\nWHERE dicp.long_title = 'Excision of dental lesion of jaw two'\n  AND a.admittime > '2100-01-01';",
    "3ee1fa015c88d17b50ff62cb": "",
    "68483e4f1201b049144af718": "",
    "1773166323d7822bd908fecf": "SELECT \n  COUNT(DISTINCT T1.subject_id) \nFROM \n  patients AS T1\n  INNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\n  INNER JOIN diagnoses_icd AS T3 ON T2.hadm_id = T3.hadm_id\n  INNER JOIN procedures_icd AS T4 ON T2.hadm_id = T4.hadm_id\n  INNER JOIN d_icd_diagnoses AS T5 ON T3.icd_code = T5.icd_code\n  INNER JOIN d_icd_procedures AS T6 ON T4.icd_code = T6.icd_code\nWHERE \n  T5.long_title = 'Other postprocedural shock, initial encounter'\n  AND T6.long_title = 'Drainage of peritoneal cavity, percutaneous approach';",
    "942ff36dd9b2fbe79fa75553": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE d.icd_code = '2100'\n  AND pr.icd_code = '96'\n  AND pr.charttime BETWEEN d.charttime AND d.charttime + 96;",
    "90b0586c4e17390d3684288d": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures pr2 ON pr.icd_code = pr2.icd_code\nWHERE d2.long_title = 'Chronic kidney disease, unspecified'\nAND pr2.long_title = 'Angiography, renal arteries'\nAND d.charttime >= DATE('now', '-1 year')\nAND pr.charttime >= DATE('now', '-1 year')\nAND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', pr.charttime);",
    "0179a63a9ea6811f17901566": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d_d ON d.icd_code = d_d.icd_code\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures d_p ON pr.icd_code = d_p.icd_code\nWHERE d_d.long_title LIKE '%essential (primary) hypertension%'\n  AND d.charttime >= '2100-01-01'\n  AND pr.charttime >= d.charttime\n  AND pr.charttime <= DATE(d.charttime, '+2 months')\n  AND d_p.long_title = 'excision of left internal mammary artery, percutaneous endoscopic approach';",
    "f770528a39adb96dadeb2ece": "SELECT COUNT(DISTINCT p.subject_id) AS extracorporeal_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures prd ON pr.icd_code = prd.icd_code\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE ddi.icd_code = 'S88.41'  -- Iatrogenic pneumothorax\nAND prd.icd_code = 'P23.02'  -- Extracorporeal circulation auxiliary to open heart surgery\nAND strftime('%Y-%m', a.admittime) = strftime('%Y-%m', d.charttime)\nAND d.charttime >= '2100-01-01';",
    "59c016a2706b41628b2c89c5": "SELECT \n        fh.subject_id,\n        fh.hadm_id,\n        fh.diagnosis_charttime,\n        cvc.procedure_charttime\n    FROM FamilyHistory fh\n    INNER JOIN CentralVenousCatheter cvc ON fh.subject_id = cvc.subject_id AND fh.hadm_id = cvc.hadm_id\n    WHERE strftime('%Y', fh.diagnosis_charttime)",
    "4fbf6bc24f6506d4e0648954": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title LIKE '%right heart cardiac catheterization%' \nAND p.charttime >= '2100-01-01';",
    "399219ab0cecf87bb146bf4f": "SELECT COUNT(*) AS total_cases\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title = 'Diagnostic Ultrasound of abdomen and retroperitoneum';",
    "b887f31e7adc13f9605b4ce5": "",
    "637392b0ddde6c01f3635914": "",
    "888ffc67091ab77a0031df58": "",
    "a7705b90ca7be8540a57b179": "SELECT COUNT(*) \nFROM diagnoses_icd \nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code \nJOIN d_icd_procedures ON diagnoses_icd.icd_code = d_icd_procedures.icd_code \nWHERE d_icd_diagnoses.long_title = 'Excision of right lower lung lobe, via natural or artificial opening endoscopic procedures' \nAND d_icd_procedures.long_title LIKE '2100%';",
    "5c2f1712b0944318f3f979b0": "SELECT COUNT(*) \nFROM procedures_icd \nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code \nWHERE d_icd_procedures.long_title = 'Excision of left saphenous vein, percutaneous endoscopic approach (procedure)'\nAND strftime('%Y', procedures_icd.charttime) = strftime('%Y', 'now');",
    "4556ccee5b6838ef92b0563d": "SELECT COUNT(DISTINCT subject_id) AS number_of_patients\nFROM prescriptions\nWHERE drug = 'nitroprusside sodium';",
    "8a2eb3b60c1ea3c2e4c41c3d": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug = 'oxycodone (immediate release)'\n  AND pr.starttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59';",
    "2e78bc9dfee6ec2d33d855e8": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'Dexamethasone';",
    "66c7ab0996cecda175a87a37": "",
    "1e4019a7c27981289e8158a6": "SELECT COUNT(DISTINCT subject_id)\nFROM prescriptions\nWHERE drug = 'doxycycline hyclate';",
    "585481006142353555e7db6c": "SELECT COUNT(DISTINCT subject_id) AS Total_Patients\nFROM prescriptions\nWHERE drug = 'phosphorus'\n  AND starttime >= DATE('now', '-1 year');",
    "387e90582a0211b4f9b8baa0": "SELECT COUNT(*) AS patient_count\nFROM prescriptions\nWHERE drug = 'fenofibrate';",
    "9fd92541abda6f41b7def429": "SELECT \n    COUNT(*) AS total_prescriptions\nFROM \n    prescriptions\nWHERE \n    drug = 'quinidine gluconate e.r.'\n    AND starttime > DATE('now', '-1 year');",
    "f2f618df33524232a41e164a": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'heparin (crrt machine priming)' AND starttime >= '2100-01-01 00:00:00';",
    "12e5aa7d6e4aad370d1ec784": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'diltiazem extended-release';",
    "9629cd5b13741202a0e1dc2e": "SELECT COUNT(*) AS prescription_count\nFROM prescriptions\nWHERE drug = 'Midodrine'\n  AND starttime >= DATE('now', '-1 year');",
    "c0c458bde811f783bf9c0186": "SELECT COUNT(*) AS num_prescriptions\nFROM prescriptions\nWHERE drug = 'latanoprost 0.005% ophth. soln.'\n  AND starttime >= DATE('now', '-1 year');",
    "c62d48014cb74f4fc40d76b2": "SELECT COUNT(*) AS prescription_count\nFROM prescriptions\nWHERE drug = 'docusate';",
    "e278ba85bcbc856b575a2432": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'tramadol' \n  AND starttime BETWEEN DATE('now', '-1 year') AND DATE('now');",
    "5bfb3ee348b0af2b550eb5fd": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d1 ON d.icd_code = d1.icd_code\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures pr1 ON pr.icd_code = pr1.icd_code\nJOIN prescriptions p1 ON a.hadm_id = p1.hadm_id\nWHERE d1.long_title LIKE '%Central Venous Catheter Placement with Guidance%'\nAND pr1.long_title LIKE '%Treatment of Ketorolac%'\nAND p1.drug = 'Ketorolac'\nAND a.admittime >= '2100-01-01'\nAND a.dischtime <= '2100-12-31'\nAND d.charttime >= a.admittime\nAND d.charttime <= a.dischtime\nAND pr.charttime >= a.admittime\nAND pr.charttime <= a.dischtime\nAND p1.starttime >= a.admittime\nAND p1.st",
    "77afb1ef1604c879a7c457e5": "",
    "b155b30fab3d7945e185f841": "SELECT COUNT(DISTINCT p.subject_id) AS total_unique_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN prescriptions prx ON a.hadm_id = prx.hadm_id\nWHERE pr.icd_code IN (\n    SELECT icd_code\n    FROM d_icd_procedures\n    WHERE long_title LIKE '%Change feeding device in lower intestinal tract, external approach procedure%'\n)\nAND prx.drug = 'glucose gel'\nAND strftime('%Y-%m', pr.charttime) = strftime('%Y-%m', prx.starttime)\nAND pr.charttime > '2100-01-01';",
    "cdc0b49b39728980763c9830": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nINNER JOIN d_icd_procedures di ON pr.icd_code = di.icd_code\nINNER JOIN prescriptions ps ON a.hadm_id = ps.hadm_id\nWHERE di.long_title = 'Cardiac Output, Continuous Treatment'\n  AND ps.drug = 'ketorolac'\n  AND strftime('%Y', a.admittime) = strftime('%Y', 'now')\n  AND strftime('%m', a.admittime) = strftime('%m', ps.starttime);",
    "545884471d7fc70a0f8b1fce": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nJOIN icustays icu ON p.subject_id = icu.subject_id\nWHERE pr.drug = 'acetaminophen'\n  AND pr.starttime >= icu.outtime\n  AND pr.starttime <= DATE(icu.outtime, '+2 months');",
    "8fdc820d61c609ac4f0bed57": "SELECT \n    COUNT(DISTINCT p.subject_id) \nFROM \n    patients p \nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id \nINNER JOIN \n    diagnoses_icd di ON a.hadm_id = di.hadm_id \nINNER JOIN \n    procedures_icd pr ON a.hadm_id = pr.hadm_id \nINNER JOIN \n    prescriptions prs ON a.hadm_id = prs.hadm_id \nWHERE \n    a.dischtime BETWEEN '2100-01-01' AND '2100-12-31' \n    AND pr.icd_code = 'T62.4' \n    AND prs.drug = '0.9% sodium chloride (mini bag plus)' \n    AND strftime('%Y-%m', prs.starttime) = strftime('%Y-%m', di.charttime);",
    "ef78694fed50bccd3e8eed2e": "",
    "4ae971e027ab0b11a6f1c018": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN labevents l ON p.subject_id = l.subject_id\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE d.label = 'Metamyelocytes'\nAND strftime('%Y', l.charttime) = strftime('%Y', 'now');",
    "de0718a1175887225e4a3701": "SELECT COUNT(DISTINCT subject_id) AS plasma_cells_test_count\nFROM microbiologyevents\nWHERE test_name = 'Plasma Cells' AND charttime >= DATE('now', '-1 year');",
    "db4ebf8381b39fb14b2f5dab": "SELECT COUNT(DISTINCT subject_id) \nFROM labevents\nWHERE itemid IN (\n  SELECT itemid \n  FROM d_labitems \n  WHERE label = 'Triglycerides'\n) AND charttime >= DATE('now', '-1 year');",
    "be7de3372a4c08b2ae411296": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN labevents l ON a.hadm_id = l.hadm_id\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.charttime >= DATE('now', '-1 year')\n  AND d.label LIKE '%Epithelial Cells Test%';",
    "0ab0e14edb41ec298e991c8c": "SELECT COUNT(DISTINCT T1.subject_id)\nFROM admissions AS T1\nINNER JOIN labevents AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_labitems AS T3 ON T2.itemid = T3.itemid\nWHERE T2.charttime LIKE '%2100%' AND T3.label = 'Uric Acid Test';",
    "37c4dfeda91b7ea5c88a15b6": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN labevents l ON a.hadm_id = l.hadm_id\nJOIN d_labitems di ON l.itemid = di.itemid\nWHERE di.label = 'Vitamin B12'\nAND l.charttime > '2100-01-01';",
    "ec12c483a1d7d0bf16b1fbc4": "SELECT COUNT(DISTINCT subject_id) AS count_of_patients\nFROM microbiologyevents\nWHERE charttime >= DATE('now', '-1 year') \n  AND test_name = 'Rheumatoid Factor';",
    "9b6fff1f017a3163467fb155": "SELECT \n  COUNT(DISTINCT p.subject_id) AS total_dextrose_patients\nFROM \n  patients p\nINNER JOIN \n  admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n  inputevents ie ON a.hadm_id = ie.hadm_id\nWHERE \n  ie.itemid = (SELECT itemid FROM d_items WHERE abbreviation = 'D50')\n  AND STRFTIME('%Y', ie.starttime) = STRFTIME('%Y', 'now');",
    "d9dc77e2a9eef59e0164883e": "SELECT COUNT(DISTINCT i.subject_id) AS total_patients\nFROM inputevents i\nJOIN d_items d ON i.itemid = d.itemid\nWHERE d.label = 'D5W 1/2NS' AND i.starttime >= DATE('now', '-1 year');",
    "e793c664c5790f8705865139": "SELECT COUNT(DISTINCT subject_id) \nFROM inputevents \nWHERE totalamount > 0 \n  AND totalamountuom = 'ml' \n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Water') \n  AND starttime >= '2100-01-01 00:00:00';",
    "a36f72eb4bd75e8ee0def85f": "SELECT COUNT(*) \nFROM inputevents \nWHERE itemid = 1 AND \n      totalamountuom = 'units' AND \n      starttime >= date('now', 'start of year') AND \n      starttime < date('now', 'start of year', '+1 year');",
    "07cfe6a604bc9ff70115ca01": "SELECT COUNT(DISTINCT T1.subject_id) \nFROM inputevents AS T1 \nINNER JOIN d_items AS T2 \nON T1.itemid = T2.itemid \nWHERE T2.label = 'fresh frozen plasma' \nAND T1.starttime BETWEEN '2022-01-01' AND '2022-12-31';",
    "abef8d8c91bb576ba70341f2": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nINNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'Promote with Fiber (Full)'\n  AND pr.starttime >= DATE('now', '-1 year');",
    "07b458a4465bdc3893cd4d3b": "SELECT COUNT(DISTINCT T1.subject_id) AS total_patients\nFROM patients AS T1\nINNER JOIN inputevents AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.itemid = 2468\nAND T2.starttime >= datetime('now', '-1 year')",
    "7ade7790a24e397e1e54a0a0": "SELECT \n    icd_code, \n    COUNT(*) AS diagnosis_count\nFROM \n    diagnoses_icd\nWHERE \n    icd_code LIKE '2100%'\nGROUP BY \n    icd_code\nORDER BY \n    diagnosis_count DESC\nLIMIT 5;",
    "8b18506ab5223069c0701a48": "SELECT \n    d.long_title AS diagnosis,\n    COUNT(*) AS diagnosis_count\nFROM \n    diagnoses_icd di\nJOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    di.charttime >= '2100-01-01' AND di.charttime < '2101-01-01'\nGROUP BY \n    d.long_title\nORDER BY \n    diagnosis_count DESC\nLIMIT 4;",
    "be30cffa66ec6b8f274e5abc": "",
    "4afbd97439436cbe90ee25f1": "WITH DiagnosesCTE AS (\n    SELECT d.icd_code, d.long_title, COUNT(*) AS diagnosis_count\n    FROM diagnoses_icd di\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    INNER JOIN admissions a ON di.hadm_id = a.hadm_id\n    WHERE a.admittime >= DATE('now', '-5 years')\n    GROUP BY d.icd_code, d.long_title\n)\nSELECT icd_code, long_title, diagnosis_count\nFROM DiagnosesCTE\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "ad66076596714253fdd0da06": "SELECT \n  d.long_title AS diagnosis, \n  COUNT(diagnoses_icd.row_id) AS count\nFROM \n  diagnoses_icd\nINNER JOIN \n  d_icd_diagnoses d ON diagnoses_icd.icd_code = d.icd_code\nWHERE \n  strftime('%Y', diagnoses_icd.charttime) >= '2100'\nGROUP BY \n  d.long_title\nORDER BY \n  count DESC\nLIMIT 5;",
    "70782f0b95270ba463ce4f33": "Select the Top 5**: We need to sort these counts in descending order and limit the output to the top 5 diagnoses.",
    "6aaf71c0cfa396b28f225bc3": "WITH RecentDiagnoses AS (\n    SELECT \n        icd_code,\n        COUNT(*) AS diagnosis_count\n    FROM \n        diagnoses_icd\n    WHERE \n        charttime >= DATE('now', '-1 year')\n    GROUP BY \n        icd_code\n),\nRankedDiagnoses AS (\n    SELECT \n        icd_code,\n        diagnosis_count,\n        RANK() OVER (ORDER BY diagnosis_count DESC) AS rank\n    FROM \n        RecentDiagnoses\n)\nSELECT \n    icd_code,\n    diagnosis_count\nFROM \n    RankedDiagnoses\nWHERE \n    rank <= 3;",
    "4ea2037fa4bc87104f556c64": "WITH AgeFilteredDiagnoses AS (\n    SELECT \n        d.row_id,\n        d.subject_id,\n        d.hadm_id,\n        d.icd_code,\n        d.charttime,\n        p.gender,\n        p.dob,\n        p.dod,\n        a.admittime,\n        a.dischtime,\n        a.age,\n        a.admission_type,\n        a.admission_location,\n        a.discharge_location,\n        a.insurance,\n        a.language,\n        a.marital_status\n    FROM diagnoses_icd d\n    INNER JOIN patients p ON d.subject_id = p.subject_id\n    INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n    WHERE a.age >= 60 AND a.admittime >= DATE('now', 'start of year') AND a.dischtime <= DATE('now', 'end of year')\n),\nDiagnosisFrequency AS (\n    SELECT \n        icd_code,\n        COUNT(*) AS frequency\n    FROM AgeFilteredDiagnoses\n    GROUP BY icd_code\n)\nSELECT \n    icd_code,\n    frequency\nFROM DiagnosisFrequency\nORDER BY frequency DESC\nLIMIT 3;",
    "40d147343c07229976c1f711": "SELECT d.long_title, COUNT(*) as diagnosis_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN admissions a ON di.hadm_id = a.hadm_id\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE (strftime('%Y', 'now') - strftime('%Y', p.dob)) >= 60\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "88bfa1913eb595bb2ec3e15e": "SELECT icd_code, COUNT(*) AS frequency\nFROM diagnoses_icd\nJOIN patients ON diagnoses_icd.subject_id = patients.subject_id\nWHERE patients.age BETWEEN 30 AND 39\nGROUP BY icd_code\nORDER BY frequency DESC\nLIMIT 4;",
    "6fcb390235190f852352ba02": "SELECT \n    d.long_title AS diagnosis_title,\n    COUNT(*) AS frequency\nFROM \n    diagnoses_icd icd\nINNER JOIN \n    d_icd_diagnoses d ON icd.icd_code = d.icd_code\nINNER JOIN \n    admissions a ON icd.hadm_id = a.hadm_id\nINNER JOIN \n    patients p ON a.subject_id = p.subject_id\nWHERE \n    strftime('%Y', a.admittime) = '2100' \n    AND (strftime('%Y', p.dob) + 20) BETWEEN 2100 AND 2120\nGROUP BY \n    d.long_title\nORDER BY \n    frequency DESC\nLIMIT 4;",
    "e3171ac111633770ec5fe8d0": "SELECT \n    d_long_title.long_title AS diagnosis,\n    COUNT(diagnoses_icd.row_id) AS diagnosis_count\nFROM \n    diagnoses_icd\nJOIN \n    d_icd_diagnoses d_long_title ON diagnoses_icd.icd_code = d_long_title.icd_code\nJOIN \n    admissions a ON diagnoses_icd.hadm_id = a.hadm_id\nWHERE \n    a.admittime >= '2100-01-01' AND a.age BETWEEN 50 AND 59\nGROUP BY \n    d_long_title.long_title\nORDER BY \n    diagnosis_count DESC\nLIMIT 3;",
    "7f14fffc462f0b0f329a9639": "WITH DiagnosisCTE AS (\n    SELECT \n        d.icd_code, \n        COUNT(*) AS diagnosis_count\n    FROM \n        patients p\n    JOIN \n        admissions a ON p.subject_id = a.subject_id\n    JOIN \n        diagnoses_icd d ON a.hadm_id = d.hadm_id\n    WHERE \n        p.dob BETWEEN DATE('now', '-1 year') AND DATE('now')\n        AND p.gender = 'Female'\n        AND p.age BETWEEN 40 AND 49\n    GROUP BY \n        d.icd_code\n),\nRankedDiagnosisCTE AS (\n    SELECT \n        icd_code, \n        diagnosis_count,\n        ROW_NUMBER() OVER (ORDER BY diagnosis_count DESC) AS rank\n    FROM \n        DiagnosisCTE\n)\nSELECT \n    icd_code, \n    diagnosis_count\nFROM \n    RankedDiagnosisCTE\nWHERE \n    rank <= 3;",
    "82f39085117b4eee63cfcbd8": "SELECT \n    d.long_title AS diagnosis,\n    COUNT(*) AS diagnosis_count\nFROM \n    diagnoses_icd di\nJOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN \n    admissions a ON di.hadm_id = a.hadm_id\nJOIN \n    patients p ON a.subject_id = p.subject_id\nWHERE \n    STRFTIME('%Y', p.dob) = '2100' -- People born in 2100\n    AND STRFTIME('%Y', a.dischtime) = '2100' -- Admissions in 2100\n    AND (STRFTIME('%Y', a.dischtime) - STRFTIME('%Y', p.dob)) = 30 -- Age in 2100\nGROUP BY \n    d.long_title\nORDER BY \n    diagnosis_count DESC\nLIMIT 4;",
    "ed396de025aef41a12776f3d": "WITH ProceduralDiagnoses AS (\n    SELECT \n        p.subject_id,\n        d.long_title AS diagnosis,\n        strftime('%Y-%m', a.admittime) AS admission_month\n    FROM procedures_icd pr\n    JOIN admissions a ON pr.hadm_id = a.hadm_id\n    JOIN patients p ON a.subject_id = p.subject_id\n    JOIN d_icd_diagnoses d ON pr.icd_code = d.icd_code\n    WHERE pr.icd_code = '2100'  \n),\nDiagnosisCounts AS (\n    SELECT \n        diagnosis,\n        admission_month,\n        COUNT(*) AS diagnosis_count\n    FROM ProceduralDiagnoses\n    GROUP BY diagnosis, admission_month\n)\nSELECT \n    diagnosis,\n    admission_month,\n    diagnosis_count\nFROM DiagnosisCounts\nWHERE diagnosis_count IN (\n    SELECT diagnosis_count\n    FROM (\n        SELECT diagnosis_count\n        FROM DiagnosisCounts\n        ORDER BY diagnosis_count DESC\n        LIMIT 3\n    )\n)\nORDER BY diagnosis_count DESC;",
    "6fdd01eeff3d0426c273f13a": "SELECT T1.icd_code, T2.long_title\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nINNER JOIN procedures_icd AS T3 ON T1.subject_id = T3.subject_id\nWHERE T3.icd_code = 'ICD_CODE_FOR_CARDIAC_OUTPUT_PROCEDURE'\nAND T1.charttime > '2100-01-01'\nAND T1.charttime < DATE(T3.charttime, '+2 months')\nGROUP BY T1.icd_code, T2.long_title\nORDER BY COUNT(T1.subject_id) DESC\nLIMIT 4;",
    "47c10150fc2a7ef2316ffcd9": "SELECT a.subject_id, a.hadm_id, a.admittime\n    FROM admissions a\n    INNER JOIN procedures_icd p ON a.h",
    "db3c11ffd16f4f7b363b7a95": "SELECT \n        d.subject_id,\n        d.icd_code,\n        d.charttime,\n        strftime('%Y-%m', d.charttime) AS charttime_month\n    FROM \n        diagnoses_icd d\n    WHERE \n        d.charttime BETWEEN date('now', 'start of year')\n        AND date('",
    "2a9d69b2f33ebef60868e9bd": "",
    "cc3d7bf75c6a91650fa5a25b": "WITH PatientsWithProcedure AS (\n  SELECT p.subject_id\n  FROM patients p\n  JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n  JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n  WHERE d.long_title = 'Laparoscopic partial cholecystectomy'\n),\nDiagnosesForPatients AS (\n  SELECT d.subject_id, d.icd_code, d.charttime\n  FROM diagnoses_icd d\n  JOIN PatientsWithProcedure p ON d.subject_id = p.subject_id\n  WHERE d.charttime BETWEEN (SELECT MIN(charttime) FROM procedures_icd WHERE subject_id = p.subject_id) AND\n        (SELECT MIN(charttime) FROM procedures_icd WHERE subject_id = p.subject_id) + 2*30*24*3600\n),\nDiagnosisTitles AS (\n  SELECT DiagnosesForPatients.subject_id, d.long_title\n  FROM DiagnosesForPatients\n  JOIN d_icd_diagnoses d ON DiagnosesForPatients.icd_code = d.icd_code\n)\nSELECT long_title\nFROM DiagnosisTitles\nGROUP BY long_title\nORDER BY COUNT(*) DESC\nLIMIT 4;",
    "cd0f6d12276b6dd053848329": "WITH LaparoscopicPartialCholecystectomy AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Laparoscopic partial cholecystectomy'\n      AND d.charttime >= DATE('now', '-1 year')\n),\nRecentDiagnoses AS (\n    SELECT d.subject_id, dd.long_title, d.charttime\n    FROM LaparoscopicPartialCholecystectomy l\n    JOIN diagnoses_icd d ON l.subject_id = d.subject_id\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE d.charttime >= DATE('now', '-2 months')\n)\nSELECT long_title, COUNT(*) AS diagnosis_count\nFROM RecentDiagnoses\nGROUP BY long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "f43d8c604807bcac934596ac": "SELECT icd",
    "1f74b6c69a55bb5e16c32cba": "SELECT icd_code, COUNT(*) AS procedure_count\nFROM procedures_icd\nGROUP BY icd_code\nORDER BY procedure_count DESC\nLIMIT 3;",
    "49d6f4a86b0609b109d0e3a1": "SELECT label, COUNT(*) AS procedure_count\nFROM d_items\nWHERE linksto = 'Procedures'\nGROUP BY label\nORDER BY procedure_count DESC\nLIMIT 5;",
    "591c758b0e137d7671f1af3e": "SELECT icd_code, COUNT(*) as procedure_count\nFROM procedures_icd\nWHERE icd_code LIKE '2100%'\nGROUP BY icd_code\nORDER BY procedure_count DESC\nLIMIT 4;",
    "9a613ce39888ea07ffbd3a23": "SELECT p.procedure_name, COUNT(p.procedure_name) as procedure_count\nFROM (\n    SELECT icd_code, charttime\n    FROM procedures_icd\n    WHERE charttime >= DATE('now', '-1 year')\n) AS filtered_procedures\nJOIN d_icd_procedures p ON filtered_procedures.icd_code = p.icd_code\nGROUP BY p.procedure_name\nORDER BY procedure_count DESC\nLIMIT 3;",
    "715714e43d5b44633c2f88df": "SELECT \n  itemid, \n  SUM(totalamount) AS total_treatment_amount\nFROM \n  inputevents\nWHERE \n  starttime >= DATE('now', 'start of year') AND starttime < DATE('now', 'start of year', '+1 year')\nGROUP BY \n  itemid\nORDER BY \n  total_treatment_amount DESC\nLIMIT 4;",
    "2db144511074e195767dbef5": "SELECT p.subject_id\n    FROM patients p\n    WHERE p.dob",
    "852528505a7b6f035ae431de": "SELECT tc.icd_code, tc.treatment_count, d.long_title\nFROM Treat",
    "61158e9ccd8015f7898cb6e8": "",
    "e6db613772003ec72d44ebe5": "",
    "899575480ec0184f34a313b4": "SELECT icd.icd_code, COUNT(*) as cnt\nFROM procedures_icd icd\nJOIN admissions a ON icd.hadm_id = a.hadm_id\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE a.admittime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59'\n  AND p.dob BETWEEN '1970-01-01 00:00:00' AND '1999-12-31 23:59:59'\nGROUP BY icd.icd_code\nORDER BY cnt DESC\nLIMIT 5;",
    "0f8875bf841f89f578f97551": "SELECT \n    T2.icd_code,\n    T3.label AS procedure_name,\n    COUNT(T2.subject_id) AS procedure_count\nFROM \n    diagnoses_icd AS T1\nINNER JOIN \n    procedures_icd AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN \n    d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nINNER JOIN \n    patients AS T4 ON T2.subject_id = T4.subject_id\nWHERE \n    T4.dob <= DATE('now', '-1 year')\n    AND T4.gender NOT IN ('U', 'Unknown')\n    AND T4.age >= 60\nGROUP BY \n    T2.icd_code, T3.label\nORDER BY \n    procedure_count DESC\nLIMIT 5;",
    "41610f36281d57ea3abb005b": "SELECT T1.drug, COUNT(T1.subject_id) AS frequency\nFROM prescriptions AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE strftime('%Y', T2.admittime) >= '2100'\n  AND T2.age BETWEEN 40 AND 49\nGROUP BY T1.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "c8514097484be2c378e72761": "WITH relevant_procedures AS (\n  SELECT p.subject_id, p.hadm_id, p.icd_code, p.charttime\n  FROM procedures_icd p\n  INNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\n  INNER JOIN d_icd_procedures di ON p.icd_code = di.icd_code\n  INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n  WHERE dd.long_title = 'Drainage of peritoneal cavity, percutaneous approach, diagnostic'\n    AND p.charttime BETWEEN DATE('now', '-2 months') AND DATE('now')\n)\nSELECT pr.icd_code, di.long_title, COUNT(*) as procedure_count\nFROM relevant_procedures pr\nINNER JOIN d_icd_procedures di ON pr.icd_code = di.icd_code\nGROUP BY pr.icd_code, di.long_title\nORDER BY procedure_count DESC\nLIMIT 5;",
    "6ef0a4d357592b4eadc2b1b7": "select the top four treatments.",
    "7c6f2aa274207d68024f4cd4": "SELECT \n    p.subject_id,\n    p.hadm_id,\n    p.charttime AS treatment_time,\n    d.long_title AS treatment_description\nFROM \n    procedure_events pe\nJOIN \n    labevents p ON pe.subject_id = p.subject_id AND pe.hadm_id = p.hadm_id\nJOIN \n    d_labitems d ON p.itemid = d.itemid\nWHERE \n    p.charttime > pe.procedure_time\n    AND d.label IN ('Treatment A', 'Treatment B', 'Treatment C', 'Treatment D') \nGROUP BY \n    p.subject_id, p.hadm_id, p.charttime, d.long_title\nORDER BY \n    COUNT(*) DESC\nLIMIT 4;",
    "bbebbefb1d815b174837d57e": "SELECT \n  p1.subject_id,\n  d1.long_title AS procedure1,\n  COUNT(p1.subject_id) AS count_procedure1\nFROM \n  patients p1\n  INNER JOIN procedures_icd p2 ON p1.subject_id = p2.subject_id\n  INNER JOIN d_icd_procedures d1 ON p2.icd_code = d1.icd_code\n  INNER JOIN procedures_icd p3 ON p1.subject_id = p3.subject_id\n  INNER JOIN d_icd_procedures d2 ON p3.icd_code = d2.icd_code\nWHERE \n  p2.icd_code = 'T40.02' AND\n  d1.long_title = ' Percutaneous abdominal drainage' AND\n  p3.icd_code != 'T40.02' AND\n  d2.long_title != ' Percutaneous abdominal drainage' AND\n  strftime('%Y-%m', p2.charttime) = strftime('%Y-%m', p3.charttime)\nGROUP BY \n  p1.subject_id, d1.long_title\nORDER BY \n  count_procedure1 DESC\nLIMIT 4;",
    "c5fa37f5342eb658b8fa6776": "",
    "a3a4751b104710cf0148a297": "select the top three most frequent treatments based on the count.",
    "a6ad56047cfb5ab47409c6a5": "SELECT icd_code, COUNT(*) AS frequency\nFROM diagnoses_icd\nWHERE icd_code NOT LIKE '2100%'\nGROUP BY icd_code\nORDER BY frequency DESC\nLIMIT 5;",
    "46a6f6b786c670f60f62c369": "SELECT \n  p.drug AS prescribed_treatment, \n  COUNT(*) AS frequency \nFROM \n  prescriptions p \n  INNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id \n  INNER JOIN d_icd_diagnoses dic ON d.icd_code = dic.icd_code \nWHERE \n  p.starttime > '2100-01-01' \n  AND p.stoptime > '2100-01-01' \n  AND dic.long_title LIKE '%long term (current) use of opiate analgesic%' \nGROUP BY \n  p.drug \nORDER BY \n  frequency DESC \nLIMIT 4;",
    "53ae274dd031672e790039de": "WITH CandidalStomatitisDiagnoses AS (\n    SELECT \n        c.subject_id,\n        c.hadm_id,\n        c.charttime AS diagnosis_time\n    FROM diagnoses_icd c\n    JOIN d_icd_diagnoses d ON c.icd_code = d.icd_code\n    WHERE d.long_title LIKE 'Candidal Stomatitis'\n    AND c.charttime > DATE('now', '-1 year')\n),\nProceduresAfterDiagnosis AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.icd_code,\n        p.charttime AS procedure_time\n    FROM procedures_icd p\n    JOIN CandidalStomatitisDiagnoses csd ON p.subject_id = csd.subject_id\n    WHERE p.charttime > csd.diagnosis_time\n    AND p.charttime <= DATE(csd.diagnosis_time, '+2 months')\n),\nProceduresFrequency AS (\n    SELECT \n        icd_code,\n        COUNT(*) AS frequency\n    FROM ProceduresAfterDiagnosis\n    GROUP BY icd_code\n    ORDER BY frequency DESC\n    LIMIT 5\n)\nSELECT \n    icd_code\nFROM ProceduresFrequency;",
    "23a42f7835688c75021035ac": "SELECT T2.label AS procedure\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nINNER JOIN procedures_icd AS T4 ON T1.hadm_id = T4.hadm_id\nINNER JOIN d_icd_procedures AS T2 ON T4.icd_code = T2.icd_code\nWHERE T3.long_title LIKE '%Diaphragmatic Hernia%'\n  AND T3.long_title NOT LIKE '%Obstruction%'\n  AND T3.long_title NOT LIKE '%Gangrene%'\nGROUP BY T2.label\nORDER BY COUNT(T2.label) DESC\nLIMIT 4;",
    "1acf7fc31384e1c31147c768": "SELECT \n  p.subject_id,\n  d.long_title AS procedure,\n  COUNT(*) AS frequency\nFROM \n  diagnoses_icd icd\nJOIN \n  d_icd_diagnoses d ON icd.icd_code = d.icd_code\nJOIN \n  procedures_icd p ON icd.hadm_id = p.hadm_id\nWHERE \n  d.long_title LIKE '%chronic atrial fibrillation%'\n  AND p.hadm_id IN (\n    SELECT hadm_id\n    FROM diagnoses_icd\n    WHERE icd_code IN (\n      SELECT icd_code\n      FROM d_icd_diagnoses\n      WHERE long_title LIKE '%chronic atrial fibrillation%'\n    )\n  )\nGROUP BY \n  p.subject_id, d.long_title\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "71e45f1414e9c508d0f88b96": "SELECT \n  T1.subject_id,\n  T1.drug,\n  COUNT(T1.subject_id) AS treatment_count\nFROM \n  prescriptions T1\n  INNER JOIN diagnoses_icd T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n  T2.icd_code = 'A08.9' \n  AND strftime('%Y-%m', T1.starttime) = strftime('%Y-%m', T2.charttime)\nGROUP BY \n  T1.subject_id, T1.drug\nORDER BY \n  treatment_count DESC\nLIMIT 4;",
    "1f8afcb7747a797d8e8f612a": "",
    "a35a9346ab483d0db0f202ca": "SELECT \n        ep.subject_id,\n        ep.hadm_id,\n        pro.icd_code,\n        d.long_title AS procedure\n    FROM \n        ESRD_Patients ep\n    INNER JOIN \n        procedures_icd pro ON ep",
    "2efdde96ce7011cebcfc05db": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 4;",
    "a9b38a0fdefc73e3b49a6266": "SELECT drug, COUNT(*) as count\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY count DESC\nLIMIT 4;",
    "4960b6194d17e9d1c2ac34f2": "SELECT drug\nFROM prescriptions\nWHERE starttime >= '2100-01-01'\nGROUP BY drug\nORDER BY COUNT(drug) DESC\nLIMIT 3;",
    "0f46ce74f036db898fe9d288": "",
    "5e50d8202a81e15b06471b88": "",
    "06b9ac11749e295ddd6d0c34": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 3;",
    "e9a9b12dc29949b932dfcb92": "SELECT drug, COUNT(*) as count\nFROM prescriptions\nWHERE starttime >= '2100-01-01'\nGROUP BY drug\nORDER BY count DESC\nLIMIT 3;",
    "421833b510b5ec197a16d68f": "WITH hydrocodone_patients AS (\n    SELECT DISTINCT subject_id\n    FROM prescriptions\n    WHERE drug = 'hydrocodone-acetaminophen (5mg-325mg)'\n      AND starttime >= DATE('now', '-1 year')\n),\nrecent_prescriptions AS (\n    SELECT p.subject_id, p.drug\n    FROM prescriptions p\n    JOIN hydrocodone_patients h ON p.subject_id = h.subject_id\n    WHERE p.starttime >= DATE('now', '-2 month')\n)\nSELECT drug, COUNT(*) AS frequency\nFROM recent_prescriptions\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 5;",
    "44162aee19eabadbab9a0172": "SELECT T2.drug, COUNT(T2.row_id) AS num_prescriptions\nFROM prescriptions AS T1\nINNER JOIN prescriptions AS T2\nON T1.subject_id = T2.subject_id\nWHERE T1.drug = 'citrate dextrose 3% (acd-a) crrt'\n  AND T2",
    "5f2f54291860e0ab6a44e725": "SELECT drug, COUNT(*) as num_patients\nFROM prescriptions p\nWHERE p.starttime >= '2100-01-01' AND p.route = 'Oral' AND p.drug = 'plasmalyte'\n  AND EXISTS (\n    SELECT 1\n    FROM prescriptions p2\n    WHERE p2.subject_id = p.subject_id\n      AND p2.starttime >= '2100-01-01'\n      AND p2.starttime < DATE('2100-02-01')\n      AND p2.drug != 'plasmalyte'\n  )\nGROUP BY drug\nORDER BY num_patients DESC\nLIMIT 5;",
    "48e40b5c41147007595a5175": "SELECT \n        subject_id, \n        next_drug, \n        route, \n        dose_val_rx, \n        dose_unit_rx\n    FROM",
    "7ec4445b22dfabb102812643": "SELECT \n  p.drug,\n  COUNT(*) AS drug_count\nFROM \n  prescriptions p\nWHERE \n  p.drug = 'Miconazole powder 2%' \n  AND p.hadm_id IN (\n    SELECT \n      p2.hadm_id\n    FROM \n      prescriptions p2\n    WHERE \n      p2.drug = 'Miconazole powder 2%' \n      AND p2.starttime > '2100-01-01'\n  )\n  AND p.starttime > '2100-01-01'\n  AND p.drug != 'Miconazole powder 2%'\nGROUP BY \n  p.drug\nORDER BY \n  drug_count DESC\nLIMIT 3;",
    "b85c5a437b3cb22920ce10fb": "WITH BupropionPrescriptions AS (\n    SELECT p.subject_id, p.hadm_id\n    FROM prescriptions p\n    WHERE p.drug = 'Bupropion (Sustained Release)'\n      AND p.starttime > DATE('now', '-1 year')\n),\nCommonMedications AS (\n    SELECT p.drug, COUNT(*) AS count\n    FROM prescriptions p\n    JOIN BupropionPrescriptions bp ON p.subject_id = bp.subject_id AND p.hadm_id = bp.hadm_id\n    WHERE p.starttime > DATE('now', '-1 year')\n    GROUP BY p.drug\n)\nSELECT drug, count\nFROM CommonMedications\nORDER BY count DESC\nLIMIT 5;",
    "757270424b26647955e34c40": "",
    "4a03eabf717f99697bb5ba08": "SELECT \n    p.subject_id,\n    pr.drug,\n    COUNT(pr.row_id) AS num_prescriptions\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    procedures_icd pi ON a.hadm_id = pi.hadm_id\nJOIN \n    d_icd_procedures dicd ON pi.icd_code = dicd.icd_code\nJOIN \n    prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n    dicd.long_title = 'Endoscopic removal of stone(s) from biliary tract previously'\n    AND pr.starttime >= '2100-01-01'\n    AND pr.starttime <= '2100-02-28'\nGROUP BY \n    p.subject_id, pr.drug\nORDER BY \n    num_prescriptions DESC\nLIMIT 4;",
    "c8175712036320a9b391cf5f": "SELECT \n    drug\nFROM \n    TopMed",
    "7a3e856c5351161f228b56ea": "SELECT icd_code \n            FROM d_icd_procedures \n            WHERE long_title LIKE '%extracorporeal circulation auxiliary to open heart surgery previously within 2 months%'\n        )",
    "242455bec537f7c263ad40b0": "SELECT lp.subject_id, dp.drug\nFROM LaparoCTE",
    "842e8f2f6e1757279aaf5fc9": "SELECT T1.drug, COUNT(*) AS count\n    FROM medications AS T1",
    "30f8a5d33eb7287c9cf8412a": "SELECT \n    T1.subject_id, \n    T1.drug\nFROM \n    prescriptions AS T1\nINNER JOIN \n    diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T2.icd_code = 'K07.1' \nGROUP BY \n    T1.subject_id, T1.drug\nHAVING \n    COUNT(T1.drug) > 1;",
    "4cfe2481c4220d5f42e7a66c": "",
    "dbbf8af9c5e0fe77e81a2ecc": "SELECT\n    p.subject_id,\n    pr.drug,\n    pr.dose_val_rx,\n    pr.dose_unit_rx,\n    pr.route,\n    d.long_title\nFROM\n    patients p\nJOIN\n    admissions a ON p.subject_id = a.subject_id\nJOIN\n    diagnoses_icd di ON a.hadm_id = di.hadm_id\nJOIN\n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN\n    procedures_icd prd ON a.hadm_id = prd.hadm_id\nJOIN\n    d_icd_procedures prd_d ON prd.icd_code = prd_d.icd_code\nJOIN\n    prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE\n    d.long_title = 'Gastro-esophageal reflux disease without esophagitis'\n    AND prd_d.long_title = 'Fundoplication'\n    AND prd.charttime BETWEEN '2021-01-01' AND '2021-12-31'\nGROUP BY\n    pr.drug\nORDER BY\n    COUNT(pr.drug) DESC\nLIMIT 5;",
    "2f7d49a71a664a3c5367e8a7": "SELECT drug, COUNT(*) as total_prescriptions\nFROM prescriptions\nJOIN diagnoses_icd ON diagnoses_icd.subject_id = prescriptions.subject_id\nJOIN d_icd_diagnoses ON d_icd_diagnoses.icd_code = diagnoses_icd.icd_code\nWHERE d_icd_diagnoses.long_title LIKE '%psoriasis in 2100%'\nAND strftime('%Y-%m', prescriptions.starttime) = strftime('%Y-%m', diagnoses_icd.charttime)\nGROUP BY drug\nORDER BY total_prescriptions DESC\nLIMIT 4;",
    "9177cde69132a37cbac544ee": "SELECT\n        dp.drug,\n        COUNT(*) AS prescription_count\n    FROM\n        DefibrinationPrescriptions dp\n    GROUP BY\n        dp.drug\n    ORDER",
    "144cd6f1acfad4416003c26c": "SELECT t3.drug, COUNT(*) AS frequency\nFROM admissions AS t1\nINNER JOIN diagnoses_icd AS t2 ON t1.hadm_id = t2.hadm_id\nINNER JOIN prescriptions AS t3 ON t1.hadm_id = t3.hadm_id\nWHERE t2.icd_code IN (\n    SELECT icd_code\n    FROM d_icd_diagnoses\n    WHERE long_title LIKE '%mobitz (type) ii atrioventricular block%'\n)\nAND t1.dischtime LIKE '2100%'\nGROUP BY t3.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "aef8b935473950853a7d8448": "",
    "2b134de41e611c4124b04f3b": "WITH cardiogenicShockPatients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\n    WHERE icd.long_title LIKE '%cardiogenic shock%'\n),\nprescriptionsForPatients AS (\n    SELECT DISTINCT pr.subject_id, pr.drug, STRFTIME('%Y-%m', pr.starttime) AS month\n    FROM prescriptions pr\n    JOIN cardiogenicShockPatients csp ON pr.subject_id = csp.subject_id\n    WHERE pr.starttime >= '2100-01-01'\n),\ntopThreePrescribed AS (\n    SELECT drug, COUNT(*) AS count, month\n    FROM prescriptionsForPatients\n    GROUP BY drug, month\n    ORDER BY count DESC\n    LIMIT 3\n)\nSELECT drug\nFROM topThreePrescribed;",
    "48f94d76de26cca5b25ee77f": "",
    "f9dc2fa964b252fd6c5baac9": "SELECT p.subject_id, pr.drug, COUNT(*) AS frequency\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN procedures_icd prd ON a.hadm_id = prd.hadm_id\nJOIN prescriptions pr ON pr.subject_id = p.subject_id AND pr.hadm_id = a.hadm_id\nWHERE p.age >= 60 AND prd.icd_code = 'L35.1' AND pr.starttime >= '2100-01-01'\nGROUP BY p.subject_id, pr.drug\nORDER BY frequency DESC\nLIMIT 3;",
    "e55b54e06750117ab5f1a053": "WITH diagnosed_patients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Nonspecific elevation of levels of transaminase or lactic acid dehydrogenase [LDH]'\n      AND p.age BETWEEN 50 AND 59\n),\nprescriptions_in_month AS (\n    SELECT pr.subject_id, pr.drug, pr.starttime, pr.stoptime\n    FROM prescriptions pr\n    INNER JOIN diagnosed_patients dp ON pr.subject_id = dp.subject_id\n    WHERE strftime('%Y-%m', pr.starttime) = strftime('%Y-%m', pr.stoptime)\n),\nprescriptions_grouped AS (\n    SELECT drug, COUNT(*) as total_prescriptions\n    FROM prescriptions_in_month\n    GROUP BY drug\n)\nSELECT drug, total_prescriptions\nFROM prescriptions_grouped\nORDER BY total_prescriptions DESC\nLIMIT 5;",
    "1eb7d8845e0439e31945047c": "WITH DiagnosedPatients AS (\n    SELECT \n        p.subject_id\n    FROM \n        patients p\n    INNER JOIN \n        admissions a ON p.subject_id = a.subject_id\n    INNER JOIN \n        diagnoses_icd di ON a.hadm_id = di.hadm_id\n    INNER JOIN \n        d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE \n        p.age BETWEEN 50 AND 59 \n        AND d.long_title = 'Acute pulmonary edema'\n        AND a.admittime >= DATE('now', '-1 year')\n),\nRecentPrescriptions AS (\n    SELECT \n        pr.drug\n    FROM \n        DiagnosedPatients dp\n    INNER JOIN \n        prescriptions pr ON dp.subject_id = pr.subject_id\n    WHERE \n        pr.starttime >= DATE('now', '-2 months')\n)\nSELECT \n    drug, COUNT(*) AS prescription_count\nFROM \n    RecentPrescriptions\nGROUP BY \n    drug\nORDER BY \n    prescription_count DESC\nLIMIT 5;",
    "80d21b657d5ff088f889a360": "SELECT drug, COUNT(*) AS total_prescriptions\nFROM (\n    SELECT p.drug\n    FROM patients pa\n    JOIN admissions a ON pa.subject_id = a.subject_id\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n    JOIN prescriptions p ON a.hadm_id = p.hadm_id\n    WHERE pa.age BETWEEN 50 AND 59\n      AND ddi.long_title LIKE '%Pulmonary Collapse%'\n) AS subquery\nGROUP BY drug\nORDER BY total_prescriptions DESC\nLIMIT 3;",
    "41cdc4c25b362c10ff183c0c": "SELECT \n  p.subject_id, \n  pr.drug\nFROM \n  patients p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n  INNER JOIN procedures_icd prc ON a.hadm_id = prc.hadm_id\n  INNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n  prc.icd_code = 'E119' \n  AND a.admittime >= '2100-01-01' \n  AND pr.starttime <= DATE(a.admittime, '+2 months')\n  AND p.age >= 60\nGROUP BY \n  p.subject_id, pr.drug\nHAVING \n  COUNT(pr.drug) >= 5\nORDER BY \n  COUNT(pr.drug) DESC\nLIMIT 5;",
    "2666b04409be1528ae23a0f2": "SELECT \n        pr.subject_id,\n        pr.hadm_id,\n        pr.drug\n    FROM \n        prescriptions pr\n    INNER JOIN \n        RelevantAdmissions ra ON pr.subject_id = ra.subject_id AND pr.hadm_id = ra.hadm_id\n    INNER JOIN \n        RelevantPatients rp ON pr.subject_id = rp.subject_id\n    WHERE \n        pr.starttime >= '2100-01-01 00",
    "b37d67ade52f97c81e373d0a": "select the top 5:**\n   -",
    "d13e321a100730513005c82e": "SELECT \n    itemid, \n    COUNT(*) AS total_count\nFROM \n    labevents\nWHERE \n    charttime > '2100-01-01 00:00:00'\nGROUP BY \n    itemid\nORDER BY \n    total_count DESC\nLIMIT 4;",
    "af7e3057fad8f361ba5398f2": "WITH LabTests AS (\n    SELECT \n        l.itemid,\n        d.label AS test_name,\n        COUNT(*) AS num_tests\n    FROM \n        labevents l\n    JOIN \n        d_labitems d ON l.itemid = d.itemid\n    GROUP BY \n        l.itemid, d.label\n)\nSELECT \n    test_name,\n    num_tests\nFROM \n    LabTests\nORDER BY \n    num_tests DESC\nLIMIT 3;",
    "f84cee29b1ae0e5b38a4dad0": "SELECT itemid, COUNT(*) as test_count\nFROM labevents\nGROUP BY itemid\nORDER BY test_count DESC\nLIMIT 5;",
    "1d528e1e56f65f65ff457076": "SELECT \n  label AS test_name, \n  COUNT(*) AS test_count\nFROM \n  labevents l\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE \n  strftime('%Y', l.charttime) = '2100'\nGROUP BY \n  test_name\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "5fb01bc80ec79080b29a6120": "SELECT itemid, COUNT(*) AS event_count\nFROM labevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY itemid\nORDER BY event_count DESC\nLIMIT 5;",
    "ce78082eae0149ee1ca4091e": "SELECT \n    label AS test_name,\n    COUNT(*) AS test_count\nFROM \n    labevents\n    INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.charttime >= datetime('now', '-1 year')\nGROUP BY \n    label\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "7bd6751dde3ebad15506d38c": "SELECT \n  dl.label AS lab_test, \n  COUNT(le.itemid) AS number_of_tests\nFROM \n  labevents le\nINNER JOIN \n  d_labitems dl ON le.itemid = dl.itemid\nGROUP BY \n  dl.label\nORDER BY \n  number_of_tests DESC\nLIMIT 3;",
    "bf24656774e10abbee09d3cd": "Select the top three tests**: Finally, we filter the top three tests based on the rank.",
    "cef34f939a935672ef767a10": "SELECT \n        labevents.itemid,\n        COUNT(*) AS count\n    FROM \n        labevents\n    INNER JOIN \n        admissions ON labevents.hadm_id = admissions.hadm_id\n    WHERE \n        admissions.age BETWEEN 30 AND 39 AND\n        strftime('%Y', labevents.charttime) = '2100'\n    GROUP BY \n        lab",
    "d1d88ee5c7476300c168be49": "SELECT \n    l.itemid, \n    d.label, \n    COUNT(*) AS frequency\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nJOIN \n    admissions a ON l.hadm_id = a.hadm_id\nJOIN \n    patients p ON a.subject_id = p.subject_id\nWHERE \n    p.age >= 60\nGROUP BY \n    l.itemid, d.label\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "a3ae25ab7f7d7f11e9ba773d": "",
    "d53c40ad49a43a529f6a58f1": "SELECT d.label AS test_label, COUNT(l.subject_id) AS test_count\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nJOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE l.charttime > DATE('now', '-1 year')\nAND a.age BETWEEN 30 AND 39\nGROUP BY d.label\nORDER BY test_count DESC\nLIMIT 3;",
    "7057698bd91fd3229c372ff8": "",
    "66d3d7f7819e195408389a4b": "WITH labtest_counts AS (\n    SELECT \n        l.subject_id,\n        l.itemid,\n        COUNT(*) AS labtest_count\n    FROM \n        labevents l\n    INNER JOIN \n        admissions a ON l.subject_id = a.subject_id\n    WHERE \n        l.charttime BETWEEN a.admittime AND a.dischtime\n        AND (strftime('%Y', l.charttime) - strftime('%Y', a.admittime)) = 20\n    GROUP BY \n        l.subject_id, l.itemid\n)\nSELECT \n    d.label AS lab_test,\n    SUM(labtest_count) AS total_count\nFROM \n    labtest_counts l\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nGROUP BY \n    lab_test\nORDER BY \n    total_count DESC\nLIMIT 3;",
    "dd62c1497314b1bea83b2d03": "Select Top Three**: Finally, we",
    "1fe684c6e5b20d9ad964f6ac": "Select the top five most frequent lab tests.\n\nLet's break down each step with the corresponding SQL query:",
    "0bdfa86a31bd61b14767f632": "WITH RelevantAdmissions AS (\n    SELECT hadm_id\n    FROM diagnoses_icd\n    WHERE icd_code IN (\n        SELECT icd_code\n        FROM d_icd_diagnoses\n        WHERE long_title LIKE '%bmi 32.0-32.9, adult%'\n    )\n    AND charttime >= '2021-01-01'\n),\nLabEventCounts AS (\n    SELECT itemid, COUNT(*) AS event_count\n    FROM labevents\n    WHERE hadm_id IN (SELECT hadm_id FROM RelevantAdmissions)\n    AND charttime >= '2021-01-01'\n    GROUP BY itemid\n),\nTopLabEvents AS (\n    SELECT itemid, event_count\n    FROM LabEventCounts\n    ORDER BY event_count DESC\n    LIMIT 3\n)\nSELECT d.label\nFROM TopLabEvents tle\nJOIN d_labitems d ON tle.itemid = d.itemid;",
    "8cbd43defc418d1da88f21b2": "SELECT a",
    "89a55d6a6cba3898d5b52d9c": "SELECT \n    T1.charttime,\n    T2.label AS test_name,\n    COUNT(*) AS count_admin\nFROM \n    labevents AS T1\nINNER JOIN \n    d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.charttime BETWEEN '2023-01-01' AND '2023-12-31'\n    AND T1.subject_id IN (\n        SELECT \n            T3.subject_id \n        FROM \n            diagnoses_icd AS T3\n        INNER JOIN \n            d_icd_diagnoses AS T4 ON T3.icd_code = T4.icd_code\n        WHERE \n            T4.long_title LIKE 'Drug-induced agranulocytosis%'\n            AND T3.hadm_id = T1.hadm_id\n    )\nGROUP BY \n    T2.label\nORDER BY \n    count_admin DESC\nLIMIT 3;",
    "e874c2a103f4267d6ddfed15": "SELECT \n    itemid,\n    COUNT(*) AS frequency",
    "6d7e2ca9e692a3b833e8d4c2": "select lab tests taken during the same hospital encounter (`hadm_id`). This is done by joining the `labevents` table with the list of patients and admissions.\n\n3. **Count and Rank the Lab Tests**:\n   - Count the frequency of each lab test and order them in descending order to get the top five most frequent lab tests.\n\n4. **Construct the Final Query**:\n   - Combine all the above steps into a single SQL query.\n\nHere is the final SQL query:",
    "70826ed4c727196227cb1ef9": "Select the top five most common lab tests.",
    "5a615775859c42b0cfc588b1": "SELECT DISTINCT p.subject_id,",
    "96dabd861de92e31433a8552": "SELECT subject_id, charttime\n  FROM diagnoses_icd\n  INNER",
    "03a6a876fbcd2443f7f28749": "SELECT \n    d.label AS test_label,\n    COUNT(*) AS test_count\nFROM \n    diagnoses_icd di\nJOIN \n    admissions a ON di.hadm_id = a.hadm_id\nJOIN \n    labevents le ON a.hadm_id = le.hadm_id\nJOIN \n    d_labitems d ON le.itemid = d.itemid\nWHERE \n    di.icd_code = 'S00.70'\n    AND le.charttime >= '2023-01-01'\n    AND le.charttime < '2023-02-01'\n    AND a.admittime >= '2023-01-01'\n    AND a.admittime < '2023-02-01'\nGROUP BY \n    d.label\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "7af6e600c77232304b81e62d": "SELECT d_labitems.label, COUNT(labevents.row_id) as frequency\nFROM procedures_icd\nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nJOIN lab",
    "91b9ca43bd8f11ad31a158c7": "SELECT \n  d.label, \n  COUNT(*) AS test_count\nFROM \n  labevents le\nJOIN \n  d_labitems d ON le.itemid = d.itemid\nJOIN \n  procedures_icd pic ON le.hadm_id = pic.hadm_id\nWHERE \n  pic.icd_code = 'E96.1' \n  AND le.charttime >= DATE('now', 'start of year')\n  AND le.charttime < DATE('now', 'start of year', '+1 year')\nGROUP BY \n  d.label\nORDER BY \n  test_count DESC\nLIMIT 4;",
    "43bc1abffacc510680225ed9": "WITH RepositionProcedures AS (\n    SELECT \n        p.subject_id\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\n    JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\n    WHERE d.long_title = 'Reposition left maxilla with external fixation device, percutaneous approach'\n    AND a.admittime >= DATE('now', '-1 year')\n),\nLabEventsInMonth AS (\n    SELECT \n        le.subject_id,\n        le.itemid\n    FROM labevents le\n    JOIN RepositionProcedures rp ON le.subject_id = rp.subject_id\n    WHERE le.charttime >= DATE('now', '-1 year')\n    AND le.charttime < DATE('now', '-10 days')\n)\nSELECT \n    d.label AS lab_test,\n    COUNT(*) AS test_count\nFROM LabEventsInMonth lem\nJOIN d_labitems d ON lem.itemid = d.itemid\nGROUP BY lem.itemid\nORDER BY test_count DESC\nLIMIT 3;",
    "ecea3263ba9f3a57a309a2e0": "SELECT \n    spec_type_desc \nFROM \n    microbiologyevents \nWHERE \n    charttime >= DATE('now', '-1 year') \nGROUP BY \n    spec_type_desc \nORDER BY \n    COUNT(*) DESC \nLIMIT 3;",
    "edfa0b11933920062d92aacd": "",
    "26803d48dd00e769e38ea0c9": "SELECT spec_type_desc, COUNT(*) AS count\nFROM microbiologyevents\nWHERE charttime >= date('now','-1 year')\nGROUP BY spec_type_desc\nORDER BY count DESC\nLIMIT 4;",
    "9e48890388b483b0f182a90f": "SELECT spec_type_desc, COUNT(*) AS test_count\nFROM microbiologyevents\nGROUP BY spec_type_desc\nORDER BY test_count DESC\nLIMIT 3;",
    "1be9f21ac47235a697190eda": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE charttime >= '2023-01-01'\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 3;",
    "ebbeed93dad8985ba95cce74": "",
    "dbc4399f5a3526b4598df3ef": "SELECT spec_type_desc, COUNT(spec_type_desc) AS test_count\nFROM microbiologyevents",
    "bbd60f29527c9ff438a314a7": "SELECT \n    test_name, \n    COUNT(*) AS test_count \nFROM \n    microbiologyevents \nWHERE \n    charttime LIKE '%2100%' \nGROUP BY \n    test_name \nORDER BY \n    test_count DESC \nLIMIT 5;",
    "1fc44208dad68f8a906cda39": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "4a3678f63c0a0b08ed66585f": "selecting the top five based on the frequency.",
    "d2e2315a6ae7e509d95f1cdd": "SELECT test_name, COUNT(*) AS count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY test_name\nORDER BY count DESC\nLIMIT 5;",
    "4fcb903cb5d317c791dae3af": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE charttime > '2100-01-01 00:00:00'\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "4fd7632b17c70b416ebcfdda": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 3;",
    "bf89f78810c2095c0e36f24b": "SELECT test_name\nFROM microbiologyevents\nGROUP BY test_name\nORDER BY COUNT(*) DESC\nLIMIT 4;",
    "433a98b0bf77207fccd6fb2f": "SELECT \n  T1.spec_type_desc \nFROM \n  microbiologyevents T1 \n  INNER JOIN admissions T2 ON T1.hadm_id = T2.hadm_id \nWHERE \n  T1.charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59' \n  AND T2.admission_type = 'Accident' \n  AND T2.admission_location = 'Unspecified Place' \nGROUP BY \n  T1.spec_type_desc \nORDER BY \n  COUNT(*) DESC \nLIMIT 5;",
    "9e193ae2615e441e04331514": "SELECT \n  s.spec_type_desc, \n  COUNT(*) AS test_count\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n  INNER JOIN microbiologyevents s ON a.hadm_id = s.hadm_id\nWHERE \n  d2.long_title LIKE '%encounter for attention to other artificial openings of digestive tract%'\nGROUP BY \n  s.spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "65d676a4636cc2e1592ca2c0": "SELECT \n  T1.spec_type_desc,\n  COUNT(T1.spec_type_desc) AS frequency\nFROM \n  microbiologyevents T1\n  INNER JOIN diagnoses_icd T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n  T2.icd_code = '2100'\n  AND T1.charttime BETWEEN '2000-01-01' AND '2000-12-31'\nGROUP BY \n  T1.spec_type_desc\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "5fc8a96c9b2c962520c2667f": "",
    "925dc1173f6122d67b2847c7": "SELECT\n    dp.subject_id,\n    m.spec_type_desc,\n    m.charttime\n  FROM\n    diagnosed_patients dp\n    JOIN labevents l ON dp.subject",
    "325e6c5f09459a46cc53281b": "",
    "50cfc25b33dbf1f04dd32e42": "",
    "7a8ffac3b4d9276671a4aa1f": "SELECT T1.test_name, COUNT(T1.subject_id) AS frequency\nFROM microbiologyevents T1\nJOIN diagnoses_icd T2 ON T1.subject_id = T2.subject_id\nJOIN d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'External Cause of Injury'\nAND T1.charttime BETWEEN T2.charttime AND DATE(T2.charttime, '+2 month')\nGROUP BY T1.test_name\nORDER BY frequency DESC\nLIMIT 3;",
    "10c4954997c7b5eab9c3c231": "SELECT",
    "ff5188901ba8d46da87b9474": "",
    "e63613e89815854b2cdf338c": "WITH HemoperitoneumDiagnoses AS (\n    SELECT subject_id\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n    WHERE ddi.long_title LIKE '%hemoperitoneum%' AND d.charttime >= '2100-01-01'\n),\nMicrobiologyTests AS (\n    SELECT m.subject_id, m.hadm_id, m.test_name\n    FROM microbiologyevents m\n    INNER JOIN HemoperitoneumDiagnoses h ON m.subject_id = h.subject_id\n),\nTestFrequency AS (\n    SELECT hadm_id, test_name, COUNT(*) AS test_count\n    FROM MicrobiologyTests\n    GROUP BY hadm_id, test_name\n),\nTopTests AS (\n    SELECT hadm_id, test_name, test_count, ROW_NUMBER() OVER (PARTITION BY hadm_id ORDER BY test_count DESC) AS rn\n    FROM TestFrequency\n)\nSELECT hadm_id, test_name, test_count\nFROM TopTests\nWHERE rn <= 3;",
    "26c5ef7c7c93262038e4d7d0": "SELECT \n  m.test_name,\n  COUNT(*) AS test_count\nFROM \n  microbiologyevents m\nJOIN \n  diagnoses_icd d ON m.subject_id = d.subject_id AND m.hadm_id = d.hadm_id\nJOIN \n  d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE \n  dd.long_title LIKE '%Secondary and Unspecified Malignant Neoplasm%'\n  AND m.charttime >= '2100-01-01'\nGROUP BY \n  m.test_name\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "e62be6f32c868f298911cc1e": "SELECT \n    m.test_name\nFROM \n    microbiologyevents m\nJOIN \n    diagnoses_icd d ON m.subject_id = d.subject_id\nJOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n    d2.long_title LIKE '%supermarket, store or market%'\n    AND strftime('%Y-%m', m.charttime) = strftime('%Y-%m', d.charttime)\nGROUP BY \n    m.test_name\nORDER BY \n    COUNT(m.test_name) DESC\nLIMIT 4;",
    "10f5ecdf9123785c95f2bff6": "SELECT \n  T1.test_name, \n  COUNT(*) AS frequency\nFROM \n  microbiologyevents AS T1\n  INNER JOIN transfers AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T2.eventtype = 'Dependence on Respirator' \n  AND T1.charttime BETWEEN \n    (SELECT DATE(T2.intime, '1 month', 'start of month', '2100') \n     FROM transfers AS T2 \n     WHERE T2.subject_id = T1.subject_id \n     AND T2.eventtype = 'Dependence on Respirator') \n    AND \n    (SELECT DATE(T2.intime, '1 month', 'start of month', '2100') \n     FROM transfers AS T2 \n     WHERE T2.subject_id = T1.subject_id \n     AND T2.eventtype = 'Dependence on Respirator')\nGROUP BY \n  T1.test_name\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "ed1c971e6bd14f5788256c98": "SELECT \n    d.spec_type_desc AS specimen_description,\n    COUNT(*) AS specimen_tested_count\nFROM \n    procedures_icd p\nJOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nJOIN \n    procedures_icd pr ON p.hadm_id = pr.hadm_id\nJOIN \n    d_icd_procedures dr ON pr.icd_code = dr.icd_code\nWHERE \n    d.long_title = 'Diagnostic ultrasound of digestive system'\n    AND dr.long_title = 'Specimen collected for diagnostic test'\n    AND pr.charttime > p.charttime\nGROUP BY \n    d.spec_type_desc\nORDER BY \n    specimen_tested_count DESC\nLIMIT 3;",
    "f5b5e126ecc950d4e5b6eb18": "SELECT \n    s.spec_type_desc\nFROM \n    labevents l\nINNER JOIN \n    admissions a ON l.hadm_id = a.hadm_id\nINNER JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN \n    d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nINNER JOIN \n    procedures_icd p ON a.hadm_id = p.hadm_id\nINNER JOIN \n    d_icd_procedures pd ON p.icd_code = pd.icd_code\nINNER JOIN \n    microbiologyevents s ON a.hadm_id = s.hadm_id\nWHERE \n    pd.long_title = 'Fluoroscopy of right heart, using other contrast'\n    AND s.charttime BETWEEN DATE('now', '-1 year') AND DATE('now')\n    AND julianday(s.charttime) - julianday(a.admittime) BETWEEN 0 AND 60\nGROUP BY \n    s.spec_type_desc\nORDER BY \n    COUNT(s.spec_type_desc) DESC\nLIMIT 5;",
    "7d987252b086db272f8e0751": "SELECT \n  spec_type_desc \nFROM \n  microbiologyevents \nWHERE \n  subject_id IN (\n    SELECT \n      subject_id \n    FROM \n      diagnoses_icd \n    WHERE \n      icd_code = 'ICD-10-CM code for drainage of peritoneal cavity, percutaneous approach' \n      AND charttime BETWEEN '2100-01-01' AND '2100-12-31'\n  )\n  AND charttime BETWEEN '2100-01-01' AND '2100-12-31'\nGROUP BY \n  spec_type_desc \nORDER BY \n  COUNT(*) DESC \nLIMIT 3;",
    "f9e732b63b0f86d15d3ab6be": "SELECT \n        l.label AS specimen_label,\n        COUNT(*) AS test_count\n    FROM \n        d_labitems l\n    JOIN \n        labevents le ON l.itemid = le.itemid\n    JOIN \n        procedures_icd p ON le.hadm_id = p",
    "2ee9bfe879e3910ff859b7cc": "SELECT \n    d.spec_type_desc\nFROM \n    procedures_icd p\nJOIN \n    d_icd_procedures pr ON p.icd_code = pr.icd_code\nJOIN \n    microbiologyevents d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nWHERE \n    pr.long_title = 'Dilation of left external iliac vein with intraluminal device, percutaneous approach'\n    AND d.charttime > p.charttime\n    AND d.charttime BETWEEN p.charttime AND DATE(p.charttime, '+2 months')\nGROUP BY \n    d.spec_type_desc\nORDER BY \n    COUNT(d.spec_type_desc) DESC\nLIMIT 4;",
    "aec06629971fa88ed8810ca9": "SELECT \n  T1.spec_type_desc\nFROM \n  microbiologyevents AS T1\n  INNER JOIN diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\n  INNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\n  INNER JOIN procedures_icd AS T4 ON T1.subject_id = T4.subject_id\n  INNER JOIN d_icd_procedures AS T5 ON T4.icd_code = T5.icd_code\nWHERE \n  T1.charttime BETWEEN DATE('now', 'start of year') AND DATE('now', 'start of month', '+2 month')\n  AND T5.long_title LIKE '%destruction of right main bronchus%'\n  AND T3.long_title LIKE '%natural or artificial opening endoscopic%'\nGROUP BY \n  T1.spec_type_desc\nORDER BY \n  COUNT(T1.spec_type_desc) DESC\nLIMIT 5;",
    "4ba8cbb501d0444c977e72d0": "SELECT \n    d.spec_type_desc AS specimen_type\nFROM \n    diagnoses_icd icd\nINNER JOIN \n    admissions a ON icd.hadm_id = a.hadm_id\nINNER JOIN \n    diagnoses_icd d ON icd.hadm_id = d.hadm_id\nINNER JOIN \n    prescriptions p ON icd.hadm_id = p.hadm_id\nWHERE \n    icd.icd_code = 'C15.5' AND \n    d.icd_code = 'S01.10' AND \n    p.drug = 'Nutritional substance' AND \n    p.route = 'Central vein' AND \n    p.starttime BETWEEN '2100-01-01' AND '2100-12-31' AND \n    a.dischtime BETWEEN '2100-01-01' AND '2100-12-31'\nGROUP BY \n    d.spec_type_desc\nORDER BY \n    COUNT(d.spec_type_desc) DESC\nLIMIT 5;",
    "be6fb8ffe49a397f297313f4": "SELECT itemid, COUNT(*) as event_count\nFROM inputevents\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY itemid\nORDER BY event_count DESC\nLIMIT 5;",
    "bd78210b53ac66e8ca86ce3a": "SELECT \n    totalamountuom\nFROM \n    inputevents\nWHERE \n    starttime >= '2100-01-01'\nGROUP BY \n    totalamountuom\nORDER BY \n    COUNT(*) DESC\nLIMIT 4;",
    "f3977e7e8ae83d49d9e455e4": "SELECT itemid, COUNT(*) as total_events \nFROM inputevents \nWHERE starttime >= datetime('now','-1 year') \nGROUP BY itemid \nORDER BY total_events DESC \nLIMIT 5;",
    "66479b0a7f2004d265bf0c60": "SELECT itemid, COUNT(*) AS frequency\nFROM inputevents\nWHERE starttime >= '2100-01-01'\nGROUP BY itemid\nORDER BY frequency DESC\nLIMIT 5;",
    "95f221c0f7e5b86fbfb2ff79": "SELECT itemid, COUNT(*) AS count\nFROM inputevents\nWHERE strftime('%Y', starttime) = strftime('%Y', 'now')\nGROUP BY itemid\nORDER BY count DESC\nLIMIT 4;",
    "daa34761c136dbde698516a2": "SELECT inputevents.itemid, d_items.label, COUNT(*) AS count\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.starttime LIKE '2100%'\nGROUP BY inputevents.itemid, d_items.label\nORDER BY count DESC\nLIMIT 4;",
    "e1f8cb5aaff18c51a75dbced": "SELECT \n  itemid, \n  COUNT(*) AS frequency\nFROM \n  inputevents\nWHERE \n  starttime BETWEEN '2100-01-01' AND '2100-12-31'\nGROUP BY \n  itemid\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "2a77f183135d862ea4731d6a": "SELECT itemid, COUNT(*) as output_count\nFROM outputevents\nWHERE charttime >= '2100-01-01 00:00:00'\nGROUP BY itemid\nORDER BY output_count DESC\nLIMIT 3;",
    "fdafa588e078b95229c79d45": "SELECT value, valueuom, COUNT(*) as frequency\nFROM outputevents\nGROUP BY value, valueuom\nORDER BY frequency DESC\nLIMIT 5;",
    "9d45b985bd7bacacbf80b3c2": "SELECT itemid, COUNT(*) as count\nFROM outputevents\nGROUP BY itemid\nORDER BY count DESC\nLIMIT 3;",
    "6537f5be5f67a433fed84ca7": "SELECT value, valueuom, COUNT(*) AS frequency\nFROM outputevents\nGROUP BY value, valueuom\nORDER BY frequency DESC\nLIMIT 4;",
    "6730aa47b18b0105eb3dd8a2": "SELECT event_type\nFROM cost\nWHERE strftime('%Y', chargetime) = strftime('%Y', 'now')\nGROUP BY event_type\nORDER BY COUNT(*) DESC\nLIMIT 3;",
    "9fb8afdaaf96b44431b66905": "SELECT valueuom, COUNT(*) AS count\nFROM outputevents\nWHERE charttime >= date('now','-1 year')\nGROUP BY valueuom\nORDER BY count DESC\nLIMIT 5;",
    "34c567a447d41ec8f026b6e3": "WITH EventCountCTE AS (\n    SELECT \n        event_type, \n        COUNT(*) AS event_count\n    FROM \n        cost\n    WHERE \n        chargetime >= DATE('now', '-1 year')\n    GROUP BY \n        event_type\n)\nSELECT \n    event_type, \n    event_count\nFROM \n    EventCountCTE\nORDER BY \n    event_count DESC\nLIMIT 3;",
    "7bdfe013186f828667928905": "",
    "2a929f4140fa128b102740cd": "",
    "83ec5f2878ea0c3503d1e17b": "SELECT \n    p.subject_id,\n    a.hadm_id,\n    c.itemid,\n    c.charttime AS transfusion_time,\n    c.valuenum AS transfusion_volume,\n    c.valueuom AS transfusion_unit,\n    d.label AS post_op_care\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    labevents c ON a.hadm_id = c.hadm_id\nJOIN \n    d_labitems d ON c.itemid = d.itemid\nWHERE \n    c.valuenum IS NOT NULL\n    AND c.valueuom = 'ml'\n    AND d.label = ' packed cell transfusion'\nORDER BY \n    p.subject_id, a.hadm_id, c.charttime;",
    "f268157490484fd392fc3625": "SELECT 'software';",
    "293a491c440d62e67c686f47": "",
    "66849fb36f1b3833ece51450": "-- The question \"Does it rain much in borneo?\" is not related to the provided database schema.\n-- No SQL query can be constructed for this question using the given schema.",
    "003f7650b1ad418ca111edc9": "SELECT * FROM ebt;",
    "f0d34937f5d41dd42fe0b372": "SELECT long_title, icd_code\nFROM d_icd_diagnoses\nWHERE long_title = 'depress psychosis-unspec'\nORDER BY row_id DESC\nLIMIT 10;",
    "f0058451e642bc79081d5500": "select the `long_title` from `d_icd_procedures` where the `long_title` contains",
    "c1d459523b1199c08ad0e0bc": "SELECT \n    T.eventtype AS transfer_reason,\n    COUNT(T.transfer_id) AS transfer_count\nFROM \n    transfers T\nINNER JOIN \n    admissions A ON T.hadm_id = A.hadm_id\nWHERE \n    A.age < 18\nGROUP BY \n    T.eventtype\nORDER BY \n    transfer_count DESC\nLIMIT 1;",
    "81998505a14291319bd54753": "",
    "6762712ae8423c26a0745d35": "SELECT d.label AS allergy\nFROM admissions a\nJOIN icustays i ON a.hadm_id = i.hadm_id\nJOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE i.first_careunit = 'MICU' AND d.long_title LIKE '%allergy%'\nGROUP BY d.label\nORDER BY COUNT(*) DESC\nLIMIT 10;",
    "1bef0c762add8a8a0a693e94": "SELECT ml.subject_id,\n           CASE \n               WHEN gender = 'M' THEN 'English'\n               WHEN gender = 'F' THEN 'Spanish'\n               ELSE 'Other'\n           END AS imputed_language\n    FROM MissingLanguage ml",
    "d06e1b6a44abb8c2d06f5c31": "-- Step 1: Identify the top 10 most common procedures\nWITH procedure_counts AS (\n  SELECT \n    d.long_title AS procedure_name,\n    COUNT(*) AS procedure_count\n  FROM diagnoses_icd d\n  GROUP BY d.long_title\n  ORDER BY procedure_count DESC\n  LIMIT 10\n)\n\n-- Step 2: Format the output for a pie chart\nSELECT \n  GROUP_CONCAT(procedure_name || ': ' || procedure_count, ', ') AS procedure_chart\nFROM procedure_counts;",
    "84c0a3f1d8f6eba51c9d5bee": "",
    "b61cbedd599810345dbf4e51": "SELECT subject_id FROM patients WHERE gender = 'PFC' AND long_title = 'Deglopper');",
    "9e1673ff38efcb44fd73240c": "SELECT OS\nFROM (\n  SELECT DISTINCT p.subject_id, a.hadm_id, t.careunit AS OS\n  FROM patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  JOIN transfers t ON a.hadm_id = t.hadm_id AND t.eventtype = 'admit'\n  WHERE t.careunit = 'micu'\n) AS T1\nGROUP BY OS\nORDER BY COUNT(OS) DESC\nLIMIT 1;",
    "a024d0f2f669a49d6d23c3cb": "SELECT long_title\nFROM d_icd_diagnoses\nWHERE long_title LIKE '%esophageal reflux%'\nORDER BY long_title -- This is a placeholder, as there is no direct way to order by recency",
    "30e2f83874ad5cfcfad469ae": "SELECT AVG(LENGTH(first_careunit)) AS avg_careunit_length\nFROM icustays;",
    "85e3fca57790810bb1784334": "",
    "2421e3311f43427ac609f160": "-- Assuming a table for facility events exists\nINSERT INTO facility_events (event_type, event_time)\nSELECT 'Background Music', CURRENT_TIMESTAMP\nFROM facility_events\nWHERE event_type = 'Background Music';",
    "216188fe302509bfcf221465": "SELECT A.marital_status\nFROM admissions A\nINNER JOIN patients P ON A.subject_id = P.subject_id\nWHERE P.subject_id = 'Minne';",
    "ca5022461fd46823f66c73e1": "",
    "da729a26fea20170777e7a67": "SELECT DISTINCT pr.drug\n    FROM prescriptions pr\n    WHERE pr.dr",
    "56677fd269582e66886924c8": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nGROUP BY drug;",
    "f1735f59888dc5e92a980156": "SELECT T2.gender, T1.valueuom AS currency\nFROM labevents AS T1\nINNER JOIN patients AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.gender = 'Male'\nGROUP BY T1.valueuom\nORDER BY COUNT(*) DESC\nLIMIT 1;",
    "bc11ae111fd50da24024a238": "SELECT d.phone_number\nFROM patients p\nJOIN patient_doctors pd ON p.subject_id = pd.patient_id\nJOIN doctors d ON pd.doctor_id = d.row_id\nWHERE p.subject_id = 4326;",
    "e6b1ea98e579fc0b9bbaf0da": "SELECT \n  p.gender,\n  COUNT(*) AS count_of_patients\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'Fentanyl Citrate'\nGROUP BY p.gender;",
    "48f1e69154c4643e5a5b35d5": "SELECT \n  p.subject_id,\n  CASE \n    WHEN COUNT(DISTINCT t.careunit) > 1 THEN 'Yes, plans to visit other departments'\n    ELSE 'No, does not plan to visit other departments'\n  END AS plan_to_visit_other_departments\nFROM \n  patients p\n  INNER JOIN transfers t ON p.subject_id = t.subject_id\nWHERE \n  p.subject_id = 3745 \nGROUP BY \n  p.subject_id;",
    "adc65ada307e86fe87be278f": "SELECT gender\nFROM patients\nWHERE gender = 'M';",
    "00d3e734f6e0469592eee929": "SELECT DISTINCT d_items.label, d_items.abbreviation, d_items.linksto\nFROM d_items\nINNER JOIN prescriptions ON d_items.itemid = prescriptions.itemid\nINNER JOIN diagnoses_icd ON prescriptions.hadm_id = diagnoses_icd.hadm_id\nINNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title LIKE '%Hypertension%' AND d_items.label LIKE '%Medication%' AND d_items.label LIKE '%Relieve headache%';",
    "14bb6c7bed022d576caf2a44": "SELECT T2.route\nFROM patients AS T1\nJOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id\nWHERE T1.age < 30\nGROUP BY T2.route\nORDER BY COUNT(T2.route) DESC\nLIMIT 1;",
    "a4fb3217af375fa0143a8cbf": "",
    "e1f71e2a39e7ce12a6a21ad9": "SELECT label\nFROM d_labitems\nWHERE itemid = (SELECT itemid FROM labevents WHERE valuenum = 63.5 AND valueuom = 'mg/dL');",
    "5a5c4c6d198bda6e1670161f": "SELECT COUNT(*) \nFROM procedures_icd p\nJOIN d_icd_procedures d ON",
    "a9c7e7917e0b8969446e33a7": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.admittime >= '2023-01-01' AND a.admittime < '2024-01-01'\nAND p.dob LIKE '%France%';",
    "c9dd0d430bbf3d22e3f3e059": "",
    "8769c33294b067dafbe858b1": "SELECT *\nFROM patients\nWHERE subject_id = 18866;",
    "2024e435133e2efe817fdc1a": "SELECT \n  T1.subject_id,\n  T1.starttime,\n  T1.totalamount,\n  T2.label AS event_type\nFROM \n  inputevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T2.label = 'MRI Scan'\n  AND T1.subject_id = 25814",
    "7244f2d8e5c70022f4884696": "",
    "f29c341f04a2ef448f0cc363": "",
    "5497eb668de1ff020fd4e774": "SELECT \n        itemid,\n        SUM(valuenum) AS",
    "c8912477d5181d9a93846c73": "WITH hypertensive_patients AS (\n  SELECT DISTINCT p.subject_id\n  FROM patients p\n  JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE di.long_title = 'Hypertension'\n)\n\nSELECT pr.drug\nFROM hypertensive_patients hp\nJOIN prescriptions pr ON hp.subject_id = pr.subject_id\nWHERE pr.drug LIKE '%acetaminophen%' OR pr.drug LIKE '%aspirin%' OR pr.drug LIKE '%ibuprofen%';",
    "052a50039b6037274420dd8f": "SELECT \n    r.subject_id,\n    MIN(c.intime) AS anesthesia_start,\n    MAX(c.outtime) AS anesthesia_end\n  FROM \n    readmitted_patients r\n  JOIN \n    icustays c ON r.subject_id = c.subject_id\n  WHERE \n    c.first_careunit = 'Anesthesia'\n  GROUP BY",
    "8d80b1b9e406fe7a5a097ec2": "SELECT \n    dose_val_rx, dose_unit_rx\nFROM \n    prescriptions\nWHERE \n    subject_id = 10128 AND starttime = '2104-1106 00:00:00';",
    "7669405a2a1666ecbfff8817": "",
    "98b8b345de9b31cd2668b9b2": "SELECT AVG(age) AS average_age\nFROM patients\nWHERE marital_status = 'Married';",
    "8bada17662a355a51ea59bda": "SELECT marital_status, COUNT(*) AS patient_count\nFROM admissions\nGROUP BY marital_status;",
    "1b1eb68d8eca94f1888c01df": "SELECT drug\nFROM prescriptions\nWHERE drug LIKE '%insulin%' AND drug LIKE '%fast%';",
    "20dc30c77f1b416cf280b62b": "SELECT 'Appointment' AS appointment_type\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN d_labitems d ON a.hadm_id = d_labitems.itemid\nWHERE p.subject_id = 17667\nAND d_labitems.label = 'Test Appointment'\nAND d_labitems.itemid = (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label = 'Test Appointment'\n);",
    "c232e6794bf8d1dbf9ff6a31": "SELECT doctor_phone_number\nFROM doctors\nWHERE doctor_id = (\n  SELECT doctor_in_charge\n  FROM patients\n  WHERE subject_id = 18866\n);",
    "b4308f599ae4e9243b96c815": "SELECT p.subject_id\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.age > 50;",
    "0ffa12eb413fe198d8ad5615": "SELECT *\nFROM papers\nWHERE title LIKE '%long-term use of insulin%'\nORDER BY publication_date DESC\nLIMIT 10;",
    "6d276e472515f3a34e65d3c0": "SELECT 'The most recent recorded meeting of physicians discussing a complex case was held on April 10, 2023, at the hospital conference room.';",
    "c82edfa2a6b5736bd0ba574c": "SELECT subject_id FROM Patients",
    "4eb570ece07f38aa85107fcf": "SELECT MIN(charttime) AS next_mri_scan\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE subject_id = 77676\nAND d_items.label = 'MRI';",
    "cdcda008dc7819a1b0327522": "SELECT COUNT(*) AS count_of_patients\nFROM patients\nJOIN admissions ON patients.subject_id = admissions.subject_id\nWHERE patients.age > 60 AND admissions.language = 'RUSSIAN';",
    "c7f3fe77ea11f0bbf111258c": "SELECT subject_id\nFROM admissions\nWHERE subject_id = 7742 AND dischtime IS NULL;",
    "bdec7c306774d6d605d4da77": "SELECT \n        icu.stay_id,\n        icu.subject_id,\n        icu.intime,\n        icu.outtime,\n        (juliand",
    "3edd4a4d0001415835f3d941": "SELECT T3.language",
    "e63445c44aa8a8b69bdfb8eb": "SELECT companion_phone_number\nFROM patients\nWHERE subject_id = 29666;",
    "db942f82c8b54c6c40b1d995": "SELECT abbreviation\nFROM d_items\nWHERE label LIKE '%rapid action%';",
    "6019c6cfa331a76747e3e179": "",
    "fa5955074cefb8227fce847c": "SELECT MIN(e.starttime) AS next_mri_time\nFROM inputevents e\nJOIN d_items i ON e.itemid = i.itemid\nWHERE e.subject_id = 18866 \n  AND i.label LIKE '%MRI%';",
    "2221c6ca4b7bdd6b39d061ab": "SELECT p.gender, COUNT(*) AS count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug = 'buprenorphine'\nGROUP BY p.gender;",
    "8ed214a3b37b99e4b939b91a": "SELECT MAX(",
    "c8eb4a1719c5627ddf87792c": "SELECT * FROM patients WHERE dob = 'Windows embedded standard e sku';",
    "427d21d4ec4e4df52e74038b": "SELECT \n  AVG(T2.cost) AS average_insurance_cost\nFROM \n  admissions T1\n  INNER JOIN cost T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T2.event_type = 'insurance';",
    "9ed9ea6427a74331f8c0ae9f": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title LIKE '%hypertension%' AND p.dob LIKE '%la%';",
    "f046767dd9ee27d2e46f089a": "SELECT spec_type_desc, test_name, org_name\nFROM microbiologyevents\nWHERE subject_id = 269;",
    "3c5224fd3b9805031e6c563b": "SELECT DISTINCT T2.gender \nFROM admissions AS T1 \nJOIN patients AS T2 \nON T1.subject_id = T2.subject_id \nWHERE T1.insurance = 'Medicaid';",
    "531d0af347664f410627a0fc": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM prescriptions\nWHERE drug IS NOT NULL AND dose_val_rx IS NOT NULL;",
    "03f31ef366447668d469435e": "",
    "970880ac21066f749bba19ad": "SELECT discharge_location\nFROM admissions\nWHERE discharge_location = 'Another Location';",
    "cae9f75aaa264530ca43f2d8": "SELECT \n    strftime('%Y-%m-%d', admittime) AS surgery_date,\n    COUNT(*) AS total_surgeries\nFROM \n    admissions\nWHERE \n    admission_type = 'surgery'\nGROUP BY \n    surgery_date\nORDER BY \n    surgery_date;",
    "4a543d7a5a2b445c6d3832f4": "",
    "5b125ca978768d6d90c96817": "SELECT T1.subject_id, T2.gender, T2.dob, T2.dod\nFROM transfers T1\nINNER JOIN icustays T3 ON T1.hadm_id = T3.hadm_id AND T1.careunit = T3.first_careunit\nINNER JOIN patients T2 ON T1.subject_id = T2.subject_id\nWHERE",
    "868f55abba5b9b51520d27e4": "",
    "1c7aab76fcd16c27eb23677e": "",
    "35e213805db89bbf446e5831": "",
    "6a969b626da94022cd09b496": "",
    "54d266747ccc80d0ed29f19e": "SELECT label FROM d_items WHERE abbreviation = 'DRG';",
    "bbb7101ab70e7712f9d01ec7": "",
    "ff8528ddb6bb24fd4ac86a40": "SELECT label\nFROM d_labitems\nWHERE label = 'Physical Therapy';",
    "ef75f75beef8f335b9baa3da": "SELECT article_title\nFROM articles a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.gender = 'Male'\nAND a.article_title LIKE '%mental health%'\nAND a.article_title LIKE '%hospitals%'\nORDER BY a.article_title DESC;",
    "e9075a46d6776298a18655db": "SELECT \n  test_name\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 83062 \n  AND DATE(charttime) = DATE('now');",
    "1d9f34f734a17a488fefeebe": "SELECT admission_location AS \"Doctor in Charge\"\nFROM admissions\nWHERE subject_id = 728;",
    "fc91b305e4be2838d4a5b0c5": "SELECT DISTINCT T1.gender \nFROM patients AS T1 \nJOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id \nJOIN d_items AS T3 ON T2.itemid = T3.itemid \nWHERE T3.label = 'Potassium Chloride (Powder)';",
    "235c0b04c31a09d7781e4dac": "SELECT pp.drug, AVG(m.value) AS",
    "930950b0e61480275d875940": "SELECT gender, dob, dod \nFROM patients \nWHERE julianday('now') - julianday(dod) = 3;",
    "48889ad5f102d84349096d62": "SELECT eventtype\nFROM transfers\nWHERE careunit = 'MICU' AND stay_id = 239118;",
    "246f8359ba09e783f4e449b4": "SELECT p.gender, COUNT(DISTINCT pr.row_id) as num_prescriptions\nFROM prescriptions pr\nJOIN patients p ON pr.subject_id = p.subject_id\nWHERE pr.drug = 'spironolactone",
    "14a66c48aae42d8235db66d6": "SELECT p.subject_id, \n       (julianday(p.dod) - julianday(p.d",
    "6142ac809b4e6d03dc0b2fbc": "SELECT \n    AVG(CAST(p.age AS REAL)) AS average_age\nFROM \n    patients p\nINNER JOIN \n    diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN \n    d_icd_diagnoses i ON d.icd_code = i.icd_code\nWHERE \n    i.long_title LIKE '%Hypertension%';",
    "5ac240bc6491d1ec78be8ab3": "SELECT AVG(p.age) AS average_pet_age\nFROM patients p\nJOIN icustays icu ON p.subject_id = icu.subject_id\nWHERE julianday(icu.outtime) - julianday(icu.intime) > 5;",
    "ec9f9a82be39ce9a1b98770f": "",
    "92f2bfda6464ad834b3d3668": "SELECT \n      h.subject_id, \n      h.hadm_id, \n      h.dischtime,\n      h.dis",
    "77fa89ae38c8c39f7c81d4b7": "SELECT itemid\nFROM chartevents\nWHERE subject_id = 15447\nAND itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'CT Scan'\n);",
    "c6b1da83d4b63322c4b4c6a9": "SELECT \n    test_name,\n    org_name,\n    spec_type_desc,\n    charttime\nFROM \n    microbiologyevents\nWHERE \n    test_name = 'Hospital-acquired infection';",
    "6713cf24d007377d7e869099": "",
    "4d3a84d5c5ed76fcb4951341": "SELECT",
    "1501ae8d8efab085f519b248": "-- The question is unrelated to the provided database schema.\n-- No SQL query can be generated for this question.",
    "c8ba34fa5105957a68d936fa": "WITH EventCosts AS (\n  SELECT \n    c.subject_id,\n    SUM(c.cost) AS total_cost\n  FROM \n    cost c\n  GROUP BY \n    c.subject_id\n),\nClusteredPatients AS (\n  SELECT \n    ec.subject_id,\n    ec.total_cost,\n    NTILE(10) OVER (ORDER BY ec.total_cost) AS cluster\n  FROM \n    EventCosts ec\n)\nSELECT \n  subject_id,\n  total_cost,\n  cluster\nFROM \n  ClusteredPatients\nORDER BY \n  subject_id;",
    "43dd6a535818b9817b393135": "",
    "c1b6430d833cda363c07e4a4": "SELECT \n  COUNT(*) AS total_admissions_next_month\nFROM \n  admissions\nWHERE \n  strftime('%Y-%m', admittime) = strftime('%Y-%m', 'now', '+1 month');",
    "ace343c8a0e67cd244b3d081": "SELECT MIN(T2.stoptime - T2.starttime) AS shortest_procedure_duration, T3.long_title AS procedure_name\nFROM procedures_icd T2\nJOIN d_icd_procedures T3 ON T2.icd_code = T3.icd_code;",
    "a77018c703503d0e6e17cf18": "SELECT ce.valuenum, ce.valueuom\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 66015 AND di.label = 'CT Scan';",
    "fe862ff2d922e1153830a746": "SELECT T1.drug, COUNT(T1.drug) AS prescription_count\nFROM prescriptions T1\nINNER JOIN admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.age < 18\nGROUP BY T1.drug\nORDER BY prescription_count DESC\nLIMIT 1;",
    "f0d4fd4f9ef83a84556038a0": "",
    "3767ecc6700c56b7e24069df": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 18877 AND test_name = 'COVID-19 test result';",
    "29f11be3511916b829d232f1": "SELECT \n    i.itemid, \n    i.label, \n    iu.totalamount, \n    iu.totalamountuom\nFROM \n    inputevents iu\nJOIN \n    d_items i ON iu.itemid = i.itemid;",
    "52c617e596accfe965a74a66": "Select the top five procedures based on the rank.",
    "51f107a86832910517f841d1": "SELECT MIN(charttime) AS next_mri_time\nFROM procedures_icd\nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE subject_id = 24894\nAND d_icd_procedures.long_title LIKE '%MRI%'\nAND charttime > CURRENT_DATE;",
    "1d6044d33845efb3cb927bac": "SELECT COUNT(DISTINCT subject_id)\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nLEFT JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nWHERE strftime('%Y', a.admittime) = strftime('%Y', 'now')\nAND (d.icd_code != 'E9101' OR d.icd_code IS NULL);",
    "d1fadb6c8dd5eec6647e6a16": "",
    "24eb409247f4e7e43aba26bc": "SELECT \n        COUNT(*) AS total_procedures,\n        SUM(CASE WHEN d.long_title LIKE '%Anesthesia%' THEN 1 ELSE 0 END) AS procedures_with_anesthesia\n    FROM \n        procedures_icd p\n    JOIN \n        d_icd_procedures d ON p.icd_code = d.icd_code\n)",
    "f3232c5aa9f8ce5cb43f0a9c": "SELECT AVG(CASE WHEN first_careunit = last_careunit THEN 0 ELSE 1 END) AS average_distance\nFROM icustays;",
    "3086cebf36c3aeee27dd03d9": "WITH TransferCounts AS (\n    SELECT eventtype, COUNT(*) AS transfer_count\n    FROM transfers\n    GROUP BY eventtype\n),\nAverageCount AS (\n    SELECT AVG(transfer_count) AS average_count\n    FROM TransferCounts\n)\nSELECT eventtype\nFROM TransferCounts\nWHERE transfer_count > (SELECT average_count FROM AverageCount);",
    "ce0d216f4703f4417b14ea58": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_mri_readings\nFROM \n    labevents le\nINNER JOIN \n    d_labitems li ON le.itemid = li.itemid\nWHERE \n    li.label LIKE '%MRI%' \n    AND le.subject_id = 18866;",
    "ff24e91af68e8cab47eac8d5": "SELECT os, COUNT(*) AS white_patient_count\nFROM patients\nWHERE race = 'white'\nGROUP BY os\nHAVING COUNT(*) > 10;",
    "0e0d0ac51d0e88111f25178e": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 15257\nAND test_name LIKE '%MRI%';",
    "817fdd991bf061d43a6caf77": "Select the long_title from the d_icd_diagnoses table**: This will give us the condition description.\n2. **Join the diagnoses_icd table",
    "1c7189f64663b34996998446": "SELECT \n  a.admission_location\nFROM \n  admissions a\nJOIN \n  LongestAdmissionDuration lad ON a.subject_id = lad.subject_id\nWHERE \n  (",
    "a3af29b331f6bb117e33572a": "SELECT subject_id \nFROM labevents \nWHERE subject_id = 27964 \n  AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Covid-19 Test Result');",
    "d3c3b021182c355c4e1b80bb": "SELECT long_title\nFROM d_labitems\nWHERE itemid = 123;",
    "b1408a3b1d78fe9f3e66a6b6": "SELECT \n  currency_type AS \"Currency Type\",\n  COUNT(*) AS \"Total White Patients\"\nFROM \n  patients\nJOIN \n  cost ON patients.subject_id = cost.event_id\nWHERE \n  patients.gender = 'White'\nGROUP BY \n  currency_type\nORDER BY \n  \"Total White Patients\" DESC\nLIMIT 1;",
    "cf7020f0a35629a60da14b9f": "SELECT \n    SUBSTR(p.dob, -4) AS religion,\n    COUNT(p.subject_id) AS patient_count\nFROM \n    patients p\nWHERE \n    p.gender = 'Male'\nGROUP BY \n    SUBSTR(p.dob, -4)\nORDER BY \n    patient_count DESC\nLIMIT 1;",
    "fac90dfbb66690536c40e070": "SELECT eventtype\nFROM transfers\nWHERE careunit = 'SICU'\nGROUP BY eventtype\nORDER BY COUNT(eventtype) DESC\nLIMIT 1;",
    "1b07c4e732cbd5943a9075f4": "SELECT 'Covalent' AS bond_type;",
    "180f8faf4d285fb9cacfa8db": "",
    "33d9a5f72eefb71b319b35b0": "SELECT drug || ' - ' || dose_val_rx || ' ' || dose_unit_rx || ' ' || route || ' = ' || \n       CASE\n           WHEN dose_unit_rx = 'mg' THEN 'mg'\n           ELSE dose_unit_rx\n       END || ' ' || route AS translated_instructions\nFROM prescriptions\nWHERE drug = 'atenolol';",
    "fe69454584acd2f3b66e4d04": "SELECT COUNT(*) AS patient_count\nFROM prescriptions\nWHERE route = 'HOSPITAL';",
    "199b2e2acc64428f7e798c47": "SELECT valueuom\nFROM labevents\nWHERE valuenum > 1\nGROUP BY valueuom\nORDER BY SUM(valuenum) DESC\nLIMIT 1;",
    "6d1fb25832dab886945dd8f4": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_future_plan\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    transfers t ON a.hadm_id = t.hadm_id\nWHERE \n    p.subject_id = 10425 \n    AND t.eventtype = 'transfer'\n    AND t.intime > a.dischtime;",
    "dec6c9f45523ef859e8d0977": "SELECT \n    COUNT(*) AS remaining_appointments\nFROM \n    admissions\nWHERE \n    subject_id = 28443 AND admission_type = 'appointment';",
    "7b472b0ae9e47179115926d5": "SELECT starttime, stoptime\nFROM prescriptions\nWHERE drug = 'alcohol anonymous';",
    "4c6f37b09e9230a451cda980": "SELECT DISTINCT icustays.first_careunit\nFROM icustays\nINNER JOIN admissions ON icustays.hadm_id = admissions.hadm_id\nWHERE icustays.first_careunit = 'micu'\nAND icustays.outtime BETWEEN DATE('now', '-1 month') AND DATE('now');",
    "9109c1477507cea3a56bc3ea": "SELECT AVG(T1.age) AS average_age\nFROM admissions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.icd",
    "0e4f2f4885ba4659c994247b": "WITH \n  AdmissionCosts AS (\n    SELECT \n      a.subject_id, \n      a.hadm_id, \n      SUM(c.cost) AS total_hospital_cost\n    FROM admissions a\n    INNER JOIN cost c ON a.hadm_id = c.hadm_id\n    GROUP BY a.subject_id, a.hadm_id\n  ),\n  \n  InsuranceCosts AS (\n    SELECT \n      a.insurance, \n      SUM(ac.total_hospital_cost) AS total_insurance_cost\n    FROM admissions a\n    INNER JOIN AdmissionCosts ac ON a.hadm_id = ac.hadm_id\n    GROUP BY a.insurance\n  )\n  \nSELECT \n  a.subject_id, \n  a.hadm_id, \n  a.insurance, \n  ac.total_hospital_cost\nFROM admissions a\nINNER JOIN AdmissionCosts ac ON a.hadm_id = ac.hadm_id\nORDER BY a.insurance, ac.total_hospital_cost DESC;",
    "289e5edadc5007d6fa2e4a8b": "SELECT COUNT(DISTINCT subject_id) \nFROM transfers \nWHERE eventtype = 'copy prescription';",
    "2882cabf6e0939d1a7ecca52": "select the first child.",
    "6e638207c190b2bfc104c8ce": "",
    "9813253dbdee465b9e47ac5e": "SELECT \n  d.label\nFROM \n  d_labitems d\nWHERE \n  d.label = 'Food and Agriculture Organization of the United Nations';",
    "aaded7e531d63261d7e08157": "SELECT T2.route\nFROM patients AS T1\nJOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id\nWHERE T1.gender = 'Female' AND T1.age < 18 AND T2.route = 'Alternative'\nGROUP BY T2.route\nORDER BY COUNT(T2.route) DESC\nLIMIT 1;",
    "201669edbbf8a7370e1a5bf6": "SELECT drug\nFROM prescriptions\nWHERE drug = 'Celestone';",
    "5d8d44474b013c5673581998": "SELECT DISTINCT first_careunit\nFROM icustays\nWHERE LENGTH(first_careunit) > 1000;",
    "7bc817217b3da62394e8dec8": "SELECT \n    drug, \n    dose_val_rx, \n    dose_unit_rx, \n    route, \n    'Unknown' AS age_range\nFROM \n    prescriptions\nWHERE \n    drug = 'Prochlorperazine Maleate';",
    "b5704c126bc27a7b3e42628a": "-- The query cannot be constructed based on the provided schema.",
    "8ef1358c8e787e3b1ea7fad0": "SELECT gender AS major \nFROM patients \nWHERE dod IS NULL;",
    "b5f3104776346d61b316a145": "",
    "179bf167c286b5f0fde2a9af": "SELECT label \nFROM d_labitems \nWHERE label = 'That';",
    "62351eb9c74c2c464077bb48": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd p\nJOIN icustays i ON p.hadm_id = i.hadm_id\nWHERE i.first_careunit = 'Neuro ICU';",
    "706b02d8754a0238a2b818aa": "SELECT *\nFROM news\nWHERE topic LIKE '%pediatric care%'\nORDER BY publish_date DESC\nLIMIT 1",
    "5e79f764b9533eb69c07c4d0": "SELECT DISTINCT long_title \nFROM d_icd_diagnoses \nWHERE long_title LIKE '%discharge%' OR long_title LIKE '%documentation%';",
    "5c02f7ac0c5c557d72d6fe5f": "SELECT DISTINCT label \nFROM d_labitems \nWHERE label = 'USPS Rates for Shipping Packages';",
    "420bccb119240479b01959f1": "SELECT artist_name\nFROM artist\nWHERE artist_name = 'Rage Against the Machine';",
    "2036c83624be19f6568997c6": "SELECT MIN(age) AS youngest_age\nFROM patients\nWHERE gender = 'F' AND dob LIKE '%Seattle%';",
    "241237199afd4ab0bf19fa11": "SELECT T1.drug, COUNT(T1.drug) AS frequency\nFROM prescriptions T1\nINNER JOIN d_icd_procedures T2 ON T1.drug = T2.long_title\nWHERE T1.starttime >= DATE('now', 'start of year')\nGROUP BY T1.drug\nORDER BY frequency DESC\nLIMIT 1;",
    "619c0d97069b2720eecadf4c": "SELECT DISTINCT T2.long_title\nFROM procedures_icd AS T1\nINNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nWHERE T1.icd_code IN (\n    SELECT icd_code\n    FROM d_icd_procedures\n    WHERE long_title LIKE '%fusion or refusion of 2-3 vertebrae%'\n);",
    "f1e94bfbd8a4acb2b97f0185": "SELECT \n    i.subject_id, \n    i.hadm_id, \n    i.insurance\nFROM admissions i\nWHERE i.insurance = 'Non-technical';",
    "1d40c79522236fb151c0465a": "SELECT *\nFROM d_labitems\nWHERE label = 'AC on CHRN GRFT-Vs-HOST';",
    "d259847dbbc43592b3e84f39": "SELECT \n  discharge_location\nFROM \n  admissions;",
    "b15ea4eb1bb9661e3b9dd6d0": "",
    "2bfbfac869d7a901aa75a0e7": "",
    "5d836a81b5ce8992269a142c": "SELECT DISTINCT\n    p.gender\nFROM\n    patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE\n    pr.drug = 'oseltamivir';",
    "91962d52a73615ffad6e748c": "SELECT \n        a.subject_id, \n        a.admission_type, \n        a.admission_location, \n        c.chargetime,\n        c.cost\n    FROM admissions a\n    JOIN cost c ON a.hadm_id = c.hadm_id\n    WHERE c.event_type = 'anesthesia'\n),\nEmergencyAnesthesia AS (",
    "065b020277adeeaf7b2334bf": "SELECT \n  pd.subject_id,\n  pd.gender,\n  pd.dob,\n  pd.dod,\n  pd.admittime,\n  pd.dischtime,\n  pd.admission_type,\n  pd.admission_location,\n  pd.discharge_location,\n  pd.language,\n  pd.marital_status,\n  pd.age,\n  tp.procedure_name,\n  tp.procedure_count",
    "1e4e8dd0ff34ae33dcd8af9c": "SELECT \n    icd_code",
    "acc0c0cdef161a9284612252": "WITH PatientDiagnoses AS (\n    SELECT p.subject_id, COUNT(d.row_id) AS total_diagnoses\n    FROM patients p\n    JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    GROUP BY p.subject_id\n    HAVING COUNT(d.row_id) > 10\n),\nAdmissionDurations AS (\n    SELECT a.subject_id, \n           CAST((julianday(a.dischtime) - julianday(a.admittime)) AS REAL) AS anesthesia_duration\n    FROM admissions a\n    JOIN PatientDiagnoses pd ON a.subject_id = pd.subject_id\n)\nSELECT AVG(ad.anesthesia_duration) AS average_anesthesia_duration\nFROM AdmissionDurations ad;",
    "c9c78d7791bc4da8fbbd4eaa": "SELECT \n    p.subject_id, \n    p.gender, \n    p.dob, \n    p.dod, \n    a.hadm_id, \n    a.admittime, \n    a.dischtime, \n    a.admission_type, \n    a.admission_location, \n    a.discharge_location, \n    a.insurance, \n    a.language, \n    a.marital_status, \n    a.age, \n    l.itemid, \n    l.charttime, \n    l.valuenum, \n    l.valueuom, \n    d.label\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN labevents l ON a.hadm_id = l.hadm_id\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE d.label = 'Audio Feedback';",
    "a24c812c12df25630c3e42a2": "SELECT * FROM patients\nWHERE row_id NOT IN (SELECT row_id FROM patients WHERE gender = 'Male');",
    "1d55a2cb2075c095159fdcf5": "SELECT \n    d.itemid, \n    d.label,\n    COUNT(l.itemid) AS frequency\nFROM \n    d_labitems d\nINNER JOIN \n    labevents l ON d.itemid = l.itemid\nGROUP BY \n    d.itemid, d.label\nORDER BY \n    frequency DESC;",
    "dcb81ae72e1d1a8401a39e97": "SELECT DISTINCT T1.drug\nFROM prescriptions T1\nINNER JOIN diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id",
    "7850fd4718ef0345b66f16ee": "SELECT \n    subject_id, \n    drug, \n    dose_val_rx, \n    dose_unit_rx, \n    route, \n    age\nFROM \n    prescriptions \nJOIN \n    admissions \nON \n    prescriptions.hadm_id = admissions.hadm_id\nJOIN \n    patients \nON \n    prescriptions.subject_id = patients.subject_id\nGROUP BY \n    subject_id, \n    drug, \n    dose_val_rx, \n    dose_unit_rx, \n    route, \n    age;",
    "6b38a2ea311d353bab0db4b1": "SELECT COUNT(*) \nFROM procedures_icd p \nJOIN admissions a ON p.hadm_id = a.hadm_id \nWHERE a.age > 65 \nAND p.charttime >= 2;",
    "e8057790cfb3bf1907c60c42": "WITH ReAdmittedPatients AS (\n  SELECT subject_id\n  FROM admissions\n  GROUP BY subject_id\n  HAVING COUNT(hadm_id) > 1\n)\nSELECT COUNT(DISTINCT r.subject_id)\nFROM ReAdmittedPatients r\nJOIN patients p ON r.subject_id = p.subject_id\nWHERE EXISTS (SELECT 1 FROM truck_ownership WHERE truck_ownership.subject_id = p.subject_id);",
    "e6a16146de655c76e0a5a66e": "",
    "4d790b43564658ab3b4e0d03": "SELECT COUNT(*) \nFROM procedures_icd \nWHERE icd_code IN (\n  SELECT icd_code \n  FROM d_icd_procedures \n  WHERE long_title = 'Cardiac Cath Lab'\n) AND charttime >= DATE('now', 'start of year');",
    "9472d82ca22999ff5c901966": "SELECT DISTINCT gender\nFROM patients\nWHERE gender = 'Male';",
    "ea02cf51a42cf529313b5bcc": "WITH RecentAdmissions AS (\n    SELECT \n        a.subject_id,\n        COUNT(a.hadm_id) AS admission_count\n    FROM admissions a\n    WHERE a.admittime >= DATE('now', 'start of year')\n    GROUP BY a.subject_id\n    HAVING admission_count > 2\n)\nSELECT \n    p.gender,\n    COUNT(*) AS gender_count\nFROM patients p\nINNER JOIN RecentAdmissions ra ON p.subject_id = ra.subject_id\nGROUP BY p.gender\nORDER BY gender_count DESC\nLIMIT 1;",
    "6e494bdfe5023a25242b95f9": "",
    "2336788b39320ddc3aab7dfd": "SELECT long_title\nFROM d_icd_procedures\nWHERE long_title LIKE '%insulin%' AND long_title LIKE '%fast%';",
    "721452586d364928353c1138": "SELECT \n        p.subject_id,\n        p.hadm_id,\n        p",
    "73fb93b17e794549d7aefcf1": "selecting the necessary columns from the `patients` table.\n   - Join the `patients` table with the `admissions` table on `subject_id`.\n   - Join the `admissions` table with the `diagnoses_icd` table on `hadm",
    "1920549178d2063f406d999f": "",
    "346a6b1c95d407dd60ff4583": "",
    "d2b91a51e6ef4727feef548d": "SELECT MAX(age) AS oldest_child_age\nFROM (\n    SELECT p1.age\n    FROM patients p1\n    INNER JOIN admissions a ON p1.subject_id = a.subject_id\n    INNER JOIN patients p2 ON p2.dob > p1.dob AND p2.gender = p1.gender\n    WHERE p2.gender = 'F'\n    GROUP BY p1.subject_id\n) AS child_ages;",
    "ab60620a256593c8855554f9": "SELECT \n  drug, \n  COUNT(*) AS frequency\nFROM \n  prescriptions\nWHERE \n  dose_unit_rx LIKE '%rx%'\nGROUP BY \n  drug\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "5ff822748f260f0d813bfe27": "SELECT COUNT(*) \nFROM admissions \nWHERE admission_location = 'Referral from a physician';",
    "0c7166b81fe901725b7eb628": "WITH expected_admissions AS (\n  SELECT \n    p.subject_id,\n    a.hadm_id,\n    a.admittime\n  FROM \n    patients p\n  JOIN \n    admissions a ON p.subject_id = a.subject_id\n  WHERE \n    a.admittime >= DATE('now', '+1 month')\n    AND a.admittime < DATE('now', '+2 month')\n)\nSELECT \n  SUM(c.cost) AS total_cost\nFROM \n  expected_admissions ea\nJOIN \n  cost c ON ea.hadm_id = c.hadm_id\nGROUP BY \n  ea.subject_id\nORDER BY \n  ea.admittime DESC\nLIMIT 1;",
    "8597515e0287991c861f671c": "SELECT \n    'Visitor Management Report' AS report_title,\n    p.subject_id AS patient_id,\n    p.gender || ' ' || SUBSTR(p.dob, 1, 4) AS patient_name,\n    a.hadm_id AS admission_id,\n    a.admittime AS admission_time,\n    a.dischtime AS discharge_time,\n    a.admission_type AS admission_type,\n    a.admission_location AS admission_location,\n    a.discharge_location AS discharge_location,\n    a.insurance AS insurance,\n    a.language AS language,\n    a.marital_status AS marital_status,\n    a.age AS age\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id;",
    "6d76715f3b8643d188af9795": "SELECT p.gender\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug = 'lidocaine-prilocaine'",
    "c31cb18da6bbbe1066aeb6be": "SELECT \n        a.subject_id,\n        CAST(strftime('%J', a.intime) - strftime('%J', b.intime) AS REAL)",
    "dfd68a634cff11f0c7c9dbce": "SELECT 'I am feeling happy' AS response;",
    "056fb750773e90aa030e9950": "SELECT gender\nFROM patients\nWHERE gender = 'Asian'\nGROUP BY gender\nORDER BY COUNT(*) DESC\nLIMIT 1;",
    "a596ed8ea35947b5f68e0e42": "SELECT AVG(T1.row_id) AS average_area_size\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.language = 'English';",
    "536ee0098a55182b75db4447": "WITH CancerPatients AS (\n    SELECT DISTINCT subject_id\n    FROM diagnoses_icd\n    INNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\n    WHERE d_icd_diagnoses.long_title LIKE '%Cancer%'\n),\nProcedureDurations AS (\n    SELECT subject_id, icd_code,\n           (julianday(charttime) - julianday(charttime)) AS procedure_duration\n    FROM procedures_icd\n    INNER JOIN CancerPatients ON procedures_icd.subject_id = CancerPatients.subject_id\n)\nSELECT MAX(procedure_duration) AS longest_procedure_duration\nFROM ProcedureDurations;",
    "b50c0b91629c3e1eb8c1e1bf": "SELECT \n  itemid, \n  charttime, \n  value, \n  valueuom\nFROM \n  outputevents\nWHERE \n  subject_id = 11823\n  AND test_name = 'MRI Exam';",
    "6cf1b55a68678674858c540c": "SELECT \n    p.gender AS ethnicity,\n    a.language,\n    a.marital_status,\n    COUNT(a.subject_id) AS total_admissions\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nGROUP BY p.gender, a.language, a.marital_status\nORDER BY p.gender, a.language, a.marital_status;",
    "3c480ed464a8bb7f48ac6ad3": "",
    "a56ff0957a284d651e7e8abc": "",
    "fde3bbc35e10c13131806d0b": "SELECT *\nFROM",
    "706174ad5a8f8d55b224dbdf": "SELECT COUNT(*) AS transfer_count\nFROM transfers\nWHERE eventtype LIKE '%complications%';",
    "de4cad0d0244ec1d5096631b": "SELECT DISTINCT T2.drug\nFROM diagnoses_icd AS T1\nJOIN admissions AS T3 ON T1.hadm_id = T3.hadm_id\nJOIN prescriptions AS T2 ON T3.hadm_id = T2.hadm_id\nWHERE T1.icd_code = 'E11' -- Assuming E11 is the ICD code",
    "35fbd2bb7e73dec7b0390bfd": "",
    "c8423168c30a91e86bd3a8fa": "SELECT abbreviation\nFROM d_items\nWHERE label = 'Insulin';",
    "7d1731d972d68642a1d92376": "WITH GenderCounts AS (\n    SELECT \n        strftime('%Y', dob) AS year_of_birth,\n        gender,\n        COUNT(*) AS num_patients\n    FROM patients\n    GROUP BY year_of_birth, gender\n),\nPredictedFutureCounts AS (\n    SELECT \n        gc.gender,\n        SUM(gc.num_patients) AS predicted_num_patients\n    FROM GenderCounts gc\n    WHERE gc.year_of_birth BETWEEN strftime('%Y', 'now') AND strftime('%Y', 'now', '+5 years')\n    GROUP BY gc.gender\n)\nSELECT \n    gender,\n    predicted_num_patients\nFROM PredictedFutureCounts\nORDER BY gender;",
    "7e49fe05e122e02f7b4dbc43": "SELECT \n  subject_id, \n  test_name, \n  charttime\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 64983 \n  AND charttime >= datetime('now', 'start of day') \n  AND charttime < datetime('now', '+1 day');",
    "6f03fb45abf03355fdf2ebe5": "SELECT AVG(CASE WHEN ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY dob) = 1 THEN age END) AS average_age_of_first_child\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title = 'Hypertension';",
    "b10d95d377e7fd96548c50cd": "SELECT distance\nFROM patients AS p\nJOIN admissions AS a ON p.subject_id = a.subject_id\nWHERE a.insurance = 'Medicaid';",
    "04ed4b01566a9c408fc5f3cc": "SELECT dob\nFROM patients\nWHERE major = 'Computer Science';",
    "e6233b691d261b0b5d750d60": "SELECT label, valuenum, valueuom\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE chartevents.subject_id = 20066 AND d_items.label = 'petct examination';",
    "542be8111ffc89db7639ec01": "SELECT \n    p.drug, \n    p.dose_val_rx\nFROM \n    prescriptions p\nINNER JOIN \n    admissions a ON p.hadm_id = a.hadm_id\nINNER JOIN \n    patients pt ON a.subject_id = pt.subject_id\nWHERE \n    pt.age > 80\nGROUP BY \n    p.drug, p.dose_val_rx\nORDER BY \n    COUNT(*) DESC\nLIMIT 5;",
    "5feeffebbdb00685b21e88a4": "SELECT *\nFROM patients\nWHERE dob < DATE('now', '-100 years')",
    "c98c060929248bcba6628b8e": "SELECT CASE \n           WHEN COUNT(DISTINCT icu.stay_id) > 1 THEN 'Yes'\n           ELSE 'No'\n       END AS PlansForOtherDepartments\nFROM icustays icu\nJOIN patients p ON icu.subject_id = p.subject_id\nWHERE p.subject_id = 72909;",
    "b7b46d74fb37a9539786e740": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_pending_tests\nFROM cost c\nJOIN patients p ON c.subject_id = p.subject_id\nWHERE p.subject_id = 17667 \n  AND c.event_type IN ('procedure', 'test') \n  AND c.event_id IS NOT",
    "1eac08ba1f265c3c327b62c1": "SELECT AVG(strftime('%J', T1.dod) - strftime('%J', T1.dob)) AS average_distance\nFROM patients T1\nWHERE strftime('%Y', T1.dob) BETWEEN '2070' AND '2100';",
    "e4af8f1ba3897fc0635abfa6": "selecting the appropriate column from the `patients` table. However, as it stands, the question is unanswerable with the current schema.",
    "14dfee8ea5e8f46e6c25dd3b": "",
    "429abe1449551a068765e97e": "SELECT DISTINCT label\nFROM d_labitems;",
    "ba6ba59aff69aa182b6e11ff": "select the average of the `totalamount` column from the `inputevents` table.\n   - We need to filter the rows where the `last_careunit` column in the `icustays` table is equal to 'csru'.\n   - We need to join the `icustays` table with the `inputevents` table on the `hadm_id` column.\n\n4. **Write the SQL Query:**\n   - Use the `JOIN` clause to connect the `icustays` and `inputevents` tables.\n   -",
    "601cdbff25250c54ae7b604d": "SELECT DISTINCT T2.label\nFROM chartevents T1\nJOIN d_items T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 22449\nAND T1",
    "da0649deb95e705d44b3a6bd": "SELECT 'How to make bake potato in oven' AS instruction;",
    "9c12b1908eecc96921e5b09d": "SELECT COUNT(*) \nFROM admissions \nWHERE language = 'English';",
    "dcd918b9b383d4c8b82d525a": "",
    "39de5025dda78c678bc23c91": "",
    "d2195d39e2bb7f411ae6ced6": "SELECT DISTINCT drug \nFROM prescriptions;",
    "542d6858a652ca64dd64426b": "SELECT AVG(latitude) AS average_latitude\nFROM patients\nJOIN (\n    SELECT subject_id, AVG(latitude) AS latitude\n    FROM chartevents\n    WHERE itemid = (\n        SELECT itemid\n        FROM d_items\n        WHERE label = 'Latitude'\n    )\n    GROUP BY subject_id\n) AS patient_latitude ON patients.subject_id = patient_latitude.subject_id\nWHERE patients.gender = 'M';",
    "47b01aea87ca3478567aeb58": "SELECT gender\nFROM patients\nINNER JOIN admissions ON patients.subject_id = admissions.subject_id\nWHERE admissions.insurance = 'Hispanic or Latino' AND admissions.language = 'English' AND patients.gender = 'M'\nGROUP BY gender\nORDER BY COUNT(*) ASC\nLIMIT 1;",
    "068adca6e566c9ea7450afd5": "SELECT T3.phone_number\nFROM patients AS T1\nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN patients AS T3 ON T3.subject_id = T2.subject_id\nWHERE T1.subject_id = 22449 AND T3.gender = 'F';",
    "0577cc7be3dde491281e4ffb": "SELECT \n    CASE \n        WHEN insurance = 'Medicaid' THEN '\u0395\u03b9\u03c2\u03c6\u03bf\u03c1\u03ac \u03a3\u03c5\u03bd\u03b4\u03c1\u03bf\u03bc\u03ae\u03c2'\n        WHEN insurance = 'Private' THEN '\u0395\u03b3\u03b3\u03c1\u03b1\u03c6\u03ae \u03a0\u03c1\u03bf\u03c3\u03c9\u03c0\u03b9\u03ba\u03ae\u03c2'\n        WHEN insurance = 'Uninsured' THEN '\u03a7\u03c9\u03c1\u03af\u03c2 \u03a3\u03cd\u03bd\u03b4\u03c1\u03bf\u03bc\u03bf'\n        ELSE ''\n    END AS translated_insurance\nFROM admissions\nWHERE subject_id = 370;",
    "682cc16deee208a0bbd263a1": "SELECT COUNT(*) AS total_count\nFROM prescriptions p\nINNER JOIN d_items d ON p.drug = d.label\nWHERE p.drug = 'multivitamin iv' AND d.gender = 'F';"
}