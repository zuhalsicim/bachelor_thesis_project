{
    "b9bf51c5e3af21242ac2e487": "SELECT label \nFROM d_items \nWHERE label = 'Potassium Chl 40 meq/1000 mL (D5W)';",
    "71085ce4beef02dd87ed0ae5": "SELECT DISTINCT route, dose_unit_rx\nFROM prescriptions\nWHERE drug = 'AMOXICILLIN';",
    "14282f53339c46daadec3a20": "SELECT DISTINCT` to ensure we only get unique routes.",
    "776a4927e962a0f0d91d35e7": "SELECT DISTINCT T1.route \nFROM prescriptions T1\nWHERE T1.drug = 'Citrate Dextrose 3% (ACD-A) CRRt';",
    "e80f4420e687a67930a3fe82": "SELECT DISTINCT route \nFROM prescriptions \nWHERE drug = 'Tamoxifen Citrate';",
    "76e23fd708f338036f1db3a5": "SELECT DISTINCT route \nFROM prescriptions \nWHERE drug = 'Tramadol';",
    "1a02966a7807415ea5d44f3e": "SELECT DISTINCT route\nFROM prescriptions\nWHERE drug = 'Midodrine';",
    "6360cf590c61b892d228aec3": "SELECT c.cost\nFROM cost c\nINNER JOIN procedures_icd p ON c.event_id = p.row_id\nINNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Other incision of brain';",
    "fbcce2387805995ccfb14da7": "SELECT \n    SUM(c.cost) AS total_cost\nFROM \n    cost c\nJOIN \n    diagnoses_icd d ON c.event_id = d.row_id\nJOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n    d2.long_title LIKE '%left heart cardiac catheterization%';",
    "5d3fdd6cfa3395ed7d31a509": "SELECT SUM(cost) AS total_cost\nFROM cost\nJOIN procedures_icd ON cost.event_id = procedures_icd.row_id\nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE d_icd_procedures.long_title = 'Alcohol detoxification';",
    "ea5ae93b3e09584a70590863": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nINNER JOIN procedures_icd p ON c.event_id = p.row_id\nINNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Drainage of pericardial cavity with drainage device, percutaneous approach';",
    "3dad9658c00a426a28cd032a": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title LIKE '%Catheter-based invasive electrophysiological testing%'",
    "23f5cb31ebe9cc2a949960b0": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN procedures_icd p ON c.event_id = p.row_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Angiography of Femoral and Other Lower Extremity Arteries';",
    "7c477af3b36987109db0d925": "SELECT AVG(T1.cost) AS typical_repair_cost\nFROM cost T1\nJOIN procedures_icd T2 ON T1.event_id = T2.row_id\nJOIN d_icd_procedures T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title LIKE '%repair of rectocele with graft or prosthesis%';",
    "6fd97088e685ba9d993b674a": "SELECT \n  CAST(COUNT(T1.row_id) AS REAL) / COUNT(DISTINCT T2.hadm_id) AS selling_rate\nFROM \n  prescriptions T1\n  INNER JOIN admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.drug = 'acetaminophen-caff-butalbital';",
    "e24decfb710d3c3dc6eab1d8": "SELECT T2.dose_val_rx AS price\nFROM d_items AS T1\nINNER JOIN prescriptions AS T2 ON T1.itemid = T2.row_id\nWHERE T1.label = 'multivitamin' AND T2.route = 'IV';",
    "3cf3b888f16e871e3f5f181c": "SELECT DISTINCT drug\nFROM prescriptions\nWHERE drug = 'vial';",
    "a69dfee809d4c6a558d663e8": "SELECT cost.cost\nFROM cost\nINNER JOIN prescriptions ON cost.event_id = prescriptions.row_id\nWHERE prescriptions.drug = 'Ferrous sulfate (liquid)';",
    "3a42a1f5b0ab7a9b081c5484": "SELECT drug, dose_val_rx, dose_unit_rx, route\nFROM prescriptions\nWHERE drug = 'lactulose';",
    "451285f64c11d4d19cbf2a11": "SELECT dose_val_rx AS price\nFROM prescriptions\nWHERE drug = 'vitamin e';",
    "ab2b79aa3faaaa7c9d7f7f40": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN prescriptions p ON c.hadm_id = p.hadm_id\nWHERE p.drug = 'buspirone';",
    "a635207e9ad6b0adfff52120": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nINNER JOIN diagnoses_icd d ON c.event_id = d.row_id\nINNER JOIN d_icd_diagnoses i ON d.icd_code = i.icd_code\nWHERE i.long_title = 'Secondary malignant neoplasm of bone and bone marrow';",
    "37d5cb2d101d086c45aae957": "SELECT cost\nFROM cost\nWHERE event_type = 'Diagnosis'\nAND event_id IN (\n  SELECT row_id\n  FROM diagnoses_icd\n  WHERE icd_code IN (\n    SELECT icd_code\n    FROM d_icd_diagnoses\n    WHERE long_title = 'Personal history of transient ischemic attack (tia)'\n    OR long_title = 'Cerebral infarction without residual deficits'\n  )\n);",
    "a8225cc86d80b3c2bcb42899": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd di ON c.event_id = di.row_id\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title LIKE '%splenomegaly%';",
    "6e81a82c2e87daa57c7ae655": "SELECT cost.cost\nFROM cost\nINNER JOIN diagnoses_icd ON cost.event_id = diagnoses_icd.row_id\nINNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title = ' Dependence on respirator [ventilator] status';",
    "1c82eecbdc0ba4bcb2d34047": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Other primary cardiomyopathies'\nAND c.event_type = 'Diagnosis';",
    "fc0f5148afa412b85497beb3": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN diagnoses_icd di ON c.event_id = di.row_id\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title = 'Septicemia due to Escherichia coli [E. coli]';",
    "6594b2ea56fc3dde1c9203af": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nINNER JOIN diagnoses_icd di ON c.event_id = di.row_id\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title = 'Candidiasis of mouth';",
    "cc2d0e8abf70d2897312faf2": "SELECT gender \nFROM patients \nWHERE subject_id = 10014078;",
    "caf2ed4e7d85cf6d0cba15f8": "",
    "7a8719784f36b469832da18e": "SELECT gender\nFROM patients\nWHERE subject_id = 10014078;",
    "0e38c978a69e475449c84fee": "selects the `gender` column from the `patients` table where the `subject_id` matches the specified value, which is exactly what the question asks for. Therefore, the SQL query remains as is, without any modifications.",
    "cc30aba23d4b59298a12f192": "SELECT gender FROM patients WHERE subject_id = 10038933;",
    "261994390f6de9839143e6eb": "",
    "2d6aa3feeed3bfeb72da5fb2": "SELECT gender\nFROM patients\nWHERE subject_id = 10005348;",
    "cd552ac1f210bf943008ccac": "SELECT dob \nFROM patients \nWHERE subject_id = 10031404;",
    "7e1617588226f306caaf252b": "SELECT dob \nFROM patients \nWHERE subject_id = 10007928;",
    "11f75d0b44ffab8233b7f684": "SELECT dob\nFROM patients\nWHERE subject_id = 10022281;",
    "16247191e328f040590ae2fc": "SELECT dob FROM patients WHERE subject_id = 10019568;",
    "d395d70704b10b00a4f7f1af": "SELECT dob \nFROM patients \nWHERE subject_id = 10019172;",
    "eddba4d41895f6e1c03c2a52": "SELECT dob\nFROM patients\nWHERE subject_id = 10022017;",
    "9b7032c149a5ae595cfcdf73": "SELECT dob\nFROM patients\nWHERE subject_id = 10004457;",
    "28df618041d9cc5a95d8c30d": "",
    "ac3aa786885a117e774dc77c": "SELECT \n    MIN(ce1.charttime) AS first_measurement_time,\n    MAX(ce1.charttime) AS last_measurement_time,\n    ce1.valuenum AS first_value,\n    ce2.valuenum AS last_value\nFROM chartevents ce1\nJOIN chartevents ce2 ON ce1.hadm_id = ce2.hadm_id\nWHERE ce1.subject_id = 10027602\nAND ce1.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\nAND ce2.itemid = ce1.itemid\nAND ce1.charttime = (SELECT MIN(charttime) \n                     FROM chartevents \n                     WHERE subject_id = 10027602 \n                     AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight'))\nAND ce2.charttime = (SELECT MAX(charttime) \n                     FROM chartevents \n                     WHERE subject_id = 10027602 \n                     AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight'));",
    "97a564727fd229d0a1d9c3ba": "WITH LastAdmissionCTE AS (\n    SELECT MAX(hadm_id) AS last_hadm_id\n    FROM admissions\n    WHERE subject_id = 10027602\n),\nWeightMeasurementsCTE AS (\n    SELECT\n        i.itemid,\n        i.totalamount,\n        ROW_NUMBER() OVER (ORDER BY i.starttime) AS rank\n    FROM inputevents i\n    INNER JOIN d_items di ON i.itemid = di.itemid\n    INNER JOIN LastAdmissionCTE la ON i.hadm_id = la.last_hadm_id\n    WHERE di.label = 'Weight'\n      AND i.subject_id = 10027602\n)\nSELECT\n    MAX(CASE WHEN rank = 2 THEN totalamount END) - MAX(CASE WHEN rank = 1 THEN totalamount END) AS weight_difference\nFROM WeightMeasurementsCTE\nWHERE rank <= 2;",
    "10e5776d6866e2b43f77a084": "SELECT \n  (SELECT valuenum \n   FROM chartevents \n   WHERE subject_id = 10018081 \n     AND itemid = 123 \n     AND charttime = '2100-12-31 00:00:00') - \n  (SELECT valuenum \n   FROM chartevents \n   WHERE subject_id = 10018081 \n     AND itemid = 123 \n     AND charttime = '2100-12-30 00:00:00') AS weight_shift",
    "350e7b3e88e232febb94440c": "SELECT \n  MAX(CASE WHEN weight_events.row_num = 1 THEN weight_events.valuenum END) - \n  MAX(CASE WHEN weight_events.row_num = 2 THEN weight_events.valuenum END) AS weight_difference\nFROM (\n  SELECT \n    charttime, \n    valuenum, \n    ROW_NUMBER() OVER (ORDER BY charttime DESC) AS row_num\n  FROM \n    chartevents\n  JOIN \n    d_items ON chartevents.itemid = d_items.itemid\n  WHERE \n    subject_id = 10004422 AND d_items.label = 'Weight'\n) AS weight_events",
    "dc7482ecedbaea3e549bc140": "SELECT \n    MAX(ce.charttime) AS last_charttime,\n    MIN(ce.charttime) AS first_charttime,\n    MAX(ce.valuenum) - MIN(ce.valuenum) AS weight_difference\nFROM \n    chartevents ce\nWHERE \n    ce.subject_id = 10027445\n    AND ce.itemid = 226735;",
    "9fee7ced768b7c2b796af2ce": "SELECT \n    T2.charttime, \n    T2.valuenum AS weight_at_second_visit \nFROM \n    chartevents AS T2 \nWHERE \n    T2.subject_id = 10007795 \n    AND T2.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight') \n    AND T2.charttime > (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10007795 AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight'))\n    AND T2.charttime = (\n        SELECT MIN(charttime) \n        FROM chartevents \n        WHERE subject_id = 10007795 \n          AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight') \n          AND charttime > (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10007795 AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight'))\n    )",
    "922e1796a0883763c0252e8b": "SELECT \n  (le2.valuenum - le1.valuenum) AS diff\nFROM labevents le1\nJOIN labevents le2 ON le1.subject_id = le2.subject_id AND le1.hadm_id = le2.hadm_id\nJOIN d_labitems li ON le1.itemid = li.itemid\nWHERE li.label = 'Alkaline Phosphatase' \n  AND le1.subject_id = 10002495 \n  AND le1.row_id < le2.row_id\n  AND le1.charttime < le2.charttime\n  AND le1.row_id = (\n    SELECT MIN(row_id)\n    FROM labevents\n    WHERE subject_id = 10002495 AND itemid = li.itemid AND hadm_id = le1.hadm_id\n  )\n  AND le2.row_id = (\n    SELECT MIN(row_id)\n    FROM labevents\n    WHERE subject_id = 10002495 AND itemid = li.itemid AND hadm_id = le1.hadm_id AND row_id > le1.row_id\n  );",
    "efb37b1f8299f18af10b51ec": "WITH LastVisitMeasurements AS (\n    SELECT\n        le.charttime,\n        le.valuenum,\n        ROW_NUMBER() OVER (ORDER BY le.charttime) AS row_num\n    FROM\n        labevents le\n    INNER JOIN\n        d_labitems li ON le.itemid = li.itemid\n    WHERE\n        le.subject_id = 10019568\n        AND li.label = 'Creatinine'\n        AND le.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10019568 ORDER BY admittime DESC LIMIT 1)\n)\nSELECT\n    (MAX(CASE WHEN row_num = 2 THEN valuenum END) - MAX(CASE WHEN row_num = 1 THEN valuenum END)) AS creatinine_diff\nFROM\n    LastVisitMeasurements\nWHERE\n    row_num <= 2;",
    "57c595ed27d732fb9989f76d": "SELECT \n  (MAX(ce.valuenum) - MIN(ce.valuenum)) AS difference\nFROM \n  labevents ce\nJOIN \n  d_labitems dl ON ce.itemid = dl.itemid\nWHERE \n  ce.subject_id = 10038999\n  AND dl.label = 'Monos';",
    "f0713b333180377cd4e7a5ef": "WITH FirstVisit AS (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10015272\n    ORDER BY admittime\n    LIMIT 1\n),\nAlkalinePhosphataseValues AS (\n    SELECT \n        le.charttime,\n        le.valuenum\n    FROM labevents le\n    JOIN FirstVisit fv ON le.hadm_id = fv.hadm_id\n    JOIN d_labitems li ON le.itemid = li.itemid\n    WHERE li.label = 'ALK PHOSPHATASE'\n)\nSELECT \n    MAX(valuenum) - MIN(valuenum) AS difference\nFROM AlkalinePhosphataseValues;",
    "01b66115a27e8ec4031d99ba": "WITH LastAdmission AS (\n    SELECT \n        MAX(hadm_id) AS hadm_id\n    FROM \n        admissions\n    WHERE \n        subject_id = 10025612\n),\nCKValues AS (\n    SELECT \n        charttime,\n        valuenum\n    FROM \n        labevents\n    WHERE \n        itemid = (SELECT itemid FROM d_labitems WHERE label = 'CK')\n        AND hadm_id = (SELECT hadm_id FROM LastAdmission)\n    ORDER BY \n        charttime\n)\nSELECT \n    MAX(CASE WHEN rn = 2 THEN valuenum END) - MAX(CASE WHEN rn = 1 THEN valuenum END) AS value_difference\nFROM (\n    SELECT \n        charttime,\n        valuenum,\n        ROW_NUMBER() OVER (ORDER BY charttime) AS rn\n    FROM \n        CKValues\n) AS rankedCKValues;",
    "beba7369b04f1b191db5f12e": "",
    "7e5e17dca306a105f47f9bb7": "WITH last_hospital_visit AS (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10002495 \n    ORDER BY admittime DESC \n    LIMIT 1\n),\ntroponin_t_values AS (\n    SELECT charttime, valuenum\n    FROM labevents \n    WHERE hadm_id = (SELECT hadm_id FROM last_hospital_visit)\n      AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Troponin T')\n    ORDER BY charttime DESC\n)\nSELECT \n    (SELECT valuenum FROM troponin_t_values LIMIT 1) - \n    (SELECT valuenum FROM troponin_t_values LIMIT 1 OFFSET 1) AS difference;",
    "eed5de84751262898d675c22": "SELECT \n  (SELECT T1.valuenum \n   FROM chartevents AS T1\n   INNER JOIN icustays AS T2 ON T1.stay_id = T2.stay_id\n   WHERE T1.subject_id = 10037975 AND T2.subject_id = 10037975\n   AND T1.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\n   ORDER BY T1.charttime DESC\n   LIMIT 1) - \n  (SELECT T1.valuenum \n   FROM chartevents AS T1\n   INNER JOIN icustays AS T2 ON T1.stay_id = T2.stay_id\n   WHERE T1.subject_id = 10037975 AND T2.subject_id = 10037975\n   AND T1.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\n   ORDER BY T1.charttime DESC\n   LIMIT 1 OFFSET 1) AS SpO2_change;",
    "6b3760b9b37e0bb8f9e647f8": "",
    "a2438ede03e572f4af4fcd58": "SELECT\n    (MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10010471 AND hadm_id IN (SELECT hadm_id FROM icustays WHERE stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10010471))) THEN ce.valuenum END) -\n     MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10010471 AND hadm_id IN (SELECT hadm_id FROM icustays WHERE stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10010471))) THEN ce.valuenum END)) AS heart_rate_change\nFROM\n    chartevents ce\nJOIN\n    d_items di ON ce.itemid = di.itemid\nWHERE\n    di.label = 'Heart Rate'\n    AND ce.subject_id = 10010471\n    AND ce.hadm_id IN (SELECT hadm_id FROM icustays WHERE subject_id = 10010471)\n    AND ce.itemid IN (SELECT itemid FROM d_items WHERE label = 'Heart Rate');",
    "941095e5c2a9df6746e4a383": "SELECT \n    MAX(ce1.charttime) AS first_icu_visit,\n    ce1.valuenum AS last_measured_first_icu_visit,\n    MAX(ce2.charttime) AS second_last_measured_first_icu_visit,\n    ce2.valuenum AS second_last_measured_value\nFROM \n    chartevents ce1\nINNER JOIN chartevents ce2 ON ce1.stay_id = ce2.stay_id\nWHERE \n    ce1.subject_id = 10001725 AND \n    ce2.subject_id = 10001725 AND \n    ce1.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2') AND \n    ce2.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2') AND \n    ce1.charttime < ce2.charttime\nGROUP BY \n    ce1.stay_id\nORDER BY \n    ce1.charttime DESC\nLIMIT 2;",
    "b5ddccb2652019203e02c96e": "WITH LastICUVisit AS (\n    SELECT MAX(stay_id) AS last_stay_id\n    FROM icustays\n    WHERE subject_id = 10003046\n),\nLastICUChartTime AS (\n    SELECT MAX(charttime) AS last_charttime\n    FROM chartevents\n    WHERE subject_id = 10003046\n      AND stay_id = (SELECT last_stay_id FROM LastICUVisit)\n),\nFirstSystolicBP AS (\n    SELECT valuenum AS first_value\n    FROM chartevents\n    WHERE subject_id = 10003046\n      AND stay_id = (SELECT last_stay_id FROM LastICUVisit)\n      AND charttime = (\n        SELECT MIN(charttime)\n        FROM chartevents\n        WHERE subject_id = 10003046\n          AND stay_id = (SELECT last_stay_id FROM LastICUVisit)\n      )\n      AND itemid = (\n        SELECT itemid\n        FROM d_items\n        WHERE label = 'Systolic BP'\n      )\n),\nLastSystolicBP AS (\n    SELECT valuenum AS last_value\n    FROM chartevents\n    WHERE subject_id = 10003046\n      AND stay_id = (SELECT last_stay_id FROM LastICUVisit)\n      AND charttime = (SELECT last_charttime FROM LastICUChartTime)\n      AND itemid = (\n        SELECT itemid\n        FROM d_items\n        WHERE label = 'Systolic BP'\n      )\n)\nSELECT \n    (SELECT last_value FROM LastSystolicBP) - (SELECT first_value FROM FirstSystolicBP) AS systolic_bp_change",
    "9ea8c0016a33c461c3a77f56": "WITH SystolicBPMeasurements AS (\n    SELECT \n        c.charttime,\n        c.valuenum,\n        i.row_id AS itemid\n    FROM chartevents c\n    JOIN d_items i ON c.itemid = i.itemid\n    JOIN icustays icu ON c.hadm_id = icu.hadm_id AND c.stay_id = icu.stay_id\n    WHERE c.subject_id = 10037975\n    AND i.label = 'Systolic BP'\n),\nFirstSecondMeasurements AS (\n    SELECT \n       valuenum AS first_value,\n        LEAD(valuenum) OVER (ORDER BY charttime) AS second_value\n    FROM SystolicBPMeasurements\n    LIMIT 1\n)\nSELECT \n    first_value - second_value AS difference\nFROM FirstSecondMeasurements;",
    "5ae9eba9c11262b3bc8961b7": "WITH LastICUStay AS (\n    SELECT\n        stay_id,\n        MAX(charttime) AS last_charttime\n    FROM icuStays\n    WHERE subject_id = 10020187\n    GROUP BY stay_id\n),\nFilteredLabEvents AS (\n    SELECT\n        le.row_id,\n        le.subject_id,\n        le.hadm_id,\n        le.itemid,\n        le.charttime,\n        le.valuenum,\n        d_items.label\n    FROM labevents le\n    INNER JOIN d_labitems d_items ON le.itemid = d_items.itemid\n    INNER JOIN LastICUStay lus ON le.hadm_id = lus.stay_id AND le.charttime = lus.last_charttime\n    WHERE le.subject_id = 10020187 AND d_items.label LIKE '%systolic blood pressure%'\n),\nRankedMeasurements AS (\n    SELECT\n        row_id,\n        valuenum,\n        ROW_NUMBER() OVER (ORDER BY charttime DESC) AS rn\n    FROM FilteredLabEvents\n)\nSELECT\n    MAX(CASE WHEN rn = 1 THEN valuenum END) - MAX(CASE WHEN rn = 2 THEN valuenum END) AS bp_change\nFROM RankedMeasurements\nWHERE rn IN (1, 2);",
    "617d9b7140ffa467be53e5b8": "SELECT \n    MAX(labevents.charttime) AS last_charttime,\n    MIN(labevents.charttime) AS first_charttime,\n    MAX(labevents.valuenum) AS last_value,\n    MIN(labevents.valuenum) AS first_value\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10039831 AND\n    d_labitems.label = 'CO2 Reading'\nGROUP BY \n    labevents.hadm_id\nHAVING \n    MAX(labevents.charttime) > MIN(labevents.charttime)\n    AND MAX(labevents.valuenum) < MIN(labevents.valuenum);",
    "769ea1c5d6c42c47ac9a1735": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10036156) THEN ce.valuenum END) \n             > MIN(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10036156) THEN ce.valuenum END) \n        THEN 'true' \n        ELSE 'false' \n    END AS has_platelets_changed\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10036156 AND \n    di.label = 'PLT COUNT';",
    "ffc47b7e01463f229eb09bce": "WITH FirstCalciumMeasurement AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        MIN(charttime) AS first_charttime,\n        valuenum AS first_valuenum\n    FROM \n        labevents\n    WHERE \n        subject_id = 10021487 \n        AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Calcium, urine')\n    GROUP BY \n        subject_id, hadm_id\n),\nLastCalciumMeasurement AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        MAX(charttime) AS last_charttime,\n        valuenum AS last_valuenum\n    FROM \n        labevents\n    WHERE \n        subject_id = 10021487 \n        AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Calcium, urine')\n    GROUP BY \n        subject_id, hadm_id\n)\nSELECT \n    CASE \n        WHEN lcm.last_valuenum > fcm.first_valuenum THEN 'Yes'\n        ELSE 'No'\n    END AS result\nFROM \n    FirstCalciumMeasurement fcm\nJOIN \n    LastCalciumMeasurement lcm \nON \n    fcm.subject_id = lcm.subject_id \n    AND fcm.hadm_id = lcm.hadm_id;",
    "ac19aaffd02ad22588a7a6e7": "",
    "fd2b88c449aa3147d9ef22a9": "select the first and second measurements of the protein value and compare them.",
    "06ed0a3cc8ab3dc7839b7919": "SELECT \n    MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10018501) THEN ce.valuenum END) AS first_rdw,\n    MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10018501) THEN ce.valuenum END) AS last_rdw\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10018501\n    AND di.label = 'RDW';",
    "96a829af0978aeef2a29366b": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN t1.charttime = (SELECT MAX(charttime) FROM labevents WHERE subject_id = 10016810 AND itemid = t1.itemid) \n                  THEN t1.valuenum END) \n    < MAX(CASE WHEN t1.charttime = (SELECT MIN(charttime) FROM labevents WHERE subject_id = 10016810 AND itemid = t1.itemid) \n               THEN t1.valuenum END) THEN 'Yes' \n    ELSE 'No' \n  END AS comparison_result\nFROM labevents t1\nJOIN d_labitems t2 ON t1.itemid = t2.itemid\nWHERE t1.subject_id = 10016810 AND t2.label = 'Calcium, Total';",
    "b45fe4ea7ffaf00e84199e79": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10016742 AND itemid = 36225993) THEN ce.valuenum END) \n             < MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10016742 AND itemid = 36225993) THEN ce.valuenum END) \n        THEN 'Yes' \n        ELSE 'No' \n    END AS IsRespiratoryRateLess\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10016742 AND di.abbreviation = 'RR' AND ce.stay_id IN (SELECT stay_id FROM icustays WHERE subject_id = 10016742);",
    "0845eda9197d9666e0b3a017": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10021118 AND itemid = di.itemid) THEN ce.valuenum END) >\n             MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10021118 AND itemid = di.itemid AND charttime < (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10021118 AND itemid = di.itemid)) THEN ce.valuenum END) \n        THEN 'Yes'\n        ELSE 'No'\n    END AS is_greater\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10021118 AND di.label LIKE '%Arterial Blood Pressure%' AND di.label LIKE '%Diastolic%';",
    "7a1c80e590227785f1b6c6a6": "",
    "a4067779dc66a630f0290603": "",
    "5defc394d5a39a4bee811cf5": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN c.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10011398 AND itemid = d1.itemid) THEN c.valuenum END) \n    > MAX(CASE WHEN c.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10011398 AND itemid = d1.itemid) THEN c.valuenum END) THEN 'Yes'\n    ELSE 'No'\n  END AS is_systolic_increase\nFROM \n  chartevents c\nJOIN \n  d_items d1 ON c.itemid = d1.itemid\nWHERE \n  c.subject_id = 10011398 AND d1.label = 'Arterial Blood Pressure Systolic';",
    "18712984cf426bc265ef3c86": "SELECT \n    CASE \n        WHEN MAX(CASE WHEN charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10010471 AND itemid = d_items.itemid AND d_items.label = 'O2 saturation pulseoxymetry') THEN valuenum END) >\n            MAX(CASE WHEN charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10010471 AND itemid = d_items.itemid AND d_items.label = 'O2 saturation pulseoxymetry') THEN valuenum END) OVER () \n        THEN 'Yes' \n        ELSE 'No' \n    END AS is_last_higher \nFROM chartevents \nJOIN d_items ON chartevents.itemid = d_items.itemid \nWHERE subject_id = 10010471 AND d_items.label = 'O2 saturation pulseoxymetry';",
    "49096da9fc4db23df0c9ca94": "",
    "0aaf715cd38172a3fec8d22f": "SELECT age\nFROM admissions\nWHERE subject_id = 10022281\nORDER BY admittime DESC\nLIMIT 1;",
    "a5dc36ab0d9765ac8ab2b0be": "SELECT age\nFROM admissions\nWHERE subject_id = 10038992\nORDER BY admittime DESC\nLIMIT 1;",
    "6a0426303656887491909d29": "SELECT age \nFROM admissions \nWHERE subject_id = 10022041 \nORDER BY admittime \nLIMIT 1;",
    "8f9bd64fc45fb2e7efce6e09": "SELECT age \nFROM admissions \nWHERE subject_id = 10031757 \nORDER BY admittime DESC \nLIMIT 1;",
    "7181a0d2584214c798eeebfb": "SELECT age\nFROM admissions\nWHERE subject_id = 10000032\nORDER BY admittime ASC\nLIMIT 1;",
    "cf80e026f450ba3b1f34afca": "SELECT \n  age \nFROM \n  admissions \nWHERE \n  subject_id = 10035185 \nORDER BY \n  admittime DESC \nLIMIT 1;",
    "d0fede74514340f1c6713467": "",
    "f34840d2e5d80b70e76bfdec": "SELECT \n  insurance \nFROM \n  admissions \nWHERE \n  subject_id = 10004422 \nORDER BY \n  admittime DESC \nLIMIT 1;",
    "33eb641aa295e6631d41c5b9": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10004720\nORDER BY hadm_id DESC\nLIMIT 1;",
    "695375d6c1fa9fdcc62343bd": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10007818\nORDER BY admittime ASC\nLIMIT 1;",
    "cbb82c6ae494381e1e693100": "SELECT insurance \nFROM admissions \nWHERE subject_id = 10006053 \nORDER BY admittime DESC \nLIMIT 1;",
    "8166e7dd802e75a9bb516018": "",
    "f6b19667a6aead364aac15bf": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10023239 AND hadm_id = 1;",
    "6938ea8746e5138601dbdae7": "WITH PatientAgeCTE AS (\n  SELECT age\n  FROM admissions\n  WHERE subject_id = 10035185 AND hadm_id IN (\n    SELECT hadm_id FROM admissions WHERE subject_id = 10035185\n  )\n),\nFilteredLabEventsCTE AS (\n  SELECT l.charttime, l.valuenum, l.valueuom\n  FROM labevents l\n  JOIN d_labitems d ON l.itemid = d.itemid\n  JOIN admissions a ON l.hadm_id = a.hadm_id\n  WHERE d.label = 'BUN' AND a.age = (SELECT age FROM PatientAgeCTE)\n)\nSELECT \n  (SELECT COUNT(*) FROM FilteredLabEventsCTE WHERE valuenum < 38.0) * 100.0 / COUNT(*) AS percentile\nFROM FilteredLabEventsCTE;",
    "b88b37ae5acfee6df9247dfb": "WITH PatientAge AS (\n  SELECT age\n  FROM admissions\n  WHERE subject_id = 10038081\n),\nLabValues AS (\n  SELECT le.valuenum\n  FROM labevents le\n  JOIN admissions a ON le.hadm_id = a.hadm_id\n  JOIN d_labitems li ON le.itemid = li.itemid\n  WHERE li.label = 'Lab Red Blood Cells'\n    AND a.age = (SELECT age FROM PatientAge)\n)\nSELECT PERCENT_RANK() OVER (ORDER BY lv.valuenum) AS percentile\nFROM LabValues lv\nWHERE lv.valuenum = 2.71;",
    "f90fbe1a6c278c3d4b3d2829": "WITH PatientAge AS (\n    SELECT age\n    FROM admissions\n    WHERE subject_id = 10023117\n    ORDER BY admittime DESC\n    LIMIT 1\n),\nPatientLabEvents AS (\n    SELECT \n        e.subject_id,\n        e.charttime,\n        e.valuenum,\n        e.valueuom\n    FROM \n        labevents e\n    INNER JOIN \n        PatientAge pa ON e.subject_id IN (\n            SELECT subject_id\n            FROM admissions\n            WHERE age = pa.age\n        )\n    WHERE \n        e.itemid = (\n            SELECT itemid \n            FROM d_labitems \n            WHERE label = 'Magnesium'\n        )\n)\nSELECT \n    PERCENT_RANK() OVER (ORDER BYvaluenum) AS percentile\nFROM \n    PatientLabEvents\nWHERE \n    valuenum = 2.0\nLIMIT 1;",
    "01f54f272e5f4a9bc0a7232d": "-- Step 1: Identify the age of patient 10008287 in their last hospital encounter\nWITH PatientAgeCTE AS (\n  SELECT age\n  FROM admissions\n  WHERE subject_id = 10008287\n  ORDER BY admittime DESC\n  LIMIT 1\n),\n\n-- Step 2: Retrieve all labevent records for the ptt lab test for patients of the same age\nLabEventValuesCTE AS (\n  SELECT T1.valuenum\n  FROM labevents AS T1\n  INNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\n  INNER JOIN d_labitems AS T3 ON T1.itemid = T3.itemid\n  WHERE T3.label = 'ptt' AND T2.age = (SELECT age FROM PatientAgeCTE)\n),\n\n-- Step 3: Calculate the percentile of the value 23.5 among these records\nPercentileCTE AS (\n  SELECT (COUNT(*) * 100.0) / (SELECT COUNT(*) FROM LabEventValuesCTE) AS percentile\n  FROM LabEventValuesCTE\n  WHERE valuenum < 23.5\n)\n\n-- Final selection of the calculated percentile\nSELECT percentile\nFROM PercentileCTE;",
    "325f8e14568068a880720cc4": "",
    "1039ad255c53fd49a3e45f2f": "WITH LastAdmissionCTE AS (\n  SELECT \n    subject_id, \n    hadm_id\n  FROM \n    admissions\n  WHERE \n    subject_id = 10015931\n  ORDER BY \n    admittime DESC\n  LIMIT 1\n),\nGlucoseLabEventsCTE AS (\n  SELECT \n    le.subject_id, \n    le.charttime, \n    le.valuenum, \n    le.valueuom, \n    a.age\n  FROM \n    labevents le\n  JOIN \n    LastAdmissionCTE la ON le.hadm_id = la.hadm_id\n  JOIN \n    admissions a ON le.hadm_id = a.hadm_id\n  WHERE \n    le.itemid IN (SELECT itemid FROM d_labitems WHERE label LIKE '%Glucose%')\n),\nAgeGroupCTE AS (\n  SELECT \n    age\n  FROM \n    GlucoseLabEventsCTE\n)\nSELECT \n  PERCENT_RANK() OVER (ORDER BY age) * 100 AS percentile\nFROM (\n  SELECT \n    age\n  FROM \n    GlucoseLabEventsCTE\n  WHERE \n    valuenum = 186.0\n) subquery\nCROSS JOIN (\n  SELECT \n    age\n  FROM \n    GlucoseLabEventsCTE\n) age_group;",
    "7dc8ffd1359d41d1da9da63c": "WITH AgeGroup AS (\n    SELECT age\n    FROM admissions\n    WHERE subject_id = 10021487\n),\nResultPercentile AS (\n    SELECT \n        PERCENT_RANK() OVER (\n            ORDER BY l.valuenum\n        ) AS percentile\n    FROM labevents l\n    INNER JOIN d_labitems d ON l.itemid = d.itemid\n    INNER JOIN AgeGroup a ON l.subject_id = (SELECT subject_id FROM admissions WHERE hadm_id = l.hadm_id)\n    WHERE l.valuenum = 114.0 AND d.label = 'PLATELET COUNT'\n)\nSELECT percentile * 100 AS percentile\nFROM ResultPercentile;",
    "b1f43697c74666c4701854b3": "SELECT \n    (strftime('%s', i.intime) - strftime('%s', a.admittime)) / 3600.0 AS hours_since_admission\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    icustays i ON a.hadm_id = i.hadm_id\nWHERE \n    p.subject_id = 10018081;",
    "a4601ccbd52ea5048219a13a": "SELECT julianday('now') - julianday((SELECT intime FROM icustays WHERE subject_id = 10018081 LIMIT 1)) AS days_in_icu\nFROM icustays\nWHERE subject_id = 10018081\nLIMIT 1;",
    "90eb2c78447a14389410b63f": "",
    "3444c5918e4cc5369449a9b3": "",
    "ab9f098a63937bcf7a768bee": "SELECT \n  (strftime('%s', 'now') - strftime('%s', icu.intime)) / 3600.0 AS hours_since_icu_admission\nFROM \n  icustays icu\nINNER JOIN \n  admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE \n  icu.subject_id = 10018081;",
    "a08cb35b715a295797129d6f": "",
    "12c4448b67fe5aedbc6c32e2": "SELECT \n    (strftime('%s', 'now') - strftime('%s', i.intime)) / 86400 AS days_since_admission\nFROM icustays i\nWHERE i.subject_id = 10039831;",
    "2322a6ff73f6c9d85f8b5a42": "SELECT \n  (julianday(T2.outtime) - julianday(T2.intime)) * 24 AS hours_in_careunit\nFROM \n  icustays T2\nWHERE \n  T2.subject_id = 10021487 AND T2.first_careunit = 'med/surg/trauma';",
    "55734b9319f9dd143aa308ee": "SELECT \n  (julianday('now') - julianday(T1.intime)) * 24 AS hours_since_first_careunit\nFROM \n  icustays AS T1\nWHERE \n  T1.subject_id = 10004733 AND T1.first_careunit = 'neurology';",
    "aedafdf56773a3d83e728b07": "SELECT \n  (JULIANDAY('now') - JULIANDAY(MAX(ic.intime))) AS days_since_last_stay\nFROM \n  admissions a\n  INNER JOIN icustays ic ON a.hadm_id = ic.hadm_id\nWHERE \n  a.subject_id = 10021487\n  AND ic.first_careunit = 'emergency';",
    "14cbab955b0cd896876914ae": "WITH LastAdmissionCTE AS (\n    SELECT \n        a.subject_id,\n        a.dischtime,\n        ROW_NUMBER() OVER (PARTITION BY a.subject_id ORDER BY a.dischtime DESC) AS rn\n    FROM admissions a\n    WHERE a.admission_location = 'Trauma SICU' AND a.subject_id = 10018081\n)\nSELECT \n    CAST((julianday('now') - julianday(la.dischtime)) AS INTEGER) AS days_since_last_admission\nFROM LastAdmissionCTE la\nWHERE la.rn = 1;",
    "43896dd8714c99844b172005": "SELECT \n  (julianday('now') - julianday(icustays.outtime)) AS days_since_last_stay\nFROM icustays\nWHERE icustays.subject_id = 10039831\nAND icustays.last_careunit = 'discharge lounge'\nORDER BY icustays.outtime DESC\nLIMIT 1;",
    "468c08e2b6a2ad56c3a4b7ce": "SELECT \n    (JULIANDAY(MAX(icustays.outtime)) - JULIANDAY(MIN(icustays.intime))) * 24 AS hours_since_first_careunit\nFROM \n    icustays\nWHERE \n    icustays.first_careunit = 'medicine' \n    AND icustays.subject_id = 10004733;",
    "66efbf3af38673128432f1ca": "SELECT \n    julianday(icustays.outtime) - julianday(icustays.intime) AS days_in_icu\nFROM \n    icustays\nWHERE \n    icustays.subject_id = 10039831 \n    AND icustays.first_careunit = 'Discharge Lounge';",
    "5c76a4f60142e53facaaad36": "SELECT \n  (strftime('%s', 'now') - strftime('%s', MIN(T1.charttime))) / 3600.0 AS hours_since_diagnosis\nFROM \n  labevents AS T1\nINNER JOIN \n  d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T2.label IN ('Serum Osmolality', 'Serum Sodium') AND T1.subject_id = 10018081;",
    "e02703e99cca2a83c3ce8360": "SELECT COUNT(*) AS hours_since_last_diagnosis\nFROM diagnoses_icd\nWHERE subject_id = 10018081\nAND icd_code = 'I10.9';",
    "5ba5d822e1cd7d6ea2e879f5": "SELECT \n  (julianday('now') - julianday(T1.charttime)) * 24 AS hours_since_last_diagnosis\nFROM diagnoses_icd T1\nJOIN d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\nWHERE T1.subject_id = 10018081\n  AND T2.long_title LIKE '%unspecified essential hypertension%'\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "84abf7eeac8648121f34613c": "SELECT \n  (MIN(labevents.charttime) - MIN(admissions.admittime)) / 3600.0 AS hours_since_admission\nFROM \n  admissions\nINNER JOIN \n  labevents ON admissions.hadm_id = labevents.hadm_id\nINNER JOIN \n  d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  admissions.subject_id = 10018081 \n  AND d_labitems.label = 'Severe Sepsis'",
    "851fcf327081528d82ce552c": "SELECT \n    (strftime('%s', 'now') - strftime('%s', d.charttime)) / 3600.0 AS hours_since_diagnosis\nFROM \n    diagnoses_icd d\nJOIN \n    d_icd_diagnoses i ON d.icd_code = i.icd_code\nWHERE \n    d.subject_id = 10021487 AND i.long_title LIKE '%other fluid overload%'\nLIMIT 1;",
    "b9f5b0364513fe3fe10ac23e": "SELECT \n    JULIANDAY(d.charttime) - JULIANDAY(p.dob) AS days_since_dob\nFROM \n    patients p\nINNER JOIN \n    diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN \n    d_icd_diagnoses di ON d.icd_code = di.icd_code\nWHERE \n    p.subject_id = 10004733\n    AND di.long_title LIKE '%unspecified disturbance of conduct%'\nORDER BY \n    d.charttime DESC\nLIMIT 1;",
    "dcc1a24e525aca42e0faa8ad": "SELECT \n    (julianday('now') - julianday(T.charttime)) * 24 AS hours_since_diagnosis\nFROM \n    diagnoses_icd T\nINNER JOIN \n    d_icd_diagnoses D ON T.icd_code = D.icd_code\nWHERE \n    T.subject_id = 10021487 \n    AND D.icd_code = 'I84.5'\nORDER BY \n    T.charttime DESC\nLIMIT 1;",
    "b037cad3311b5d427cda5306": "SELECT \n    MIN(strftime('%J', charttime) - strftime('%J', '1970-01-01')) AS days_since_test\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10018081 AND \n    d_labitems.label = 'Basophils';",
    "fc9243a5cde088d80aaae29a": "SELECT \n  (JULIANDAY('now') - JULIANDAY(T1.charttime)) * 24 AS hours_since_first_ast\nFROM \n  labevents T1\nINNER JOIN \n  d_labitems T2 ON T1.itemid = T2.itemid\nINNER JOIN \n  admissions T3 ON T1.hadm_id = T3.hadm_id\nWHERE \n  T1.subject_id = 10021487 AND T2.label = 'AST'\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "90b5ca0a939ce91e8678e9e2": "SELECT \n    MIN(julianday(l.charttime) - julianday(a.admittime)) AS days_since_admission\nFROM \n    admissions a\nINNER JOIN \n    labevents l ON a.hadm_id = l.hadm_id\nWHERE \n    a.subject_id = 10021487\n    AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'pco2');",
    "b2aa7e4ded1cb22312719f24": "SELECT \n    (strftime('%s', 'now') - strftime('%s', charttime)) / 3600.0 AS hours_since_test\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10039831 \n    AND d_labitems.label = 'Creatinine'\nORDER BY \n    charttime ASC\nLIMIT 1;",
    "de82a5b21bc173cb82992e90": "SELECT \n  (JULIANDAY('now') - JULIANDAY(MIN(charttime))) AS days_since_first_test\nFROM \n  labevents\nWHERE \n  subject_id = 10021487 AND \n  itemid IN (\n    SELECT \n      itemid\n    FROM \n      d_labitems\n    WHERE \n      label = 'Amylase' OR \n      label = 'Pleural Lab Test'\n  );",
    "e76832974c5806793c6d4c8a": "SELECT \n    JULIANDAY('now') - JULIANDAY(MIN(l.charttime)) AS days_since_first_po2_test\nFROM \n    labevents l\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10021487 \n    AND d.label = 'Po2';",
    "23dd8572482a3b9ef2437c37": "SELECT \n  (julianday(MAX(ce.charttime)) - julianday(MIN(ce.charttime))) AS days_difference\nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  ce.subject_id = 10018081 AND di.label LIKE '%po2%'",
    "b9271c00a9f5d1cda644a8f7": "WITH RelevantICUStay AS (\n  SELECT \n    MAX(stay_id) AS stay_id\n  FROM \n    icustays\n  WHERE \n    subject_id = 10039831\n),\nLastInputEvent AS (\n  SELECT \n    MAX(starttime) AS last_input_time\n  FROM \n    inputevents\n  WHERE \n    subject_id = 10039831 AND \n    stay_id = (SELECT stay_id FROM RelevantICUStay)\n)\nSELECT \n  (julianday('now') - julianday(last_input_time)) AS days_since_last_input\nFROM \n  LastInputEvent;",
    "56d7f83c3d047987d4f5ad6a": "",
    "d5598306e9ea4771b948f856": "",
    "86522357b4bc14150a100527": "SELECT \n  (julianday(T2.charttime) - julianday(T1.intime)) * 24 AS hours_elapsed\nFROM \n  icustays AS T1\nINNER JOIN \n  inputevents AS T2 ON T1.stay_id = T2.stay_id\nWHERE \n  T1.subject_id = 10018081 \n  AND T2.itemid = (SELECT itemid FROM d_items WHERE label = 'Gastric Meds')\nORDER BY \n  T2.charttime ASC\nLIMIT 1;",
    "b3f250788370221cd33bdb7b": "SELECT \n  (strftime('%s', i.starttime) - strftime('%s', i.intime)) / 3600.0 AS hours_since_first_input\nFROM \n  inputevents i\nJOIN \n  icustays icu ON i.stay_id = icu.stay_id\nWHERE \n  i.itemid = (SELECT itemid FROM d_items WHERE label = 'Gastric Meds')\n  AND i.subject_id = 10018081\n  AND i.stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10018081 ORDER BY intime DESC LIMIT 1);",
    "a19d8f8790ee9cc3b62ce290": "SELECT \n  JULIANDAY('now') - MIN(JULIANDAY(ie.starttime)) AS days_since_first_input\nFROM \n  inputevents ie\n  INNER JOIN d_items di ON ie.itemid = di.itemid\nWHERE \n  ie.subject_id = 10018081 AND di.label = 'nepro (full)';",
    "8fa5e7278b3b5b9b839b6135": "SELECT \n  julianday('now') - MIN(julianday(T1.starttime)) AS days_since_first_input\nFROM \n  inputevents AS T1\n  INNER JOIN icustays AS T2 ON T1.stay_id = T2.stay_id\nWHERE \n  T2.subject_id = 10018081\n  AND T1.totalamountuom = 'gt flush';",
    "653e63e266f88f5e4752d092": "SELECT \n    admission_type\nFROM \n    admissions\nWHERE \n    subject_id = 10020740\nORDER BY \n    admittime\nLIMIT 1;",
    "129654f0722de6dae2867660": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10018423 \nORDER BY admittime ASC \nLIMIT 1;",
    "6fd5e2805d0a42a23c2787ff": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10018081 \nORDER BY admittime ASC \nLIMIT 1;",
    "68c085ad9374a9c886e43355": "SELECT \n    admission_type \nFROM \n    admissions \nWHERE \n    subject_id = 10019917 \nORDER BY \n    hadm_id DESC \nLIMIT 1;",
    "60f8d59c27fe673230ac2a83": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10006053\nORDER BY admittime ASC \nLIMIT 1;",
    "94cd2d4043d712084245bed1": "SELECT \n    admission_type \nFROM \n    admissions \nWHERE \n    subject_id = 10020740 \nORDER BY \n    admittime \nLIMIT 1;",
    "8df120a9e3e8d73de47c1a11": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10011398\nORDER BY admittime DESC\nLIMIT 1;",
    "1b6f72d94895e62f9e279e35": "",
    "b82dba86a4b2a808ab2cef89": "SELECT T1.valuenum \nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10011398 \nAND T2.label = 'Weight' \nAND T1.charttime >= DATE('now', '-30 months')\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "63359ce4687532a538d1238d": "SELECT T1.valuenum, T1.valueuom\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10009628\nAND T2.label = 'Weight'\nAND T1.charttime >= DATE('now', '-25 month')\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "27ce9933ce0b1542c2dd468c": "SELECT \n  c.valuenum AS weight\nFROM \n  chartevents c\nINNER JOIN \n  d_items i ON c.itemid = i.itemid\nWHERE \n  c.subject_id = 10036156\n  AND i.label = 'Weight'\nORDER BY \n  c.charttime ASC\nLIMIT 1;",
    "9cd37fc842ad70310d54ee58": "SELECT \n  c.valuenum \nFROM \n  chartevents c\n  INNER JOIN d_items d ON c.itemid = d.itemid\nWHERE \n  c.subject_id = 10027602\n  AND d.label LIKE '%Weight%'\n  AND c.charttime >= date('now', '-5 months')\nORDER BY \n  c.charttime ASC\nLIMIT 1;",
    "689684471cdf1a2cea58ca7c": "select the `valuenum` (the weight value) from `labevents`.\n   - We will filter by `subject_id = 10007928`.\n   - We will match the `itemid` to the lab item that represents weight.\n   - We will identify the `hadm_id` of the last hospital encounter for the patient.\n\n4. Write the SQL query:\n   - We will use a subquery to find the `hadm_id` of the last hospital encounter for the patient.\n   - We will then filter the `labevents` table based on this `hadm_id` and the `itemid`.",
    "5b70769cdf8e342b6b7432c8": "SELECT MAX(ce.charttime) AS last_charttime, ce.valuenum AS last_weight\nFROM chartevents ce\nJOIN icustays icu ON ce.stay_id = icu.stay_id\nJOIN admissions a ON icu.hadm_id = a.hadm_id\nWHERE ce.subject_id = 10005909\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "84ffe2eecf94db13c293cd18": "select the longest title from `d_icd_diagnoses` corresponding to the most recent diagnosis code from `diagnoses_icd` for the specified patient since one year ago.",
    "531d3b5c9daeaf625b709381": "SELECT d.long_title\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.subject_id = 10025612 \n  AND di.charttime >= DATE('now', '-1 year')\nORDER BY di.charttime DESC\nLIMIT 1;",
    "c382285cc641ffefb4754fec": "SELECT \n    d.long_title AS diagnosis\nFROM \n    diagnoses_icd di\nINNER JOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    di.subject_id = 10011398\n    AND di.charttime = (\n        SELECT MAX(di2.charttime) \n        FROM diagnoses_icd di2 \n        WHERE di2.subject_id = 10011398\n          AND di2.hadm_id = di.hadm_id\n    )\nORDER BY \n    di.charttime DESC\nLIMIT 1;",
    "a68a8f7c8f9c51d21140fbb2": "SELECT d.long_title\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.subject_id = 10020740 AND di.charttime >= '2100-01-01 00:00:00'\nORDER BY di.charttime ASC\nLIMIT 1;",
    "480b667942347b982307f45c": "SELECT \n  d.long_title \nFROM \n  diagnoses_icd di \nINNER JOIN \n  d_icd_diagnoses d ON di.icd_code = d.icd_code \nWHERE \n  di.subject_id = 10009628 \nORDER BY \n  di.charttime ASC \nLIMIT 1;",
    "19013f71186dd94c3663224d": "SELECT DISTINCT d.long_title AS diagnosis\nFROM diagnoses_icd icd\nINNER JOIN d_icd_diagnoses d ON icd.icd_code = d.icd_code\nINNER JOIN admissions a ON icd.hadm_id = a.hadm_id\nWHERE a.subject_id = 10029291 AND strftime('%Y', icd.charttime) = '2100'\nORDER BY icd.charttime ASC\nLIMIT 1;",
    "b389e224ed07b11a553f0329": "SELECT \n  d.long_title \nFROM \n  diagnoses_icd icd \n  INNER JOIN d_icd_diagnoses d ON icd.icd_code = d.icd_code \nWHERE \n  icd.subject_id = 10001217 \nORDER BY \n  icd.charttime \nLIMIT 1;",
    "882e179f26d1d73b14ec8e40": "SELECT T2.drug\nFROM admissions AS T1\nJOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.route = 'nu'\nAND T2.subject_id = 10035185\nAND T1.hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10035185)\nLIMIT 1;",
    "0df69b82de6a35ad5bdec3d3": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10010471 \nAND route = 'neb' \nAND starttime >= DATE('2100-12-01') \nORDER BY starttime \nLIMIT 1;",
    "c1b92eb9d2e4ceedd614efe5": "SELECT \n  drug, \n  starttime \nFROM \n  prescriptions \nWHERE \n  subject_id = 10029291 \n  AND starttime LIKE '2023-03-%' \n  AND route = 'iv' \nORDER BY \n  starttime ASC \nLIMIT 1;",
    "ad08e146a6e37e3a138c8c78": "",
    "5bb6c677596960ca463e9a0c": "SELECT p.drug\nFROM prescriptions p\nWHERE p.subject_id = 10038933\nAND p.hadm_id = (\n    SELECT adm.hadm_id\n    FROM admissions adm\n    WHERE adm.subject_id = 10038933\n    ORDER BY adm.admittime ASC\n    LIMIT 1\n)\nAND p.route = 'td'\nORDER BY p.starttime DESC\nLIMIT 1;",
    "727a314e82ff330ad11ea76a": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10020187\n  AND route = 'po'\n  AND starttime >= DATE('now', 'start of year', '+1 month', '-1 day')\n  AND starttime <= DATE('now', 'start of year', '+1 month')\nORDER BY starttime DESC\nLIMIT 1;",
    "86aa92cf8b22de77c9f101da": "SELECT T1.drug \nFROM prescriptions AS T1 \nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id \nWHERE T1.subject_id = 10007818 AND T1.route = 'replace'\nORDER BY T1.starttime ASC \nLIMIT 1;",
    "b1230a6aa17968195ee8b217": "SELECT p.drug\nFROM prescriptions p\nWHERE p.subject_id = 10003400\nAND p.starttime >= DATE('now', '-26 months')\nORDER BY p.starttime ASC\nLIMIT 1;",
    "779440f275cacfb10aac9cd9": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10001725\nAND starttime >= DATE('now', '-28 months')\nORDER BY starttime ASC\nLIMIT 1;",
    "db9cfb9fbfbda61eb399064e": "SELECT p.drug\nFROM prescriptions p\nWHERE p.subject_id = 10022041\nAND p.hadm_id IN (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10022041\n    ORDER BY admittime ASC\n    LIMIT 1\n)\nAND p.starttime = (\n    SELECT MAX(starttime)\n    FROM prescriptions\n    WHERE subject_id = 10022041\n    AND hadm_id IN (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10022041\n        ORDER BY admittime ASC\n        LIMIT 1\n    )\n);",
    "03dfaec9b60c0b6d9aa52f8a": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10021118\n  AND starttime >= '2012-12-01'\n  AND starttime < '2013-01-01'\nORDER BY starttime DESC\nLIMIT 1;",
    "fe2d6c0f694f5a4cc2357932": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10005817 AND starttime >= '2009-01-01'\nORDER BY starttime ASC \nLIMIT 1;",
    "a0db7ff03e5bff5fb4b04f91": "SELECT MAX(hadm_id) \n               FROM prescriptions \n               WHERE subject_id = 10007818) \nLIMIT 1;",
    "1bc55cd8f6d690799f8c4047": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10020306\nAND starttime >= DATE('now', '-13 months')\nORDER BY starttime ASC\nLIMIT 1;",
    "d668bffcab5e2672863cb63b": "SELECT p.drug\nFROM diagnoses_icd AS d\nJOIN prescriptions AS p ON d.subject_id = p.subject_id AND d.hadm_id = p.hadm_id\nWHERE d.subject_id = 10018081\n  AND d.icd_code = (\n    SELECT icd_code FROM d_icd_diagnoses WHERE long_title LIKE '%other and unspecified hyperlipidemia%'\n  )\n  AND p.starttime >= d.charttime\n  AND p.starttime <= DATE(d.charttime, '+2 days');",
    "59e904000d52c139e656f371": "",
    "084bc1062af3fecf71b004b8": "SELECT p.drug\nFROM prescriptions p\nJOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE p.subject_id = 10022281\nAND d2.long_title = 'Diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled in 06/2100'\nAND p.starttime >= (SELECT admittime FROM admissions WHERE subject_id = 10022281)\nAND p.stoptime <= (SELECT dischtime FROM admissions WHERE subject_id = 10022281);",
    "edc9d546d2286562d9028ba2": "SELECT T1.drug\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Family history of malignant neoplasm of breast'\nAND T1.subject_id = 10020306\nAND T1.starttime >= DATE('now', '-1 month')\nAND T1.starttime <= DATE('now');",
    "188165b0d15bdb552ff80f78": "select the medication.",
    "274b0d1304fb6e07afcfbbda": "",
    "fb06199e01e940e2278f83e6": "SELECT T1.drug\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10011398\n  AND T3.long_title = 'Intermediate coronary syndrome'\n  AND T2.charttime BETWEEN DATE('now', 'start of month') AND DATE('now', 'start of month', '+1 month', '-1 day')\n  AND T1.starttime BETWEEN T2.charttime AND DATE(T2.charttime, '+2 days');",
    "d7d06c5202d42d089c98cbcb": "",
    "0e6e7e38aaec3a977e832859": "SELECT DISTINCT p.drug\nFROM prescriptions p\nINNER JOIN procedures_icd pr ON p.hadm_id = pr.hadm_id AND p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE p.subject_id = 10019172\n  AND d.long_title = 'Excision of dental lesion of jaw, procedure';",
    "7e34d3539103f069ec358935": "SELECT DISTINCT p.drug\nFROM prescriptions p\nJOIN procedures_icd pr ON p.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE p.subject_id = 10027602\n  AND p.hadm_id = pr.hadm_id\n  AND d.long_title = 'Continuous Invasive Mechanical Ventilation, Contraindicated for Less Than 96 Consecutive Hours'\n  AND pr.charttime BETWEEN '2012-12-01 00:00:00' AND '2012-12-21 23:59:59';",
    "72035c7e697aebbd36cc9933": "SELECT DISTINCT pr.drug\nFROM prescriptions pr\nJOIN procedures_icd pro ON pr.hadm_id = pro.hadm_id\nWHERE pr.subject_id = 10027602\nAND pro.icd_code = 'T86.10'\nAND pr.starttime >= DATE('now', '-1 month')\nAND pr.starttime < DATE('now');",
    "812c6c46b3324a53a45d2aeb": "SELECT T4.drug\nFROM procedures_icd AS T1\nINNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nINNER JOIN prescriptions AS T4 ON T1.subject_id = T4.subject_id AND T1.hadm_id = T4.hadm_id\nWHERE T1.subject_id = 10027602\nAND T2.long_title LIKE '%closed [endoscopic] biopsy of bronchus procedure%'\nAND T4.starttime >= T1.charttime\nAND T4.starttime <= DATE(T1.charttime, '+2 day')\nAND strftime('%Y-%m', T1.charttime) = strftime('%Y-%m', 'now');",
    "2a11db69d8090e01bd8a342f": "SELECT DISTINCT p.drug\nFROM procedures_icd pr\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nJOIN prescriptions p ON pr.hadm_id = p.hadm_id AND pr.subject_id = p.subject_id\nWHERE pr.subject_id = 10027602 \n  AND d.long_title = 'Endotracheal Tube Insertion'\n  AND p.starttime >= DATE('now', 'start of month')\n  AND p.stoptime <= DATE('now', 'end of month');",
    "7de6b061dc649d1607951286": "SELECT DISTINCT p.drug\nFROM prescriptions p\nJOIN procedures_icd pr ON p.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE p.subject_id = 10021312\nAND p.starttime >= pr.charttime\nAND p.starttime <= DATE(pr.charttime, '+2 days')\nAND d.long_title = 'Drainage of left main bronchus, via natural or artificial opening, endoscopic, diagnostic procedure';",
    "73f7afc22d0bf51b0967f477": "SELECT \n    SUM(prescriptions.dose_val_rx) AS total_dose\nFROM \n    prescriptions\nWHERE \n    prescriptions.subject_id = 10006053\n    AND prescriptions.starttime >= '2022-10-21 00:00:00'\n    AND prescriptions.drug = '0.9% Sodium Chloride'\n    AND prescriptions.route = 'IM'",
    "0d67d0933db06596007b915d": "SELECT \n  p.subject_id,\n  p.hadm_id,\n  p.starttime,\n  p.stoptime,\n  p.drug,\n  p.dose_val_rx,\n  p.dose_unit_rx\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10005909 AND \n  p.drug = 'Phenazopyridine';",
    "011101a7eeb61bc7e999e5d0": "",
    "8ddf87626d2c76b0babbc0d9": "SELECT dose_val_rx, dose_unit_rx\nFROM prescriptions\nWHERE drug = 'TAMOXIFEN CITRATE' AND subject_id = 10007795\nORDER BY starttime DESC\nLIMIT 1;",
    "28fd166cd9efc2ab844c870d": "",
    "7db7fa4ecb7523dc29380f8c": "SELECT \n  SUM(T1.dose_val_rx) AS total_acetaminophen_iv\nFROM \n  prescriptions AS T1\nWHERE \n  T1.subject_id = 10031757 \n  AND T1.drug = 'acetaminophen'\n  AND T1.route = 'iv'",
    "63e4dddc1461b7b4506f3036": "",
    "652c13b3ffbd655d3934525f": "SELECT SUM(p.dose_val_rx) AS total_oxycodone_dose\nFROM prescriptions p\nWHERE p.subject_id = 10020187 AND p.drug = 'oxycodone (immediate release)';",
    "ff8338b63365f7592e0f5601": "SELECT \n    dose_val_rx, \n    dose_unit_rx \nFROM \n    prescriptions \nWHERE \n    subject_id = 10014354 \n    AND drug = 'Glucose Gel';",
    "89c2d37bc8253b4bbe4a7c48": "SELECT SUM(p.dose_val_rx) AS total_dose\nFROM prescriptions p\nWHERE p.subject_id = 10020944 AND p.drug = 'pregabalin';",
    "c342b5e4b0e92d9e4a863516": "SELECT dose_val_rx\nFROM prescriptions\nWHERE subject_id = 10011398\n  AND drug = 'Glucagon'\n  AND starttime >= '2000-07-01 00:00:00';",
    "5d1a36d000cf036649466742": "SELECT SUM(p.dose_val_rx) AS total_simvastatin\nFROM prescriptions p\nWHERE p.subject_id = 10025463\nAND p.drug = 'simvastatin'\nAND p.starttime >= '2011-11-21 00:00:00';",
    "372eebaf1307d345c3c26b97": "SELECT \n    SUM(T1.dose_val_rx) AS total_ferrous_sulfate\nFROM \n    prescriptions T1\nJOIN \n    admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10012853 \n    AND T1.drug = 'Ferrous Sulfate'\n    AND T2.dischtime = (\n        SELECT MAX(dischtime) \n        FROM admissions \n        WHERE subject_id = 10012853\n    );",
    "21a26369d82d30e8f8036663": "",
    "91c672fcc248e33a4019dadc": "SELECT \n    p1.drug AS today_drug, \n    p2.drug AS yesterday_drug\nFROM \n    prescriptions p1\nLEFT JOIN \n    prescriptions p2\nON \n    p1.subject_id = p2.subject_id \n    AND p1.hadm_id = p2.hadm_id \n    AND p1.starttime >= DATE('now') \n    AND p1.starttime < DATE('now', '+1 day') \n    AND p2.starttime >= DATE('now', '-1 day') \n    AND p2.starttime < DATE('now', 'localtime', '-1 day', '+1 day')\nWHERE \n    p1.subject_id = 10004733;",
    "cf5ba52470d99772c0cfb0ff": "SELECT \n  p.starttime, \n  p.drug, \n  p.dose_val_rx, \n  p.dose_unit_rx, \n  p.route \nFROM \n  prescriptions p \nWHERE \n  p.subject_id = 10004733 \n  AND p.starttime >= DATE('now', '-1 day') \n  AND p.starttime < DATE('now') \nORDER BY \n  p.starttime DESC;",
    "5b8ffff4e21d176e195d9c35": "Select all prescriptions for the patient (subject_id = 10004733) that were started on the current day (`starttime` today) and yesterday (`starttime` yesterday).\n2. Compare the list of drugs prescribed today with those prescribed yesterday to find the ones added today.",
    "5dc8c9a7928cb067f4b75d12": "",
    "6675b86607ae8420ab26bdba": "",
    "50a2de2aeac213e640ee8dfc": "select the prescriptions made on the current date and the previous day for the specified patient and compare them.",
    "28d1d61838e9ab66ccc8ae3c": "WITH TodayPrescriptions AS (\n  SELECT drug\n  FROM prescriptions\n  WHERE subject_id = 10004733 AND DATE(starttime) = DATE('now')\n),\nYesterdayPrescriptions AS (\n  SELECT drug\n  FROM prescriptions\n  WHERE subject_id = 10004733 AND DATE(starttime) = DATE('now', '-1 day')\n)\nSELECT \n  CASE \n    WHEN tp.drug IS NOT NULL AND yp.drug IS NULL THEN 'Newly prescribed: ' || tp.drug\n    ELSE 'No change in prescription'\n  END AS NewlyPrescribedMedication\nFROM TodayPrescriptions tp\nLEFT JOIN YesterdayPrescriptions yp ON tp.drug = yp.drug\nLIMIT 1;",
    "e5441310205bb859e8ca31ba": "SELECT \n  labevents.valuenum \nFROM \n  labevents\nJOIN \n  d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.subject_id = 10023117\n  AND d_labitems.label = 'Hemoglobin'\nORDER BY \n  labevents.charttime ASC\nLIMIT 1;",
    "4710d3c9173e3759cd533b86": "SELECT \n  T1.charttime,\n  T1.valuenum,\n  T1.valueuom\nFROM \n  labevents AS T1\nJOIN \n  d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10016742\n  AND T2.label LIKE '%Platelet Count%'\n  AND T1.charttime BETWEEN '2000-08-01 00:00:00' AND '2000-08-31 23:59:59'\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "32dc827809f2f3b381144bfc": "SELECT \n  labevents.valuenum\nFROM \n  labevents\nWHERE \n  labevents.subject_id = 10002495\nORDER BY \n  labevents.charttime\nLIMIT 1;",
    "95de1cbfea9cbbf15a57c2e4": "SELECT ce.valuenum\nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10008454\nAND ce.charttime BETWEEN DATE('now', 'start of year', '+11 months') AND DATE('now', 'start of year', '+11 months', '+1 month', '-1 day')\nAND di.label = 'eag'\nORDER BY ce.charttime\nLIMIT 1;",
    "bebec164cfe1ff0dced197be": "SELECT \n  l.charttime,\n  l.valuenum,\n  l.valueuom\nFROM \n  labevents l\nINNER JOIN \n  d_labitems d ON l.itemid = d.itemid\nWHERE \n  d.label = 'K+ - Potassium Whole Blood' AND\n  l.subject_id = 10018423\nORDER BY \n  l.charttime ASC\nLIMIT 1;",
    "0eeb80895de2cb7f545f7953": "SELECT \n  le.valuenum\nFROM \n  labevents le\nJOIN \n  admissions a ON le.hadm_id = a.hadm_id\nWHERE \n  le.subject_id = 10019917 \n  AND le.itemid = (\n    SELECT \n      dli.itemid \n    FROM \n      d_labitems dli \n    WHERE \n      dli.label = 'Hematocrit'\n  )\nORDER BY \n  le.charttime DESC\nLIMIT 1;",
    "0252bfa6857e8fa392627cbf": "SELECT \n  l.charttime AS timestamp, \n  l.valuenum AS value, \n  l.valueuom AS unit\nFROM \n  labevents l\nJOIN \n  d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10021487 \n  AND d.label = 'O2 Flow'\nORDER BY \n  l.charttime ASC\nLIMIT 1;",
    "4be18d3033fa1bac9d4c0223": "SELECT d_labitems.label\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10026255\n  AND labevents.charttime >= '2000-04-01 00:00:00'\nORDER BY labevents.charttime\nLIMIT 1;",
    "bda2d1d92535f2f380e83c31": "SELECT d_labitems.label\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10022017\nAND labevents.charttime >= '2021-04-01'\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "22e094ace74f0664f5a0629e": "SELECT d_labitems.label\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10023239\nAND labevents.charttime LIKE '2000-06-21%'\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "d8d340c85d29c3512cdffb03": "SELECT \n  d.label AS LabTest\nFROM \n  labevents le\n  INNER JOIN d_labitems d ON le.itemid = d.itemid\nWHERE \n  le.subject_id = 10004235\n  AND le.charttime >= '2000-03-21'\nORDER BY \n  le.charttime\nLIMIT 1;",
    "1f1e33683e0ff2f0510efc21": "SELECT \n  l.charttime,\n  l.itemid\nFROM \n  labevents l\nWHERE \n  l.subject_id = 10002428\n  AND l.charttime BETWEEN '2000-07-01 00:00:00' AND '2000-07-31 23:59:59'\nORDER BY \n  l.charttime ASC\nLIMIT 1;",
    "1a72596befd361ee133771b0": "SELECT d_labitems.label\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10015931\nAND labevents.charttime >= '2020-05-21'\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "ecd65c3d262d3e34018c162c": "SELECT \n  l.charttime, \n  d.label AS lab_test\nFROM \n  labevents l\nINNER JOIN \n  d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10001725\n  AND l.charttime >= DATE('now', '-9 months')\nORDER BY \n  l.charttime DESC;",
    "bd3ba61db07a88f7a5920ac6": "SELECT AVG(ce.valuenum) AS average_potassium\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10037975\nAND di.label = 'Potassium, whole blood in 02/2100';",
    "0c93a24758fe815a4f4bf747": "SELECT MAX(chartevents.valuenum) AS max_value\nFROM chartevents\nWHERE chartevents.subject_id = 10004235 AND chartevents.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10004235\n    ORDER BY admittime DESC\n    LIMIT 1\n);",
    "9f0ee496296456e6f48a49a6": "Select the minimum `valuenum` for protein from the filtered lab events.",
    "89f4e7daebe9b4f5c0d96263": "SELECT MAX(ce.valuenum) AS max_mchc\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10026354\nAND ce.charttime BETWEEN '2022-11-01' AND '2022-11-30'\nAND di.label = 'mchc';",
    "a19666f04f957b696244b895": "SELECT AVG(labevents.valuenum) AS average_magnesium\nFROM labevents\nJOIN admissions ON labevents.hadm_id = admissions.hadm_id\nWHERE labevents.subject_id = 10006580 AND labevents.itemid = (\n    SELECT d_labitems.itemid \n    FROM d_labitems \n    WHERE d_labitems.label = 'Magnesium'\n)\nAND admissions.hadm_id IN (\n    SELECT MIN(hadm_id) \n    FROM admissions \n    WHERE admissions.subject_id = 10006580\n);",
    "aba8c9a560d7ec87a020f638": "",
    "9941ca19aa20b45f0d59bc93": "",
    "c3edbb8f5bd0cfd4858c41be": "SELECT \n    org_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10027602\n    AND charttime LIKE '12/21/2000%'\n    AND spec_type_desc = 'mini-bal'\nORDER BY \n    charttime DESC\nLIMIT 1;",
    "f6c2ec0da1bf93fc0c8595c0": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10029291\nAND charttime = (\n    SELECT MIN(charttime)\n    FROM microbiologyevents\n    WHERE subject_id = 10029291\n    AND spec_type_desc = 'Sputum'\n)\nAND spec_type_desc = 'Sputum';",
    "f2be9084ce59ddbf5372d16a": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10019172\nAND charttime >= DATE('now', '-1 month')\nAND test_name LIKE '%Urine%';",
    "bbef3c6dded10fa7874540f2": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10016742\nAND charttime >= '2000-08-01'\nAND spec_type_desc LIKE '%Sputum%';",
    "dd880129ab0eb4dc203813f8": "SELECT org_name \nFROM microbiologyevents\nWHERE subject_id = 10007818 AND hadm_id = (\n  SELECT hadm_id \n  FROM admissions \n  WHERE subject_id = 10007818 \n  ORDER BY admittime ASC \n  LIMIT 1\n) \nAND spec_type_desc = 'Blood Culture' \nORDER BY charttime ASC \nLIMIT 1;",
    "f5f185ff5f7901dc7c4dd711": "SELECT org_name \nFROM microbiologyevents \nWHERE subject_id = 10037861 \nAND charttime >= '2021-05-21' \nAND spec_type_desc = 'Urine' \nAND test_name = 'First urine test' \nORDER BY charttime ASC \nLIMIT 1;",
    "ee3ef44107690c988c06c3e4": "SELECT \n    org_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10007818 \n    AND charttime >= '2000-07-21' \n    AND spec_type_desc = 'First Bronchoalveolar Lavage'\n    AND test_name = 'Culture';",
    "441abc9cec7ed48c4b29a5c3": "SELECT \n    test_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10002495 AND\n    strftime('%m/%y', charttime) = '06/21';",
    "c309a617ea1462d56fdac6d2": "SELECT MIN(charttime) AS first_test_time, \n       test_name \nFROM microbiologyevents \nWHERE subject_id = 10018501 \n  AND charttime >= '2021-04-21' \nGROUP BY test_name \nORDER BY first_test_time ASC \nLIMIT 1;",
    "7782eddef35c5010b9b90ac3": "SELECT test_name \nFROM microbiologyevents \nWHERE subject_id = 10036156 AND charttime >= '06/2100' \nORDER BY charttime ASC \nLIMIT 1;",
    "38447d52a601457cc529a5b1": "SELECT \n  spec_type_desc,\n  test_name\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10005909 \n  AND charttime >= DATE('now', '-15 months');",
    "2d7404fcfff0b855a4fb2fe9": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10011398\nORDER BY charttime DESC\nLIMIT 1;",
    "2e8d527ae93a03ae76d66369": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10007795\nAND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10007795 ORDER BY admittime ASC LIMIT 1)\nORDER BY charttime ASC\nLIMIT 1;",
    "9720cb4a260b30525538f8b2": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10022281 AND charttime BETWEEN '2000-06-01 00:00:00' AND '2000-06-30 23:59:59'\nORDER BY charttime ASC\nLIMIT 1;",
    "bd164a06951b24d9fbb32e90": "SELECT test_name \nFROM microbiologyevents \nWHERE subject_id = 10008454 \n  AND charttime >= DATETIME('now', 'start of month') \nORDER BY charttime DESC \nLIMIT 1;",
    "c03994e0de214c507a8f8002": "SELECT \n  me.test_name\nFROM \n  microbiologyevents me\n  INNER JOIN admissions a ON me.hadm_id = a.hadm_id\nWHERE \n  a.subject_id = 10018845\nORDER BY \n  me.charttime\nLIMIT 1;",
    "a49efc1cdf3ebbe617aa7d26": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10008454 AND charttime >= '2022-12-01' AND charttime < '2023-01-01'\nORDER BY charttime DESC\nLIMIT 1;",
    "fd2461146ec138678719d7e3": "SELECT T1.test_name\nFROM microbiologyevents AS T1\nJOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.subject_id = 10002495\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "c68bc6d51b04677c09432ee6": "SELECT \n  T1.test_name\nFROM \n  microbiologyevents AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.subject_id = 10004235\n  AND T2.hadm_id = (SELECT MIN(hadm_id) FROM admissions WHERE subject_id = 10004235)\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "d738acddca870a290c446af4": "SELECT \n    test_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10004720\n    AND charttime >= '2001-01-01'\nORDER BY \n    charttime DESC\nLIMIT 1;",
    "677aa66bc6c493237c9e78ee": "SELECT me.test_name \nFROM microbiologyevents me\nWHERE me.subject_id = 10018845\n  AND me.hadm_id = (SELECT MAX(hadm_id) \n                    FROM microbiologyevents \n                    WHERE subject_id = 10018845)\n  AND me.charttime = (SELECT MIN(charttime) \n                      FROM microbiologyevents \n                      WHERE subject_id = 10018845 \n                        AND hadm_id = (SELECT MAX(hadm_id) \n                                       FROM microbiologyevents \n                                       WHERE subject_id = 10018845))\nLIMIT 1;",
    "21f4165a3f8a7a30e0b78f54": "Select the `label` from `d_items`.\n   - Filter the `inputevents` table by `subject_id` and `starttime` date.\n   - Order the results by `starttime` in descending order.\n   - Limit the result to 1.",
    "ac033d9ef9eacbfbf6ddce05": "SELECT starttime, itemid, totalamount, totalamountuom\nFROM inputevents\nWHERE subject_id = 10021487 AND starttime > '2100-06-22 00:00:00'\nORDER BY starttime ASC\nLIMIT 1;",
    "0265a95e555d0c4a8c1f3d50": "SELECT \n  di.label AS item_name\nFROM \n  inputevents ie\nJOIN \n  d_items di ON ie.itemid = di.itemid\nWHERE \n  ie.subject_id = 10021487\n  AND strftime('%Y-%m-%d', ie.starttime) LIKE strftime('%Y-%m-11', 'now')\nORDER BY \n  ie.starttime ASC\nLIMIT 1;",
    "674bcd311bac8e9ec3bcdba0": "SELECT \n  p.gender\nFROM \n  patients p\nJOIN \n  inputevents ie ON p.subject_id = ie.subject_id\nWHERE \n  p.subject_id = 10020786\nORDER BY \n  ie.starttime DESC\nLIMIT 1;",
    "45ecebf7e481e6c14fdc01cd": "SELECT \n  i.totalamount, \n  i.totalamountuom \nFROM \n  inputevents i\nWHERE \n  i.subject_id = 10018081 \n  AND DATE(i.starttime) = '2022-12-30' \nORDER BY \n  i.starttime DESC \nLIMIT 1;",
    "18bf32ca58ea6def07157a60": "WITH LastICUStay AS (\n    SELECT \n        stay_id\n    FROM icustays\n    WHERE subject_id = 10029291\n    ORDER BY outtime DESC\n    LIMIT 1\n)\nSELECT \n    ie.itemid,\n    d_items.label,\n    ie.totalamount,\n    ie.totalamountuom,\n    ie.starttime\nFROM inputevents ie\nJOIN d_items ON ie.itemid = d_items.itemid\nJOIN LastICUStay lis ON ie.stay_id = lis.stay_id\nORDER BY ie.starttime DESC\nLIMIT 1;",
    "6f1d4f9ac8b86db76c98d50f": "SELECT \n  d_items.label \nFROM \n  inputevents \n  JOIN d_items ON inputevents.itemid = d_items.itemid \nWHERE \n  inputevents.subject_id = 10011398 \n  AND DATE(inputevents.starttime) >= DATE('2021-07-20') \nORDER BY \n  inputevents.starttime ASC \nLIMIT 1;",
    "6b01b95b07df8e89058e4862": "SELECT SUM(totalamount) AS total_amount\nFROM inputevents\nWHERE subject_id = 10021312\nAND starttime >= '20100917000000'\nAND starttime < '20100918000000'\nAND totalamountuom = 'ml'\nAND itemid IN (\n    SELECT itemid\n    FROM d_items\n    WHERE label LIKE '%or crystalloid%'\n);",
    "61044fc8b56af395d27bc3ca": "SELECT \n  SUM(T1.totalamount) AS total_cryoprecipitate_amount\nFROM \n  inputevents T1\n  INNER JOIN d_items T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10006053 \n  AND T1.starttime LIKE '%11/16%'\n  AND T2.abbreviation = 'CRYOPRECIPO';",
    "654af28177758d29e5368635": "SELECT SUM(totalamount) AS total_lr_amount\nFROM inputevents\nWHERE subject_id = 10004235 AND starttime >= '2021-03-20 00:00:00' AND starttime < '2021-03-21 00:00:00' AND totalamountuom = 'lr';",
    "9e06157df2f8d7330094763f": "SELECT SUM(totalamount) AS total_solution_amount\nFROM inputevents\nWHERE subject_id = 10019917\n  AND starttime LIKE '2023-01-28%';",
    "4bc83d6264e9674296907cec": "SELECT \n  SUM(ie.totalamount) AS total_gastric_meds_input\nFROM \n  inputevents ie\nJOIN \n  d_items di ON ie.itemid = di.itemid\nWHERE \n  ie.subject_id = 10027602\n  AND DATE(ie.starttime) = '2021-11-29'\n  AND di.label = 'Gastric Meds';",
    "9b1a61e9a3cf7261a416c001": "SELECT SUM(T1.totalamount) AS total_kcl_bolus\nFROM inputevents AS T1\nJOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10022017\nAND T1.starttime LIKE '2023-10-03%'\nAND T2.label = 'KCL (BOLUS)'",
    "62b637c8df8e9435c243a84a": "SELECT SUM(totalamount) AS total_rbc_intake\nFROM inputevents\nWHERE subject_id = 10039831\n  AND itemid IN (\n    SELECT itemid \n    FROM d_items \n    WHERE label LIKE '%RBC%'\n  )\n  AND starttime >= '2021-10-06';",
    "6136c38332507c02dfcc394d": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10010471 AND starttime >= '2008-06-08';",
    "032b87119c5b76d8394a9373": "SELECT SUM(totalamount) AS total_input\nFROM inputevents\nWHERE subject_id = 10021487 AND starttime LIKE '2000-12-20%';",
    "7868c1035a69f54e888cb24c": "",
    "5e583d5affb4e1b0f6e62364": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10011398\nAND starttime >= '2010-10-15 00:00:00';",
    "1652f9d26e284f0b715c9070": "",
    "852fe0f9eab141f83e933cfd": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10018501 AND starttime LIKE '2100-08-10%';",
    "8e819ca96ee526f42389d521": "",
    "be9406622ce9314da8536fea": "SELECT value, valueuom, charttime\nFROM outputevents\nWHERE subject_id = 10039831\nAND charttime >= '2021-10-23'\nORDER BY charttime ASC\nLIMIT 1;",
    "f6e8b06dc6af06677ce3573e": "SELECT \n  value AS output_value,\n  valueuom AS output_unit\nFROM \n  outputevents\nWHERE \n  subject_id = 10014354\n  AND charttime >= '2000-04-12'\nORDER BY \n  charttime DESC\nLIMIT 1;",
    "ae9a06614595aba70dc8365e": "SELECT value, valueuom \nFROM outputevents \nWHERE subject_id = 10010471 AND charttime > '2001-04-01 00:00:00'\nORDER BY charttime ASC \nLIMIT 1;",
    "59e0af10bd7f401a8e0193db": "SELECT\n    itemid,\n    charttime\nFROM\n    outputevents\nWHERE\n    subject_id = 10019172\n    AND charttime >= '2003-12-01 00:00:00'\nORDER BY\n    charttime ASC\nLIMIT 1;",
    "9381ef3a83219886a02144fc": "SELECT \n  d_items.label AS output_name\nFROM \n  outputevents AS oe\n  INNER JOIN d_items AS d_items ON oe.itemid = d_items.itemid\nWHERE \n  oe.subject_id = 10027602\n  AND DATE(oe.charttime) = '2023-11-26'\nORDER BY \n  oe.charttime ASC\nLIMIT 1;",
    "193315d3d4b5326e56e84b77": "SELECT value, valueuom \nFROM outputevents \nWHERE subject_id = 10035185 \n  AND DATE(charttime) = '2023-05-18' \nORDER BY charttime ASC \nLIMIT 1;",
    "2766c75e65819b7cf9c0fba2": "",
    "1dd5f6600a1779d3902b0c74": "SELECT SUM(totalamount) AS total_blakemore_amount\nFROM inputevents\nWHERE subject_id = 10006053\nAND itemid = (\n  SELECT itemid \n  FROM d_items \n  WHERE label = 'blakemore'\n)\nAND starttime >= '2001-01-17';",
    "e4f78cd53a4a70e9d10c4eea": "SELECT o.value, o.valueuom\nFROM outputevents o\nJOIN admissions a ON o.hadm_id = a.hadm_id\nWHERE a.subject_id = 10015931\n  AND o.charttime >= '2021-12-06 00:00:00';",
    "c99300a7ea88ef7b82951b42": "SELECT SUM(value) AS total_cerebral_ventricular_output\nFROM outputevents\nWHERE subject_id = 10027602\n  AND charttime >= date('now', '-1 month')\n  AND charttime < date('now')\n  AND itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'Cerebral Ventricular #1 Output'\n  );",
    "2821799cf4699b6d8e3e4c43": "SELECT SUM(totalamount) AS total_foley_output\nFROM inputevents\nWHERE subject_id = 10020740\n  AND itemid = (SELECT itemid FROM d_items WHERE label = ' Foley Catheter Output')\n  AND starttime LIKE '2021-04-13%';",
    "e0ef594aee8d798aff512963": "SELECT SUM(oe.value) AS total_output_amount\nFROM outputevents oe\nJOIN icustays icu ON oe.stay_id = icu.stay_id\nWHERE oe.charttime LIKE '%12/16/2100%'\n  AND icu.subject_id = 10021487;",
    "7594a1fd06d38d2b7a869964": "",
    "98a679829a4f28ba76a5e3dc": "",
    "184fc5e11e0bfc9be1a0263c": "",
    "9f044b75ba284f6e96d21088": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10010471\n  AND charttime >= '2021-04-11';",
    "06d531ccb4fb7b80b892121f": "SELECT SUM(value) AS total_output_volume\nFROM outputevents\nWHERE subject_id = 10023239\nAND DATE(charttime) = DATE('now', 'start of year', '+6 month', '+29 days');",
    "67c2dbeaea4791e0feb0a69b": "",
    "b71409d570252fbb7bc7ecd0": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10007058 AND charttime >= '2021-03-20';",
    "9cb9aa60b28077c70929769c": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10018501\nAND charttime = (SELECT MAX(charttime) FROM outputevents WHERE subject_id = 10018501);",
    "8cf47ff1a1ec5cf642c7ff41": "SELECT SUM(o.value) AS total_output\nFROM outputevents o\nWHERE o.subject_id = 10020740\nAND DATE(o.charttime) = '2021-04-06';",
    "8223111c9b4bc944555d36a9": "SELECT \n    SUM(ie.totalamount) - SUM(oe.value) AS net_volume\nFROM \n    inputevents ie\nJOIN \n    outputevents oe ON ie.subject_id = oe.subject_id AND ie.hadm_id = oe.hadm_id\nWHERE \n    ie.subject_id = 10020944 \n    AND ie.starttime >= '2021-07-03 00:00:00';",
    "cfc51c8ede5f274642cc55f4": "SELECT \n    (SELECT SUM(totalamount) \n     FROM inputevents \n     WHERE subject_id = 10031404 \n       AND starttime >= '2005-06-01' \n     ) - \n    (SELECT SUM(value) \n     FROM outputevents \n     WHERE subject_id = 10031404 \n       AND charttime >= '2005-06-01' \n     ) AS difference;",
    "1f2e5b03343f0c4f90575af1": "SELECT \n  (SUM(i.totalamount) - SUM(o.value)) AS difference\nFROM \n  inputevents i\nINNER JOIN \n  outputevents o ON i.subject_id = o.subject_id AND i.hadm_id = o.hadm_id\nWHERE \n  i.subject_id = 10038999\n  AND i.starttime LIKE '2022-05-31%'\n  AND o.charttime LIKE '2022-05-31%';",
    "714cfbc303feb382801e761a": "",
    "9e01feccdfca373aaed464f2": "SELECT \n    SUM(i.totalamount) - SUM(o.value) AS net_difference\nFROM \n    inputevents i\nJOIN \n    outputevents o ON i.subject_id = o.subject_id AND i.hadm_id = o.hadm_id AND i.stay_id = o.stay_id\nWHERE \n    i.subject_id = 10021666 \n    AND i.starttime >= '2021-03-27 00:00:00';",
    "1f2b5a242cc55bb7ebee0365": "SELECT \n    SUM(i.totalamount) - SUM(o.value) AS difference\nFROM \n    inputevents i\nJOIN \n    outputevents o ON i.subject_id = o.subject_id AND i.hadm_id = o.hadm_id AND i.stay_id = o.stay_id\nWHERE \n    i.subject_id = 10015272 \n    AND i.starttime >= '2021-08-02 00:00:00'",
    "e64af8ed53f80505d1cf19e3": "SELECT \n    SUM(i.totalamount) - SUM(o.value) AS net_difference\nFROM \n    inputevents i\nJOIN \n    outputevents o ON i.subject_id = o.subject_id\nWHERE \n    i.subject_id = 10021312 \n    AND i.starttime >= DATETIME('now', '-155 days')\n    AND o.charttime >= DATETIME('now', '-155 days');",
    "34c6a8eeee0902700d4a2885": "SELECT \n  ce.charttime, \n  ce.valuenum\nFROM \n  chartevents ce\nWHERE \n  ce.subject_id = 10004422 \n  AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')\n  AND DATE(ce.charttime) = '2022-01-22'\nORDER BY \n  ce.charttime DESC\nLIMIT 1;",
    "ea6a1b775d7a1387dac35ee2": "SELECT ce.valuenum\nFROM chartevents ce\nJOIN icustays i ON ce.hadm_id = i.hadm_id AND ce.stay_id = i.stay_id\nWHERE ce.subject_id = 10003046\n  AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Arterial Blood Pressure (Systolic)')\n  AND i.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10003046)\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "3e69a6b789c8a2c74de0771d": "",
    "550a6a2fb0ecbf40e74fdb86": "SELECT ce.charttime, ce.valuenum AS last_value\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10010471\n  AND di.label = 'O2 saturation Pulseoxymetry'\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "34320356e0e8b8b03cfb94be": "SELECT \n    ce.valuenum AS last_temperature_celsius\nFROM \n    chartevents ce\nWHERE \n    ce.subject_id = 10009035\n    AND ce.valueuom = '\u00b0C'\nORDER BY \n    ce.charttime DESC\nLIMIT 1;",
    "880392e9b0ba16e0c00356d2": "SELECT ce.valuenum\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10021487\n  AND di.label = 'RESPIRATORY RATE'\n  AND DATE(ce.charttime) = '2022-12-20'\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "0e13e0edf9b3f935d475fa33": "SELECT \n  le.valuenum AS last_value\nFROM \n  labevents le\n  INNER JOIN d_labitems li ON le.itemid = li.itemid\nWHERE \n  li.label = 'O2 saturation pulseoxymetry'\n  AND le.subject_id = 10025612\n  AND le.charttime LIKE '2023-10-01%'\nORDER BY \n  le.charttime DESC\nLIMIT 1;",
    "068a6fbca2eb611746f77955": "SELECT MIN(c.valuenum) AS MinimumRespiratoryRate\nFROM chartevents c\nJOIN d_items d ON c.itemid = d.itemid\nWHERE c.subject_id = 10021487\n  AND d.abbreviation = 'RespRate'\n  AND strftime('%Y-%m-%d', c.charttime) = '2023-10-21';",
    "8f13d57ff126b0360f9b38a9": "SELECT MIN(ce.valuenum) AS min_spo2\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10037975\n  AND di.label = 'SpO2'\n  AND ce.charttime BETWEEN '2023-02-10 00:00:00' AND '2023-02-10 23:59:59';",
    "7b7e0d370650fe79de5ab188": "SELECT \n    MIN(ce.valuenum) AS minimum_heart_rate\nFROM \n    chartevents ce\nJOIN \n    patients p ON ce.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10016810\n    AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n    AND ce.charttime >= DATE('now', '-206 days');",
    "fdc3e0fe626d90707f9b9320": "SELECT MAX(ce.valuenum) AS max_heart_rate\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10029291\nAND di.label = 'Heart Rate';",
    "ec946af2d91d7d53d35312e6": "",
    "c002c7dd1abbdad1014192e2": "SELECT AVG(T1.valuenum) AS average_diastolic_blood_pressure\nFROM chartevents AS T1\nINNER JOIN icustays AS T2 ON T1.hadm_id = T2.hadm_id AND T1.stay_id = T2.stay_id\nWHERE T1.subject_id = 10013049 \nAND T1.itemid = 542 \nAND T2.stay_id = (\n  SELECT T3.stay_id \n  FROM icustays AS T3 \n  WHERE T3.subject_id = 10013049 \n  ORDER BY T3.outtime DESC \n  LIMIT 1\n);",
    "c4e3a7be2d01b9b7351a661d": "SELECT MAX(ce.valuenum) AS max_blood_pressure\nFROM chartevents ce\nINNER JOIN admissions a ON ce.hadm_id = a.hadm_id\nWHERE a.subject_id = 10005817 \n  AND ce.charttime >= '2021-08-11' \n  AND ce.itemid IN (\n    SELECT di.row_id \n    FROM d_items di \n    WHERE di.label = 'Blood Pressure (Mean)'\n  );",
    "a5253b5b458dbf9c057541b0": "select the top record.",
    "f03270451ac730c92efdd5b1": "SELECT MAX(admittime) AS last_visit\nFROM admissions\nWHERE subject_id = 10039997;",
    "609e844629d62f94381a53ef": "SELECT MAX(admittime) AS last_admission_time\nFROM admissions\nWHERE subject_id = 10002495;",
    "82fed921fe732e9851109fa0": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10016150\nORDER BY admittime DESC\nLIMIT 1;",
    "c9887571dd618b516d5a3741": "SELECT MIN(admittime) AS first_admission_time\nFROM admissions\nWHERE subject_id = 10003046;",
    "b357f1cf8213ef5655a20b3b": "SELECT MIN(admittime) AS first_admission_time\nFROM admissions\nWHERE subject_id = 10014729;",
    "6a0f9787ca51fccbc44a087c": "SELECT MAX(dischtime) AS last_hospital_visit\nFROM admissions\nWHERE subject_id = 10021938;",
    "44e4b4d97cbe90cf626c4424": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10014729 \n  AND admission_type = 'Physician referral' \nORDER BY admittime DESC \nLIMIT 1;",
    "138fe3a23beda4b897c27c94": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10004457\nORDER BY admittime ASC\nLIMIT 1;",
    "a3b2c1bfc83f38e441791752": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10018845 \n  AND admission_location = 'Emergency Room';",
    "145d13b35f2fd6558b0a9b99": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10007795 \n  AND admission_location = 'Transfer from Hospital' \nORDER BY admittime ASC \nLIMIT 1;",
    "d21ad3ab275f6cb81643201e": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10002930 AND admission_type = 'Physician referral';",
    "be0c83bb4816c62c521f4f19": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10025612 \nAND admission_type = 'Referral';",
    "b20d40188481222bfbb9b02f": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10014078 \nAND admission_location = 'ER' \nORDER BY admittime ASC \nLIMIT 1;",
    "eaf50bee63448bac98063353": "",
    "8264ca08e450da03c5c58c2a": "SELECT MAX(dischtime) AS last_discharge_time\nFROM admissions\nWHERE subject_id = 10012552;",
    "2cdba5b8a95c49f552fbdf57": "SELECT dischtime\nFROM admissions\nWHERE subject_id = 10004235\nORDER BY dischtime DESC\nLIMIT 1;",
    "7e8d5196747ac83500ed63a2": "",
    "4d5c298e863a86919a4a499a": "",
    "be1e758721f63febd66af577": "SELECT MIN(admittime) AS first_leave_time\nFROM admissions\nWHERE subject_id = 10023239;",
    "d6ea3d8ed946d219e8c6b546": "SELECT MAX(ad.dischtime) AS last_discharge_time\nFROM admissions ad\nINNER JOIN patients p ON ad.subject_id = p.subject_id\nWHERE p.subject_id = 10029291;",
    "1300c7d483802a1d509ca6f4": "SELECT \n    JULIANDAY(T1.outtime) - JULIANDAY(T1.intime) AS days_in_icu\nFROM icustays AS T1\nWHERE T1.subject_id = 10019777\nLIMIT 1;",
    "01c32ce2101e22b2dfea210b": "SELECT \n    (strftime('%J', i.outtime) - strftime('%J', i.intime)) AS duration_in_days\nFROM \n    icustays i\nWHERE \n    i.subject_id = 10016810\nORDER BY \n    i.intime DESC\nLIMIT 1;",
    "f632d74fbbe2ef65a5547997": "SELECT \n  (julianday(T2.outtime) - julianday(T2.intime)) AS duration_of_stay\nFROM \n  icustays AS T2\nWHERE \n  T2.subject_id = 10006580\nORDER BY \n  T2.outtime DESC\nLIMIT 1;",
    "e366e701723a7868b82006d6": "SELECT \n  julianday(outtime) - julianday(intime) AS length_of_stay_days\nFROM icustays\nWHERE subject_id = 10025612\nORDER BY intime DESC\nLIMIT 1;",
    "07e1885e41d9b6a449fd69a5": "SELECT \n    julianday(icustays.outtime) - julianday(icustays.intime) AS last_stay_in_days\nFROM \n    icustays\nWHERE \n    icustays.subject_id = 10023239;",
    "461b2614afff7dfabc033d6e": "SELECT \n  julianday(T2.outtime) - julianday(T2.intime) AS days_in_icu\nFROM \n  patients AS T1\nINNER JOIN \n  icustays AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.subject_id = 10022041\nORDER BY \n  T2.outtime DESC\nLIMIT 1;",
    "4c25e26fad35ddcb5d7e1eb0": "SELECT \n  (JULIANDAY(T1.outtime) - JULIANDAY(T1.intime)) AS length_of_stay_days\nFROM \n  icustays AS T1\nWHERE \n  T1.subject_id = 10001725\nORDER BY \n  T1.intime DESC\nLIMIT 1;",
    "c06d5f1b8c8e4396f73f77c8": "",
    "953fa6166e8ed2ab67753af8": "SELECT MAX(starttime) \nFROM prescriptions \nWHERE subject_id = 10008287 AND starttime > '01/2100';",
    "73924b9389e02ce45d9e3c48": "SELECT MAX(starttime) AS latest_prescription_time\nFROM prescriptions\nWHERE subject_id = 10022017 AND starttime >= '2000-04-21';",
    "994ebca608bc1b2f8b1bb1c7": "",
    "0f107c9e56d31b410f4f045c": "SELECT MAX(p.starttime) AS latest_prescription_time\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10020740\nAND a.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10020740\n    ORDER BY admittime ASC\n    LIMIT 1\n);",
    "199101dc32631127e35693a6": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10013049 AND starttime >= '2000-02-21';",
    "f5baeb5fd7062bd570005226": "SELECT MAX(T2.starttime) AS last_prescription_time\nFROM admissions AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10027602;",
    "d4f2dc48d747e43282e99fc7": "SELECT MAX(p.starttime) AS last_prescription_time\nFROM prescriptions p\nINNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.drug = 'quinidine gluconate e.r.'\nAND a.subject_id = 10025463;",
    "9ff61e95883c730111d063bb": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10010471\n  AND drug = '5% DEXTROSE (D5W)'\n  AND starttime > '2021-10-01 00:00:00';",
    "448d117f9de70ed2d4dc414e": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10019172\n  AND drug = 'metoprolol tartrate'\n  AND hadm_id = 102100;",
    "42a6e5d9d3862cee91a004d2": "SELECT MAX(starttime) AS last_prescribed_time\nFROM prescriptions\nWHERE subject_id = 10027602\n  AND drug = 'BISACODYL'\n  AND starttime >= DATE('now', 'start of month')\n  AND starttime < DATE('now', 'start of month', '+1 month');",
    "1763cfe655f1ba381ad8e71e": "",
    "28cf75715d1cf3411a84ca65": "",
    "92d6c5d899dfa362deb44658": "SELECT MIN(starttime) AS first_prescription\nFROM prescriptions\nWHERE subject_id = 10021487\nAND drug = 'heparin'\nAND starttime BETWEEN '2022-12-01' AND '2022-12-31';",
    "2a8fea2a00fcd986cf1b8067": "SELECT MIN(p1.starttime) AS first_prescription_time\nFROM prescriptions p1\nINNER JOIN admissions a ON p1.hadm_id = a.hadm_id\nWHERE a.subject_id = 10018423\nAND p1.starttime IN (\n    SELECT p2.starttime\n    FROM prescriptions p2\n    INNER JOIN admissions a2 ON p2.hadm_id = a2.hadm_id\n    WHERE a2.subject_id = 10018423\n    AND p2.drug IN ('vancomycin', 'ondansetron')\n    GROUP BY p2.starttime\n    HAVING COUNT(DISTINCT p2.drug) = 2\n);",
    "df18089e3b87a2aa47f39d54": "SELECT MAX(T1.starttime) AS last_prescription_time\nFROM prescriptions AS T1\nWHERE T1.subject_id = 10005817 \nAND T1.starttime >= DATE('now', 'start of month')\nAND T1.starttime < DATE('now', 'start of month', '+1 month')\nAND T1.subject_id IN (\n  SELECT T3.subject_id\n  FROM prescriptions AS T3\n  WHERE T3.subject_id = 10005817 \n  AND T3.starttime >= DATE('now', 'start of month')\n  AND T3.starttime < DATE('now', 'start of month', '+1 month')\n  AND T3.drug IN ('Insulin', 'Glucagon')\n  GROUP BY T3.subject_id, strftime('%Y-%m-%d', T3.starttime)\n  HAVING COUNT(DISTINCT T3.drug) = 2\n);",
    "d570690bd00855db57f1e385": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10007058\nAND drug IN ('heparin', '5% dextrose')\nAND starttime >= DATE('now', '-1 month');",
    "21a6fcf7e340c9ff6f9e4eda": "SELECT \n  starttime AS last_prescription_time\nFROM \n  prescriptions\nWHERE \n  subject_id = 10019172 \n  AND drug IN ('0.9% sodium chloride', 'docusate sodium (liquid)')\n  AND starttime >= DATE('now', '-1 month')\nORDER BY \n  starttime DESC\nLIMIT 1;",
    "380a7bc3779d96acb5543281": "SELECT MAX(p.starttime) AS last_prescription_time\nFROM prescriptions p\nWHERE p.subject_id = 10020306\n  AND p.hadm_id IN (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10020306\n    ORDER BY admittime ASC\n    LIMIT 1\n  )\n  AND p.starttime IN (\n    SELECT starttime\n    FROM prescriptions\n    WHERE subject_id = 10020306\n      AND hadm_id IN (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10020306\n        ORDER BY admittime ASC\n        LIMIT 1\n      )\n      AND drug IN ('Glucose Gel', 'Hydrocodone-acetaminophen (5mg-500mg)')\n  )\nGROUP BY p.starttime\nHAVING COUNT(DISTINCT p.drug) = 2;",
    "50ba43b1b326c73868a72835": "",
    "9333b4860f452a4674c02cbc": "SELECT \n    MIN(starttime) AS earliest_start_time\nFROM \n    prescriptions\nWHERE \n    subject_id = 10021118\n    AND starttime >= '2021-03-21'\n    AND drug IN ('Insulin', 'Glucose Gel')\nGROUP BY \n    starttime\nHAVING \n    COUNT(DISTINCT drug) = 2;",
    "f75de59a1a66905c8e18c843": "SELECT starttime\nFROM prescriptions\nWHERE subject_id = 10006580\n  AND starttime >= DATE('now', '-26 months')\n  AND route = 'im'\nORDER BY starttime DESC\nLIMIT 1;",
    "bf8aee434927ad78efbb9c37": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10026255\n  AND route = 'iv'\n  AND starttime >= '2006-01-01';",
    "ba85b4185b40acf102f505e5": "SELECT MAX(starttime) AS last_iv_prescription_time\nFROM prescriptions\nWHERE subject_id = 10022880\n  AND route = 'iv'\n  AND strftime('%m', starttime) = '03'\n  AND strftime('%Y', starttime) = '2100';",
    "9c36c694493cc1a4533c0e35": "SELECT starttime\nFROM prescriptions\nWHERE subject_id = 10010471\nAND starttime >= '2000-08-21'\nAND route = 'iv'\nORDER BY starttime DESC\nLIMIT 1;",
    "9db8bd8eeca37c40ce0282d9": "",
    "0184b4b16596dc35beb98cfd": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10001217\n  AND starttime LIKE '%/%/2023%'\n  AND route IN ('po', 'ng')",
    "4ec0747fdc64218ae8ffc26d": "SELECT MIN(starttime) AS first_pr_starttime\nFROM prescriptions\nWHERE subject_id = 10019172 AND route = 'pr';",
    "314c43e484535c98944bc116": "SELECT MIN(charttime) AS first_lab_test_time\nFROM labevents\nWHERE subject_id = 10005817\nAND charttime >= '2008-08-01';",
    "649fd348e56a70012edf8781": "SELECT \n    l.charttime AS last_lab_test_time\nFROM \n    labevents l\nWHERE \n    l.subject_id = 10009628\n    AND l.charttime BETWEEN '2020-10-01' AND '2020-10-31'\nORDER BY \n    l.charttime DESC\nLIMIT 1;",
    "a991a62ce361a4375831ca50": "",
    "a79380b2785aa5ce66c4b881": "SELECT MAX(l.charttime) AS last_test_time\nFROM labevents l\nWHERE l.subject_id = 10036156 AND l.charttime >= DATE('2007-07-01');",
    "f7e273153edfeb72b98bd9c7": "SELECT \n  MAX(labevents.charttime) AS last_charttime\nFROM \n  labevents\nWHERE \n  labevents.subject_id = 10009628\n  AND strftime('%m', labevents.charttime) = '10'\n  AND strftime('%Y', labevents.charttime) = strftime('%Y', 'now');",
    "5a5fd081d30e9927c3c6dad4": "SELECT MAX(labevents.charttime) AS last_charttime\nFROM labevents\nWHERE labevents.subject_id = 10015931\n  AND labevents.charttime >= DATE('2010-10-21');",
    "8e40479dcfc63f5443fa3003": "SELECT MAX(l.charttime) AS last_charttime\nFROM labevents l\nWHERE l.subject_id = 10006053 AND l.charttime >= '01/2100';",
    "9ae67f8f87f7be444b601b61": "SELECT \n  MIN(c.charttime) AS first_test_time\nFROM \n  chartevents c\nJOIN \n  d_items d ON c.itemid = d.itemid\nWHERE \n  c.subject_id = 10021118\n  AND d.label = 'Bilirubin, Total'\n  AND c.charttime >= '2010-10-21';",
    "c03885ae374eb4c770e9069a": "SELECT\n  l.charttime AS last_charttime\nFROM\n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN labevents l ON a.hadm_id = l.hadm_id\nWHERE\n  p.subject_id = 10031757 \n  AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Alkaline Phosphatase')\nORDER BY\n  l.charttime DESC\nLIMIT 1;",
    "d495fd8395126c8eb2bfc70f": "SELECT MIN(charttime) AS first_charttime\nFROM labevents\nWHERE subject_id = 10022880\nAND charttime BETWEEN '2023-04-01' AND '2023-04-30'\nAND itemid IN (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label LIKE '%chloride%'\n);",
    "576e916cf4beca47606878ba": "SELECT MAX(l.charttime) AS last_test_time\nFROM labevents l\nJOIN d_labitems dl ON l.itemid = dl.itemid\nWHERE l.subject_id = 10016742 AND dl.label = 'pt test';",
    "7dc3347edeff0be3bfeb2b14": "",
    "fd8916330e9d2c2e5b150852": "SELECT T1.charttime\nFROM labevents AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.subject_id = 10027445\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "528d495934e0aadbd47ad1b6": "SELECT \n  MIN(charttime) AS first_charttime\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10021312 \n  AND test_name = 'RDW';",
    "c80160c40fe40760c9ce27b2": "SELECT MIN(charttime) AS first_max_charttime\nFROM labevents\nWHERE subject_id = 10016150\n  AND itemid = (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label = 'LYMPHOCYTES'\n  )\n  AND valuenum = (\n    SELECT MAX(valuenum)\n    FROM labevents\n    WHERE subject_id = 10016150\n      AND itemid = (\n        SELECT itemid\n        FROM d_labitems\n        WHERE label = 'LYMPHOCYTES'\n      )\n  );",
    "d2063048958d7402567becbf": "SELECT MIN(charttime) AS first_max_time\nFROM labevents\nWHERE subject_id = 10037928\n  AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Chloride')\n  AND charttime >= DATE('04/2100')\n  AND valuenum = (\n    SELECT MAX(valuenum)\n    FROM labevents AS sub\n    WHERE sub.subject_id = labevents.subject_id\n      AND sub.itemid = labevents.itemid\n      AND sub.charttime >= DATE('04/2100')\n  );",
    "3701159d655f47f5724c7180": "SELECT MIN(l.charttime) AS last_min_monocytes_time\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10004720 AND d.label = 'Monocytes' AND l.charttime >= '2012-12-21'\nGROUP BY l.charttime\nHAVING MIN(l.valuenum) = (\n    SELECT MIN(valuenum)\n    FROM labevents\n    WHERE subject_id = 10004720 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Monocytes') AND charttime >= '2012-12-21'\n);",
    "0bf8b08208180cf560844cba": "SELECT \n  T1.charttime\nFROM \n  labevents T1\nJOIN \n  d_labitems T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10016810 \n  AND T2.label = 'Phosphate, Minimum'\n  AND strftime('%Y-%m', T1.charttime) = strftime('%Y-%m', 'now')\nORDER BY \n  T1.charttime DESC\nLIMIT 1;",
    "f49e8d99f34677375d3e576d": "SELECT MIN(charttime) \nFROM labevents \nWHERE subject_id = 10029484 \nAND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10029484 ORDER BY admittime DESC LIMIT 1)\nAND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Iron');",
    "327eb60e80b925374560c88e": "SELECT MIN(c.charttime) AS earliest_ferritin_time\nFROM chartevents c\nJOIN d_items d ON c.itemid = d.itemid\nWHERE c.subject_id = 10039708 AND d.label = 'Ferritin - 11/2100'\nORDER BY c.charttime DESC\nLIMIT 1;",
    "9078d39386848fe27cef5f31": "SELECT MIN(charttime)\nFROM labevents\nWHERE subject_id = 10004720\n  AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10004720\n    ORDER BY admittime ASC\n    LIMIT 1\n  )\n  AND itemid = (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label = 'Neutrophils'\n  )\n  AND valuenum = (\n    SELECT MAX(valuenum)\n    FROM labevents\n    WHERE subject_id = 10004720\n      AND hadm_id = (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10004720\n        ORDER BY admittime ASC\n        LIMIT 1\n      )\n      AND itemid = (\n        SELECT itemid\n        FROM d_labitems\n        WHERE label = 'Neutrophils'\n      )\n  );",
    "494282796f9c3fdde2f7b727": "SELECT MIN(charttime) AS first_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10013049;",
    "56ca21bbb266b349bca3f6e5": "SELECT MIN(charttime) \nFROM microbiologyevents \nWHERE subject_id = 10000032 \nAND charttime >= '2000-05-21';",
    "073f2bf50f7338fb5c3bb42b": "SELECT \n    MAX(charttime) AS last_microbiology_test_time\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10039997 AND \n    charttime LIKE '2023-09-%';",
    "eeeb5ecc1778f72724d0534d": "SELECT MIN(charttime) AS first_microbiology_test\nFROM microbiologyevents\nWHERE subject_id = 10010471 AND charttime >= '2000-06-01';",
    "885642fd5ea14ba51403e397": "SELECT MAX(charttime) AS last_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10001725;",
    "499518ffdd4562209632b0e7": "SELECT MAX(charttime) AS last_microbiology_test\nFROM microbiologyevents\nWHERE subject_id = 10002495;",
    "f99580261637ffba691a9a72": "SELECT MIN(charttime) AS first_test_time\nFROM microbiologyevents\nWHERE subject_id = 10010471\n  AND charttime >= DATE('now', '-1 month');",
    "21765b418ac742a54e95ff43": "",
    "031ff26b606f0d58d734256c": "SELECT charttime\nFROM microbiologyevents\nWHERE subject_id = 10031757 AND charttime >= '02/2100'\nORDER BY charttime DESC\nLIMIT 1;",
    "8fc30d6e91b22c5fbe1a138b": "",
    "76a9a991435e9dfbb0590490": "SELECT charttime\nFROM microbiologyevents\nWHERE subject_id = 10019777 AND test_name = 'mrsa screen'\nORDER BY charttime DESC\nLIMIT 1;",
    "58f0822239c07b746c5df6fc": "SELECT MIN(charttime) AS first_mrsa_screen_time\nFROM microbiologyevents\nWHERE subject_id = 10022041\n  AND charttime LIKE '2022-06-%'\n  AND test_name = 'MRSA Screen';",
    "689c016c32621989ea39ef0c": "SELECT charttime\nFROM microbiologyevents\nWHERE subject_id = 10008454\nAND charttime = (\n    SELECT MIN(charttime)\n    FROM microbiologyevents\n    WHERE subject_id = 10008454\n)\nAND test_name = 'Screen Microbiology Test for MRSA';",
    "a88028190c05dd2074203820": "SELECT MAX(charttime) AS last_swab_test_time\nFROM microbiologyevents\nWHERE subject_id = 10005817 AND test_name = 'Staph Aureus Swab';",
    "c503cb58dc8455398570f4a4": "SELECT MAX(starttime) AS last_input_time\nFROM inputevents\nWHERE itemid = (SELECT itemid FROM d_items WHERE label = 'NaCl 0.9%')\n  AND subject_id = 10022880\n  AND starttime LIKE '2023-04-03%';",
    "8ef3a4c7569d9db7872c7fde": "SELECT \n  MIN(starttime) AS first_administration\nFROM \n  inputevents\nWHERE \n  subject_id = 10010471 AND \n  itemid IN (SELECT itemid FROM d_items WHERE label = 'NaCl 0.9%') AND \n  starttime LIKE '2021-12-20%';",
    "5b97eeb5e63797ee9185b85c": "SELECT \n  MIN(starttime) AS first_dose_time\nFROM \n  inputevents\nWHERE \n  subject_id = 10022017 \n  AND itemid = (\n    SELECT \n      itemid \n    FROM \n      d_items \n    WHERE \n      abbreviation = 'D5W'\n  )\n  AND starttime LIKE '%10/03/2100%';",
    "bf8bff577fb09a8df5d3e544": "SELECT MIN(starttime) AS first_po_intake\nFROM inputevents\nWHERE subject_id = 10027445 \n  AND starttime LIKE '2023-09-09%' \n  AND itemid IN (\n    SELECT itemid \n    FROM d_items \n    WHERE label = 'PO Intake'\n  );",
    "7b8dd010ac6d51609aa93314": "SELECT MAX(ie.starttime) AS last_multivitamin_time\nFROM inputevents ie\nJOIN icustays icu ON ie.hadm_id = icu.hadm_id AND ie.stay_id = icu.stay_id\nWHERE ie.subject_id = 10038933 AND ie.itemid = (\n    SELECT itemid \n    FROM d_items \n    WHERE label = 'Multivitamins'\n) AND icu.stay_id = (\n    SELECT MIN(stay_id) \n    FROM icustays \n    WHERE subject_id = 10038933\n);",
    "7c188f76017d685690e33f58": "SELECT starttime \nFROM inputevents \nWHERE subject_id = 10039831 \n  AND starttime > '2021-12-31' \n  AND itemid IN (SELECT itemid FROM d_items WHERE abbreviation IN ('H', 'C')) \nORDER BY starttime DESC \nLIMIT 1;",
    "55c38b5362bf49397a27774e": "",
    "9bbe2a60bf98d234e5825b6d": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10019172\nAND starttime >= DATE('now', 'start of month', '-1 month')\nAND starttime < DATE('now', 'start of month');",
    "9bdee5cb67ac4e91e5b630da": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10008454\n  AND strftime('%Y-%m', starttime) = '2023-04';",
    "5d9fd7530f8b7c30df604ea3": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10004733\nAND starttime LIKE '%12/28/%';",
    "4d8649af3dbd396df7c0075b": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10014354 AND starttime >= '2021-03-20';",
    "3e3acb412956feade24cf02d": "SELECT \n  MAX(starttime) AS last_input_time\nFROM \n  inputevents \nWHERE \n  subject_id = 10015860 AND starttime >= '2003-07-03';",
    "3eb33ba93f9cf1fe30f6a3de": "SELECT \n  MIN(starttime) AS first_input_time\nFROM \n  inputevents\nWHERE \n  subject_id = 10026354 \n  AND starttime >= '2021-07-14';",
    "b6f5c8c63479dc0c781f71d3": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10005817\nAND starttime >= '2021-12-21';",
    "234ef243bc79fbeeafde9f09": "SELECT MIN(c.charttime) AS first_hr_check_time\nFROM chartevents c\nJOIN d_items i ON c.itemid = i.itemid\nWHERE c.subject_id = 10027602\n  AND i.label = 'HEART RATE';",
    "f54a4c50ee67f5dbec1add73": "",
    "176c4a282a56f000735207f8": "SELECT itemid FROM d_items WHERE label LIKE '%heart rate%')\nAND charttime BETWEEN '2019-01-01' AND '2019-12-31';",
    "ae02dd831bcaea6f356e18cb": "select the minimum `charttime` for the lab item with the label 'SpO2' for the given patient subject ID on the specified date.",
    "ec5c2b153da669ee108c8957": "SELECT MAX(ce.charttime) AS last_body_temperature_check\nFROM chartevents ce\nWHERE ce.subject_id = 10021487 AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Body Temperature')\n  AND ce.charttime >= '2021-06-06 00:00:00';",
    "9395b479ccae72fb9bd102d3": "",
    "e5d7989d4180e49d445f9388": "SELECT MIN(ce.charttime) AS first_reading_time\nFROM chartevents ce\nJOIN icustays icu ON ce.stay_id = icu.stay_id\nWHERE ce.subject_id = 10009035\nAND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Systolic BP')\nAND icu.stay_id = (\n    SELECT stay_id FROM icustays WHERE subject_id = 10009035\n    ORDER BY intime ASC\n    LIMIT 1\n);",
    "53761ebb18ac5c642c4f2006": "SELECT MIN(T1.charttime) AS first_time\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T2.label = 'Respiratory Rate'\nAND T1.subject_id = 10010471\nAND T1.charttime LIKE '%2019-10%'\nAND T1.valuenum > 25.0;",
    "7af68876628a4636df61cbce": "",
    "aba2a9f835c596686850b00a": "SELECT MAX(T1.charttime) AS last_record_time\nFROM chartevents T1\nINNER JOIN icustays T2 ON T1.stay_id = T2.stay_id\nWHERE T1.subject_id = 10007818\nAND T1.valuenum < 150.0\nAND T1.valueuom = 'bpm'\nAND T2.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10007818);",
    "687e1ab45a6ab29b54c44861": "SELECT \n  icu.intime AS ICU_Admittance_Time,\n  chart.charttime AS SpO2_Measurement_Time\nFROM \n  icustays icu\nINNER JOIN \n  chartevents chart ON icu.stay_id = chart.stay_id\nWHERE \n  icu.subject_id = 10038999\n  AND icu.stay_id = 1\n  AND chart.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\n  AND chart.valuenum < 96.0\n  AND chart.valueuom = '%'\nORDER BY \n  chart.charttime DESC\nLIMIT 1;",
    "cb2576703363b2124ae28f7c": "SELECT charttime\nFROM chartevents\nWHERE subject_id = 10010471 AND itemid IN (\n    SELECT itemid \n    FROM d_items \n    WHERE label = 'Respiratory Rate'\n) AND valuenum < 27.0 AND DATE(charttime) = '2023-12-20'\nORDER BY charttime ASC\nLIMIT 1;",
    "dcfff42d3b4e18800ea55074": "SELECT \n    MAX(T1.charttime) AS last_charttime\nFROM \n    chartevents AS T1\nINNER JOIN \n    d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.subject_id = 10007818\n    AND T2.label LIKE '%Heart Rate%'\n    AND T1.charttime <= '2100-07-05 00:00:00'\n    AND T1.valuenum < 83.0;",
    "29145deb2421f340268f6323": "SELECT MIN(ce.charttime) AS first_instance_time\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10018081\n  AND di.label = 'Systolic Blood Pressure'\n  AND ce.valuenum > 127.0",
    "b862c7be7085f5768ab9bd66": "",
    "b52f4e22cdd27322676517fc": "SELECT MIN(ce.charttime) AS first_time\nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10004235\n  AND di.label = 'Diastolic Blood Pressure'\n  AND ce.charttime IN (\n    SELECT MAX(ce2.charttime)\n    FROM chartevents ce2\n    INNER JOIN d_items di2 ON ce2.itemid = di2.itemid\n    WHERE ce2.subject_id = 10004235\n      AND di2.label = 'Diastolic Blood Pressure'\n      AND ce2.stay_id IN (\n        SELECT stay_id\n        FROM icustays\n        WHERE subject_id = 10004235\n        ORDER BY outtime DESC\n        LIMIT 1\n      )\n  );",
    "c0b00ebc518d168b79f08eb4": "",
    "9ec14e1d25e50dd996d4e3a7": "SELECT MIN(charttime) \nFROM labevents \nWHERE subject_id = 10004720 \n  AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Temperature') \n  AND valuenum = (SELECT MAX(valuenum) \n                  FROM labevents \n                  WHERE subject_id = 10004720 \n                    AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Temperature'))\n  AND charttime >= DATE('now', '-228 days');",
    "565bd442b074a6efca2e0887": "SELECT \n  l.charttime\nFROM \n  labevents l\nINNER JOIN \n  d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10018081\n  AND d.label = 'Diastolic Blood Pressure'\n  AND l.charttime BETWEEN '2023-12-26 00:00:00' AND '2023-12-26 23:59:59'\n  AND l.valuenum = (\n    SELECT \n      MAX(valuenum)\n    FROM \n      labevents\n    WHERE \n      subject_id = 10018081\n      AND charttime BETWEEN '2023-12-26 00:00:00' AND '2023-12-26 23:59:59'\n      AND itemid = d.itemid\n  )\nLIMIT 1;",
    "b65ad812aa58a875e2d64890": "SELECT MIN(charttime) AS first_max_heart_rate_time\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE chartevents.subject_id = 10038999\n  AND d_items.label = 'Heart Rate'\n  AND chartevents.charttime >= '2000-02-26';",
    "e799539afbf0b691d6a01724": "SELECT MAX(ce.charttime) AS last_max_blood_pressure_time\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10039997\nAND di.label = 'MAP'\nAND ce.valuenum = (\n    SELECT MAX(valuenum)\n    FROM chartevents\n    WHERE subject_id = 10039997\n    AND itemid = (\n        SELECT itemid\n        FROM d_items\n        WHERE label = 'MAP'\n    )\n)",
    "7cf6accf1943c04c3021431d": "SELECT \n    CASE \n        WHEN MAX(a.admittime) > DATE('now', '-1 year') THEN 'Yes'\n        ELSE 'No'\n    END AS came_since_year\nFROM \n    admissions a\nJOIN \n    patients p ON a.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10004422;",
    "fbf6757b5a77304084ba36d9": "",
    "d012dd1a0c9587638828166b": "SELECT CASE WHEN MIN(admittime) > '2100-01-01' THEN 'No' ELSE 'Yes' END AS patient_since_2100\nFROM admissions\nWHERE subject_id = 10015272;",
    "44877f8ac388426e512417e3": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_been_hospitalized\nFROM \n  admissions\nWHERE \n  subject_id = 10021118 AND admission_location LIKE '%2100%';",
    "c73dd80145bee718f2bf509b": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_come_to_hospital\nFROM admissions\nWHERE subject_id = 10005909 AND admittime >= '2100-01-01 00:00:00';",
    "6699cff955e99112f866a2d5": "SELECT \n  COUNT(*) AS num_hospitalizations\nFROM \n  admissions\nWHERE \n  subject_id = 10020740 AND\n  admittime >= DATE('now', 'start of year');",
    "33c6e26e755a5e0efb3a25b9": "",
    "b422362f19ca6957cfa3fb02": "",
    "c3c3a56dc8cd277bd5826031": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS went_to_er\nFROM \n  admissions\nWHERE \n  subject_id = 10007928 \n  AND admission_location = 'E.R.'\n  AND admittime >= DATE('now', '-1 year');",
    "461ed0b2f30a1fe2a7aca6e3": "SELECT DISTINCT a.admission_location = 'Emergency'\nFROM admissions a\nWHERE a.subject_id = 10012853 AND a.admission_location = 'Emergency';",
    "38b8d432b6882df96340f954": "SELECT \n  CASE \n    WHEN COUNT(a.hadm_id) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS admitted\nFROM \n  admissions a\nWHERE \n  a.subject_id = 10008454 \n  AND a.admission_location = 'Emergency Room'\n  AND a.admittime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59';",
    "f020778ee34bfe4318ed4bde": "SELECT \n    CASE \n        WHEN a.admission_location = 'Emergency Room' THEN 'Yes'\n        ELSE 'No'\n    END AS admitted_in_emergency\nFROM \n    admissions a\nWHERE \n    a.subject_id = 10001217\nORDER BY \n    a.admittime ASC\nLIMIT 1;",
    "18827b43fd9e61dcfc5d9388": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS admitted_to_er\nFROM \n  admissions\nWHERE \n  subject_id = 10016810\n  AND admission_location = 'ER'\n  AND admittime >= DATE('now', '-1 year');",
    "e62cc504176c8533a1e60738": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS had_procedure\nFROM \n  procedures_icd pi\nJOIN \n  admissions a ON pi.hadm_id = a.hadm_id\nWHERE \n  a.subject_id = 10018328;",
    "3376a341796a02ddf1d1814f": "SELECT DISTINCT icd.icd_code, d.long_title\nFROM diagnoses_icd icd\nINNER JOIN d_icd_diagnoses d ON icd.icd_code = d.icd_code\nWHERE icd.subject_id = 10021666 AND icd.charttime > '2100-01-01 00:00:00';",
    "0c85596eb9a5ce81b6fb531c": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd\nWHERE subject_id = 10005909\nAND STRFTIME('%Y', charttime) = STRFTIME('%Y', DATE('now')));",
    "36178f6bba63163826d1292a": "",
    "7fbb236187007480210be707": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_procedures\nFROM \n  procedures_icd\nWHERE \n  hadm_id IN (\n    SELECT \n      hadm_id \n    FROM \n      admissions \n    WHERE \n      subject_id = 10023117 \n    ORDER BY \n      admittime ASC \n    LIMIT 1\n  );",
    "d081d7e2db7e69a70b388b51": "selecting the top record.\n3. **Procedures**: We need to check if there are any procedures associated with the admission.",
    "10fd1a4b2a07afed251f289a": "SELECT 'No' AS result\nFROM diagnoses_icd d\nJOIN admissions a ON d.hadm_id = a.hadm_id\nWHERE a.subject_id = 10022017\nLIMIT 1;",
    "bd8736e59f3b5eb724910a84": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Y'\n        ELSE 'N'\n    END AS has_procedure\nFROM \n    procedures_icd AS p\nJOIN \n    d_icd_procedures AS d ON p.icd_code = d.icd_code\nWHERE \n    p.subject_id = 10005909 \n    AND d.long_title = 'Extirpation of matter from left femoral vein, percutaneous approach'\n    AND p.charttime > DATE('now', '-1 year');",
    "889ee571402af73523bd702b": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS result\nFROM \n    procedures_icd p\nJOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n    p.subject_id = 10007818 \n    AND p.charttime >= '2100-01-01'\n    AND d.long_title = 'Extirpation of matter from lung lingula, via natural or artificial opening endoscopic procedure';",
    "0018b73b2eda7611f63bee38": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS had_procedure\nFROM \n  admissions a\n  INNER JOIN procedures_icd p ON a.hadm_id = p.hadm_id\n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n  a.subject_id = 10029291 \n  AND d.long_title = 'Ultrasonography of superior vena cava, guidance';",
    "05a8454a6a71435a557db2cc": "SELECT \n  p.subject_id, \n  pr.drug, \n  pr.dose_val_rx, \n  pr.dose_unit_rx, \n  pr.route \nFROM \n  patients p \n  JOIN prescriptions pr ON p.subject_id = pr.subject_id \nWHERE \n  p.subject_id = 10004733 \n  AND pr.drug = 'CVP Catheter Placement with Guideline' \n  AND pr.route = 'Intravenous';",
    "7ab5610ee5258787397017e1": "SELECT COUNT(*) \nFROM procedures_icd \nWHERE icd_code IN (\n  SELECT icd_code \n  FROM d_icd_procedures \n  WHERE long_title LIKE '%urinary filtration%' \n) \nAND subject_id = 10007818 \nAND hadm_id IN (\n  SELECT hadm_id \n  FROM admissions \n  WHERE admittime >= '2100-01-01' \n)",
    "c8af28411a3f128722567f9e": "SELECT \n  T1.subject_id \nFROM \n  admissions AS T1\n  INNER JOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\n  INNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE \n  T1.subject_id = 10023117 \n  AND T3.long_title = 'Cardiac Resynchronization Defibrillator, Total System (CRT-D)'\n  AND T1.admittime = (\n    SELECT \n      MAX(admittime) \n    FROM \n      admissions \n    WHERE \n      subject_id = 10023117\n  )",
    "75ad6fb522538101f974da54": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_undergone\nFROM \n  procedures_icd p\nJOIN \n  d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n  p.subject_id = 10025463 \n  AND d.long_title = 'Excision or destruction of other lesion or tissue of heart, endovascular approach'\n  AND p.hadm_id IN (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10025463 \n      AND admittime >= '2100-01-01 00:00:00' \n      AND admittime < '2101-01-01 00:00:00'\n  );",
    "6cf60ddb53c69a32d984068c": "SELECT \n  p.drug\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10019777 AND\n  p.hadm_id = (\n    SELECT \n      a.hadm_id\n    FROM \n      admissions a\n    WHERE \n      a.subject_id = 10019777\n    ORDER BY \n      a.admittime\n    LIMIT 1\n  )\nGROUP BY \n  p.drug\nHAVING \n  COUNT(p.drug) >= 2;",
    "fcfa89f08cd7518cc467a635": "SELECT T3.long_title\nFROM diagnoses_icd AS T1\nINNER JOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10002495\nAND T2.charttime BETWEEN '2000-06-21 00:00:00' AND '2020-10-01 23:59:59'\nGROUP BY T3.long_title\nHAVING COUNT(T3.long_title) > 1;",
    "2bd36cdf648a73c1405bc0bd": "SELECT icd_code\nFROM procedures_icd\nWHERE subject_id = 10007795\n  AND charttime >= '2000-01-01 00:00:00'\nGROUP BY icd_code\nHAVING COUNT(icd_code) > 1\nLIMIT 1;",
    "68e68711b24f4ee363da9739": "SELECT \n    T1.long_title AS procedure_name\nFROM \n    d_icd_procedures AS T1\nJOIN \n    procedures_icd AS T2 ON T1.icd_code = T2.icd_code\nWHERE \n    T2.subject_id = 10027602\nGROUP BY \n    T1.long_title\nHAVING \n    COUNT(T2.icd_code) = 2;",
    "080005219b1bf48862540ed2": "SELECT T2.drug\nFROM admissions AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10015860\nAND T1.admittime = (\n  SELECT MAX(admittime)\n  FROM admissions\n  WHERE subject_id = 10015860\n)\nGROUP BY T2.drug\nHAVING COUNT(T2.drug) >= 2;",
    "641bf23b0701d0025cafd597": "SELECT \n  d.long_title AS procedure_name\nFROM \n  procedures_icd p\nINNER JOIN \n  d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n  p.subject_id = 10002495\n  AND p.hadm_id IN (\n    SELECT hadm_id \n    FROM procedures_icd \n    WHERE subject_id = 10002495\n    GROUP BY hadm_id\n    HAVING COUNT(*) >= 2\n  )\nGROUP BY \n  d.long_title\nLIMIT 1;",
    "a868ec00f8a5fa468855f6fd": "SELECT \n  d_icd_procedures.long_title\nFROM \n  procedures_icd\n  INNER JOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE \n  procedures_icd.subject_id = 10021312 \n  AND procedures_icd.charttime > DATE('now', '-10 months')\nGROUP BY \n  procedures_icd.icd_code\nHAVING \n  COUNT(procedures_icd.row_id) > 1;",
    "cc4d6ffe4f9c497d114ffb8f": "SELECT \n  CASE \n    WHEN COUNT(diagnoses_icd.row_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_diagnosis\nFROM \n  patients\n  LEFT JOIN diagnoses_icd ON patients.subject_id = diagnoses_icd.subject_id\nWHERE \n  patients.subject_id = 10036156;",
    "c5110fc62fc9ba15034f6482": "",
    "eda3c6670454f65cad04f15c": "SELECT \n    CASE \n        WHEN COUNT(T2.icd_code) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_diagnosis\nFROM \n    patients T1\nINNER JOIN \n    diagnoses_icd T2 ON T1.subject_id = T2.subject_id\nWHERE \n    T1.subject_id = 10012552;",
    "56765c70e8dbcc6a5ecdaca5": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS HasDiagnosis\nFROM diagnoses_icd\nWHERE subject_id = 10007818 AND charttime >= '2100-01-01';",
    "c73288aeb0cfc184ac029f56": "SELECT COUNT(diagnoses_icd.row_id) AS total_diagnoses\nFROM diagnoses_icd\nINNER JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id\nWHERE admissions.subject_id = 10017492\nAND admissions.hadm_id = (\n  SELECT MIN(hadm_id)\n  FROM admissions\n  WHERE subject_id = 10017492\n);",
    "f209b8c081219def0ef4ace5": "",
    "b11b1fc29cb6a59522daeb8d": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Diagnosis exists'\n    ELSE 'No diagnosis'\n  END AS diagnosis_result\nFROM \n  diagnoses_icd\nWHERE \n  subject_id = 10004733\n  AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10004733 ORDER BY admittime DESC LIMIT 1);",
    "81233148fcdb550533d311a4": "SELECT \n  p.subject_id,\n  d.charttime,\n  d.icd_code\nFROM \n  patients p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nWHERE \n  p.subject_id = 10014354\n  AND d.icd_code = 'G96.0'\n  AND d.charttime >= date('now', '-1 year')\nLIMIT 1;",
    "eaddbd134c399ccf75e4f24e": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_subdural_hemorrhage\nFROM \n  patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n  p.subject_id = 10018845\n  AND (d2.long_title LIKE '%subdural hemorrhage following injury%'\n    AND d2.long_title NOT LIKE '%open intracranial wound%'\n    AND d2.long_title LIKE '%unspecified state of consciousness%');",
    "ad475c1d5ff7b04c88a96e2c": "SELECT CASE \n  WHEN COUNT(*) > 0 THEN 'Yes'\n  ELSE 'No'\nEND AS HasChronicKidneyDisease\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE diagnoses_icd.subject_id = 10015931\n  AND d_icd_diagnoses.long_title LIKE '%Chronic Kidney Disease, stage 3 (moderate)%'\n  AND diagnoses_icd.charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59';",
    "f39c38465d2dfe0e93701a52": "",
    "50b2a084d9984e05d63230db": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y' \n    ELSE 'N' \n  END AS has_anticoagulant_diagnosis\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE diagnoses_icd.subject_id = 10018081\n  AND d_icd_diagnoses.long_title LIKE '%anticoagulant%'\n  AND diagnoses_icd.charttime > '2100-01-01';",
    "23aeb815d2db0889eb0f2b24": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Y' \n        ELSE 'N' \n    END AS received_exam\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE diagnoses_icd.subject_id = 10015931\nAND d_icd_diagnoses.long_title = 'Encounter for examination for normal comparison and control in clinical research program';",
    "48fcb0d1e3395d14eae1e8b2": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Diagnosed' \n    ELSE 'Not Diagnosed' \n  END AS diagnosis_status\nFROM diagnoses_icd\nWHERE subject_id = 10004235 \n  AND icd_code IN ('N18.1', 'N18.2', 'N18.3', 'N18.4', 'N18.5', 'N18.9');",
    "605dc49bacfb0b462cf31880": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10021118\nAND starttime >= '2000-11-01'\nAND drug IN ('docusate sodium', '5% dextrose', 'polyethylene glycol')\nLIMIT 1;",
    "2e4d054961ab8dd569126be6": "SELECT \n    p.subject_id, \n    pr.drug, \n    pr.starttime, \n    pr.stoptime\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10021487 AND pr.drug IN ('Acetazolamide', 'Bisacodyl', '5% Dextrose');",
    "c6e32087897377afc707821c": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS has_been_prescribed\nFROM prescriptions\nWHERE subject_id = 10022880\n  AND starttime >= '2100-01-01'\n  AND drug IN ('heparin', 'iso-osmotic dextrose', 'milk of magnesia');",
    "03aa2747a4bbb38e1e9ccb85": "SELECT \n    p.subject_id,\n    CASE\n        WHEN pr.drug IN ('lisinopril', 'vitamin d', 'lenalidomide') AND pr.dose_val_rx = '15mg' THEN 'Yes'\n        ELSE 'No'\n    END AS is_prescribed\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10003400 \n    AND pr.hadm_id = (\n        SELECT hadm_id \n        FROM admissions \n        WHERE subject_id = 10003400 \n        ORDER BY admittime \n        LIMIT 1\n    );",
    "977a6055c6232b7e550211d6": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS drug_administered\nFROM \n    prescriptions p\nWHERE \n    p.subject_id = 10011398 AND\n    p.starttime >= '2012-12-21' AND\n    p.drug IN ('Ibuprofen', 'Ondansetron', 'Insulin Human Regular');",
    "8575a4d0318c42ed703a89a1": "SELECT \n  T1.subject_id \nFROM \n  admissions AS T1 \n  INNER JOIN inputevents AS T2 ON T1.hadm_id = T2.hadm_id \nWHERE \n  T1.subject_id = 10015931 \n  AND T2.itemid = (SELECT itemid FROM d_items WHERE label = '5% DEXTROSE') \n  AND T2.itemid = (SELECT itemid FROM d_items WHERE label = 'GLUCOSE GEL') \n  AND T2.itemid = (SELECT itemid FROM d_items WHERE label = 'ONDANSETRON') \n  AND T2.starttime BETWEEN '2012-12-21 00:00:00' AND '2012-12-21 23:59:59';",
    "b66ed8145c0b562f96f32f22": "SELECT \n  MAX(CASE WHEN p.drug = 'Sodium Chloride 0.9%' THEN 1 ELSE 0 END) AS sodium_chloride,\n  MAX(CASE WHEN p.drug = 'Levetiracetam' THEN 1 ELSE 0 END) AS levetiracetam,\n  MAX(CASE WHEN p.drug = 'Bag' THEN 1 ELSE 0 END) AS bag\nFROM prescriptions p\nWHERE p.subject_id = 10038933\n  AND p.starttime >= '2100-01-01';",
    "9a16562e6c22fbc3ecf55004": "SELECT \n  p.subject_id, \n  pr.drug\nFROM \n  patients p\n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  p.subject_id = 10031404\n  AND pr.starttime >= '2000-08-01'\n  AND pr.starttime <= '2000-08-31';",
    "d60412f228f0e3b6df5b6d8c": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10021312 AND starttime >= '2003-03-21';",
    "b07f1b0cf6f5838302e27ea2": "SELECT \n  CASE \n    WHEN COUNT(T1.drug) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS medication_administered\nFROM \n  prescriptions T1\nWHERE \n  T1.subject_id = 10005866 \n  AND T1.hadm_id = (SELECT MAX(T2.hadm_id) \n                    FROM admissions T2 \n                    WHERE T2.subject_id = 10005866);",
    "407ffa4fc0b1f6b83c6a90e4": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS received_medication\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10027445 \n  AND p.starttime >= DATE('now', '-17 months');",
    "6b7a85cc61dd82548ef2f988": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_received_drug\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10040025\n  AND p.starttime >= DATE('now', '-1 year')\n  AND p.starttime < DATE('now', 'start of month', '+1 month', '-1 day');",
    "fdc9e1c2af088aa194e9faa5": "SELECT \n  p.subject_id,\n  pr.drug,\n  pr.starttime,\n  pr.stoptime\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n  p.subject_id = 10005817\n  AND pr.starttime >= DATE('now', '-1 year')\n  AND pr.starttime <= DATE('now', 'start of month', '-1 day');",
    "7e472b43cb7c281ea7ad2326": "SELECT \n  CASE \n    WHEN COUNT(T2.hadm_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS medication_administered\nFROM \n  patients AS T1\n  LEFT JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id AND T2.hadm_id = (\n    SELECT MAX(hadm_id) \n    FROM admissions \n    WHERE subject_id = T1.subject_id\n  )\nWHERE \n  T1.subject_id = 10016150;",
    "ab2aad38b2169268cce19216": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_midazolam\nFROM \n  prescriptions\nWHERE \n  subject_id = 10019172\n  AND drug LIKE '%midazolam%';",
    "732ddbd8735aa1ef150a5da1": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS lidocaine_1_percent_administered\nFROM \n    prescriptions\nWHERE \n    subject_id = 10004733\n    AND drug = 'Lidocaine 1%';",
    "cc187d8a2ecb0abb9fd2ff92": "SELECT \n    p.subject_id,\n    p.hadm_id,\n    p.starttime,\n    p.stoptime,\n    p.drug,\n    p.dose_val_rx,\n    p.dose_unit_rx,\n    p.route\nFROM \n    prescriptions p\nWHERE \n    p.subject_id = 10004733 AND \n    p.starttime >= '12/21/2000' AND \n    p.drug = 'Clonidine Patch 0.3 mg/24 hr';",
    "dab078420665e61aa6883a1d": "SELECT \n  p.subject_id, \n  pr.drug, \n  pr.dose_val_rx, \n  pr.dose_unit_rx, \n  pr.route \nFROM \n  patients p \n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id \nWHERE \n  p.subject_id = 10021666 \n  AND pr.drug = 'Potassium Chl 20 Meq/1000 MlNs' \n  AND pr.starttime >= '2100-01-01' \n  AND pr.stoptime <= '2100-12-31';",
    "b3baba0d3d4a30996c8d7040": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS Has_Glucose_Gel_Prescription\nFROM \n  prescriptions \nWHERE \n  subject_id = 10020944 \n  AND drug = 'Glucose Gel' \n  AND starttime <= '2000-03-31 23:59:59' \n  AND stoptime >= '2000-03-01 00:00:00';",
    "29ea8f3acec04ab1a79ac191": "",
    "f4d19ba764d6773617847b52": "",
    "2b3268beab056ff505b05347": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS has_tested\nFROM labevents \nWHERE subject_id = 10029291 \nAND charttime >= '2001-01-01';",
    "d2926f4a0d345771d9cecb6a": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS received_lab_tests\nFROM \n  labevents\nWHERE \n  subject_id = 10031757 \n  AND charttime >= DATE('now', '-15 months');",
    "d9f1d82756382ceba0364eb7": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 1 \n        ELSE 0 \n    END AS has_lab_test\nFROM \n    labevents \nWHERE \n    subject_id = 10020786 \n    AND charttime >= DATE('now', 'start of year');",
    "9957eec4f3658a2214f701c9": "select the `label` column from the `d_labitems` table to determine the lab test.",
    "82c55832a756019258539f9d": "SELECT \n  CASE \n    WHEN COUNT(l.row_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_undergone_test\nFROM \n  patients p\n  INNER JOIN labevents l ON p.subject_id = l.subject_id\nWHERE \n  p.subject_id = 10018423 AND l.charttime > '2100-01-01';",
    "1a8e264083c39ca2b5c9bc74": "SELECT \n  MAX(l.charttime) AS last_test_time\nFROM \n  labevents l\nWHERE \n  l.subject_id = 10018423 \n  AND l.charttime >= DATE('now', '-1 year');",
    "be808f9b9ff6628170faba78": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_lab_test\nFROM \n    labevents\nWHERE \n    subject_id = 10019172\n    AND strftime('%m', charttime) = '11'\n    AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "7c0a9c949c9ec7ff63c270ae": "",
    "4ec3447b9f00804b8d0a3da0": "SELECT COUNT(*) \nFROM labevents \nWHERE subject_id = 10014729 \nAND charttime > '2100-01-01'\nAND itemid IN (SELECT itemid FROM d_labitems WHERE label LIKE '%Base Excess%')",
    "d68bcea40377baf01b112ced": "SELECT\n  CASE\n    WHEN COUNT(l.itemid) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_tested_albumin\nFROM\n  labevents l\nWHERE\n  l.subject_id = 10007818\n  AND l.charttime >= DATE('now', '-1 year')\n  AND l.itemid IN (\n    SELECT d.itemid\n    FROM d_labitems d\n    WHERE d.label = 'Albumin'\n  );",
    "f53166032d928995607d2fc9": "SELECT \n  CASE \n    WHEN T1.subject_id = 10016742 THEN 'Yes'\n    ELSE 'No'\n  END AS result\nFROM \n  labevents T1\n  INNER JOIN d_labitems T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10016742\n  AND strftime('%Y/%m', T1.charttime) = '2100/07'\n  AND T2.label LIKE '%Creatinine, Urine Test%'\nLIMIT 1;",
    "97a7eba99e8adfa9dfe8aaca": "",
    "6f9ec204cf2995a0808955b7": "SELECT \n  CASE \n    WHEN LE.row_id IS NOT NULL THEN 'Yes'\n    ELSE 'No'\n  END AS lab_test_results\nFROM \n  admissions A\n  LEFT JOIN labevents LE ON A.hadm_id = LE.hadm_id\n  LEFT JOIN d_labitems LI ON LE.itemid = LI.itemid\nWHERE \n  A.subject_id = 10029291\n  AND LI.label = 'ck-mb index'\nLIMIT 1;",
    "26fa750dccd4c284472ecb48": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS received_test\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.subject_id = 10025463 \n  AND labevents.charttime >= DATE('now', '-1 month')\n  AND d_labitems.label = 'Chloride test';",
    "c8c821f2bce77aa592def2d7": "SELECT \n  MAX(CASE WHEN charttime >= DATE('now', '-24 months') THEN 1 ELSE 0 END) AS has_recent_test_results\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10005348;",
    "c0193e5f3d01df8825ae0a53": "Select records from the `microbiologyevents` table.\n2. Filter records where `subject_id` matches the given patient ID.\n3. Ensure the `charttime` is on or after April 21, 2000.\n4. Since the question asks for the existence of tests, we can use an EXISTS clause.",
    "6e5cae3a2758b55ff0bbfc87": "",
    "4a8bec0e16a11e2197448c3b": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS any_microbial_tests\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10038933 \n  AND charttime BETWEEN DATE('now', '-1 year') AND DATE('now');",
    "adfdf07d99e741f927fb639b": "Select the relevant columns from the relevant table, and apply the necessary conditions.",
    "1abc175490e91fdbe78482fb": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS HasMicrobiologyTest\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10001217 \n  AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "1c70ab701577302fd7bec691": "SELECT COUNT(*) > 0 AS has_microbiology_tests\nFROM microbiologyevents\nWHERE subject_id = 10006053\n  AND charttime >= '2021-09-01';",
    "4f4a3bef12490dacc3837b15": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes' \n         ELSE 'No' \n       END AS result\nFROM microbiologyevents\nWHERE subject_id = 10002495\n  AND test_name = 'First urine test'\n  AND org_name IS NOT NULL\n  AND strftime('%m', charttime) = '06'\n  AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "987c4c9f04e411a9be21bae2": "SELECT \n  CASE \n    WHEN COUNT(m.org_name) > 0 THEN 'Organism found'\n    ELSE 'No organism found'\n  END AS result\nFROM \n  microbiologyevents m\nWHERE \n  m.subject_id = 10007795\n  AND m.charttime >= DATE('now')\n  AND m.test_name LIKE '%abscess%';",
    "128670f0128422d00c359ab0": "SELECT \n    CASE \n        WHEN COUNT(m.org_name) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_organism_been_found\nFROM \n    microbiologyevents m\nWHERE \n    m.subject_id = 10005348\n    AND m.charttime >= DATE('now', '-1 year')\n    AND m.spec_type_desc LIKE '%Blood Culture%'\n    AND m.test_name LIKE '%First Test%'\n    AND m.org_name IS NOT NULL;",
    "2001cff617f1e7a9c0034942": "SELECT \n  MAX(CASE WHEN me.spec_type_desc = 'First Blood Culture' THEN me.charttime END) AS first_blood_culture_time\nFROM \n  microbiologyevents me\nWHERE \n  me.subject_id = 10010471 AND \n  me.charttime >= '2000-09-21 00:00:00';",
    "1478b8ca5010dfa67a0ce559": "SELECT COUNT(*) > 0 AS has_organism\nFROM microbiologyevents\nWHERE subject_id = 10007928\n  AND test_name = 'Serology/ Blood Test'\n  AND org_name IS NOT NULL;",
    "ec96517b92997f0de9c0bbbe": "SELECT \n  CASE \n    WHEN MIN(CASE WHEN org_name IS NOT NULL THEN 1 ELSE 0 END) = 1 THEN 'Yes'\n    ELSE 'No'\n  END AS any_organism_found\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10002428 \n  AND charttime > DATE('now', '-1 year') \n  AND spec_type_desc LIKE '%Blood Culture%';",
    "623a4a91b019a3f07aa9fbb9": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS has_organism\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10012552 \n    AND test_name = 'First Staph Aureus Swab'\n    AND org_name IS NOT NULL\n    AND strftime('%m', charttime) = '04'\n    AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "8ad3bd73b83b2ac224da4fdb": "SELECT CASE \n           WHEN COUNT(*) > 0 THEN 'Yes'\n           ELSE 'No'\n       END AS has_been_administered\nFROM inputevents\nWHERE subject_id = 10007058\nAND starttime >= '2100-10-01 00:00:00';",
    "422b6f9b75c44635d538e4ce": "",
    "e53e5f3db28341b88fe8d653": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_input\nFROM \n  (\n    SELECT \n      i.subject_id,\n      i.hadm_id,\n      i.stay_id,\n      i.itemid,\n      i.totalamount,\n      i.totalamountuom,\n      i.starttime,\n      i.itemid\n    FROM \n      inputevents i\n      INNER JOIN icustays c ON i.stay_id = c.stay_id\n    WHERE \n      c.subject_id = 10029291\n    ORDER BY \n      c.intime\n    LIMIT 1\n  ) AS first_icu_stay\nWHERE \n  first_icu_stay.totalamount > 0;",
    "561e8b21d83aed1d199886d6": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_been_administered\nFROM \n  prescriptions\nWHERE \n  subject_id = 10027602 AND \n  drug = 'dextrose 5%' AND \n  starttime >= '2000-02-21';",
    "e84f32d4fad193387ab842e2": "select based on the `subject_id`, `drug`, and `starttime` conditions. The date format should be adjusted to match the expected format in the `starttime` field.",
    "e6ac4f454e0ced3ae3ac6332": "SELECT \n    subject_id,\n    starttime\nFROM \n    inputevents\nWHERE \n    subject_id = 10006053\n    AND starttime LIKE '2022-11-16%'\n    AND itemid IN (\n        SELECT itemid \n        FROM d_items \n        WHERE label LIKE '%platelets%'\n    );",
    "f67fb672b995cf406d9a11a1": "SELECT \n  CASE \n    WHEN ie.totalamount > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS crystalloid_administered\nFROM \n  inputevents ie\n  INNER JOIN icustays icu ON ie.stay_id = icu.stay_id\nWHERE \n  ie.subject_id = 10035185\n  AND ie.itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%crystalloid%')\n  AND icu.stay_id = (\n    SELECT MIN(stay_id) \n    FROM icustays \n    WHERE subject_id = 10035185\n  );",
    "58a8117dba6b4ae43b573d05": "SELECT \n  test_name AS urine_test_name\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10026354\n  AND charttime >= '2004-10-04'\n  AND test_name LIKE '%urine%';",
    "66226330040dffdd0d5fd903": "SELECT subject_id, itemid, starttime, totalamount, totalamountuom\nFROM inputevents\nWHERE subject_id = 10015931\nAND starttime LIKE '2023-12-09%';",
    "471c207da5409f3275cc20cb": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_event\nFROM \n    outputevents oe\nJOIN \n    d_items di ON oe.itemid = di.itemid\nWHERE \n    oe.subject_id = 10011398 \n    AND di.label = 'Chest Tube #1';",
    "e58ee0e5c472679a4d86b25e": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS had_foley\nFROM \n  inputevents ie\nJOIN \n  d_items di ON ie.itemid = di.itemid\nWHERE \n  ie.subject_id = 10022017 AND \n  di.label = 'Foley Catheter' AND \n  ie.starttime BETWEEN '2023-10-03 00:00:00' AND '2023-10-03 23:59:59';",
    "0c5849747818dd64e3090cd8": "SELECT 'Emesis did occur' AS result\nFROM outputevents o\nWHERE o.subject_id = 10025612 \n  AND DATE(o.charttime) = '2023-10-02' \n  AND o.itemid = (SELECT itemid FROM d_items WHERE label = 'Emesis')\nUNION ALL\nSELECT 'Emesis did not occur' AS result\nWHERE NOT EXISTS (\n  SELECT 1 \n  FROM outputevents o \n  WHERE o.subject_id = 10025612 \n    AND DATE(o.charttime) = '2023-10-02' \n    AND o.itemid = (SELECT itemid FROM d_items WHERE label = 'Emesis')\n);",
    "cea5a40f3d9844b4ee58041d": "SELECT\n    CASE\n        WHEN COUNT(*) > 0 THEN 'Y'\n        ELSE 'N'\n    END AS has_procedure\nFROM\n    procedures_icd p\nJOIN\n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE\n    p.subject_id = 10013049\n    AND strftime('%m', p.charttime) = '06'\n    AND strftime('%d', p.charttime) = '21'\n    AND d.long_title = 'Oral gastric';",
    "40de69e222a145027e4f2169": "SELECT \n    labevents.charttime,\n    labevents.valuenum\nFROM \n    labevents\nJOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10029291\n    AND d_labitems.label = 'Diastolic Blood Pressure'\n    AND labevents.charttime BETWEEN '2100-03-01' AND '2100-03-31'\n    AND labevents.valuenum BETWEEN 60 AND 120;",
    "41e5c617af3a91492dc2e3d0": "SELECT \n  CASE \n    WHEN ce.valuenum > 0.9 THEN 'Normal' \n    ELSE 'Abnormal' \n  END AS spo2_status\nFROM \n  patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  JOIN chartevents ce ON a.hadm_id = ce.hadm_id\nWHERE \n  p.subject_id = 10016742\n  AND ce.itemid = 1 \n  AND ce.charttime = (\n    SELECT MAX(ce2.charttime)\n    FROM chartevents ce2\n    WHERE ce2.subject_id = p.subject_id\n      AND ce2.hadm_id = a.hadm_id\n      AND ce2.itemid = 1\n  );",
    "97551740a3b364d8e2b6214c": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN itemid = 12345 THEN valuenum ELSE NULL END) <= 24 THEN 'Normal'\n    ELSE 'Abnormal'\n  END AS respiratory_rate\nFROM chartevents\nWHERE subject_id = 10018081 \n  AND charttime LIKE '%12/29/%'\n  AND itemid = 12345;",
    "b23b961d0f2fe2cf1eec5a22": "SELECT \n    CASE \n        WHEN ce.valuenum BETWEEN 60 AND 100 THEN 'Normal'\n        ELSE 'Abnormal'\n    END AS heart_rate_status\nFROM chartevents ce\nINNER JOIN admissions a ON ce.hadm_id = a.hadm_id\nWHERE \n    ce.subject_id = 10019777 \n    AND ce.itemid = (\n        SELECT itemid \n        FROM d_items \n        WHERE label = 'Heart Rate'\n    )\n    AND a.hadm_id = (\n        SELECT MIN(hadm_id) \n        FROM admissions \n        WHERE subject_id = 10019777\n    );",
    "9a2f8970fbd241c4a1994704": "SELECT\n    CASE\n        WHEN MIN(ie.totalamount) >= 60 AND MAX(ie.totalamount) <= 100 THEN 'Normal'\n        ELSE 'Abnormal'\n    END AS heart_rate_status\nFROM\n    inputevents ie\nINNER JOIN\n    d_items di ON ie.itemid = di.itemid\nWHERE\n    ie.subject_id = 10015931 AND\n    di.label = 'Heart Rate' AND\n    ie.starttime >= '2010-10-21 00:00:00';",
    "9e463af82f31adb188a12310": "SELECT \n  ce.charttime,\n  ce.valuenum\nFROM \n  chartevents ce\nJOIN \n  d_items di ON ce.itemid = di.itemid\nWHERE \n  ce.subject_id = 10021118 AND \n  di.label LIKE 'Body Temperature%' AND \n  ce.charttime BETWEEN '2022-12-24' AND '2022-12-24';",
    "b8e813ddf11159fa6c4ca4ca": "SELECT \n  CASE \n    WHEN ce.valuenum >= 95 AND ce.valuenum <= 100 THEN 'Normal'\n    ELSE 'Abnormal'\n  END AS spo2_status\nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  ce.subject_id = 10007818\n  AND ce.charttime LIKE '2023-07-08%'\n  AND di.label = 'SpO2';",
    "d90596b35371ba4a84a1a128": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10020187\nAND admittime >= '2023-01-01'\nAND admittime < '2024-01-01';",
    "2fe2de5ecc04ecf656ea58f3": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10023117\nAND admittime >= DATE('now', '-1 year');",
    "0980045acad692ba2a8996db": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10016742\nAND admittime >= '2100-01-01 21:00:00';",
    "05ac3a771a3724d766be2218": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10018423 AND strftime('%Y', admittime) = '2100';",
    "89880a69f1f260cad697501f": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10038999 \n  AND admittime >= DATE('now', 'start of year');",
    "fcb5ab40c54f3bce352480bc": "",
    "bee55ba67d6da489306ff469": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10035185;",
    "b9c136c1e1d19649caabdeb4": "SELECT \n    strftime('%Y-%m', charttime) AS month,\n    AVG(valuenum) AS average_bilirubin\nFROM \n    labevents\nWHERE \n    subject_id = 10021487\n    AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'BILIRUBIN, DIRECT')\n    AND charttime >= '2005-01-01'\nGROUP BY \n    month\nORDER BY \n    month ASC;",
    "ab28063625f4ba14b3379479": "SELECT SUM(yearly_min_protein) AS total_protein\nFROM (\n  SELECT MIN(labevents.valuenum) AS yearly_min_protein\n  FROM patients\n  INNER JOIN admissions ON patients.subject_id = admissions.subject_id\n  INNER JOIN labevents ON admissions.hadm_id = labevents.hadm_id\n  WHERE patients.subject_id = 10035185\n  AND labevents.itemid = 1  -- Assuming itemid 1 corresponds to protein measurements\n  AND labevents.charttime BETWEEN admissions.admittime AND admissions.dischtime\n  GROUP BY strftime('%Y', labevents.charttime)\n) AS yearly_protein_totals;",
    "abd48dc45ba90022382e02c9": "SELECT \n  strftime('%Y-%m', charttime) AS month, \n  AVG(valuenum) AS avg_creatinine\nFROM \n  labevents\nWHERE \n  subject_id = 10021666 AND \n  itemid = 2100\nGROUP BY \n  strftime('%Y-%m', charttime)\nORDER BY \n  month;",
    "4ea43bff9e1b8d9f142a816d": "SELECT \n  strftime('%Y', T1.charttime) AS year,\n  MIN(T1.valuenum) AS min_mcv\nFROM \n  chartevents T1\nJOIN \n  d_items T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10021118\n  AND T2.label LIKE '%mcv%'\n  AND strftime('%Y', T1.charttime) >= '2000'\nGROUP BY \n  strftime('%Y', T1.charttime);",
    "7a60c2c50fa3345765a83271": "SELECT MIN(valuenum) AS minimum_lipase_level\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10038999\nAND d_labitems.label = 'Lipase in Blood'\nAND strftime('%Y-%m', labevents.charttime) = '2100-01';",
    "acc9bade197c3728c67fcdd7": "SELECT \n  MIN(le.valuenum) AS minimum_bilirubin\nFROM \n  labevents le\n  INNER JOIN admissions a ON le.hadm_id = a.hadm_id\nWHERE \n  le.itemid = (SELECT itemid FROM d_labitems WHERE label = 'BILIRUBIN, DIRECT') \n  AND a.subject_id = 10021487",
    "249619a43d4c7fe7add673f1": "SELECT \n  strftime('%Y', le.charttime) AS year, \n  MAX(le.valuenum) AS max_ld\nFROM labevents le\nINNER JOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10038933\nAND li.label = 'lactate dehydrogenase (ld)'\nAND strftime('%Y', le.charttime) > '2100'\nGROUP BY strftime('%Y', le.charttime)\nORDER BY strftime('%Y', le.charttime);",
    "c0faf3e95f2c2000bdda5a2e": "SELECT \n  strftime('%Y-%m', ce.charttime) AS month,\n  AVG(ce.valuenum) AS average_weight\nFROM \n  chartevents ce\n  INNER JOIN admissions a ON ce.hadm_id = a.hadm_id\nWHERE \n  ce.subject_id = 10036156 AND a.hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10036156 \n    ORDER BY admittime ASC \n    LIMIT 1\n  )\n  AND ce.itemid = (\n    SELECT itemid \n    FROM d_items \n    WHERE label = 'Weight'\n  )\nGROUP BY \n  strftime('%Y-%m', ce.charttime)\nORDER BY \n  month;",
    "fa0c00e540e79ae2f208cdee": "SELECT AVG(valuenum) AS average_weight\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10038933\n  AND di.label = 'Patient Weight (Weight)'\n  AND ce.charttime >= (\n    SELECT MAX(admittime)\n    FROM admissions\n    WHERE subject_id = 10038933\n  );",
    "996258522002126afaf5a3c0": "SELECT \n    DATE(e.charttime) AS date, \n    MIN(e.valuenum) AS min_weight\nFROM \n    chartevents e\nINNER JOIN \n    d_items i ON e.itemid = i.itemid\nWHERE \n    e.subject_id = 10027445\n    AND e.charttime > '2100-01-01'\n    AND i.label = 'Weight'\n    AND e.valueuom = 'kg'\nGROUP BY \n    DATE(e.charttime);",
    "42d490e9dcc8cd200649d0ff": "",
    "e8a376ca7f202983221786bd": "SELECT MAX(T1.valuenum) AS max_weight\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10018081 \n  AND T2.label = 'Weight'\n  AND T1.charttime >= '2021-11-21';",
    "b029fa60f795c16ffec2ddf9": "SELECT \n    DATE(c.charttime) AS date, \n    AVG(c.valuenum) AS average_weight\nFROM \n    chartevents c\nJOIN \n    patients p ON c.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10021487 \n    AND c.charttime >= DATE('now', '-16 months')\n    AND c.itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\nGROUP BY \n    DATE(c.charttime);",
    "230b50a3e6a330e4047ecfd0": "SELECT \n  strftime('%Y-%m-%d', c.charttime) AS date, \n  AVG(c.valuenum) AS average_weight\nFROM \n  chartevents c\nINNER JOIN \n  d_items d ON c.itemid = d.itemid\nWHERE \n  c.subject_id = 10014729 AND \n  d.label = 'Weight' AND \n  strftime('%m', c.charttime) = '03' AND \n  strftime('%Y', c.charttime) = '2000'\nGROUP BY \n  strftime('%Y-%m-%d', c.charttime);",
    "8a5a5d29e1a51c172836525e": "SELECT \n    strftime('%Y', i.charttime) AS year,\n    AVG(i.totalamount) AS avg_po_intake\nFROM \n    inputevents i\nJOIN \n    d_items di ON i.itemid = di.itemid\nWHERE \n    i.subject_id = 10020740 AND\n    di.label = 'PO intake' AND\n    i.charttime >= '2021-01-25'\nGROUP BY \n    strftime('%Y', i.charttime);",
    "c37d80a17e1432e62f2c945c": "SELECT \n  strftime('%Y-%m', i.starttime) AS month,\n  AVG(i.totalamount) AS average_intake\nFROM \n  inputevents i\nWHERE \n  i.subject_id = 10005909\n  AND i.hadm_id = 1\n  AND i.itemid IN (\n    SELECT itemid FROM d_items WHERE label LIKE '%PO%'\n  )\nGROUP BY \n  month;",
    "4811bca64998a864d6db6bc5": "SELECT DATE(starttime) AS intake_date, MAX(totalamount) AS max_daily_intake\nFROM inputevents\nWHERE subject_id = 10000032 AND totalamountuom = 'mg' AND itemid IN (\n    SELECT itemid FROM d_items WHERE abbreviation = 'PO'\n)\nGROUP BY DATE(starttime)\nORDER BY intake_date;",
    "53d67e5afb0eef3231919c0e": "",
    "5edb24fc6b54aabb2e6f6f5c": "SELECT MAX(T1.totalamount) AS max_totalamount\nFROM inputevents T1\nJOIN d_items T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10039831\n  AND T1.starttime >= '2021-12-05'\n  AND T2.label = 'packed rbc intake';",
    "4e02c94268e273ceadb20be5": "SELECT strftime('%Y-%m', starttime) AS month, SUM(totalamount) AS total_dose\nFROM inputevents\nWHERE subject_id = 10005817 \n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Magnesium Sulfate (Bolus)')\n  AND starttime >= '2000-12-06'\nGROUP BY month\nHAVING SUM(totalamount) > 0;",
    "e9a0e7111e770b55741de154": "SELECT \n    strftime('%Y-%m', p.starttime) AS month,\n    AVG(p.dose_val_rx) AS average_dose\nFROM \n    prescriptions p\nWHERE \n    p.subject_id = 10021487\n    AND p.starttime >= '2010-10-01'\n    AND p.drug = 'peptamen bariatric (full)'\nGROUP BY \n    strftime('%Y-%m', p.starttime)\nORDER BY \n    month;",
    "8a0c7a7faca024a1eb4dd993": "SELECT \n    DATE(charttime) AS date,\n    MAX(valuenum) AS max_respiratory_rate\nFROM \n    chartevents\nWHERE \n    subject_id = 10010471\n    AND itemid = (SELECT row_id FROM d_items WHERE label = 'Respiratory Rate')\n    AND charttime >= DATE('now', '-14 days')\nGROUP BY \n    DATE(charttime);",
    "2783cbb5eccb2b4d0c78a1e0": "SELECT \n    DATE(l.charttime) AS date, \n    MAX(l.valuenum) AS max_systolic_bp\nFROM \n    labevents l\nJOIN \n    admissions a ON l.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10003046\n    AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Systolic Blood Pressure')\nGROUP BY \n    DATE(l.charttime);",
    "dca7f0863bc05ed189b1b292": "SELECT \n  strftime('%Y-%m', charttime) AS month,\n  MAX(valuenum) AS max_systolic_bp\nFROM \n  chartevents\n  INNER JOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE \n  chartevents.subject_id = 10039831 \n  AND chartevents.charttime >= '2100-02-25'\n  AND d_items.label = 'Systolic BP'\nGROUP BY \n  strftime('%Y-%m', charttime)\nORDER BY \n  month;",
    "e1d0b53beabc24ec45e07b2d": "",
    "f5f18cb5c4dd940a95ec5360": "WITH LastICUStay AS (\n    SELECT MAX(stay_id) AS last_stay_id\n    FROM icustays\n    WHERE subject_id = 10011398\n)\nSELECT DATE(c.charttime) AS date, MAX(c.valuenum) AS max_body_temperature\nFROM chartevents c\nJOIN icustays i ON c.hadm_id = i.hadm_id AND c.stay_id = i.stay_id\nJOIN LastICUStay l ON i.stay_id = l.last_stay_id\nWHERE c.subject_id = 10011398\nAND c.itemid = 226730\nGROUP BY DATE(c.charttime)\nORDER BY date;",
    "0d7f97f7f014369165ccb406": "SELECT \n    date(l.charttime) AS date, \n    MAX(l.valuenum) AS max_diastolic_blood_pressure\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10005817 AND \n    l.charttime >= DATE('now', '-14 months') AND \n    d.label = 'Blood Pressure (Diastolic)'\nGROUP BY \n    date(l.charttime);",
    "2c5b0c8baa3288cd5ae25871": "WITH icu_stay AS (\n  SELECT \n    icu.stay_id,\n    icu.subject_id,\n    icu.hadm_id,\n    icu.intime,\n    icu.outtime,\n    ROW_NUMBER() OVER (PARTITION BY icu.subject_id ORDER BY icu.intime DESC) AS rn\n  FROM icustays icu\n  WHERE icu.subject_id = 10019385\n),\nlast_icu_stay AS (\n  SELECT \n    icu.stay_id,\n    icu.subject_id,\n    icu.hadm_id,\n    icu.intime,\n    icu.outtime\n  FROM icu_stay icu\n  WHERE icu.rn = 1\n)\nSELECT \n  DATE(ce.charttime) AS date,\n  AVG(ce.valuenum) AS avg_systolic_bp\nFROM chartevents ce\nINNER JOIN last_icu_stay lis ON ce.stay_id = lis.stay_id\nWHERE ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Systolic Blood Pressure')\nGROUP BY DATE(ce.charttime);",
    "5e1e03c6f5228f110a137a50": "SELECT COUNT(*) AS total_hospital_visits\nFROM admissions\nWHERE subject_id = 10023117 AND strftime('%Y', admittime) = '2100';",
    "cfd45a15a268ad1a89df54dd": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10020944 AND admittime >= DATE('now', '-1 year');",
    "93181a0681785a3fc636f0c0": "SELECT COUNT(a.row_id) AS number_of_admissions\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE a.admittime >= DATE('now', 'start of year') AND a.admittime < DATE('now', 'start of year', '+1 year')\nAND p.subject_id = 10037861;",
    "1565b3431aebbecefff6df1d": "SELECT COUNT(*) AS visit_count\nFROM admissions\nWHERE subject_id = 10018501;",
    "97aace30ba0ffdefe43a92fd": "SELECT COUNT(*) AS number_of_visits \nFROM admissions \nWHERE subject_id = 10014729;",
    "2e777a27e1019908bf9c76e0": "SELECT \n    COUNT(*) AS total_visits\nFROM \n    admissions\nWHERE \n    subject_id = 10003400\n    AND admittime >= DATE('now', '-1 year')",
    "bb96274f7d0903a6f3ad4e76": "",
    "c6ef8b615b48c60724e2636d": "",
    "6065fc09f8cb8ae10fb76e62": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10038081;",
    "3476f7a1daff51acd412b499": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10029291 \nAND intime >= DATE('now', '-1 year');",
    "2e1336e1727d7e40e18f93c4": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10037975 \nAND hadm_id = (SELECT hadm_id \n               FROM admissions \n               WHERE subject_id = 10037975 \n               ORDER BY admittime DESC \n               LIMIT 1);",
    "c25b681b346061f536aabbe6": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10013049 AND intime >= '2100-01-01 00:00:00';",
    "2b28101243e3c66e8678625b": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10021938 AND strftime('%Y', intime) = '2100';",
    "4a84bbe324a00742f9bdfa52": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10004720 AND hadm_id = (SELECT MAX(hadm_id) FROM icustays WHERE subject_id = 10004720);",
    "72f9afe9d7752f2079ec4df1": "SELECT COUNT(DISTINCT drug) AS total_drugs\nFROM prescriptions\nWHERE subject_id = 10024043 AND starttime >= '2100-01-01';",
    "9db928d9e5f6893e61f4f006": "SELECT COUNT(DISTINCT drug)\nFROM prescriptions\nWHERE subject_id = 10007818\nAND starttime >= '2023-07-01'\nAND starttime < '2023-08-01';",
    "ba5d2c366e08023fec9bfbe5": "SELECT COUNT(DISTINCT drug) AS drug_count\nFROM prescriptions\nWHERE subject_id = 10000032 \nAND starttime >= DATE('now', '-10 months');",
    "5861ef095f4c08ad236ab8c5": "SELECT COUNT(DISTINCT drug) AS unique_drug_count\nFROM prescriptions\nWHERE subject_id = 10005909 AND starttime >= '2010-10-01';",
    "8db871c52022d633a9f58b11": "SELECT \n    COUNT(DISTINCT drug) AS total_unique_drugs\nFROM \n    prescriptions\nWHERE \n    subject_id = 10004720\n    AND starttime >= '2021-11-21 00:00:00';",
    "81a5e45699cfa054a335726f": "SELECT COUNT(DISTINCT drug) AS total_drugs\nFROM prescriptions\nWHERE subject_id = 10009628\n  AND starttime >= '2023-09-01'\n  AND starttime < '2023-10-01';",
    "99420e9ae112f93bdf6f421a": "SELECT COUNT(DISTINCT drug) AS total_distinct_drugs\nFROM prescriptions\nWHERE subject_id = 10021938 AND starttime >= DATE('now', '-2 months');",
    "b0c1e2c1046cc6dad14ddbe4": "SELECT \n  COUNT(*) AS num_prescriptions\nFROM \n  prescriptions\nWHERE \n  subject_id = 10020740\n  AND drug = 'chlorhexidine gluconate 0.12% oral rinse in 03/2100'",
    "3290627f36487b94ca743ca3": "SELECT COUNT(*) AS num_times_prescribed\nFROM prescriptions\nWHERE subject_id = 10018081\nAND starttime >= '2022-12-01'\nAND starttime < '2023-01-01'\nAND drug = '5% dextrose';",
    "f737cdc1f727761a17f22b7d": "SELECT COUNT(*) \nFROM prescriptions \nWHERE subject_id = 10038081 \nAND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10038081 LIMIT 1)\nAND drug = 'Albumin 25% (12.5g / 50ml)';",
    "0035d27329064c6e313badd1": "SELECT COUNT(*) AS times_milk_of_magnesia_prescribed\nFROM prescriptions p\nWHERE p.subject_id = 10005348\n  AND p.drug = 'Milk of Magnesia'\n  AND p.starttime >= '2023-09-01'\n  AND p.starttime < '2023-10-01';",
    "75f2ab4d9c265d10a7c0876f": "SELECT COUNT(*) \nFROM prescriptions \nWHERE subject_id = 10015272 \nAND drug = 'potassium chloride replacement (critical care and oncology)'\nAND starttime LIKE '2100%';",
    "76ddecbe56caba3073d76d2d": "SELECT COUNT(*) \nFROM prescriptions p\nWHERE p.subject_id = 10038933\nAND p.drug = 'Levetiracetam Oral Solution (Brilanz)' \nAND p.route = 'Oral'\nAND p.dose_unit_rx = '09/2100';",
    "70280353be78e0850355e08c": "SELECT COUNT(*) AS prescription_count\nFROM prescriptions p\nINNER JOIN admissions a ON p.subject_id = a.subject_id AND p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10016810 AND p.drug = 'FAMOTIDINE';",
    "bca12dbeb197151809e62874": "SELECT COUNT(*) AS ast_test_count\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10009628 AND li.label = 'AST';",
    "18804b0230296456eb7bf9f3": "SELECT COUNT(*) \nFROM labevents \nWHERE hadm_id IN (\n  SELECT hadm_id \n  FROM admissions \n  WHERE subject_id = 10039831\n) \nAND itemid IN (\n  SELECT itemid \n  FROM d_labitems \n  WHERE label = 'Hemoglobin'\n);",
    "e46aecc50872e5e43f5dec8b": "SELECT COUNT(*) AS num_lab_tests\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10038999 AND d_labitems.label LIKE '%Lipase%';",
    "da0d0d0112db58fa527f189f": "",
    "6b5cff60f50561310ed8c3c2": "SELECT COUNT(*) AS total_tests\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10011398\n  AND labevents.charttime >= DATE('now', '-10 years')\n  AND d_labitems.label LIKE '%Platelet Count%';",
    "d535c91e21f7926fb37d3dd8": "SELECT COUNT(*) AS test_count\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10018845\nAND li.label = 'Hemoglobin'\nAND le.charttime >= '2000-07-21';",
    "272b7419a6f4ac420aae5839": "SELECT COUNT(*) \nFROM labevents AS le\nINNER JOIN d_labitems AS li ON le.itemid = li.itemid\nWHERE le.subject_id = 10002428 \nAND li.label = 'Bicarbonate'\nAND le.charttime LIKE '2022-07-%';",
    "f9e651bab94c8b0cbc349c8a": "SELECT COUNT(*) AS current_patient_count\nFROM patients;",
    "42133f6ce3b196288d44b9b7": "SELECT COUNT(*) AS currently_admitted_patients\nFROM admissions\nWHERE dischtime IS NULL;",
    "822fb5a81c6aa96e17079981": "SELECT COUNT(*) AS current_patients\nFROM patients\nWHERE dob IS NOT NULL AND dod IS NULL;",
    "adeec8d4eea99ded1a136fb0": "SELECT COUNT(*) AS current_patient_count\nFROM patients\nWHERE dod IS NULL;",
    "b4e5170ce76c3fd49390d922": "",
    "b9dd758d1b4184744da4955b": "SELECT COUNT(*) AS total_patients\nFROM patients\nWHERE (strftime('%Y', 'now') - strftime('%Y', dob)) BETWEEN 30 AND 39\n  AND dod IS NULL;",
    "87df01ff8e5b34782b6f1bab": "SELECT COUNT(*) \nFROM patients \nWHERE strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 40 AND 49 \nAND dod IS NULL;",
    "29c1d5e3303ae477c836d0a2": "SELECT COUNT(*) AS total_current_patients_age_30s\nFROM patients\nWHERE strftime('%Y', 'now') - strftime('%Y', dob) BETWEEN 30 AND 39;",
    "87157dc1a0c697225e9e5356": "",
    "466f29187cd0639b0ab5a25c": "SELECT COUNT(*) AS patient_count\nFROM patients p\nWHERE (strftime('%Y', 'now') - strftime('%Y', p.dob)) BETWEEN 40 AND 49;",
    "1408ef03b015c82da341f94f": "SELECT COUNT(*) AS num_of_patients\nFROM patients\nWHERE strftime('%Y', 'now') - strftime('%Y', dob) = 30;",
    "06766659b8f16c2233c677bd": "SELECT \n    CAST(SUM(CASE WHEN julianday(p.dod) - julianday(p.dob) <= 180 THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(p.subject_id) AS survival_rate\nFROM \n    patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id AND d.hadm_id = pr.hadm_id\nWHERE \n    dd.long_title LIKE '%microscopic hematuria%' \n    AND pr.drug = 'phytonadione'\n    AND julianday(pr.starttime) - julianday(dd.charttime) >= 0\n    AND julianday(pr.starttime) - julianday(dd.charttime) <= 180;",
    "84cb84cd44b575f06211c452": "SELECT \n    CAST(SUM(CASE WHEN p.dod IS NOT NULL AND p.dod <= DATE(a.dischtime, '+3 months') THEN 1 ELSE 0 END) AS REAL) / COUNT(*) AS survival_rate\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    diagnoses_icd di ON a.hadm_id = di.hadm_id\nJOIN \n    d_icd_diagnoses dicd ON di.icd_code = dicd.icd_code\nJOIN \n    prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n    dicd.long_title = 'Subdural Hemorrhage, Following Injury, Without Mention of Open Intracranial Wound'\n    AND pr.drug = 'Phenobarbital';",
    "6292671bc40ee6988cb71e1f": "WITH RelevantDiagnoses AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE di.long_title LIKE '%other psychotic disorder not due to a substance or known physiological condition%'\n),\nRelevantAdmissions AS (\n    SELECT \n        a.subject_id,\n        a.hadm_id\n    FROM admissions a\n    INNER JOIN prescriptions p ON a.hadm_id = p.hadm_id\n    WHERE p.drug = 'alteplase'\n),\nSurvivingPatients AS (\n    SELECT \n        p.subject_id\n    FROM patients p\n    INNER JOIN RelevantDiagnoses rd ON p.subject_id = rd.subject_id\n    INNER JOIN RelevantAdmissions ra ON p.subject_id = ra.subject_id\n    WHERE p.dod IS NULL OR p.dod > DATE((SELECT admittime FROM admissions WHERE hadm_id = ra.hadm_id), '+3 month')\n)\nSELECT \n    CAST(COUNT(*) AS REAL) * 100 / (SELECT COUNT(*) FROM RelevantAdmissions) AS survival_rate\nFROM SurvivingPatients;",
    "0c87ffd881def44ba1a584a4": "SELECT \n  CAST(SUM(CASE WHEN p.dod IS NULL THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(p.subject_id) AS survival_rate\nFROM \n  patients p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  d2.long_title = 'Pneumonia due to Klebsiella pneumoniae'\n  AND pr.drug = 'insulin'\n  AND pr.starttime > d.charttime\n  AND p.dob <= DATE(d.charttime, '+6 months')\n  AND p.dod IS NULL OR p.dod > DATE(d.charttime, '+6 months')",
    "67fe7f95e308db2d9fe6ec8f": "WITH UnspecifiedPsychosisCTE AS (\n    SELECT p.subject_id\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses d_diagnosis ON d.icd_code = d_diagnosis.icd_code\n    WHERE d_diagnosis.long_title LIKE '%unspecified psychosis%'\n),\nGlycerinSuppsCTE AS (\n    SELECT p.subject_id\n    FROM patients p\n    INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\n    WHERE pr.drug LIKE '%glycerin%' AND pr.route LIKE '%supp%'\n)\nSELECT COUNT(*) * 1.0 / (SELECT COUNT(*) FROM patients WHERE subject_id IN (SELECT subject_id FROM UnspecifiedPsychosisCTE)) AS survival_rate\nFROM patients p\nINNER JOIN UnspecifiedPsychosisCTE up ON p.subject_id = up.subject_id\nINNER JOIN GlycerinSuppsCTE gs ON p.subject_id = gs.subject_id\nWHERE p.dod IS NULL OR p.dod > DATE('now', '-6 months');",
    "f92a0c61488b57aa3f7e3ab1": "",
    "6db6baede71203bbf3781655": "SELECT \n  CAST(SUM(CASE WHEN T2.dod IS NOT NULL THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T2.subject_id) AS survival_rate\nFROM \n  diagnoses_icd T1\nINNER JOIN \n  patients T2 ON T1.subject_id = T2.subject_id\nINNER JOIN \n  admissions T3 ON T1.hadm_id = T3.hadm_id\nINNER JOIN \n  prescriptions T4 ON T3.hadm_id = T4.hadm_id\nWHERE \n  T1.icd_code IN (SELECT icd_code FROM d_icd_diagnoses WHERE long_title LIKE '%poliomyelitis%')\n  AND T4.drug LIKE '%insulin%'\n  AND T2.dob <= DATE(T3.admittime, '+6 months')\n  AND (T2.dod IS NULL OR T2.dod >= DATE(T3.admittime, '+6 months'));",
    "bb7f918822ae905cff9cc39e": "",
    "808dfe41dea511c9420e7b88": "selects the top five diagnoses based on this rate.",
    "7cc086ff238e8366912ab6a9": "WITH DiagnosisMortality AS (\n  SELECT \n    d.icd_code,\n    p.dod,\n    a.admittime\n  FROM \n    diagnoses_icd d\n  INNER JOIN \n    admissions a ON d.hadm_id = a.hadm_id\n  INNER JOIN \n    patients p ON a.subject_id = p.subject_id\n)\nSELECT \n  d.icd_code,\n  d.long_title,\n  AVG(CASE WHEN p.dod BETWEEN a.admittime AND DATE(a.admittime, '+6 months') THEN 1 ELSE 0 END) AS mortality_rate\nFROM \n  DiagnosisMortality dm\nINNER JOIN \n  diagnoses_icd d ON dm.icd_code = d.icd_code\nINNER JOIN \n  d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nINNER JOIN \n  admissions a ON dm.dod = a.dischtime AND dm.subject_id = a.subject_id\nINNER JOIN \n  patients p ON a.subject_id = p.subject_id\nGROUP BY \n  d.icd_code, d.long_title\nORDER BY \n  mortality_rate DESC\nLIMIT 4;",
    "66e468b8ba6fe6d332363ba2": "WITH DiagnosesMortality AS (\n    SELECT \n        d.icd_code,\n        COUNT(CASE WHEN p.dod <= DATE(a.admittime, '+3 months') THEN 1 ELSE NULL END) * 1.0 / COUNT(*) AS mortality_rate\n    FROM diagnoses_icd d\n    JOIN admissions a ON d.hadm_id = a.hadm_id\n    JOIN patients p ON a.subject_id = p.subject_id\n    GROUP BY d.icd_code\n),\nRankedDiagnoses AS (\n    SELECT \n        icd_code,\n        mortality_rate,\n        RANK() OVER (ORDER BY mortality_rate DESC) AS rank\n    FROM DiagnosesMortality\n)\nSELECT \n    icd_code,\n    mortality_rate\nFROM RankedDiagnoses\nWHERE rank <= 3;",
    "561a6f6df9ce2b72802718f6": "WITH DiagnosisCounts AS (\n    SELECT \n        d.icd_code,\n        d.long_title,\n        COUNT(*) AS diagnosis_count,\n        SUM(CASE WHEN p.dod IS NOT NULL AND julianday(p.dod) - julianday(a.admittime) <= 90 THEN 1 ELSE 0 END) AS mortality_count\n    FROM diagnoses_icd di\n    INNER JOIN admissions a ON di.hadm_id = a.hadm_id\n    INNER JOIN patients p ON a.subject_id = p.subject_id\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    GROUP BY d.icd_code, d.long_title\n),\nMortalityRates AS (\n    SELECT \n        long_title,\n        diagnosis_count,\n        mortality_count,\n        CAST(mortality_count AS REAL) / diagnosis_count AS mortality_rate\n    FROM DiagnosisCounts\n)\nSELECT \n    long_title,\n    mortality_rate\nFROM MortalityRates\nORDER BY mortality_rate DESC\nLIMIT 3;",
    "4b624ad8a3b82ed7e3e29dc3": "SELECT \n    d.long_title, \n    SUM(CASE WHEN p.dod IS NOT NULL THEN 1 ELSE 0 END) * 1.0 / COUNT(p.subject_id) AS mortality_rate\nFROM \n    patients p\nJOIN \n    diagnoses_icd di ON p.subject_id = di.subject_id\nJOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    p.dob <= DATE('now', '-6 months') AND (p.dod IS NOT NULL OR (p.dod IS NULL AND p.subject_id IN (\n        SELECT subject_id FROM patients WHERE dob <= DATE('now', '-6 months')\n    )))\nGROUP BY \n    d.long_title\nORDER BY \n    mortality_rate DESC\nLIMIT 3;",
    "33531c8f62b92bd9245b9217": "SELECT \n  d.icd_code, \n  COUNT(*) AS mortality_count\nFROM \n  diagnoses_icd d\n  INNER JOIN admissions a ON d.hadm_id = a.hadm_id\nWHERE \n  a.dischtime IS NOT NULL \n  AND a.dischtime < DATE(a.admittime, '+6 month')\nGROUP BY \n  d.icd_code\nORDER BY \n  mortality_count DESC\nLIMIT 4;",
    "18df7b68a00300388686a82b": "SELECT MAX(T1.cost) AS max_cost\nFROM cost AS T1\nJOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nJOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title LIKE '%extirpation of matter from right lower lung lobe%'\nAND T1.event_type = 'Procedure'\nAND strftime('%Y', T1.chargetime) = strftime('%Y', 'now');",
    "c818322213949df55b14a582": "",
    "719bc524af77a513ee6e0aa0": "SELECT \n  MAX(c.cost) AS max_total_hospital_cost \nFROM \n  cost c \n  INNER JOIN procedures_icd p ON c.event_id = p.row_id \n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code \nWHERE \n  d.long_title = 'INSERTION OF NON-DRUG-ELUTING PERIPHERAL (NON-CORONARY) VESSEL STENT(S)';",
    "37edc3b1fd1e40d2f63d5c01": "SELECT AVG(c.cost) AS average_total_cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses did ON d.icd_code = did.icd_code\nWHERE did.long_title = 'Other Laparoscopic Umbilical Herniorrhaphy in 2100';",
    "29fabfc4794a216ba5bf1993": "SELECT \n  MAX(T3.cost) AS max_total_cost\nFROM \n  procedures_icd AS T1\n  JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\n  JOIN cost AS T3 ON T1.hadm_id = T3.hadm_id AND T3.event_type = 'procedure' AND T3.event_id = T1.row_id\nWHERE \n  T2.long_title = 'combined right and left heart cardiac catheterization';",
    "778832d66a9a3b3ebeb51d39": "SELECT AVG(total_cost) AS average_total_cost\nFROM (\n    SELECT SUM(c.cost) AS total_cost\n    FROM procedures_icd pic\n    JOIN d_icd_procedures dip ON pic.icd_code = dip.icd_code\n    JOIN cost c ON pic.hadm_id = c.hadm_id\n    WHERE dip.long_title = 'Extirpation of matter from lung lingula, via natural or artificial opening endoscopic'\n    GROUP BY pic.hadm_id\n) AS subquery;",
    "7bc94deacf6c02cba88f38e5": "SELECT AVG(t.cost) AS average_cost\nFROM cost t\nINNER JOIN procedures_icd p ON t.event_id = p.row_id\nINNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title LIKE '%Other Bronchoscopy, in 2100%';",
    "5dc4ad2f2838085f7c4b9af3": "SELECT MAX(c.cost) AS max_cost\nFROM cost c\nJOIN prescriptions p ON c.event_id = p.row_id AND c.event_type = 'labevent'\nWHERE p.drug = 'Phenytoin' AND c.chargetime > '2100-01-01';",
    "e684deacbe9f8050fb9c2537": "SELECT MIN(T3.cost) AS min_total_bill\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nINNER JOIN cost AS T3 ON T1.subject_id = T3.subject_id AND T1.hadm_id = T3.hadm_id\nWHERE T2.label = 'Creatine Kinase (CK)';",
    "d91ba5c2ed88034e0a2b3870": "SELECT MAX(c.cost) AS max_cost\nFROM cost c\nINNER JOIN labevents le ON c.event_id = le.row_id\nWHERE le.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Glucose')\n  AND c.event_type = 'lab'\n  AND c.event_id IN (\n    SELECT le.row_id \n    FROM labevents le \n    WHERE le.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Pleural fluid analysis')\n  );",
    "f25934f599ad692e3d1cd779": "SELECT MIN(T1.cost) AS minimum_cost\nFROM cost AS T1\nINNER JOIN labevents AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_labitems AS T3 ON T2.itemid = T3.itemid\nWHERE T1.chargetime > DATE('now', '-1 year')\nAND T3.label LIKE '%hemoglobin a1c%';",
    "8a678e5db3bbbe38b320aa96": "SELECT \n    MAX(total_cost) AS max_overall_cost\nFROM (\n    SELECT \n        T1.subject_id,\n        SUM(T1.cost) AS total_cost\n    FROM \n        cost T1\n        INNER JOIN labevents T2 ON T1.hadm_id = T2.hadm_id\n        INNER JOIN d_labitems T3 ON T2.itemid = T3.itemid\n    WHERE \n        T3.label IN ('lactate dehydrogenase', 'pleural')\n    GROUP BY \n        T1.subject_id\n) AS subquery;",
    "688e0f542dd5995fefbabee6": "SELECT MIN(T2.cost) AS min_total_bill\nFROM labevents AS T1\nINNER JOIN d_labitems AS T3 ON T1.itemid = T3.itemid\nINNER JOIN cost AS T2 ON T1.hadm_id = T2.hadm_id AND T2.event_id = T1.row_id\nWHERE T3.label LIKE '%Lipase%';",
    "8b08fcfc0a63eadbb17b7167": "",
    "b0ded0fa2296a8f7a4d0926b": "SELECT \n  AVG(T1.cost) AS average_total_cost\nFROM \n  cost AS T1\n  INNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T2.drug = 'sulfameth/trimethoprim ss' AND\n  T1.chargetime >= DATE('now', '-1 year')",
    "ee519753d2c9f939d5fb4219": "SELECT AVG(c.cost) AS average_total_cost\nFROM prescriptions p\nJOIN cost c ON p.subject_id = c.subject_id AND p.hadm_id = c.hadm_id\nWHERE p.drug = 'neomycin-polymyxin-bacitracin';",
    "3017014a16809262a247bee7": "",
    "6b5d224a0e7421bcf92afd3c": "SELECT MAX(c.cost) AS max_total_cost\nFROM cost c\nINNER JOIN prescriptions p ON c.event_id = p.row_id\nWHERE p.drug = 'carvedilol' AND p.dose_val_rx LIKE '%2100%';",
    "a1e65b03fe2b7016b885dc09": "SELECT MIN(T2.cost) AS min_total_cost\nFROM prescriptions AS T1\nINNER JOIN cost AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.drug LIKE '%nicotine patch%' AND T2.event_type = 'medication' AND T2.chargetime LIKE '%2100%';",
    "a1070d070dd65690e308619d": "SELECT MIN(total_cost) AS minimum_total_cost\nFROM (\n    SELECT c.cost AS total_cost\n    FROM prescriptions p\n    JOIN cost c ON p.hadm_id = c.hadm_id\n    WHERE p.drug = 'ezetimibe'\n) AS subquery;",
    "064647795088c18c2eea104a": "SELECT MAX(total_cost) AS max_total_cost\nFROM (\n    SELECT SUM(c.cost) AS total_cost\n    FROM cost c\n    INNER JOIN prescriptions p ON c.hadm_id = p.hadm_id AND c.subject_id = p.subject_id\n    WHERE p.drug LIKE '%vial in 2100%'\n    GROUP BY c.hadm_id, c.subject_id\n) AS subquery;",
    "e2dee747281ae9a00c1fc13f": "SELECT \n    MAX(T3.cost) AS max_total_cost \nFROM \n    patients AS T1\nINNER JOIN \n    admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN \n    cost AS T3 ON T2.hadm_id = T3.hadm_id\nINNER JOIN \n    diagnoses_icd AS T4 ON T2.hadm_id = T4.hadm_id\nINNER JOIN \n    d_icd_diagnoses AS T5 ON T4.icd_code = T5.icd_code\nWHERE \n    T5.long_title LIKE '%esophageal obstruction%';",
    "86af6dbec3fe033cc1dee870": "SELECT \n    MAX(T2.cost) AS max_total_hospital_cost\nFROM \n    diagnoses_icd T1\nINNER JOIN \n    cost T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n    d_icd_diagnoses T3 ON T1.icd_code = T3.icd_code\nWHERE \n    T3.long_title = 'Postprocedural pneumothorax in 2100';",
    "416f64511f06e29fd379a373": "SELECT MIN(t.cost) AS min_cost\nFROM cost t\nJOIN diagnoses_icd d ON t.event_id = d.row_id\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title LIKE '%affective%disorder%'\nAND t.chargetime BETWEEN '2100-01-01' AND '2100-12-31';",
    "40314c9ace9e04fb7834c2b1": "SELECT MIN(T2.cost) AS min_cost\nFROM diagnoses_icd AS T1\nINNER JOIN cost AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2.subject_id\nWHERE T1.icd_code IN ('I63.12', 'I63.14')\nAND T2.event_type = 'hospital_service';",
    "fd9d2ad9b857f9d53588d882": "SELECT AVG(cost) AS average_hospital_cost\nFROM cost;",
    "ecd19094660d16b8b750e976": "SELECT MAX(total_hospital_cost) AS max_hospital_cost\nFROM (\n    SELECT \n        c.subject_id,\n        SUM(c.cost) AS total_hospital_cost\n    FROM cost c\n    INNER JOIN diagnoses_icd d ON c.event_id = d.row_id\n    INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE d2.long_title IN (\n        'Hypertensive chronic kidney disease, malignant, with chronic kidney disease stage i through stage iv, or unspecified'\n    )\n    GROUP BY c.subject_id\n) AS subquery;",
    "1d487033ea60fadd114b1b53": "SELECT MAX(T1.cost) AS max_total_cost\nFROM cost AS T1\nJOIN diagnoses_icd AS T2 ON T1.event_id = T2.row_id\nJOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title LIKE '%closed fracture of two ribs%'\nAND T1.chargetime >= '2100-01-01';",
    "93102b4334928d2d31c801fb": "SELECT \n  MAX(yearly_count) AS max_yearly_count\nFROM (\n  SELECT \n    strftime('%Y', admittime) AS year, \n    COUNT(*) AS yearly_count\n  FROM \n    admissions\n  WHERE \n    admission_location = 'Unspecified' \n    AND strftime('%Y', admittime) >= '2100'\n  GROUP BY \n    strftime('%Y', admittime)\n) AS yearly_counts;",
    "0d43d9237d6c0f97e565e463": "SELECT \n    strftime('%Y-%m', T2.charttime) AS month, \n    COUNT(*) AS count\nFROM \n    diagnoses_icd AS T1\nJOIN \n    d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nJOIN \n    diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n    T3.long_title LIKE '%Other Reconstructive Surgery%' AND \n    T2.charttime LIKE '%2100%'\nGROUP BY \n    month\nORDER BY \n    month DESC;",
    "e2beb6df478d6979ad0aa648": "SELECT MAX(monthly_patient_count) AS max_monthly_patient_count\nFROM (\n    SELECT strftime('%Y-%m', T1.charttime) AS month_year, COUNT(T1.subject_id) AS monthly_patient_count\n    FROM diagnoses_icd AS T1\n    INNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\n    WHERE T2.icd_code = 'C18.000'  -- Gout, unspecified since 2100\n    GROUP BY strftime('%Y-%m', T1.charttime)\n) AS subquery;",
    "1cb58d36d8c6b931e631e3da": "SELECT MIN(yearly_count) AS min_yearly_count\nFROM (\n    SELECT strftime('%Y', c.chargetime) AS year, COUNT(*) AS yearly_count\n    FROM cost c\n    JOIN diagnoses_icd d ON c.event_id = d.row_id\n    JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE di.long_title LIKE '%unspecified%vascular%insufficiency%of%intestine%'\n      AND c.chargetime >= '2100-01-01'\n    GROUP BY year\n) subquery;",
    "96da08df43f14b5424aed61f": "SELECT AVG(total_patients) AS average_daily_patients\nFROM (\n  SELECT COUNT(*) AS total_patients, DATE(admittime) AS admittime_date\n  FROM admissions\n  INNER JOIN diagnoses_icd ON admissions.hadm_id = diagnoses_icd.hadm_id\n  INNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\n  WHERE d_icd_diagnoses.long_title = 'Acute on chronic diastolic heart failure'\n    AND strftime('%Y', admissions.admittime) = '2100'\n  GROUP BY admittime_date\n) AS daily_patients;",
    "799182af909a63e2da1ddacf": "SELECT \n    strftime('%Y-%m', p.dob) AS month, \n    COUNT(*) AS num_records \nFROM \n    patients p \n    INNER JOIN admissions a ON p.subject_id = a.subject_id \nWHERE \n    a.admission_type = 'Newborn' \nGROUP BY \n    month\nORDER BY \n    month;",
    "b720f1ba67b87fd98f11e04c": "SELECT strftime('%Y-%m', c.charttime) AS month, AVG(c.valuenum) AS average_bmi\nFROM chartevents c\nJOIN d_items d ON c.itemid = d.itemid\nWHERE d.label = 'Body Mass Index (BMI)'\nAND c.valuenum BETWEEN 38.0 AND 38.9\nGROUP BY month;",
    "278f3690974261bfe1e57d23": "SELECT COUNT(*) \nFROM patients \nWHERE dob >= DATE('now', '-1 year') AND dod IS NOT NULL;",
    "4c6b438bb57ca0920edd4e9c": "SELECT COUNT(*) \nFROM patients p \nJOIN admissions a ON p.subject_id = a.subject_id \nWHERE a.discharge_location = 'Discharged' AND strftime('%Y', a.dischtime) = '2100';",
    "8ba9ec982c184a417b8e5f83": "SELECT COUNT(*) AS total_discharged_patients\nFROM admissions\nWHERE strftime('%Y', dischtime) = strftime('%Y', 'now');",
    "ebd67617c22beab016550006": "SELECT COUNT(*) AS patient_count\nFROM admissions\nWHERE dischtime >= DATE('now', '-1 year');",
    "199488cf0d6a538d41fdc01b": "SELECT COUNT(DISTINCT a.subject_id) AS patient_count\nFROM admissions a\nWHERE strftime('%Y', a.dischtime) = '2100';",
    "6b1fd8208b249c9a3f399917": "SELECT COUNT(*) AS patient_count\nFROM admissions\nWHERE strftime('%Y', dischtime) = strftime('%Y', 'now');",
    "f92a9715af7d181a656d4998": "SELECT COUNT(DISTINCT a.subject_id) AS recent_discharges\nFROM admissions a\nWHERE a.dischtime >= DATE('now', '-1 year');",
    "521aab3060d8c38e0cfbfa52": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN icustays icu ON p.subject_id = icu.subject_id\nWHERE strftime('%Y', icu.intime) = strftime('%Y', 'now')\nAND icu.first_careunit IN ('micu', 'sicu');",
    "2d8946a73f748f86fc32345c": "selecting the data.\n3. Apply filters based on the criteria.\n4. Count the number of patients who meet the criteria.",
    "b593bfbb3c11df43f547bfcc": "SELECT COUNT(p.subject_id) AS total_patients\nFROM patients p\nWHERE p.gender = 'M' AND p.dob >= DATE('now', '-1 year');",
    "8ba1b2de9452cc1d23057b9f": "SELECT COUNT(*) AS patient_count\nFROM icustays\nWHERE first_careunit = 'neuro sicu'\nAND intime >= DATE('now', '-1 year');",
    "a85685397831a790ea2cc0a7": "SELECT \n  COUNT(DISTINCT admissions.subject_id) AS patient_count\nFROM \n  admissions\nWHERE \n  admissions.admittime >= datetime('now', 'start of day')\n  AND admissions.admission_location = 'Med/Surg/Gyn';",
    "04ceafe43c52472b3acaedb4": "SELECT \n  COUNT(DISTINCT p.subject_id) AS total_patients\nFROM \n  patients p\n  INNER JOIN icustays i ON p.subject_id = i.subject_id\nWHERE \n  i.first_careunit = 'Med/Surg'\n  AND i.intime BETWEEN DATE('now', '-1 year') AND DATE('now');",
    "775f200f8927ed7b82f10ff9": "SELECT COUNT(*) \nFROM icustays \nWHERE last_careunit = 'Discharge Lounge' \nAND intime > (strftime('%s', 'now') - 31536000);",
    "97d71a4dfbda63c1b6544be6": "SELECT COUNT(DISTINCT d.subject_id) AS patient_count\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nJOIN admissions a ON d.hadm_id = a.hadm_id\nJOIN diagnoses_icd d_prev ON d.hadm_id = d_prev.hadm_id AND d.row_id > d_prev.row_id\nJOIN d_icd_diagnoses dd_prev ON d_prev.icd_code = dd_prev.icd_code\nWHERE dd_prev.long_title = 'Multiple fractures of ribs, left side'\nAND dd.long_title = 'Patient room place of occurrence of external cause within 2 months following the previous diagnosis'\nAND a.admission_type = 'Initial encounter for closed fracture of 2100';",
    "72392c4da0fd16d899e4307e": "SELECT COUNT(DISTINCT T1.subject_id) \nFROM diagnoses_icd AS T1 \nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code \nINNER JOIN diagnoses_icd AS T3 ON T1.hadm_id = T3.hadm_id \nINNER JOIN d_icd_diagnoses AS T4 ON T3.icd_code = T4.icd_code \nWHERE T2.long_title LIKE '%Bipolar I Disorder%' \nAND T4.long_title LIKE '%Other and Unspecified Hyperlipidemia%' \nAND T1.charttime < T3.charttime;",
    "ddee5ac733d7dabd9130af5c": "SELECT COUNT(*) AS patient_count\nFROM diagnoses_icd d1\nJOIN diagnoses_icd d2 ON d1.subject_id = d2.subject_id AND d1.hadm_id = d2.hadm_id\nJOIN d_icd_diagnoses icd1 ON d1.icd_code = icd1.icd_code\nJOIN d_icd_diagnoses icd2 ON d2.icd_code = icd2.icd_code\nWHERE icd1.long_title LIKE '%alcohol abuse, unspecified%'\nAND icd2.long_title LIKE '%constipation, unspecified%'\nAND d1.charttime < d2.charttime;",
    "d81467bbe205d33ca94ef61f": "",
    "43c158cb01b2f2079157b719": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\nJOIN \n    diagnoses_icd d1 ON p.subject_id = d1.subject_id\nJOIN \n    d_icd_diagnoses dd1 ON d1.icd_code = dd1.icd_code\nJOIN \n    diagnoses_icd d2 ON p.subject_id = d2.subject_id\nJOIN \n    d_icd_diagnoses dd2 ON d2.icd_code = dd2.icd_code\nWHERE \n    dd1.long_title LIKE '%aortic valve disorder%' \n    AND dd2.long_title LIKE '%postprocedural fever%'\n    AND strftime('%Y-%m', d1.charttime) = strftime('%Y-%m', d2.charttime)\n    AND strftime('%Y-%m', d1.charttime) > strftime('%Y-%m', '2100-01-01');",
    "3e9064d2108a3ee8c6ae4ee2": "",
    "f87b894e8644d660bf3e856f": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title = 'Collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture in 2100'\nAND EXISTS (\n    SELECT 1\n    FROM admissions a\n    WHERE a.subject_id = p.subject_id\n    AND a.admission_location = 'Patient Room'\n    AND a.admission_type = 'External Cause'\n    AND a.admission_location = 'Same Hospital Visit'\n)",
    "dd686405621c04ac8522072e": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title LIKE '%mitral valve disorders%'\nAND d2.icd_code LIKE '2100%';",
    "81a0501d514e4a4fa8672c08": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d1 ON d.icd_code = d1.icd_code\nWHERE d1.long_title LIKE '%BMI 19-24%'\nAND p.gender = 'M' OR p.gender = 'F' -- Assuming gender is not a factor in the BMI range\nAND d.charttime > '2100-01-01 00:00:00';",
    "9e655b0885b1141a8fcb1bb1": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN diagnoses_icd d ON p.subject_id = d.subject_id \nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code \nWHERE d2.long_title = 'Major depressive disorder, single episode, unspecified in 2100';",
    "e843bc5ff21d749a06ab5bc3": "SELECT COUNT(*) AS \"Number of People with DNR Status\"\nFROM patients\nWHERE subject_id IN (\n    SELECT subject_id\n    FROM diagnoses_icd\n    WHERE icd_code = 'R06.1' \n);",
    "6708f1fa7b82536c05febcef": "SELECT COUNT(*) \nFROM diagnoses_icd \nINNER JOIN d_icd_diagnoses \nON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code \nWHERE d_icd_diagnoses.long_title = 'Acute edema of lung, unspecified';",
    "6d5bb8b2a694bc9e91caea13": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dicd ON d.icd_code = dicd.icd_code\nWHERE dicd.long_title = 'Acute venous embolism and thrombosis of subclavian veins'\nAND d.charttime >= DATE('now', '-1 year');",
    "9b08cb9ac92f27049de294fd": "SELECT \n  COUNT(DISTINCT p.subject_id) AS total_patients\nFROM \n  patients p\nINNER JOIN \n  diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN \n  d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE \n  dd.long_title LIKE '%hemiplegia%' AND\n  dd.long_title LIKE '%hemiparesis%' AND\n  dd.long_title LIKE '%cerebral infarction%' AND\n  dd.long_title LIKE '%left non-dominant side%' AND\n  d.charttime >= '2100-01-01';",
    "a2af82429c00976d404b6e5d": "",
    "d09c79e777148f87f0c15c92": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\n   FROM procedures_icd pr\n   JOIN d_icd_procedures di ON pr.icd_code = di.icd_code\n   JOIN patients p ON pr.subject_id = p.subject_id\n   WHERE di.long_title = 'Other electroshock therapy'\n     AND strftime('%Y', pr.charttime) = '2100';",
    "c7bc7892dca1cc286f05887f": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title = 'Other Incision of Brain'\nAND strftime('%Y', pr.charttime) = strftime('%Y', 'now');",
    "3fa5e54471bc2eac34ec48ed": "SELECT COUNT(*) AS num_deaths\nFROM procedures_icd\nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE d_icd_procedures.long_title = 'Destruction of left main bronchus, via natural or artificial opening endoscopic procedure';",
    "ea784a4b3ba382dd3a8dca8e": "SELECT COUNT(DISTINCT t1.subject_id) AS aortography_count\nFROM procedures_icd AS t1\nINNER JOIN d_icd_procedures AS t2\nON t1.icd_code = t2.icd_code\nWHERE t2.long_title LIKE '%aortography%';",
    "e39e837fb8cffe6bbe93bb60": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM procedures_icd pr\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nJOIN patients p ON pr.subject_id = p.subject_id\nWHERE d.long_title = 'Bypass coronary artery, one artery from aorta with autologous venous tissue, open approach'\nAND strftime('%Y', pr.charttime) = '2100';",
    "a8a7ae0b4b0cdddab9d4616d": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title = 'Excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure'\n  AND a.dischtime BETWEEN '2100-01-01' AND '2100-12-31';",
    "af72aeed0e5cc61f2a10a8ed": "SELECT \n  COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n  patients p\n  INNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE \n  pr.icd_code = 'Q52.2'\n  AND pr.charttime >= '2100-01-01 00:00:00'\nGROUP BY \n  p.subject_id\nHAVING \n  COUNT(pr.charttime) >= 2;",
    "225970019a185c7b566265ff": "SELECT COUNT(*) AS total_people\nFROM (\n    SELECT p.subject_id\n    FROM procedures_icd pr\n    INNER JOIN d_icd_procedures p ON pr.icd_code = p.icd_code\n    INNER JOIN admissions a ON pr.hadm_id = a.hadm_id\n    INNER JOIN patients pa ON a.subject_id = pa.subject_id\n    WHERE p.long_title LIKE '%excision of dental lesion of jaw%' \n      AND STRFTIME('%Y', pr.charttime) = STRFTIME('%Y', 'now')\n    GROUP BY p.subject_id\n    HAVING COUNT(pr.row_id) >= 2\n) subquery;",
    "a51c8d210fb99892e9c4157c": "WITH RECENT_PATIENTS AS (\n    SELECT p.subject_id\n    FROM patients p\n    WHERE p.dob >= datetime('now', '-1 year')\n),\nANGIOCARDIOGRAPHY_PATIENTS AS (\n    SELECT r.subject_id\n    FROM RECENT_PATIENTS r\n    INNER JOIN diagnoses_icd d ON r.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses x ON d.icd_code = x.icd_code\n    WHERE x.long_title LIKE '%Angiocardiography of left heart structures%'\n    GROUP BY r.subject_id\n    HAVING COUNT(*) = 2\n)\nSELECT COUNT(*) AS patient_count\nFROM ANGIOCARDIOGRAPHY_PATIENTS;",
    "4f58f3a3dafa1f8cd4ff29a8": "",
    "3b064609e2c9c1d5192c303d": "SELECT COUNT(*) AS patient_count\nFROM (\n    SELECT p.subject_id\n    FROM procedures_icd pi\n    INNER JOIN d_icd_procedures d ON pi.icd_code = d.icd_code\n    INNER JOIN admissions a ON pi.hadm_id = a.hadm_id\n    INNER JOIN patients p ON a.subject_id = p.subject_id\n    WHERE d.long_title = 'Other Computer Assisted Surgery'\n      AND a.admittime >= DATE('now', '-1 year')\n    GROUP BY p.subject_id\n    HAVING COUNT(pi.row_id) > 1\n) AS subquery;",
    "3984301a9bd8a75a815b502a": "SELECT COUNT(*) AS total_people\nFROM (\n  SELECT DISTINCT p.subject_id\n  FROM patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN procedures_icd pi ON a.hadm_id = pi.hadm_id\n  INNER JOIN d_icd_procedures dip ON pi.icd_code = dip.icd_code\n  WHERE dip.long_title LIKE '%excision of dental lesion of jaw%'\n    AND pi.charttime >= '2100-01-01'\n) AS people_given_procedure\nWHERE COUNT(*) >= 2;",
    "3ee1fa015c88d17b50ff62cb": "",
    "68483e4f1201b049144af718": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures pd ON pr.icd_code = pd.icd_code\nWHERE dd.long_title LIKE '%other ascites%'\n  AND pd.long_title LIKE '%other open umbilical herniorrhaphy%'\n  AND pr.charttime BETWEEN d.charttime AND DATE(d.charttime, '+2 months');",
    "1773166323d7822bd908fecf": "SELECT COUNT(*) \nFROM diagnoses_icd d\nINNER JOIN procedures_icd p ON d.hadm_id = p.hadm_id\nWHERE d.icd_code = 'R46' \n  AND p.icd_code = 'W73';",
    "942ff36dd9b2fbe79fa75553": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d_diagnosis ON d.icd_code = d_diagnosis.icd_code\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures d_procedure ON pr.icd_code = d_procedure.icd_code\nJOIN inputevents i ON p.subject_id = i.subject_id\nWHERE d_diagnosis.long_title LIKE '%severe sepsis%'\nAND d_procedure.long_title LIKE '%continuous invasive mechanical ventilation%'\nAND i.totalamountuom = '96 hours'\nAND pr.hadm_id = d.hadm_id\nAND i.hadm_id = d.hadm_id;",
    "90b0586c4e17390d3684288d": "",
    "0179a63a9ea6811f17901566": "SELECT COUNT(DISTINCT p.subject_id) AS count_of_patients\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures pr2 ON pr.icd_code = pr2.icd_code\nWHERE d2.long_title LIKE '%essential (primary) hypertension%'\n  AND pr2.long_title LIKE '%excision of left internal mammary artery, percutaneous endoscopic approach%'\n  AND pr.charttime > d.charttime\n  AND pr.charttime < DATE(d.charttime, '+2 months')",
    "f770528a39adb96dadeb2ece": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    INNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE \n    d.icd_code = 'P23.11'  \n    AND pr.icd_code = 'S05.8'  \n    AND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', pr.charttime)\n    AND strftime('%Y-%m', d.charttime) >= '2100-01';",
    "59c016a2706b41628b2c89c5": "SELECT COUNT(*) \nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures pr2 ON pr.icd_code = pr2.icd_code\nWHERE d2.long_title = 'Family history of malignant neoplasm of trachea, bronchus, and lung'\n  AND pr2.long_title = 'Central Venous Catheter Placement with Guidance'\n  AND strftime('%Y', d.charttime) = strftime('%Y', 'now', '-1 year')\n  AND strftime('%m', pr.charttime) = strftime('%m', d.charttime);",
    "4fbf6bc24f6506d4e0648954": "",
    "399219ab0cecf87bb146bf4f": "SELECT COUNT(*) AS total_cases\nFROM diagnoses_icd\nINNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title = 'Diagnostic Ultrasound of Abdomen and Retroperitoneum';",
    "b887f31e7adc13f9605b4ce5": "SELECT COUNT(*) AS num_alcohol_detoxifications\nFROM procedures_icd\nWHERE icd_code = 'S83.5' AND charttime BETWEEN '2023-01-01' AND '2023-12-31';",
    "637392b0ddde6c01f3635914": "SELECT COUNT(*) \nFROM procedures_icd AS pi\nINNER JOIN d_icd_procedures AS dip ON pi.icd_code = dip.icd_code\nWHERE dip.long_title = 'Excision of left internal mammary artery, percutaneous endoscopic approach';",
    "888ffc67091ab77a0031df58": "SELECT COUNT(*) \nFROM procedures_icd AS pi \nJOIN d_icd_procedures AS dip ON pi.icd_code = dip.icd_code \nWHERE dip.long_title = 'Respiratory ventilation, greater than 96 consecutive hours' \nAND pi.hadm_id IS NOT NULL;",
    "a7705b90ca7be8540a57b179": "SELECT COUNT(*) \nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title LIKE '%excision of right lower lung lobe%'\nAND d.long_title LIKE '%natural or artificial opening endoscopic%'\nAND p.charttime BETWEEN '2100-01-01' AND '2100-12-31';",
    "5c2f1712b0944318f3f979b0": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Excision of left saphenous vein, percutaneous endoscopic approach' \nAND p.charttime >= DATE('now', 'start of year');",
    "4556ccee5b6838ef92b0563d": "SELECT COUNT(*) AS number_of_patients\nFROM prescriptions\nWHERE drug = 'NITROPRUSSIDE SODIUM';",
    "8a2eb3b60c1ea3c2e4c41c3d": "SELECT COUNT(DISTINCT subject_id) AS patient_count\nFROM prescriptions\nWHERE drug = 'Oxycodone (Immediate Release)'\nAND starttime LIKE '%2100%';",
    "2e78bc9dfee6ec2d33d855e8": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'Dexamethasone';",
    "66c7ab0996cecda175a87a37": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM prescriptions p\nWHERE p.drug = 'metformin (glucophage)'\nAND p.starttime >= DATE('now', 'start of year')\nAND p.stoptime <= DATE('now', 'end of year');",
    "1e4019a7c27981289e8158a6": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'doxycycline hyclate';",
    "585481006142353555e7db6c": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'phosphorus' \n  AND starttime >= DATE('now', '-1 year');",
    "387e90582a0211b4f9b8baa0": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'fenofibrate';",
    "9fd92541abda6f41b7def429": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE drug = 'quinidine gluconate e.r.'\nAND starttime >= DATE('now', '-1 year');",
    "f2f618df33524232a41e164a": "SELECT COUNT(*) AS number_of_prescriptions\nFROM prescriptions\nWHERE drug = 'heparin (crrt machine priming)'\n  AND starttime >= '2100-01-01 00:00:00';",
    "12e5aa7d6e4aad370d1ec784": "",
    "9629cd5b13741202a0e1dc2e": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'midodrine' AND starttime >= DATE('now', '-1 year');",
    "c0c458bde811f783bf9c0186": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'latanoprost 0.005% ophth. soln.' \n  AND starttime >= DATE('now', '-1 year');",
    "c62d48014cb74f4fc40d76b2": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'docusate';",
    "e278ba85bcbc856b575a2432": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'Tramadol' AND starttime >= DATE('now', '-1 year');",
    "5bfb3ee348b0af2b550eb5fd": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN procedures_icd p2 ON a.hadm_id = p2.hadm_id\nJOIN prescriptions ps ON a.hadm_id = ps.hadm_id\nWHERE a.admittime >= '2100-01-01'\nAND pr.icd_code = 'S51.11'\nAND p2.icd_code = 'R06.01'\nAND ps.drug = 'ketorolac';",
    "77afb1ef1604c879a7c457e5": "SELECT COUNT(DISTINCT p.subject_id)\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nJOIN icustays ic ON pr.hadm_id = ic.hadm_id\nWHERE pr.drug = 'SPIRANOLACTONE'\nAND pr.starttime >= ic.intime AND pr.starttime <= ic.outtime\nAND ic.intime >= DATE(ic.intime, '-1 year')",
    "b155b30fab3d7945e185f841": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN procedures_icd pi ON a.hadm_id = pi.hadm_id\nINNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pi.icd_code = 'P31.01' AND pr.drug = 'GLUCOSE GEL'\nAND STRFTIME('%Y-%m', pr.starttime) = STRFTIME('%Y-%m', a.admittime)\nAND STRFTIME('%Y-%m', pi.charttime) = STRFTIME('%Y-%m', a.admittime);",
    "cdc0b49b39728980763c9830": "SELECT COUNT(*) AS prescribed_count\nFROM prescriptions p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\nWHERE p.drug LIKE '%ketorolac%' \n  AND pr.icd_code LIKE '%210.10%' \n  AND strftime('%Y', p.starttime) = strftime('%Y', 'now') \n  AND strftime('%m', p.starttime) = strftime('%m', pr.charttime);",
    "545884471d7fc70a0f8b1fce": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures dp ON pr.icd_code = dp.icd_code\nJOIN prescriptions ps ON p.subject_id = ps.subject_id\nWHERE dp.long_title = 'Drainage of pancreatic cyst by catheter'\nAND ps.drug = 'acetaminophen'\nAND (julianday(ps.starttime) - julianday(pr.charttime)) BETWEEN 0 AND 60;",
    "8fdc820d61c609ac4f0bed57": "SELECT COUNT(DISTINCT T1.subject_id) AS patient_count\nFROM prescriptions AS T1\nINNER JOIN procedures_icd AS T2\nON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE strftime('%Y', T1.starttime) = '2100'\n  AND strftime('%Y', T1.starttime) = strftime('%Y', T2.charttime)\n  AND strftime('%m', T1.starttime) = strftime('%m', T2.charttime)\n  AND T1.drug = '0.9% sodium chloride (mini bag plus)'\n  AND T2.icd_code IN (\n    SELECT icd_code\n    FROM d_icd_procedures\n    WHERE long_title = 'Other endoscopy of small intestine (procedure)'\n  );",
    "ef78694fed50bccd3e8eed2e": "SELECT COUNT(T1.subject_id) \nFROM procedures_icd AS T1 \nINNER JOIN prescriptions AS T3 \nON T1.subject_id = T3.subject_id \nWHERE T1.icd_code = 'P33.11' \nAND T3.drug = 'lidocaine 5% patch' \nAND strftime('%Y', T3.starttime) = '2100' \nAND strftime('%m', T3.starttime) = strftime('%m', T1.charttime);",
    "4ae971e027ab0b11a6f1c018": "",
    "de0718a1175887225e4a3701": "SELECT COUNT(DISTINCT subject_id) AS total_patients\nFROM microbiologyevents\nWHERE test_name = 'Plasma Cells'\nAND charttime >= DATE('now', '-1 year');",
    "db4ebf8381b39fb14b2f5dab": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN labevents l ON p.subject_id = l.subject_id \nJOIN d_labitems d ON l.itemid = d.itemid \nWHERE d.label = 'Triglycerides' AND l.charttime >= DATE('now', '-1 year');",
    "be7de3372a4c08b2ae411296": "SELECT COUNT(DISTINCT me.subject_id)\nFROM microbiologyevents me\nWHERE me.charttime >= DATE('now', '-1 year')\n  AND me.test_name LIKE '%epithelial cells%';",
    "0ab0e14edb41ec298e991c8c": "SELECT COUNT(DISTINCT le.subject_id) \nFROM labevents le\nINNER JOIN d_labitems li ON le.itemid = li.itemid\nWHERE li.label LIKE '%Uric Acid Test%' \nAND strftime('%Y', le.charttime) = '2100';",
    "37c4dfeda91b7ea5c88a15b6": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients_with_vitamin_b12_test\nFROM patients p\nJOIN labevents le ON p.subject_id = le.subject_id\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE li.label LIKE '%vitamin b12%' AND le.charttime >= '2100-01-01';",
    "ec12c483a1d7d0bf16b1fbc4": "",
    "9b6fff1f017a3163467fb155": "SELECT COUNT(DISTINCT ie.subject_id) AS total_dextrose_50_input_patients\nFROM inputevents ie\nINNER JOIN d_items di ON ie.itemid = di.itemid\nWHERE di.label = 'Dextrose 50%' \nAND strftime('%Y', ie.starttime) = strftime('%Y', 'now');",
    "d9dc77e2a9eef59e0164883e": "SELECT COUNT(*) AS input_count\nFROM inputevents ie\nJOIN d_items di ON ie.itemid = di.itemid\nWHERE di.label = 'D5W'\n  AND ie.starttime BETWEEN DATE('now', '-1 year') AND DATE('now')\n  AND ie.totalamount > 0;",
    "e793c664c5790f8705865139": "SELECT COUNT(DISTINCT subject_id)\nFROM inputevents\nWHERE totalamountuom = 'Free water' AND starttime LIKE '%2100%';",
    "a36f72eb4bd75e8ee0def85f": "SELECT COUNT(*) \nFROM inputevents \nWHERE totalamountuom = 'packed red blood cells' \n  AND starttime >= date('now', 'start of year');",
    "07cfe6a604bc9ff70115ca01": "SELECT COUNT(DISTINCT ie.subject_id) AS patient_count\nFROM inputevents ie\nJOIN d_items di ON ie.itemid = di.itemid\nWHERE di.label = 'Fresh Frozen Plasma'\n  AND ie.starttime >= DATE('now', '-1 year');",
    "abef8d8c91bb576ba70341f2": "SELECT COUNT(DISTINCT subject_id) AS patient_count\nFROM prescriptions\nWHERE drug = 'Promote with Fiber (full)'\n  AND dose_unit_rx = 'Tablet'\n  AND starttime > DATE('now', '-1 year');",
    "07b458a4465bdc3893cd4d3b": "SELECT COUNT(DISTINCT p.subject_id) AS total_albumin_5_percent_inputs\nFROM patients p\nINNER JOIN inputevents ie ON p.subject_id = ie.subject_id\nINNER JOIN d_items di ON ie.itemid = di.itemid\nWHERE di.label = 'Albumin 5%'\nAND ie.starttime >= DATE('now', '-1 year');",
    "7ade7790a24e397e1e54a0a0": "SELECT \n  d.long_title AS diagnosis,\n  COUNT(*) AS diagnosis_count\nFROM \n  diagnoses_icd i\nINNER JOIN \n  d_icd_diagnoses d ON i.icd_code = d.icd_code\nWHERE \n  strftime('%Y', i.charttime) = '2100'\nGROUP BY \n  d.long_title\nORDER BY \n  diagnosis_count DESC\nLIMIT 5;",
    "8b18506ab5223069c0701a48": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd di\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "be30cffa66ec6b8f274e5abc": "SELECT d.long_title AS Diagnosis, COUNT(*) AS Frequency\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE strftime('%Y', di.charttime) >= '2100'\nGROUP BY d.long_title\nORDER BY Frequency DESC\nLIMIT 5;",
    "4afbd97439436cbe90ee25f1": "SELECT \n  d.long_title AS diagnosis_description, \n  COUNT(*) AS occurrence_count\nFROM \n  diagnoses_icd di\nJOIN \n  d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n  di.charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59'\nGROUP BY \n  d.long_title\nORDER BY \n  occurrence_count DESC\nLIMIT 5;",
    "ad66076596714253fdd0da06": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.charttime > '2100-01-01'\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "70782f0b95270ba463ce4f33": "SELECT \n    d.icd_code, \n    COUNT(d.icd_code) AS diagnosis_count\nFROM \n    diagnoses_icd d\nINNER JOIN \n    admissions a ON d.hadm_id = a.hadm_id\nWHERE \n    a.admittime >= DATE('now', 'start of year')\nGROUP BY \n    d.icd_code\nORDER BY \n    diagnosis_count DESC\nLIMIT 5;",
    "6aaf71c0cfa396b28f225bc3": "SELECT \n    T1.long_title, \n    COUNT(T2.row_id) AS count\nFROM \n    d_icd_diagnoses AS T1\nJOIN \n    diagnoses_icd AS T2 ON T1.icd_code = T2.icd_code\nWHERE \n    T2.charttime >= DATE('now', '-1 year')\nGROUP BY \n    T1.long_title\nORDER BY \n    count DESC\nLIMIT 3;",
    "4ea2037fa4bc87104f556c64": "SELECT d.long_title, COUNT(*) AS frequency\nFROM diagnoses_icd di\nJOIN admissions a ON di.hadm_id = a.hadm_id\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE a.admittime >= DATE('now', 'start of year') AND a.age >= 60\nGROUP BY d.long_title\nORDER BY frequency DESC\nLIMIT 3;",
    "40d147343c07229976c1f711": "SELECT \n  d.long_title AS diagnosis, \n  COUNT(*) AS count\nFROM \n  diagnoses_icd di\n  INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n  INNER JOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE \n  a.age >= 60\nGROUP BY \n  d.long_title\nORDER BY \n  count DESC\nLIMIT 5;",
    "88bfa1913eb595bb2ec3e15e": "SELECT \n  T2.icd_code,\n  COUNT(T2.icd_code) AS frequency\nFROM \n  diagnoses_icd T2\n  INNER JOIN admissions T1 ON T2.hadm_id = T1.hadm_id\nWHERE \n  T1.age BETWEEN 30 AND 39\nGROUP BY \n  T2.icd_code\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "6fcb390235190f852352ba02": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd di\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nINNER JOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE a.age BETWEEN 20 AND 29 AND a.admittime LIKE '%2100%'\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "e3171ac111633770ec5fe8d0": "SELECT icd_code, COUNT(*) AS frequency\nFROM diagnoses_icd\nWHERE subject_id IN (\n    SELECT subject_id\n    FROM patients\n    WHERE strftime('%Y', dob) BETWEEN '1950' AND '1959'\n)\nAND hadm_id IN (\n    SELECT hadm_id\n    FROM admissions\n    WHERE strftime('%Y', admittime) >= '2100'\n)\nGROUP BY icd_code\nORDER BY frequency DESC\nLIMIT 3;",
    "7f14fffc462f0b0f329a9639": "",
    "82f39085117b4eee63cfcbd8": "",
    "ed396de025aef41a12776f3d": "WITH procedure_events AS (\n    SELECT\n        p.subject_id,\n        a.hadm_id,\n        a.admittime\n    FROM\n        procedures_icd p\n    INNER JOIN\n        admissions a ON p.hadm_id = a.hadm_id\n    WHERE\n        p.icd_code = 'T20.517' AND strftime('%Y', a.admittime) = '2100'\n),\ndiagnoses_events AS (\n    SELECT\n        de.subject_id,\n        de.hadm_id,\n        de.charttime,\n        d.long_title\n    FROM\n        diagnoses_icd de\n    INNER JOIN\n        d_icd_diagnoses d ON de.icd_code = d.icd_code\n    WHERE\n        strftime('%Y-%m', de.charttime) = strftime('%Y-%m', (SELECT admittime FROM procedure_events pe WHERE pe.subject_id = de.subject_id))\n)\nSELECT\n    long_title,\n    COUNT(*) AS frequency\nFROM\n    diagnoses_events\nGROUP BY\n    long_title\nORDER BY\n    frequency DESC\nLIMIT 3;",
    "6fdd01eeff3d0426c273f13a": "SELECT T1.icd_code, COUNT(*) AS frequency\nFROM diagnoses_icd AS T1\nINNER JOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2.subject_id\nWHERE T1.charttime >= '2100-01-01' AND T2.charttime >= '2100-01-01' \n  AND T2.icd_code = 'C01.0' \n  AND T1.charttime <= DATE(T2.charttime, '+2 months')\nGROUP BY T1.icd_code\nORDER BY frequency DESC\nLIMIT 4;",
    "47c10150fc2a7ef2316ffcd9": "WITH laparoscopic_procedures AS (\n  SELECT hadm_id\n  FROM procedures_icd\n  WHERE icd_code IN (\n    SELECT icd_code\n    FROM d_icd_procedures\n    WHERE long_title LIKE '%laparoscopic lysis of peritoneal adhesions%'\n  )\n  AND charttime >= DATE('now', '-1 year')\n),\ndiagnoses_within_timeframe AS (\n  SELECT T1.subject_id, T1.hadm_id, T2.icd_code\n  FROM diagnoses_icd T1\n  JOIN laparoscopic_procedures T3 ON T1.hadm_id = T3.hadm_id\n  JOIN diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\n  WHERE T2.charttime BETWEEN T3.charttime AND DATE(T3.charttime, '+2 months')\n)\nSELECT T4.long_title, COUNT(*) AS frequency\nFROM diagnoses_within_timeframe T2\nJOIN d_icd_diagnoses T4 ON T2.icd_code = T4.icd_code\nGROUP BY T4.long_title\nORDER BY frequency DESC\nLIMIT 3;",
    "db3c11ffd16f4f7b363b7a95": "",
    "2a9d69b2f33ebef60868e9bd": "WITH SpecificProcedures AS (\n  SELECT p.subject_id, p.hadm_id, p.charttime\n  FROM procedures_icd p\n  JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  WHERE d.long_title = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic'\n),\nRecentDiagnoses AS (\n  SELECT s.subject_id, d_icd.icd_code\n  FROM SpecificProcedures sp\n  JOIN diagnoses_icd d_icd ON sp.subject_id = d_icd.subject_id AND sp.hadm_id = d_icd.hadm_id\n  JOIN d_icd_diagnoses d ON d_icd.icd_code = d.icd_code\n  WHERE d_icd.charttime BETWEEN sp.charttime AND DATE(sp.charttime, '+2 months')\n),\nDiagnosisCounts AS (\n  SELECT d.icd_code, COUNT(*) AS diagnosis_count\n  FROM RecentDiagnoses rd\n  JOIN d_icd_diagnoses d ON rd.icd_code = d.icd_code\n  GROUP BY d.icd_code\n)\nSELECT icd.icd_code, icd.long_title, dc.diagnosis_count\nFROM DiagnosisCounts dc\nJOIN d_icd_diagnoses icd ON dc.icd_code = icd.icd_code\nORDER BY dc.diagnosis_count DESC\nLIMIT 3;",
    "cc3d7bf75c6a91650fa5a25b": "WITH LaparoscopicCholecystectomy AS (\n  SELECT \n    p.subject_id,\n    a.admittime\n  FROM patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n  WHERE d2.long_title LIKE '%laparoscopic partial cholecystectomy%'\n),\nDiagnosedPatients AS (\n  SELECT \n    l.subject_id,\n    l.admittime,\n    d2.long_title\n  FROM LaparoscopicCholecystectomy l\n  INNER JOIN admissions a ON l.subject_id = a.subject_id\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n  WHERE a.admittime BETWEEN l.admittime AND DATE(l.admittime, '+2 months')\n)\nSELECT \n  long_title,\n  COUNT(long_title) AS diagnosis_count\nFROM DiagnosedPatients\nGROUP BY long_title\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "cd0f6d12276b6dd053848329": "SELECT T1.icd_code, COUNT(*) AS num_diagnoses\nFROM diagnoses_icd AS T1\nINNER JOIN procedures_icd AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE T2.icd_code = '00.20' \n  AND T1.charttime >= DATE('now', '-1 year') \n  AND T1.charttime <= DATE('now', '-2 months')\nGROUP BY T1.icd_code\nORDER BY num_diagnoses DESC\nLIMIT 5;",
    "f43d8c604807bcac934596ac": "",
    "1f74b6c69a55bb5e16c32cba": "SELECT \n  p.long_title AS procedure_name, \n  COUNT(*) AS count\nFROM \n  procedures_icd AS pi\n  INNER JOIN d_icd_procedures AS p ON pi.icd_code = p.icd_code\nGROUP BY \n  p.long_title\nORDER BY \n  count DESC\nLIMIT 3;",
    "49d6f4a86b0609b109d0e3a1": "SELECT T2.long_title, COUNT(T1.icd_code) AS frequency\nFROM procedures_icd T1\nINNER JOIN d_icd_procedures T2 ON T1.icd_code = T2.icd_code\nGROUP BY T2.long_title\nORDER BY frequency DESC\nLIMIT 5;",
    "591c758b0e137d7671f1af3e": "SELECT icd_code, COUNT(*) AS procedure_count\nFROM procedures_icd\nWHERE icd_code LIKE '2100%'\nGROUP BY icd_code\nORDER BY procedure_count DESC\nLIMIT 4;",
    "9a613ce39888ea07ffbd3a23": "SELECT \n  p.long_title AS procedure_name, \n  COUNT(*) AS procedure_count \nFROM \n  procedures_icd pr \nJOIN \n  d_icd_procedures p ON pr.icd_code = p.icd_code \nWHERE \n  pr.charttime >= date('now', '-1 year') \nGROUP BY \n  p.long_title \nORDER BY \n  procedure_count DESC \nLIMIT 3;",
    "715714e43d5b44633c2f88df": "SELECT \n  T.drug, \n  COUNT(T.drug) AS total_prescriptions\nFROM \n  prescriptions T\nWHERE \n  strftime('%Y', T.starttime) = strftime('%Y', 'now')\nGROUP BY \n  T.drug\nORDER BY \n  total_prescriptions DESC\nLIMIT 4;",
    "2db144511074e195767dbef5": "SELECT \n  d.long_title, \n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd p\nINNER JOIN \n  d_icd_procedures d ON p.icd_code = d.icd_code\nINNER JOIN \n  admissions a ON p.hadm_id = a.hadm_id\nINNER JOIN \n  patients pt ON a.subject_id = pt.subject_id\nWHERE \n  pt.dob BETWEEN DATE('now', '-1 year') AND DATE('now')\n  AND (strftime('%Y', 'now') - strftime('%Y', pt.dob)) BETWEEN 40 AND 49\nGROUP BY \n  d.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 5;",
    "852528505a7b6f035ae431de": "SELECT p1.drug, COUNT(*) AS count\nFROM prescriptions p1\nJOIN patients p2 ON p1.subject_id = p2.subject_id\nWHERE strftime('%Y', p2.dob) <= '2100' AND strftime('%Y', p2.dod) >= '2100'\nAND strftime('%Y', p1.starttime) = '2100'\nGROUP BY p1.drug\nORDER BY count DESC\nLIMIT 3;",
    "61158e9ccd8015f7898cb6e8": "SELECT \n  p.long_title, \n  COUNT(*) as procedure_count\nFROM \n  procedures_icd pr\n  JOIN d_icd_procedures p ON pr.icd_code = p.icd_code\n  JOIN admissions a ON pr.hadm_id = a.hadm_id\nWHERE \n  a.age >= 20 AND a.age < 30\nGROUP BY \n  p.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 4;",
    "e6db613772003ec72d44ebe5": "SELECT \n  t.label, \n  COUNT(*) AS treatment_count\nFROM \n  admissions a\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses t ON d.icd_code = t.icd_code\nWHERE \n  a.admittime >= '2100-01-01' \n  AND a.admittime < '2101-01-01' \n  AND a.age BETWEEN 20 AND 29\nGROUP BY \n  t.label\nORDER BY \n  treatment_count DESC\nLIMIT 3;",
    "899575480ec0184f34a313b4": "SELECT \n  p.long_title AS procedure_name,\n  COUNT(*) AS procedure_count\nFROM \n  admissions a\n  INNER JOIN procedures_icd pi ON a.hadm_id = pi.hadm_id\n  INNER JOIN d_icd_procedures p ON pi.icd_code = p.icd_code\nWHERE \n  a.admittime LIKE '2100-%' AND a.age BETWEEN 30 AND 39\nGROUP BY \n  p.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 5;",
    "0f8875bf841f89f578f97551": "WITH RecentAdmissions AS (\n    SELECT subject_id\n    FROM admissions\n    WHERE admittime >= DATE('now', '-1 year')\n    AND age >= 60\n),\nProcedureCounts AS (\n    SELECT p.icd_code, COUNT(*) AS procedure_count\n    FROM procedures_icd p\n    JOIN RecentAdmissions ra ON p.subject_id = ra.subject_id\n    GROUP BY p.icd_code\n)\nSELECT d.long_title, pc.procedure_count\nFROM ProcedureCounts pc\nJOIN d_icd_procedures d ON pc.icd_code = d.icd_code\nORDER BY pc.procedure_count DESC\nLIMIT 5;",
    "41610f36281d57ea3abb005b": "SELECT T2.drug, COUNT(*) AS count\nFROM patients AS T1\nJOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id\nWHERE T1.gender = 'M' OR T1.gender = 'F'\nAND strftime('%Y', T2.starttime) >= '2100'\nAND (strftime('%Y', T2.starttime) - strftime('%Y', T1.dob)) = 40\nGROUP BY T2.drug\nORDER BY count DESC\nLIMIT 4;",
    "c8514097484be2c378e72761": "SELECT p.drug AS procedure\nFROM prescriptions p\nINNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.admittime >= DATE('now', 'start of year')\nAND p.starttime >= DATE('now', '-2 months')\nAND p.drug = 'Drainage of peritoneal cavity, percutaneous approach, diagnostic'\nGROUP BY p.drug\nORDER BY COUNT(p.drug) DESC\nLIMIT 5;",
    "6ef0a4d357592b4eadc2b1b7": "SELECT p.drug, COUNT(*) AS frequency\nFROM procedures_icd AS pr\nJOIN d_icd_procedures AS dp ON pr.icd_code = dp.icd_code\nJOIN prescriptions AS p ON pr.hadm_id = p.hadm_id\nWHERE dp.long_title = 'Open Reduction of Fracture with Internal Fixation, Humerus'\nAND p.starttime >= pr.charttime\nAND p.starttime < DATE(pr.charttime, '+1 month')\nGROUP BY p.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "7c6f2aa274207d68024f4cd4": "SELECT T1.drug, COUNT(T1.drug) AS frequency\nFROM prescriptions AS T1\nJOIN d_icd_procedures AS T2 ON T1.hadm_id = T2.icd_code\nWHERE T2.long_title = 'Fluoroscopy of right heart using other contrast since 2100'\nGROUP BY T1.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "bbebbefb1d815b174837d57e": "WITH PerCutaneousCTE AS (\n    SELECT subject_id, admittime\n    FROM admissions\n    WHERE admission_type = 'EMERGENCY' AND admission_location = 'ER' AND insurance = 'Percutaneous abdominal drainage'\n),\nSurgeryCTE AS (\n    SELECT subject_id, admittime, discharge_location\n    FROM admissions\n    WHERE admission_type = 'EMERGENCY' AND admission_location = 'ER' AND discharge_location IN ('Ward', 'Home')\n),\nSurgeryMonthCTE AS (\n    SELECT subject_id, strftime('%Y-%m', admittime) AS surgery_month\n    FROM SurgeryCTE\n),\nPercutaneousMonthCTE AS (\n    SELECT subject_id, strftime('%Y-%m', admittime) AS percutaneous_month\n    FROM PerCutaneousCTE\n),\nSurgeryPercutaneousCTE AS (\n    SELECT S.subject_id, S.surgery_month, P.percutaneous_month\n    FROM SurgeryMonthCTE S\n    INNER JOIN PerCutaneousMonthCTE P ON S.subject_id = P.subject_id AND S.surgery_month = P.percutaneous_month\n)\nSELECT discharge_location, COUNT(*) AS surgery_count\nFROM SurgeryCTE\nWHERE subject_id IN (\n    SELECT subject_id\n    FROM SurgeryPercutaneousCTE\n)\nGROUP BY discharge_location\nORDER BY surgery_count DESC\nLIMIT 4;",
    "c5fa37f5342eb658b8fa6776": "SELECT \n  p1.long_title AS procedure_name,\n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd pr\n  INNER JOIN d_icd_procedures p1 ON pr.icd_code = p1.icd_code\nWHERE \n  pr.charttime >= DATE('now', 'start of year') AND \n  pr.charttime < DATE('now', 'start of year', '+1 month')\nGROUP BY \n  pr.icd_code\nORDER BY \n  procedure_count DESC\nLIMIT 3;",
    "a3a4751b104710cf0148a297": "WITH spinal_tap_diagnoses AS (\n  SELECT \n    p.subject_id,\n    p.hadm_id\n  FROM \n    diagnoses_icd p\n  INNER JOIN \n    d_icd_diagnoses d ON p.icd_code = d.icd_code\n  WHERE \n    d.long_title LIKE '%spinal tap%'\n),\ntreatment_counts AS (\n  SELECT \n    pr.drug,\n    COUNT(pr.row_id) AS treatment_count\n  FROM \n    spinal_tap_diagnoses std\n  INNER JOIN \n    prescriptions pr ON std.subject_id = pr.subject_id AND std.hadm_id = pr.hadm_id\n  GROUP BY \n    pr.drug\n)\nSELECT \n  drug,\n  treatment_count\nFROM \n  treatment_counts\nORDER BY \n  treatment_count DESC\nLIMIT 3;",
    "a6ad56047cfb5ab47409c6a5": "",
    "46a6f6b786c670f60f62c369": "SELECT p.drug, COUNT(*) as num_prescriptions\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN prescriptions p ON di.hadm_id = p.hadm_id\nWHERE d.long_title LIKE '%long-term (current) use of opiate analgesic%'\n  AND p.starttime >= '2100-01-01'\nGROUP BY p.drug\nORDER BY num_prescriptions DESC\nLIMIT 4;",
    "53ae274dd031672e790039de": "WITH CandidalStomatitisDiagnoses AS (\n    SELECT \n        d.subject_id, \n        d.hadm_id, \n        d.charttime AS diagnosis_time\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE \n        dd.long_title = 'Candidal Stomatitis'\n),\nProceduresWithin2Months AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id, \n        p.charttime AS procedure_time,\n        d.icd_code, \n        dp.long_title AS procedure_name\n    FROM \n        procedures_icd p\n    INNER JOIN \n        d_icd_procedures dp ON p.icd_code = dp.icd_code\n    INNER JOIN \n        CandidalStomatitisDiagnoses d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\n    WHERE \n        p.charttime BETWEEN d.diagnosis_time AND DATE(d.diagnosis_time, '+2 months')\n)\nSELECT \n    procedure_name, \n    COUNT(*) AS frequency\nFROM \n    ProceduresWithin2Months\nWHERE \n    procedure_time >= DATE('now', '-1 year')\nGROUP BY \n    procedure_name\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "23a42f7835688c75021035ac": "SELECT p2.long_title AS procedure_title\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses d1 ON d.icd_code = d1.icd_code\nJOIN procedures_icd p ON d.hadm_id = p.hadm_id\nJOIN d_icd_procedures p2 ON p.icd_code = p2.icd_code\nWHERE d1.long_title = 'Diaphragmatic hernia' \n  AND p2.long_title NOT LIKE '%obstruction%' \n  AND p2.long_title NOT LIKE '%gangrene%'\nGROUP BY p2.long_title\nORDER BY COUNT(*) DESC\nLIMIT 4;",
    "1acf7fc31384e1c31147c768": "SELECT p.long_title, COUNT(*) as procedure_count\nFROM procedures_icd as pi\nJOIN d_icd_procedures as p ON pi.icd_code = p.icd_code\nWHERE pi.hadm_id IN (\n    SELECT hadm_id \n    FROM diagnoses_icd \n    WHERE icd_code = 'I47' AND charttime >= '2100-01-01' \n)\nGROUP BY p.long_title\nORDER BY procedure_count DESC\nLIMIT 3;",
    "71e45f1414e9c508d0f88b96": "",
    "1f8afcb7747a797d8e8f612a": "",
    "a35a9346ab483d0db0f202ca": "SELECT \n  d.long_title AS procedure_name,\n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd p\n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  INNER JOIN diagnoses_icd g ON p.hadm_id = g.hadm_id\n  INNER JOIN d_icd_diagnoses h ON g.icd_code = h.icd_code\nWHERE \n  h.long_title LIKE '%end stage renal disease%'\nGROUP BY \n  d.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 5;",
    "2efdde96ce7011cebcfc05db": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 4;",
    "a9b38a0fdefc73e3b49a6266": "SELECT drug, COUNT(*) AS total_orders\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY total_orders DESC\nLIMIT 4;",
    "4960b6194d17e9d1c2ac34f2": "SELECT drug, COUNT(*) AS drug_count\nFROM prescriptions\nWHERE starttime >= '2100-01-01'\nGROUP BY drug\nORDER BY drug_count DESC\nLIMIT 3;",
    "0f46ce74f036db898fe9d288": "SELECT \n  p.drug, \n  COUNT(p.drug) AS frequency\nFROM \n  prescriptions p\n  INNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE \n  a.admittime >= DATE('now', '-1 year')\nGROUP BY \n  p.drug\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "5e50d8202a81e15b06471b88": "SELECT drug, COUNT(*) AS num_prescriptions\nFROM prescriptions\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY drug\nORDER BY num_prescriptions DESC\nLIMIT 4;",
    "06b9ac11749e295ddd6d0c34": "SELECT p.drug, COUNT(p.drug) AS total_prescriptions\nFROM prescriptions p\nWHERE p.starttime >= datetime('now', '-1 year')\nGROUP BY p.drug\nORDER BY total_prescriptions DESC\nLIMIT 3;",
    "e9a9b12dc29949b932dfcb92": "SELECT drug, COUNT(*) as total\nFROM prescriptions\nWHERE starttime >= '2100-01-01'\nGROUP BY drug\nORDER BY total DESC\nLIMIT 3;",
    "421833b510b5ec197a16d68f": "SELECT \n  p.drug,\n  COUNT(p.row_id) as prescription_count\nFROM \n  prescriptions p\nWHERE \n  p.subject_id IN (\n    SELECT \n      p2.subject_id\n    FROM \n      prescriptions p2\n    WHERE \n      p2.drug = 'hydrocodone-acetaminophen (5mg-325mg)'\n      AND p2.starttime >= DATE('now', '-1 year')\n      AND p2.stoptime <= DATE('now')\n  )\n  AND p.starttime >= DATE('now', '-2 months')\n  AND p.stoptime <= DATE('now')\nGROUP BY \n  p.drug\nORDER BY \n  prescription_count DESC\nLIMIT 5;",
    "44162aee19eabadbab9a0172": "SELECT \n    p1.drug,\n    COUNT(p2.drug) AS drug_count\nFROM \n    prescriptions p1\nINNER JOIN \n    prescriptions p2 ON p1.subject_id = p2.subject_id\nWHERE \n    p1.drug = 'citrate dextrose 3% (acd-a) crrt'\n    AND p2.starttime > p1.stoptime\n    AND julianday(p2.starttime) - julianday(p1.stoptime) <= 60\n    AND p2.drug != 'citrate dextrose 3% (acd-a) crrt'\nGROUP BY \n    p1.drug\nORDER BY \n    drug_count DESC\nLIMIT 4;",
    "5f2f54291860e0ab6a44e725": "SELECT p.drug, COUNT(*) AS num_of_patients\nFROM prescriptions p\nWHERE p.starttime >= '2100-01-01' AND p.starttime < '2101-01-01'\n  AND p.subject_id IN (\n    SELECT pr.subject_id\n    FROM prescriptions pr\n    WHERE pr.starttime >= '2100-01-01' AND pr.starttime < '2101-01-01'\n      AND pr.drug LIKE '%plasmalyte%'\n  )\nGROUP BY p.drug\nORDER BY num_of_patients DESC\nLIMIT 5;",
    "48e40b5c41147007595a5175": "SELECT \n  drug, \n  COUNT(*) AS frequency\nFROM \n  prescriptions\nWHERE \n  starttime >= '2100-01-01' AND\n  starttime <= DATE((SELECT starttime FROM prescriptions WHERE drug = 'donepezil' LIMIT 1), '+2 months')\nGROUP BY \n  drug\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "7ec4445b22dfabb102812643": "SELECT T2.drug, COUNT(*) AS frequency\nFROM prescriptions AS T2\nWHERE T2.hadm_id IN (\n  SELECT T3.hadm_id\n  FROM prescriptions AS T3\n  WHERE T3.drug = 'MICONAZOLE POWDER 2%' AND T3.starttime >= '2100-01-01'\n)\nAND T2.starttime >= '2100-01-01'\nGROUP BY T2.drug\nORDER BY frequency DESC\nLIMIT 3;",
    "b85c5a437b3cb22920ce10fb": "SELECT T2.drug\nFROM admissions AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.drug = 'BUPROPION (SUSTAINED RELEASE)'\n  AND T2.starttime >= DATE('now', '-1 year')\nGROUP BY T2.drug\nORDER BY COUNT(T2.drug) DESC\nLIMIT 5;",
    "757270424b26647955e34c40": "WITH vecuronium_prescriptions AS (\n  SELECT \n    subject_id,\n    strftime('%Y-%m', starttime) AS vecuronium_month\n  FROM \n    prescriptions\n  WHERE \n    drug = 'Vecuronium Bromide'\n    AND starttime >= date('now', 'start of year')\n),\nfollowing_month_prescriptions AS (\n  SELECT \n    p.subject_id,\n    p.drug,\n    strftime('%Y-%m', p.starttime) AS prescription_month\n  FROM \n    prescriptions p\n  INNER JOIN \n    vecuronium_prescriptions vp \n  ON \n    p.subject_id = vp.subject_id\n  WHERE \n    p.starttime >= date(vp.vectronium_month || '-01', '+1 month')\n    AND p.starttime < date((vp.vectronium_month || '-01'), '+2 month')\n)\nSELECT \n  drug,\n  COUNT(*) AS prescription_count\nFROM \n  following_month_prescriptions\nGROUP BY \n  drug\nORDER BY \n  prescription_count DESC\nLIMIT 4;",
    "4a03eabf717f99697bb5ba08": "",
    "c8175712036320a9b391cf5f": "SELECT \n  p.drug,\n  COUNT(p.drug) AS frequency\nFROM \n  prescriptions p\nINNER JOIN \n  admissions a ON p.subject_id = a.subject_id AND p.hadm_id = a.hadm_id\nWHERE \n  a.admission_type = 'hemodialysis' \n  AND a.admittime >= DATE('now', '-1 year') \n  AND p.starttime BETWEEN a.admittime AND DATE(a.admittime, '+1 month')\nGROUP BY \n  p.drug\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "7a3e856c5351161f228b56ea": "SELECT T3.drug, COUNT(T3.drug) AS frequency\nFROM admissions T1\nINNER JOIN procedures_icd T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN prescriptions T3 ON T1.hadm_id = T3.hadm_id\nWHERE T1.admittime >= DATE('now', '-2 month')\nAND T2.icd_code = 'P00.61' -- Assuming this code refers to extracorporeal circulation auxiliary to open heart surgery\nGROUP BY T3.drug\nORDER BY frequency DESC\nLIMIT 5;",
    "242455bec537f7c263ad40b0": "WITH laparoscopic_procedures AS (\n  SELECT p.subject_id\n  FROM procedures_icd p\n  JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  WHERE d.long_title LIKE '%laparoscopic lysis of peritoneal adhesions%'\n  AND strftime('%Y', p.charttime) = '2100'\n  AND strftime('%m', p.charttime) = strftime('%m', date('now', '-1 month'))\n)\nSELECT pr.drug, COUNT(*) AS num_prescriptions\nFROM prescriptions pr\nJOIN laparoscopic_procedures lp ON pr.subject_id = lp.subject_id\nWHERE pr.starttime >= date('now', '-1 month')\nAND strftime('%Y', pr.starttime) = '2100'\nGROUP BY pr.drug\nORDER BY num_prescriptions DESC\nLIMIT 4;",
    "842e8f2f6e1757279aaf5fc9": "Select the top five most frequent medications.",
    "30f8a5d33eb7287c9cf8412a": "SELECT p1.drug AS medication, COUNT(*) AS frequency\nFROM prescriptions p1\nINNER JOIN procedures_icd p2 ON p1.subject_id = p2.subject_id AND p1.hadm_id = p2.hadm_id\nWHERE p2.icd_code = 'E10.0'\nAND p1.drug IS NOT NULL\nGROUP BY p1.drug\nHAVING COUNT(*) > 1\nORDER BY frequency DESC\nLIMIT 4;",
    "4cfe2481c4220d5f42e7a66c": "SELECT drug\nFROM (\n    SELECT p.drug, COUNT(*) AS count\n    FROM prescriptions p\n    JOIN procedures_icd pr ON p.hadm_id = pr.hadm_id\n    WHERE pr.icd_code = 'Q53.1'\n    GROUP BY p.drug\n)\nORDER BY count DESC\nLIMIT 5;",
    "dbbf8af9c5e0fe77e81a2ecc": "SELECT \n  p.drug, \n  COUNT(p.drug) as drug_count\nFROM \n  prescriptions p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nWHERE \n  d.icd_code = 'K26.0'\n  AND p.starttime >= '2100-01-01 00:00:00'\n  AND p.stoptime <= '2100-12-31 23:59:59'\nGROUP BY \n  p.drug\nORDER BY \n  drug_count DESC\nLIMIT 5;",
    "2f7d49a71a664a3c5367e8a7": "SELECT T2.drug, COUNT(T2.drug) AS frequency\nFROM diagnoses_icd AS T1\nINNER JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nWHERE T3.icd_code LIKE '2100%' AND T2.starttime >= T1.charttime AND T2.starttime < DATE(T1.charttime, '+1 month')\nGROUP BY T2.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "9177cde69132a37cbac544ee": "SELECT p.drug, COUNT(*) AS frequency\nFROM prescriptions p\nINNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title LIKE '%Defibrination Syndrome%'\n  AND p.starttime >= DATE('now', '-1 year')\n  AND p.starttime <= DATE('now', '-1 month')\nGROUP BY p.drug\nORDER BY frequency DESC\nLIMIT 3;",
    "144cd6f1acfad4416003c26c": "SELECT \n  p.drug, \n  COUNT(*) AS prescription_count\nFROM \n  prescriptions p\n  INNER JOIN diagnoses_icd di ON p.hadm_id = di.hadm_id AND p.subject_id = di.subject_id\nWHERE \n  di.icd_code = 'Q24.1' \nGROUP BY \n  p.drug\nORDER BY \n  prescription_count DESC\nLIMIT 4;",
    "aef8b935473950853a7d8448": "select the top three.",
    "2b134de41e611c4124b04f3b": "SELECT p.drug, COUNT(*) as num_prescriptions\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nJOIN prescriptions p ON d.hadm_id = p.hadm_id\nWHERE d2.long_title = 'Cardiogenic Shock'\nAND strftime('%Y-%m', p.starttime) = strftime('%Y-%m', d.charttime)\nGROUP BY p.drug\nORDER BY num_prescriptions DESC\nLIMIT 3;",
    "48f94d76de26cca5b25ee77f": "SELECT p.drug, COUNT(*) AS order_count\nFROM prescriptions p\nINNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses did ON d.icd_code = did.icd_code\nWHERE did.long_title = 'Acquired absence of organ, genital organs previously'\nAND strftime('%Y', p.starttime) = strftime('%Y', 'now')\nGROUP BY p.drug\nORDER BY order_count DESC\nLIMIT 3;",
    "f9dc2fa964b252fd6c5baac9": "WITH PatientsDiagnosed AS (\n    SELECT \n        p.subject_id\n    FROM \n        patients p\n        JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n        JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE \n        dd.long_title LIKE '%esophageal reflux%' \n        AND p.gender = 'Male' \n        AND strftime('%Y', p.dob) <= '1960' \n        AND strftime('%Y', p.dod) >= '2100'\n),\nPrescribedDrugs AS (\n    SELECT \n        pr.drug\n    FROM \n        PatientsDiagnosed pd\n        JOIN prescriptions pr ON pd.subject_id = pr.subject_id\n    WHERE \n        strftime('%Y', pr.starttime) >= '2100'\n)\nSELECT \n    drug,\n    COUNT(*) AS frequency\nFROM \n    PrescribedDrugs\nGROUP BY \n    drug\nORDER BY \n    frequency DESC\nLIMIT 3;",
    "e55b54e06750117ab5f1a053": "WITH NonspecificDiagnosis AS (\n    SELECT di.subject_id\n    FROM diagnoses_icd di\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE d.long_title LIKE '%nonspecific elevation of levels of transaminase or lactic acid dehydrogenase [ldh] since 2100%'\n),\nPatientsInTheir50s AS (\n    SELECT p.subject_id\n    FROM patients p\n    WHERE strftime('%Y', p.dob) = strftime('%Y', 'now', '-50 years')\n),\nPrescriptionsInMonth AS (\n    SELECT pr.drug, strftime('%Y-%m', pr.starttime) AS month\n    FROM prescriptions pr\n    INNER JOIN NonspecificDiagnosis nd ON pr.subject_id = nd.subject_id\n    INNER JOIN PatientsInTheir50s pit50 ON pr.subject_id = pit50.subject_id\n    WHERE strftime('%Y', pr.starttime) >= strftime('%Y', 'now', '-50 years')\n)\nSELECT drug, COUNT(*) AS count\nFROM PrescriptionsInMonth\nGROUP BY drug, month\nORDER BY count DESC\nLIMIT 5;",
    "1eb7d8845e0439e31945047c": "SELECT \n  p.drug AS most_frequent_drug\nFROM \n  admissions a\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN prescriptions p ON a.hadm_id = p.hadm_id\nWHERE \n  d.icd_code = 'I50'  -- Acute pulmonary edema\n  AND a.admittime >= DATE('now', '-1 year')  -- Admitted within the last year\n  AND p.starttime <= DATE(a.admittime, '+2 months')  -- Prescribed within 2 months\n  AND a.age BETWEEN 45 AND 55  -- Patients in their 50s\nGROUP BY \n  p.drug\nORDER BY \n  COUNT(p.drug) DESC\nLIMIT 5;",
    "80d21b657d5ff088f889a360": "SELECT T1.drug, COUNT(*) AS num_prescriptions\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN patients AS T3 ON T1.subject_id = T3.subject_id\nWHERE T2.icd_code IN (\n  SELECT icd_code\n  FROM d_icd_diagnoses\n  WHERE long_title LIKE '%Pulmonary Collapse%'\n)\nAND T3.age BETWEEN 50 AND 59\nGROUP BY T1.drug\nORDER BY num_prescriptions DESC\nLIMIT 3;",
    "41cdc4c25b362c10ff183c0c": "SELECT p.drug, COUNT(p.drug) AS total_prescriptions\nFROM prescriptions p\nINNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE d.icd_code = 'I47' \n  AND p.starttime >= DATE('now', '-2100 years') \n  AND p.starttime < DATE('now', '+2 months') \n  AND a.age >= 60\nGROUP BY p.drug\nORDER BY total_prescriptions DESC\nLIMIT 5;",
    "2666b04409be1528ae23a0f2": "SELECT \n    p.drug, \n    COUNT(*) AS frequency\nFROM \n    diagnoses_icd AS d\nINNER JOIN \n    admissions AS a ON d.hadm_id = a.hadm_id\nINNER JOIN \n    prescriptions AS p ON p.hadm_id = a.hadm_id\nINNER JOIN \n    d_icd_diagnoses AS dicd ON d.icd_code = dicd.icd_code\nWHERE \n    dicd.long_title LIKE '%esophageal reflux%' \n    AND a.admittime >= '2100-01-01' \n    AND a.admittime <= DATE('2100-01-01', '+2 months') \n    AND a.age >= 60\nGROUP BY \n    p.drug\nORDER BY \n    frequency DESC\nLIMIT 4;",
    "b37d67ade52f97c81e373d0a": "SELECT \n  T2.drug, \n  COUNT(*) as frequency\nFROM \n  diagnoses_icd AS T1 \n  INNER JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\n  INNER JOIN d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nWHERE \n  T3.long_title LIKE '%long-term (current) use of anticoagulants%'\n  AND T2.starttime >= '2100-01-01'\n  AND T2.starttime <= date('now', '-2 months')\nGROUP BY \n  T2.drug\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "d13e321a100730513005c82e": "SELECT itemid, COUNT(*) AS test_count\nFROM labevents\nWHERE charttime > '2100-01-01'\nGROUP BY itemid\nORDER BY test_count DESC\nLIMIT 4;",
    "af7e3057fad8f361ba5398f2": "SELECT \n  d_labitems.label, \n  COUNT(labevents.row_id) AS total_tests\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nGROUP BY \n  d_labitems.label\nORDER BY \n  total_tests DESC\nLIMIT 3;",
    "f84cee29b1ae0e5b38a4dad0": "SELECT \n  dli.label AS test_name,\n  COUNT(le.row_id) AS count\nFROM \n  labevents le\nJOIN \n  d_labitems dli ON le.itemid = dli.itemid\nGROUP BY \n  dli.label\nORDER BY \n  count DESC\nLIMIT 5;",
    "1d528e1e56f65f65ff457076": "SELECT \n  T2.label,\n  COUNT(T1.row_id) AS num_tests\nFROM \n  labevents T1\n  INNER JOIN d_labitems T2 ON T1.itemid = T2.itemid\nWHERE \n  strftime('%Y', T1.charttime) = '2100'\nGROUP BY \n  T2.label\nORDER BY \n  num_tests DESC\nLIMIT 3;",
    "5fb01bc80ec79080b29a6120": "SELECT \n    d.label AS test_name,\n    COUNT(le.row_id) AS test_count\nFROM \n    labevents le\nJOIN \n    d_labitems d ON le.itemid = d.itemid\nWHERE \n    strftime('%Y', le.charttime) = strftime('%Y', 'now')\nGROUP BY \n    d.label\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "ce78082eae0149ee1ca4091e": "",
    "7bd6751dde3ebad15506d38c": "SELECT itemid, COUNT(*) AS count\nFROM labevents\nGROUP BY itemid\nORDER BY count DESC\nLIMIT 3;",
    "bf24656774e10abbee09d3cd": "",
    "cef34f939a935672ef767a10": "SELECT \n  d_labitems.label AS test_name,\n  COUNT(labevents.itemid) AS test_count\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.charttime BETWEEN '2100-01-01' AND '2100-12-31'\n  AND labevents.subject_id IN (\n    SELECT \n      admissions.subject_id\n    FROM \n      admissions\n    WHERE \n      admissions.admittime BETWEEN '2100-01-01' AND '2100-12-31'\n      AND admissions.age BETWEEN 30 AND 39\n  )\nGROUP BY \n  d_labitems.label\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "d1d88ee5c7476300c168be49": "SELECT \n  l.label AS test_label,\n  COUNT(*) AS test_count\nFROM \n  labevents le\nINNER JOIN \n  d_labitems l ON le.itemid = l.itemid\nINNER JOIN \n  admissions a ON le.hadm_id = a.hadm_id\nWHERE \n  a.age >= 60\nGROUP BY \n  l.label\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "a3ae25ab7f7d7f11e9ba773d": "SELECT \n    l.label AS lab_test,\n    COUNT(*) AS test_count\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nJOIN patients p ON le.subject_id = p.subject_id\nWHERE strftime('%Y', le.charttime) = '2100'\n    AND strftime('%Y', p.dob) BETWEEN '1960' AND '2000'\n    AND (strftime('%Y', p.dob) + 40) = strftime('%Y', le.charttime)\nGROUP BY l.label\nORDER BY test_count DESC\nLIMIT 5;",
    "d53c40ad49a43a529f6a58f1": "SELECT l.label, COUNT(*) AS count\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nJOIN patients p ON le.subject_id = p.subject_id\nWHERE le.charttime > DATETIME('now', '-1 year') \nAND strftime('%Y', 'now') - strftime('%Y', p.dob) BETWEEN 30 AND 39\nGROUP BY l.label\nORDER BY count DESC\nLIMIT 3;",
    "7057698bd91fd3229c372ff8": "SELECT \n  d_labitems.label AS test_name,\n  COUNT(labevents.row_id) AS num_tests\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\n  INNER JOIN admissions ON labevents.hadm_id = admissions.hadm_id\nWHERE \n  admissions.admittime >= DATE('now', '-1 year') \n  AND admissions.age BETWEEN 20 AND 29\nGROUP BY \n  d_labitems.label\nORDER BY \n  num_tests DESC\nLIMIT 3;",
    "66d3d7f7819e195408389a4b": "SELECT \n  L.label AS test_label,\n  COUNT(*) AS order_count\nFROM \n  labevents LE\n  INNER JOIN d_labitems L ON LE.itemid = L.itemid\nWHERE \n  strftime('%Y', LE.charttime) - strftime('%Y', (SELECT dob FROM patients WHERE subject_id = LE.subject_id)) = 20\nGROUP BY \n  L.label\nORDER BY \n  order_count DESC\nLIMIT 3;",
    "dd62c1497314b1bea83b2d03": "WITH MalignantNeoplasmDiagnoses AS (\n    SELECT d.subject_id, d.hadm_id\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n    WHERE ddi.long_title LIKE '%personal history of malignant neoplasm of other gastrointestinal tract%'\n),\nLabEventCounts AS (\n    SELECT l.itemid, dl.label, COUNT(*) AS event_count\n    FROM labevents l\n    INNER JOIN d_labitems dl ON l.itemid = dl.itemid\n    INNER JOIN MalignantNeoplasmDiagnoses mnd ON l.subject_id = mnd.subject_id AND l.hadm_id = mnd.hadm_id\n    GROUP BY l.itemid, dl.label\n)\nSELECT label, event_count\nFROM LabEventCounts\nORDER BY event_count DESC\nLIMIT 3;",
    "1fe684c6e5b20d9ad964f6ac": "SELECT d_labitems.label, COUNT(*) as count\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id IN (\n    SELECT diagnoses_icd.subject_id\n    FROM diagnoses_icd\n    INNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\n    WHERE d_icd_diagnoses.long_title LIKE '%insomnia, unspecified since 2100%'\n)\nAND strftime('%Y-%m', labevents.charttime) = strftime('%Y-%m', (\n    SELECT MIN(diagnoses_icd.charttime)\n    FROM diagnoses_icd\n    INNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\n    WHERE d_icd_diagnoses.long_title LIKE '%insomnia, unspecified since 2100%'\n    AND diagnoses_icd.subject_id = labevents.subject_id\n))\nGROUP BY d_labitems.label\nORDER BY count DESC\nLIMIT 5;",
    "0bdfa86a31bd61b14767f632": "SELECT \n  di.label AS lab_test, \n  COUNT(*) AS count_of_tests\nFROM \n  diagnoses_icd d_i\n  INNER JOIN d_icd_diagnoses d ON d_i.icd_code = d.icd_code\n  INNER JOIN labevents l_e ON d_i.hadm_id = l_e.hadm_id\n  INNER JOIN d_labitems di ON l_e.itemid = di.itemid\nWHERE \n  d.long_title LIKE '%BMI 32.0-32.9, Adult%'\n  AND l_e.charttime >= DATE('now', 'start of year', '+2100 months')\n  AND l_e.charttime < DATE('now', 'start of year', '+2101 months')\nGROUP BY \n  di.label\nORDER BY \n  count_of_tests DESC\nLIMIT 3;",
    "8cbd43defc418d1da88f21b2": "SELECT \n  labevents.itemid, \n  COUNT(*) AS total_count\nFROM \n  labevents\n  INNER JOIN diagnoses_icd ON labevents.hadm_id = diagnoses_icd.hadm_id\n  INNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE \n  d_icd_diagnoses.long_title LIKE '%body mass index between 19-24%' \n  AND labevents.charttime > DATETIME('now', '-1 year')\n  AND labevents.charttime BETWEEN (\n    SELECT admittime FROM admissions WHERE admissions.hadm_id = labevents.hadm_id\n  ) AND (\n    SELECT dischtime FROM admissions WHERE admissions.hadm_id = labevents.hadm_id\n  )\nGROUP BY \n  labevents.itemid\nORDER BY \n  total_count DESC\nLIMIT 3;",
    "89a55d6a6cba3898d5b52d9c": "select the top three.",
    "e874c2a103f4267d6ddfed15": "SELECT \n  l.itemid, \n  COUNT(l.charttime) AS frequency\nFROM \n  labevents l\n  INNER JOIN diagnoses_icd d ON l.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE \n  dd.long_title = 'Cerebral laceration and contusion, other and unspecified, without open intracranial wound, with loss of consciousness of unspecified duration'\n  AND l.charttime >= '2100-01-01'\n  AND l.charttime <= DATE('2100-12-31', '+1 month')\nGROUP BY \n  l.itemid\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "6d7e2ca9e692a3b833e8d4c2": "SELECT l.label, COUNT(*) as count\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nJOIN diagnoses_icd di ON di.subject_id = le.subject_id AND di.hadm_id = le.hadm_id\nWHERE di.icd_code = 'C2100'\nGROUP BY l.label\nORDER BY count DESC\nLIMIT 5;",
    "70826ed4c727196227cb1ef9": "SELECT \n    d_labitems.label, \n    COUNT(labevents.row_id) as count\nFROM \n    labevents\nINNER JOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nINNER JOIN \n    procedures_icd ON labevents.hadm_id = procedures_icd.hadm_id AND labevents.subject_id = procedures_icd.subject_id\nWHERE \n    procedures_icd.icd_code = '00.72' \n    AND labevents.charttime BETWEEN procedures_icd.charttime AND DATE(procedures_icd.charttime, '+1 month')\nGROUP BY \n    d_labitems.label\nORDER BY \n    count DESC\nLIMIT 5;",
    "5a615775859c42b0cfc588b1": "SELECT \n  L.itemid,\n  COUNT(*) AS frequency\nFROM \n  labevents L\n  INNER JOIN procedures_icd P ON L.subject_id = P.subject_id AND L.hadm_id = P.hadm_id\nWHERE \n  STRFTIME('%Y-%m', L.charttime) = STRFTIME('%Y-%m', P.charttime)\n  AND P.icd_code = 'R21.00'\nGROUP BY \n  L.itemid\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "96dabd861de92e31433a8552": "",
    "03a6a876fbcd2443f7f28749": "SELECT \n  d_labitems.label, \n  COUNT(labevents.row_id) as test_count\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.charttime LIKE strftime('%Y-%m-%d', labevents.charttime) || '%'\n  AND labevents.charttime BETWEEN DATE('now', 'start of month') AND DATE('now', 'start of month', '+1 month', '-1 day')\nGROUP BY d_labitems.label\nORDER BY test_count DESC\nLIMIT 4;",
    "7af6e600c77232304b81e62d": "",
    "91b9ca43bd8f11ad31a158c7": "",
    "43bc1abffacc510680225ed9": "SELECT l.label, COUNT(*) as test_count\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nJOIN procedures_icd pi ON le.hadm_id = pi.hadm_id\nWHERE pi.icd_code = 'T47.280'\nAND le.charttime BETWEEN DATE('now', '-1 year') AND DATE('now', '+1 month')\nGROUP BY l.label\nORDER BY test_count DESC\nLIMIT 3;",
    "ecea3263ba9f3a57a309a2e0": "SELECT spec_type_desc, COUNT(*) as count\nFROM microbiologyevents\nWHERE charttime >= DATE('now', '-1 year')\nGROUP BY spec_type_desc\nORDER BY count DESC\nLIMIT 3;",
    "edfa0b11933920062d92aacd": "SELECT spec_type_desc, COUNT(*) as test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY spec_type_desc\nORDER BY test_count DESC\nLIMIT 5;",
    "26803d48dd00e769e38ea0c9": "SELECT spec_type_desc, COUNT(*) AS count\nFROM microbiologyevents\nWHERE charttime >= DATE('now', '-1 year')\nGROUP BY spec_type_desc\nORDER BY count DESC\nLIMIT 4;",
    "9e48890388b483b0f182a90f": "SELECT \n  spec_type_desc, \n  COUNT(*) AS test_count\nFROM \n  microbiologyevents\nGROUP BY \n  spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "1be9f21ac47235a697190eda": "SELECT \n    spec_type_desc, \n    COUNT(*) AS total_tests\nFROM \n    microbiologyevents\nWHERE \n    charttime >= DATE('now', 'start of year')\nGROUP BY \n    spec_type_desc\nORDER BY \n    total_tests DESC\nLIMIT 3;",
    "ebbeed93dad8985ba95cce74": "SELECT \n  spec_type_desc, \n  COUNT(*) AS test_count\nFROM \n  microbiologyevents\nGROUP BY \n  spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "dbc4399f5a3526b4598df3ef": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = '2100'\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 4;",
    "bbd60f29527c9ff438a314a7": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = '2100'\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "1fc44208dad68f8a906cda39": "SELECT \n  test_name, \n  COUNT(test_name) AS test_count\nFROM \n  microbiologyevents\nWHERE \n  strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY \n  test_name\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "4a3678f63c0a0b08ed66585f": "SELECT \n  test_name, \n  COUNT(*) AS test_count\nFROM \n  microbiologyevents\nGROUP BY \n  test_name\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "d2e2315a6ae7e509d95f1cdd": "SELECT \n  test_name, \n  COUNT(test_name) AS test_count\nFROM \n  microbiologyevents\nWHERE \n  STRFTIME('%Y', charttime) = STRFTIME('%Y', CURRENT_DATE)\nGROUP BY \n  test_name\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "4fcb903cb5d317c791dae3af": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE charttime >= '2100-01-01'\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "4fd7632b17c70b416ebcfdda": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nWHERE charttime >= DATE('now', 'start of year')\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 3;",
    "bf89f78810c2095c0e36f24b": "SELECT test_name, COUNT(*) as test_count\nFROM microbiologyevents\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 4;",
    "433a98b0bf77207fccd6fb2f": "SELECT \n  m.spec_type_desc, \n  COUNT(m.spec_type_desc) AS spec_count\nFROM \n  diagnoses_icd d\n  INNER JOIN admissions a ON d.hadm_id = a.hadm_id\n  INNER JOIN microbiologyevents m ON d.hadm_id = m.hadm_id\nWHERE \n  d.icd_code = 'V01.2'  \nGROUP BY \n  m.spec_type_desc\nORDER BY \n  spec_count DESC\nLIMIT 5;",
    "9e193ae2615e441e04331514": "SELECT \n  T1.spec_type_desc,\n  COUNT(*) AS test_count\nFROM \n  microbiologyevents T1\nINNER JOIN \n  diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n  d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\nWHERE \n  T3.long_title LIKE '%encounter for attention to other artificial openings of digestive tract%'\n  AND T1.charttime BETWEEN T2.charttime AND DATE(T2.charttime, '+2 months')\nGROUP BY \n  T1.spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "65d676a4636cc2e1592ca2c0": "SELECT \n  me.spec_type_desc,\n  COUNT(*) as test_frequency\nFROM \n  microbiologyevents me\n  INNER JOIN diagnoses_icd di ON me.hadm_id = di.hadm_id\nWHERE \n  di.icd_code = '2100' \n  AND DATE(me.charttime) BETWEEN DATE(di.charttime, 'start of month') AND DATE(di.charttime, '+1 month', '-1 day')\nGROUP BY \n  me.spec_type_desc\nORDER BY \n  test_frequency DESC\nLIMIT 4;",
    "5fc8a96c9b2c962520c2667f": "SELECT \n    spec_type_desc, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents me\nJOIN \n    diagnoses_icd di ON me.hadm_id = di.hadm_id\nWHERE \n    di.icd_code = 'P92.03' \n    AND me.charttime >= DATE('now', '-1 year')\nGROUP BY \n    spec_type_desc\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "925dc1173f6122d67b2847c7": "WITH diagnoses AS (\n    SELECT \n        T1.subject_id, \n        T1.hadm_id,\n        STRFTIME('%Y-%m', T1.charttime) AS diagnosis_month\n    FROM \n        diagnoses_icd T1\n    INNER JOIN \n        d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\n    WHERE \n        T2.long_title IN ('Oliguria', 'Anuria')\n),\nfiltered_diagnoses AS (\n    SELECT \n        subject_id,\n        diagnosis_month\n    FROM \n        diagnoses\n    WHERE \n        diagnosis_month IN (\n            SELECT diagnosis_month \n            FROM diagnoses \n            WHERE subject_id = diagnoses.subject_id \n            GROUP BY diagnosis_month\n            HAVING COUNT(DISTINCT long_title) = 2\n        )\n)\nSELECT \n    T1.spec_type_desc,\n    COUNT(*) AS test_count\nFROM \n    filtered_diagnoses T0\nINNER JOIN \n    diagnoses_icd T2 ON T0.subject_id = T2.subject_id\nINNER JOIN \n    microbiologyevents T1 ON T2.hadm_id = T1.hadm_id\nWHERE \n    STRFTIME('%Y', T1.charttime) = STRFTIME('%Y', 'now')\nGROUP BY \n    T1.spec_type_desc\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "325e6c5f09459a46cc53281b": "WITH DiagnosedPatients AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN diagnoses_icd di ON p.subject_id = di.subject_id\n    JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE d.long_title = 'Chronic lymphocytic leukemia of B-cell type not having achieved remission'\n),\nSpecimensTested AS (\n    SELECT me.spec_type_desc, COUNT(*) AS test_count\n    FROM DiagnosedPatients dp\n    JOIN admissions a ON dp.subject_id = a.subject_id\n    JOIN microbiologyevents me ON a.hadm_id = me.hadm_id\n    GROUP BY me.spec_type_desc\n)\nSELECT spec_type_desc, test_count\nFROM SpecimensTested\nORDER BY test_count DESC\nLIMIT 5;",
    "50cfc25b33dbf1f04dd32e42": "",
    "7a8ffac3b4d9276671a4aa1f": "",
    "10c4954997c7b5eab9c3c231": "SELECT \n  m.test_name,\n  COUNT(*) as test_count\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses d1 ON d.icd_code = d1.icd_code\n  INNER JOIN microbiologyevents m ON a.hadm_id = m.hadm_id\nWHERE \n  d1.long_title LIKE '%noncompliance with renal dialysis%' \n  AND m.charttime BETWEEN a.admittime AND DATE(a.admittime, '+2 months')\nGROUP BY \n  m.test_name\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "ff5188901ba8d46da87b9474": "SELECT \n  m.test_name, \n  COUNT(*) AS test_count\nFROM \n  patients p\nINNER JOIN \n  admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n  diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN \n  d_icd_diagnoses di ON d.icd_code = di.icd_code\nINNER JOIN \n  microbiologyevents m ON p.subject_id = m.subject_id\nWHERE \n  di.long_title LIKE '%ischemic cardiomyopathy%' \n  AND m.charttime >= a.admittime \n  AND m.charttime < DATE(a.admittime, '+1 month')\nGROUP BY \n  m.test_name\nORDER BY \n  test_count DESC\nLIMIT 4;",
    "e63613e89815854b2cdf338c": "WITH HemoperitoneumDiagnoses AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id\n    FROM diagnoses_icd d\n    INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n    WHERE di.long_title LIKE '%hemoperitoneum%'\n      AND d.charttime >= '2100-01-01'\n),\nMicrobiologyTests AS (\n    SELECT \n        m.subject_id,\n        m.hadm_id,\n        m.test_name\n    FROM microbiologyevents m\n    INNER JOIN HemoperitoneumDiagnoses hd ON m.subject_id = hd.subject_id AND m.hadm_id = hd.hadm_id\n)\nSELECT \n    test_name,\n    COUNT(*) AS test_count\nFROM MicrobiologyTests\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 3;",
    "26c5ef7c7c93262038e4d7d0": "SELECT T1.test_name, COUNT(*) AS frequency\nFROM microbiologyevents AS T1\nINNER JOIN diagnoses_icd AS T2\nON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_diagnoses AS T3\nON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes'\nGROUP BY T1.test_name\nORDER BY frequency DESC\nLIMIT 5;",
    "e62be6f32c868f298911cc1e": "SELECT \n  test_name,\n  COUNT(*) as count\nFROM \n  microbiologyevents me\n  INNER JOIN diagnoses_icd d ON me.subject_id = d.subject_id AND strftime('%Y-%m', me.charttime) = strftime('%Y-%m', d.charttime)\n  INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n  d2.long_title LIKE '%Supermarket%' \n  OR d2.long_title LIKE '%Store%' \n  OR d2.long_title LIKE '%Market%'\nGROUP BY \n  test_name\nORDER BY \n  count DESC\nLIMIT 4;",
    "10f5ecdf9123785c95f2bff6": "SELECT \n  m.test_name, \n  COUNT(*) as frequency\nFROM \n  microbiologyevents m\nINNER JOIN \n  transfers t ON m.subject_id = t.subject_id AND m.hadm_id = t.hadm_id\nWHERE \n  t.eventtype = '_DEPENDENCE ON RESPIRATOR' \n  AND m.charttime >= DATE(t.intime, 'START OF MONTH', '+1 DAY') \n  AND m.charttime < DATE(t.intime, 'START OF MONTH', '+1 MONTH')\nGROUP BY \n  m.test_name\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "ed1c971e6bd14f5788256c98": "SELECT \n  m.spec_type_desc AS \"Specimen Description\", \n  COUNT(*) AS \"Specimen Count\"\nFROM \n  microbiologyevents m\nJOIN \n  procedures_icd p ON m.subject_id = p.subject_id AND m.hadm_id = p.hadm_id\nWHERE \n  p.icd_code = '00.00'\nGROUP BY \n  m.spec_type_desc\nORDER BY \n  \"Specimen Count\" DESC\nLIMIT 3;",
    "f5b5e126ecc950d4e5b6eb18": "SELECT \n    m.spec_type_desc,\n    COUNT(*) AS total_tests\nFROM \n    microbiologyevents m\nINNER JOIN \n    procedures_icd p ON m.subject_id = p.subject_id AND m.hadm_id = p.hadm_id\nINNER JOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n    d.long_title = 'Fluoroscopy of right heart using other contrast'\n    AND m.charttime BETWEEN DATE('now', '-1 year') AND DATE('now', '-2 months')\nGROUP BY \n    m.spec_type_desc\nORDER BY \n    total_tests DESC\nLIMIT 5;",
    "7d987252b086db272f8e0751": "WITH procedure_filter AS (\n  SELECT hadm_id, subject_id\n  FROM procedures_icd p\n  JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  WHERE d.long_title = 'drainage of peritoneal cavity, percutaneous approach'\n),\nlabevents_filtered AS (\n  SELECT le.itemid, le.charttime\n  FROM labevents le\n  JOIN procedure_filter pf ON le.hadm_id = pf.hadm_id AND le.subject_id = pf.subject_id\n  WHERE strftime('%Y-%m', le.charttime) = '2100-01'\n)\nSELECT d.long_title, COUNT(*) as test_count\nFROM labevents_filtered l\nJOIN d_labitems d ON l.itemid = d.itemid\nGROUP BY d.long_title\nORDER BY test_count DESC\nLIMIT 3;",
    "f9e732b63b0f86d15d3ab6be": "SELECT \n  spec_type_desc,\n  COUNT(*) AS num_tests\nFROM \n  microbiologyevents\nWHERE \n  charttime BETWEEN \n    (SELECT MIN(admittime) FROM admissions WHERE discharge_location = 'Left Femoral Vein, Percutaneous Approach') \n    AND \n    (SELECT MAX(admittime) FROM admissions WHERE discharge_location = 'Left Femoral Vein, Percutaneous Approach')\nGROUP BY \n  spec_type_desc\nORDER BY \n  num_tests DESC\nLIMIT 5;",
    "2ee9bfe879e3910ff859b7cc": "SELECT \n    d.spec_type_desc,\n    COUNT(*) AS specimen_count\nFROM \n    microbiologyevents d\nJOIN \n    procedures_icd p ON d.subject_id = p.subject_id AND d.hadm_id = p.hadm_id\nWHERE \n    p.icd_code = 'P00.0' AND\n    d.charttime > p.charttime AND\n    d.charttime <= DATE(p.charttime, '+2 months')\nGROUP BY \n    d.spec_type_desc\nORDER BY \n    specimen_count DESC\nLIMIT 4;",
    "aec06629971fa88ed8810ca9": "SELECT \n  m.spec_type_desc, \n  COUNT(m.spec_type_desc) AS count\nFROM \n  admissions a\n  INNER JOIN procedures_icd p ON a.hadm_id = p.hadm_id\n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  INNER JOIN microbiologyevents m ON a.hadm_id = m.hadm_id\nWHERE \n  d.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic'\n  AND m.charttime >= DATE('now', 'start of year', '-2 months')\nGROUP BY \n  m.spec_type_desc\nORDER BY \n  count DESC\nLIMIT 5;",
    "4ba8cbb501d0444c977e72d0": "",
    "be6fb8ffe49a397f297313f4": "SELECT \n  i.itemid, \n  d.label, \n  SUM(i.totalamount) AS total_input_amount\nFROM \n  inputevents i\nINNER JOIN \n  d_items d ON i.itemid = d.itemid\nWHERE \n  i.starttime >= DATE('now', '-1 year')\nGROUP BY \n  i.itemid, d.label\nORDER BY \n  total_input_amount DESC\nLIMIT 5;",
    "bd78210b53ac66e8ca86ce3a": "SELECT itemid, COUNT(*) AS input_count\nFROM inputevents\nWHERE starttime >= '2100-01-01'\nGROUP BY itemid\nORDER BY input_count DESC\nLIMIT 4;",
    "f3977e7e8ae83d49d9e455e4": "SELECT itemid, COUNT(*) AS total_events\nFROM inputevents\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY itemid\nORDER BY total_events DESC\nLIMIT 5;",
    "66479b0a7f2004d265bf0c60": "SELECT itemid, COUNT(*) AS input_count\nFROM inputevents\nWHERE starttime >= '2100-01-01 00:00:00'\nGROUP BY itemid\nORDER BY input_count DESC\nLIMIT 5;",
    "95f221c0f7e5b86fbfb2ff79": "SELECT itemid, COUNT(*) as count\nFROM inputevents\nWHERE starttime >= DATE('now', 'start of year')\nGROUP BY itemid\nORDER BY count DESC\nLIMIT 4;",
    "daa34761c136dbde698516a2": "SELECT totalamountuom, COUNT(*) as frequency\nFROM inputevents\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY totalamountuom\nORDER BY frequency DESC\nLIMIT 4;",
    "e1f8cb5aaff18c51a75dbced": "SELECT \n  i.itemid, \n  d.label, \n  SUM(i.totalamount) AS total_amount\nFROM \n  inputevents i\nINNER JOIN \n  d_items d ON i.itemid = d.itemid\nWHERE \n  strftime('%Y', i.starttime) = '2100'\nGROUP BY \n  i.itemid, d.label\nORDER BY \n  total_amount DESC\nLIMIT 5;",
    "2a77f183135d862ea4731d6a": "SELECT valueuom, COUNT(*) as frequency\nFROM outputevents\nWHERE charttime >= '2100-01-01'\nGROUP BY valueuom\nORDER BY frequency DESC\nLIMIT 3;",
    "fdafa588e078b95229c79d45": "SELECT itemid, COUNT(*) AS frequency \nFROM outputevents \nGROUP BY itemid \nORDER BY frequency DESC \nLIMIT 5;",
    "9d45b985bd7bacacbf80b3c2": "SELECT \n  oe.itemid, \n  COUNT(*) AS output_count\nFROM \n  outputevents oe\nGROUP BY \n  oe.itemid\nORDER BY \n  output_count DESC\nLIMIT 3;",
    "6537f5be5f67a433fed84ca7": "SELECT value, COUNT(*) as count \nFROM outputevents \nWHERE valueuom = '2100' \nGROUP BY value \nORDER BY count DESC \nLIMIT 4;",
    "6730aa47b18b0105eb3dd8a2": "SELECT \n  event_type,\n  COUNT(*) AS event_count\nFROM \n  cost\nWHERE \n  strftime('%Y', chargetime) = strftime('%Y', 'now')\nGROUP BY \n  event_type\nORDER BY \n  event_count DESC\nLIMIT 3;",
    "9fb8afdaaf96b44431b66905": "SELECT \n  o.itemid, \n  d.label AS output_event, \n  COUNT(*) AS event_count\nFROM \n  outputevents o\n  INNER JOIN d_items d ON o.itemid = d.itemid\nWHERE \n  o.charttime >= DATE('now', '-1 year')\nGROUP BY \n  o.itemid, d.label\nORDER BY \n  event_count DESC\nLIMIT 5;",
    "34c567a447d41ec8f026b6e3": "SELECT event_type, COUNT(*) as event_count\nFROM cost\nWHERE chargetime >= DATE('now', '-1 year')\nGROUP BY event_type\nORDER BY event_count DESC\nLIMIT 3;",
    "7bdfe013186f828667928905": "",
    "2a929f4140fa128b102740cd": "SELECT DISTINCT d.long_title AS diagnosis\nFROM diagnoses_icd di\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title LIKE '%fetus%' OR d.long_title LIKE '%tanning bed%';",
    "83ec5f2878ea0c3503d1e17b": "SELECT DISTINCT p.subject_id,\n                d.long_title AS diagnosis,\n                pr.long_title AS procedure\nFROM prescriptions prs\nINNER JOIN patients p ON prs.subject_id = p.subject_id\nINNER JOIN diagnoses_icd di ON prs.hadm_id = di.hadm_id\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nINNER JOIN procedures_icd prc ON prs.hadm_id = prc.hadm_id\nINNER JOIN d_icd_procedures pr ON prc.icd_code = pr.icd_code\nWHERE prs.drug LIKE '%packed cell transfusion%';",
    "f268157490484fd392fc3625": "SELECT 'software';",
    "293a491c440d62e67c686f47": "SELECT MAX(drug_count) AS max_drug_count, drug_manufacturer\nFROM (\n  SELECT drug AS drug_manufacturer, COUNT(*) AS drug_count\n  FROM prescriptions\n  GROUP BY drug\n)",
    "66849fb36f1b3833ece51450": "SELECT \n  COUNT(*) AS total_rainy_days\nFROM \n  weather\nWHERE \n  weather.rainfall > 0;",
    "003f7650b1ad418ca111edc9": "SELECT 'What train goes to the ebt' AS result;",
    "f0d34937f5d41dd42fe0b372": "SELECT long_title \nFROM d_icd_diagnoses \nWHERE long_title LIKE '%depress psychosis-unspec%' \nORDER BY long_title DESC \nLIMIT 10;",
    "f0058451e642bc79081d5500": "SELECT DISTINCT l.label\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nWHERE l.label LIKE '%pancreas%' OR l.label LIKE '%pain%';",
    "c1d459523b1199c08ad0e0bc": "SELECT T1.eventtype AS transfer_reason\nFROM transfers AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN patients AS T3 ON T2.subject_id = T3.subject_id\nWHERE T3.gender = 'M' OR T3.gender = 'F' \nAND strftime('%Y', T2.admittime) - strftime('%Y', T3.dob) < 18\nGROUP BY T1.eventtype\nORDER BY COUNT(T1.transfer_id) DESC\nLIMIT 1;",
    "81998505a14291319bd54753": "SELECT DISTINCT d.long_title\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code;",
    "6762712ae8423c26a0745d35": "SELECT T1.drug, COUNT(*) AS allergy_count\nFROM prescriptions T1\nINNER JOIN icustays T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.first_careunit = 'MICU'\nGROUP BY T1.drug\nHAVING COUNT(*) > 10;",
    "1bef0c762add8a8a0a693e94": "SELECT \n  a.subject_id,\n  a.hadm_id,\n  CASE \n    WHEN a.language IS NULL THEN 'Unknown'\n    ELSE a.language\n  END AS imputed_language\nFROM admissions a\nLEFT JOIN patients p ON a.subject_id = p.subject_id\nWHERE a.language IS NULL;",
    "d06e1b6a44abb8c2d06f5c31": "SELECT \n    p.long_title AS procedure_name,\n    COUNT(*) AS procedure_count\nFROM \n    procedures_icd pi\nJOIN \n    d_icd_procedures p ON pi.icd_code = p.icd_code\nGROUP BY \n    p.long_title\nORDER BY \n    procedure_count DESC\nLIMIT 10;",
    "84c0a3f1d8f6eba51c9d5bee": "SELECT AVG(ce.valuenum) AS average_speed\nFROM chartevents ce\nJOIN icustays icu ON ce.stay_id = icu.stay_id\nWHERE ce.charttime >= datetime('now', '-3 month')\nAND ce.valueuom = 'knots';",
    "b61cbedd599810345dbf4e51": "",
    "9e1673ff38efcb44fd73240c": "SELECT first_careunit, COUNT(*) AS count\nFROM icustays\nWHERE first_careunit = 'MICU'\nGROUP BY first_careunit\nORDER BY count DESC\nLIMIT 1;",
    "a024d0f2f669a49d6d23c3cb": "SELECT \n  T1.subject_id,\n  T2.charttime,\n  T3.long_title\nFROM \n  diagnoses_icd T2\nINNER JOIN \n  d_icd_diagnoses T3 ON T2.icd_code = T3.icd_code\nINNER JOIN \n  patients T1 ON T2.subject_id = T1.subject_id\nWHERE \n  T3.long_title LIKE '%esophageal reflux%'\nORDER BY \n  T2.charttime DESC\nLIMIT 10;",
    "30e2f83874ad5cfcfad469ae": "SELECT AVG(unit_stay_count) AS average_area_size\nFROM (\n  SELECT COUNT(stay_id) AS unit_stay_count\n  FROM icustays\n  GROUP BY first_careunit\n) AS care_unit_counts;",
    "85e3fca57790810bb1784334": "",
    "2421e3311f43427ac609f160": "",
    "216188fe302509bfcf221465": "",
    "ca5022461fd46823f66c73e1": "select 'engineer' patients from the `patients` table.\n2. **Join Admissions**: Join the `admissions` table to get the admissions for these patients.\n3. **Diagnoses**: Join the `diagnoses_icd` table to get the diagnoses for these admissions.\n4. **Filter Hypertension**: Join the `d_icd_diagnoses` table to filter diagnoses that are related to hypertension.\n5. **Count**: Count the number of 'engineer' patients who suffered from hypertension.\n6. **Calculate Percentage**: Calculate the percentage of these patients relative to all 'engineer' patients.",
    "da729a26fea20170777e7a67": "",
    "56677fd269582e66886924c8": "SELECT \n    drug,\n    COUNT(*) AS frequency\nFROM \n    prescriptions\nGROUP BY \n    drug\nORDER BY \n    frequency DESC;",
    "f1735f59888dc5e92a980156": "SELECT \n  cost \nFROM \n  cost \nGROUP BY \n  cost \nORDER BY \n  COUNT(*) DESC \nLIMIT 1;",
    "bc11ae111fd50da24024a238": "SELECT \n  p.gender,\n  p.dob,\n  p.dod\nFROM \n  patients p\nWHERE \n  p.subject_id = 4326;",
    "e6b1ea98e579fc0b9bbaf0da": "SELECT p.gender, COUNT(*) AS prescription_count\nFROM prescriptions pr\nJOIN patients p ON pr.subject_id = p.subject_id\nWHERE pr.drug = 'fentanyl citrate'\nGROUP BY p.gender;",
    "48f1e69154c4643e5a5b35d5": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1 \n            FROM admissions a2 \n            WHERE a2.subject_id = a.subject_id \n            AND a2.dischtime > a.dischtime\n        ) OR EXISTS (\n            SELECT 1 \n            FROM transfers t2 \n            WHERE t2.subject_id = a.subject_id \n            AND t2.intime > a.dischtime\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS has_plan_to_visit\nFROM admissions a\nWHERE a.subject_id = 3745 \nLIMIT 1;",
    "adc65ada307e86fe87be278f": "SELECT gender \nFROM patients \nWHERE gender = 'M';",
    "00d3e734f6e0469592eee929": "",
    "14bb6c7bed022d576caf2a44": "SELECT T1.route\nFROM prescriptions AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.age < 30 AND T1.route = 'Alternative'\nGROUP BY T1.route\nORDER BY COUNT(T1.route) DESC\nLIMIT 1;",
    "a4fb3217af375fa0143a8cbf": "",
    "e1f71e2a39e7ce12a6a21ad9": "SELECT T1.label\nFROM d_labitems T1\nINNER JOIN labevents T2\nON T1.itemid = T2.itemid\nWHERE T2.valuenum = 63.5 AND T2.valueuom = 'mg/dL';",
    "5a5c4c6d198bda6e1670161f": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd AS p\nINNER JOIN admissions AS a ON p.hadm_id = a.hadm_id\nINNER JOIN d_icd_procedures AS d ON p.icd_code = d.icd_code\nWHERE a.admittime >= DATE('now', '-1 month')\nAND d.long_title LIKE '%Anesthesia%';",
    "a9c7e7917e0b8969446e33a7": "",
    "c9dd0d430bbf3d22e3f3e059": "SELECT \n    p.gender,\n    COUNT(*) as count\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n    pr.drug = 'Bisacodyl'\nGROUP BY \n    p.gender;",
    "8769c33294b067dafbe858b1": "SELECT NULL AS companion_number\nFROM patients\nWHERE subject_id = 18866;",
    "2024e435133e2efe817fdc1a": "SELECT \n    ie.starttime AS next_mri_scan\nFROM \n    inputevents ie\nINNER JOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    ie.subject_id = 25814  \n    AND di.label = 'MRI'\nORDER BY \n    ie.starttime\nLIMIT 1;",
    "7244f2d8e5c70022f4884696": "SELECT phone_number \nFROM doctors \nWHERE doctor_id = (SELECT doctor_id \n                    FROM patient_doctor_relationship \n                    WHERE patient_id = 30826);",
    "f29c341f04a2ef448f0cc363": "SELECT AVG(\n    JULIANDAY(T2.admittime) - JULIANDAY(T1.dischtime)\n) AS average_days_between_discharge_and_next_admission\nFROM admissions T1\nINNER JOIN admissions T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id < T2.hadm_id;",
    "5497eb668de1ff020fd4e774": "SELECT \n    icu.subject_id,\n    icu.stay_id,\n    icu.itemid,\n    d_items.label AS equipment_label,\n    icu.charttime AS usage_time,\n    icu.valuenum AS usage_duration,\n    icu.valueuom AS unit_of_measurement\nFROM chartevents icu\nINNER JOIN d_items d_items ON icu.itemid = d_items.itemid\nWHERE d_items.label LIKE '%ICU%'",
    "c8912477d5181d9a93846c73": "",
    "052a50039b6037274420dd8f": "WITH AdmissionsCTE AS (\n    SELECT \n        a.subject_id,\n        a.admittime,\n        a.dischtime,\n        ROW_NUMBER() OVER (PARTITION BY a.subject_id ORDER BY a.admittime) AS admission_order\n    FROM \n        admissions a\n),\nFilteredAdmissionsCTE AS (\n    SELECT \n        a1.subject_id,\n        a1.admittime AS first_admittime,\n        a2.admittime AS second_admittime,\n        julianday(a2.admittime) - julianday(a1.admittime) AS days_between\n    FROM \n        AdmissionsCTE a1\n    INNER JOIN \n        AdmissionsCTE a2 ON a1.subject_id = a2.subject_id AND a1.admission_order = 1 AND a2.admission_order = 2\n    WHERE \n        julianday(a2.admittime) - julianday(a1.admittime) <= 30\n),\nAnesthesiaDurationsCTE AS (\n    SELECT \n        fa.subject_id,\n        AVG(julianday(ad.dischtime) - julianday(ad.admittime)) AS average_anesthesia_duration\n    FROM \n        FilteredAdmissionsCTE fa\n    INNER JOIN \n        admissions ad ON fa.subject_id = ad.subject_id AND fa.first_admittime = ad.admittime\n    GROUP BY \n        fa.subject_id\n)\nSELECT \n    AVG(average_anesthesia_duration) AS overall_average_anesthesia_duration\nFROM \n    AnesthesiaDurationsCTE;",
    "8d80b1b9e406fe7a5a097ec2": "SELECT drug, dose_val_rx, dose_unit_rx\nFROM prescriptions\nWHERE subject_id = 10128 AND starttime = '2104-1106 00:00:00';",
    "7669405a2a1666ecbfff8817": "Select distinct patients: Since each prescription record might be for a different period of time within a patient's stay, we'll ensure we're counting distinct patients.",
    "98b8b345de9b31cd2668b9b2": "",
    "8bada17662a355a51ea59bda": "SELECT marital_status, COUNT(*) as count\nFROM admissions\nGROUP BY marital_status",
    "1b1eb68d8eca94f1888c01df": "SELECT drug \nFROM prescriptions \nWHERE drug LIKE '%insulin%' \nAND dose_unit_rx = 'fast-acting';",
    "20dc30c77f1b416cf280b62b": "SELECT *\nFROM chartevents\nWHERE subject_id = 17667 AND DATE(charttime) = DATE('now');",
    "c232e6794bf8d1dbf9ff6a31": "",
    "b4308f599ae4e9243b96c815": "SELECT patients.gender \nFROM patients \nWHERE patients.age > 50;",
    "0ffa12eb413fe198d8ad5615": "",
    "6d276e472515f3a34e65d3c0": "",
    "c82edfa2a6b5736bd0ba574c": "WITH PatientStayDurations AS (\n  SELECT\n    p.subject_id,\n    julianday(a.dischtime) - julianday(a.admittime) AS stay_duration\n  FROM\n    patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n),\nAlcoholUsePatients AS (\n  SELECT DISTINCT\n    subject_id\n  FROM\n    diagnoses_icd\n  WHERE\n    icd_code = 'K70'  -- ICD-10 code for alcohol use disorders\n)\nSELECT\n  AVG(CASE WHEN aup.subject_id IS NOT NULL THEN psd.stay_duration ELSE NULL END) AS avg_stay_with_alcohol,\n  AVG(CASE WHEN aup.subject_id IS NULL THEN psd.stay_duration ELSE NULL END) AS avg_stay_without_alcohol\nFROM\n  PatientStayDurations psd\n  LEFT JOIN AlcoholUsePatients aup ON psd.subject_id = aup.subject_id;",
    "4eb570ece07f38aa85107fcf": "",
    "cdcda008dc7819a1b0327522": "SELECT COUNT(*) AS count_above_60_russian\nFROM admissions\nWHERE age > 60 AND language = 'RUS';",
    "c7f3fe77ea11f0bbf111258c": "",
    "bdec7c306774d6d605d4da77": "WITH ICUStayLengths AS (\n    SELECT\n        c.subject_id,\n        julianday(c.outtime) - julianday(c.intime) AS stay_length,\n        a.insurance\n    FROM\n        icustays c\n    JOIN\n        admissions a ON c.hadm_id = a.hadm_id\n),\nInsuranceStayLengths AS (\n    SELECT\n        insurance,\n        SUM(stay_length) AS total_stay_length\n    FROM\n        ICUStayLengths\n    GROUP BY\n        insurance\n)\nSELECT\n    (SELECT total_stay_length FROM InsuranceStayLengths WHERE insurance = 'completed') -\n    (SELECT total_stay_length FROM InsuranceStayLengths WHERE insurance = 'delayed') AS length_difference;",
    "3edd4a4d0001415835f3d941": "SELECT \n    T1.language\nFROM \n    admissions AS T1\nINNER JOIN \n    prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    CAST(REPLACE(T2.dose_val_rx, ' ', '') AS REAL) > CAST(REPLACE(T2.dose_unit_rx, ' ', '') AS REAL)\nGROUP BY \n    T1.language\nORDER BY \n    COUNT(T1.language) DESC;",
    "e63445c44aa8a8b69bdfb8eb": "",
    "db942f82c8b54c6c40b1d995": "SELECT label\nFROM d_items\nWHERE label LIKE '%Insulin%' AND label LIKE '%Rapid%';",
    "6019c6cfa331a76747e3e179": "",
    "fa5955074cefb8227fce847c": "SELECT MIN(starttime) AS next_mri_time\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 18866 AND d_items.label = 'MRI SCAN';",
    "2221c6ca4b7bdd6b39d061ab": "SELECT \n  p.gender\nFROM \n  prescriptions pr\n  INNER JOIN patients p ON pr.subject_id = p.subject_id\nWHERE \n  pr.drug = 'BUPRENORPHINE'\nGROUP BY \n  p.gender\nHAVING \n  COUNT(*) > 0;",
    "8ed214a3b37b99e4b939b91a": "",
    "c8eb4a1719c5627ddf87792c": "SELECT \n  'Windows embedded standard e sku' AS product_name;",
    "427d21d4ec4e4df52e74038b": "SELECT AVG(c.cost) AS average_insurance_cost\nFROM cost c\nJOIN admissions a ON c.hadm_id = a.hadm_id;",
    "9ed9ea6427a74331f8c0ae9f": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE icd.long_title LIKE '%hypertension%' AND p.dob LIKE '%la%';",
    "f046767dd9ee27d2e46f089a": "SELECT \n  m.subject_id,\n  m.charttime,\n  m.spec_type_desc,\n  m.test_name,\n  m.org_name\nFROM \n  microbiologyevents m\nWHERE \n  m.subject_id = 269;",
    "3c5224fd3b9805031e6c563b": "SELECT DISTINCT p.gender\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.insurance LIKE '%Medicaid%'",
    "531d0af347664f410627a0fc": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id;",
    "03f31ef366447668d469435e": "SELECT 'The Pepsi Center is located in Denver, Colorado.' AS location;",
    "970880ac21066f749bba19ad": "SELECT DISTINCT discharge_location\nFROM admissions\nWHERE discharge_location IS NOT NULL;",
    "cae9f75aaa264530ca43f2d8": "SELECT 'Daily Surgery Schedule: ' || \n       'Surgery on ' || \n       strftime('%Y-%m-%d', adm.admittime) || \n       ' at ' || \n       adm.hadm_id || \n       ' from ' || \n       strftime('%H:%M', adm.admittime) || \n       ' to ' || \n       strftime('%H:%M', adm.dischtime) || \n       ' with patient ' || \n       p.gender || \n       ' ' || \n       p.subject_id || \n       ' aged ' || \n       adm.age || \n       ' admitted from ' || \n       adm.admission_location || \n       ' and discharged to ' || \n       adm.discharge_location || \n       ' with insurance ' || \n       adm.insurance || \n       ' and marital status ' || \n       adm.marital_status || \n       ' was scheduled for surgery ' || \n       d.long_title || \n       ' (ICD-10: ' || icd.icd_code || ')'\nFROM admissions adm\nJOIN diagnoses_icd icd ON adm.hadm_id = icd.hadm_id\nJOIN d_icd_diagnoses d ON icd.icd_code = d.icd_code\nJOIN patients p ON adm.subject_id = p.subject_id\nWHERE d.long_title LIKE '%Surgery%'",
    "4a543d7a5a2b445c6d3832f4": "SELECT \n    l.label AS mri_exam_label,\n    e.valuenum AS mri_exam_value,\n    e.valueuom AS mri_exam_unit\nFROM \n    labevents e\nINNER JOIN \n    d_labitems l ON e.itemid = l.itemid\nWHERE \n    e.subject_id = 59049\n    AND l.label LIKE '%MRI%';",
    "5b125ca978768d6d90c96817": "SELECT T1.subject_id\nFROM transfers T1\nWHERE T1.careunit = 'MICU'\nGROUP BY T1.subject_id\nHAVING COUNT(T1.transfer_id) > 1;",
    "868f55abba5b9b51520d27e4": "SELECT \n  p.subject_id,\n  pd.long_title AS procedure,\n  (a.dischtime - a.admittime) AS anesthesia_duration\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\n  INNER JOIN d_icd_procedures pd ON pr.icd_code = pd.icd_code\nWHERE \n  a.admittime >= DATE('now', '-1 month')\nORDER BY \n  anesthesia_duration DESC\nLIMIT 1;",
    "1c7aab76fcd16c27eb23677e": "",
    "35e213805db89bbf446e5831": "SELECT \n  o.value AS outcome\nFROM \n  microbiologyevents m\n  JOIN outputevents o ON m.hadm_id = o.hadm_id AND m.subject_id = o.subject_id\nWHERE \n  m.test_name = 'MRI'\n  AND m.subject_id = 32163;",
    "6a969b626da94022cd09b496": "SELECT \n  label\nFROM \n  d_labitems\nWHERE \n  label LIKE '%patient privacy%' \n  OR label LIKE '%hospital privacy%'\nORDER BY \n  label ASC;",
    "54d266747ccc80d0ed29f19e": "SELECT \n  ce.valuenum \nFROM \n  chartevents ce \n  INNER JOIN admissions a ON ce.hadm_id = a.hadm_id \nWHERE \n  a.subject_id = 1242;",
    "bbb7101ab70e7712f9d01ec7": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS has_pet_ct\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 19412 \nAND d_labitems.label = 'PET-CT Readings';",
    "ff8528ddb6bb24fd4ac86a40": "SELECT '';",
    "ef75f75beef8f335b9baa3da": "SELECT \n    di.icd_code,\n    d.long_title AS diagnosis\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title LIKE '%Mental Health%';",
    "e9075a46d6776298a18655db": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 83062\nAND DATE(charttime) = DATE('now');",
    "1d9f34f734a17a488fefeebe": "SELECT *\nFROM admissions\nWHERE subject_id = 728;",
    "fc91b305e4be2838d4a5b0c5": "SELECT p.gender, COUNT(*) AS num_prescriptions\nFROM prescriptions pr\nJOIN patients p ON pr.subject_id = p.subject_id\nWHERE pr.drug = 'Potassium Chloride (Powder)'\nGROUP BY p.gender;",
    "235c0b04c31a09d7781e4dac": "",
    "930950b0e61480275d875940": "SELECT \n  subject_id\nFROM \n  patients\nWHERE \n  dod IS NOT NULL AND DATE(dod) = DATE('now', '-3 days');",
    "48889ad5f102d84349096d62": "SELECT T1.eventtype\nFROM transfers AS T1\nJOIN icustays AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.stay_id = 239118;",
    "246f8359ba09e783f4e449b4": "SELECT \n    p.gender,\n    COUNT(pr.prescription) AS num_prescriptions\nFROM \n    patients p\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    pr.drug = 'spironolactone'\nGROUP BY \n    p.gender;",
    "14a66c48aae42d8235db66d6": "SELECT DISTINCT icustays.last_careunit AS distance\nFROM icustays\nWHERE icustays.last_careunit = 'ccu';",
    "6142ac809b4e6d03dc0b2fbc": "",
    "5ac240bc6491d1ec78be8ab3": "SELECT AVG(strftime('%Y', 'now') - strftime('%Y', p.dob)) AS average_pet_age\nFROM patients p\nJOIN icustays i ON p.subject_id = i.subject_id\nWHERE (strftime('%J', i.outtime) - strftime('%J', i.intime)) > 5;",
    "ec9f9a82be39ce9a1b98770f": "SELECT \n    icu.stay_id,\n    icu.intime,\n    icu.outtime\nFROM \n    icustays icu\nWHERE \n    icu.intime >= DATE('now', '-3 years');",
    "92f2bfda6464ad834b3d3668": "WITH next_admissions AS (\n  SELECT \n    a.subject_id,\n    a.dischtime,\n    p.icd_code,\n    LEAD(a.dischtime) OVER (PARTITION BY a.subject_id ORDER BY a.dischtime) AS next_dischtime\n  FROM admissions a\n  INNER JOIN procedures_icd p ON a.hadm_id = p.hadm_id\n)\nSELECT \n  icd_code,\n  AVG(JULIANDAY(next_dischtime) - JULIANDAY(dischtime)) AS avg_time_diff\nFROM next_admissions\nWHERE next_dischtime IS NOT NULL\nGROUP BY icd_code\nORDER BY avg_time_diff ASC\nLIMIT 1;",
    "77fa89ae38c8c39f7c81d4b7": "SELECT \n    T1.valuenum\nFROM \n    labevents AS T1\nJOIN \n    d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.subject_id = 15447 \n    AND T2.label = 'CT Scan';",
    "c6b1da83d4b63322c4b4c6a9": "SELECT *\nFROM microbiologyevents\nORDER BY charttime DESC\nLIMIT 1;",
    "6713cf24d007377d7e869099": "SELECT DISTINCT p.drug\nFROM prescriptions p\nJOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE d2.long_title LIKE '%Hypertension%' AND p.drug LIKE '%Acetaminophen%' OR p.drug LIKE '%Ibuprofen%';",
    "4d3a84d5c5ed76fcb4951341": "WITH \n  GrowthRates AS (\n    SELECT \n      ic.first_careunit,\n      (julianday(ic.outtime) - julianday(ic.intime)) AS growth_rate\n    FROM icustays ic\n    INNER JOIN microbiologyevents m ON ic.hadm_id = m.hadm_id AND ic.subject_id = m.subject_id\n  )\nSELECT \n  first_careunit,\n  AVG(growth_rate) AS average_growth_rate\nFROM GrowthRates\nGROUP BY first_careunit;",
    "1501ae8d8efab085f519b248": "SELECT 'Did the squirrel have a name?' AS answer;",
    "c8ba34fa5105957a68d936fa": "",
    "43dd6a535818b9817b393135": "SELECT DISTINCT 'USD' AS currency\nFROM patients p\nWHERE p.dob IS NOT NULL AND strftime('%Y', 'now') - strftime('%Y', p.dob) > 40;",
    "c1b6430d833cda363c07e4a4": "SELECT COUNT(DISTINCT a.subject_id) AS upcoming_admissions\nFROM admissions a\nWHERE DATE(a.admittime) BETWEEN DATE('now', '+1 month', 'start of month') \n  AND DATE('now', '+1 month', 'start of month', '+1 month', '-1 day');",
    "ace343c8a0e67cd244b3d081": "SELECT MIN(T1.stoptime - T1.starttime) AS shortest_procedure_duration, T2.long_title AS procedure_name\nFROM procedures_icd AS T1\nINNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code;",
    "a77018c703503d0e6e17cf18": "SELECT le.valuenum, le.valueuom\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE li.label = 'CT Scan'\nAND le.subject_id = 66015;",
    "fe862ff2d922e1153830a746": "SELECT drug, COUNT(*) AS total_prescriptions\nFROM prescriptions\nJOIN admissions ON prescriptions.hadm_id = admissions.hadm_id\nWHERE admissions.age < 18\nGROUP BY drug\nORDER BY total_prescriptions DESC\nLIMIT 1;",
    "f0d4fd4f9ef83a84556038a0": "",
    "3767ecc6700c56b7e24069df": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1\n      FROM chartevents ce\n      INNER JOIN d_items di ON ce.itemid = di.itemid\n      WHERE ce.subject_id = 18877 \n        AND di.label = 'COVID-19 Test Result'\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS covid_19_test_result",
    "29f11be3511916b829d232f1": "SELECT * FROM d_items WHERE label = 'IELTS';",
    "52c617e596accfe965a74a66": "SELECT \n  p.long_title AS procedure_title, \n  SUM(c.cost) AS total_cost\nFROM \n  procedures_icd pic\n  INNER JOIN d_icd_procedures p ON pic.icd_code = p.icd_code\n  INNER JOIN cost c ON pic.row_id = c.event_id\n  INNER JOIN admissions a ON pic.hadm_id = a.hadm_id\nWHERE \n  a.insurance = 'anthem'\n  AND c.event_type = 'procedure'\n  AND strftime('%Y', c.chargetime) = strftime('%Y', 'now')\nGROUP BY \n  p.long_title\nORDER BY \n  total_cost DESC\nLIMIT 5;",
    "51f107a86832910517f841d1": "",
    "1d6044d33845efb3cb927bac": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nLEFT JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nWHERE strftime('%Y', a.admittime) = strftime('%Y', 'now')\nAND d.icd_code NOT LIKE '%allergy%'\nAND d.icd_code IS NULL;",
    "d1fadb6c8dd5eec6647e6a16": "SELECT \n  p.subject_id,\n  p.hadm_id,\n  p.drug,\n  p.dose_val_rx,\n  p.dose_unit_rx,\n  p.route,\n  p.starttime,\n  p.stoptime\nFROM \n  prescriptions p;",
    "24eb409247f4e7e43aba26bc": "SELECT \n    (SUM(CASE WHEN T1.label LIKE '%anesthesia%' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS anesthesia_percentage\nFROM \n    d_icd_procedures T1\n    JOIN procedures_icd T2 ON T1.icd_code = T2.icd_code;",
    "f3232c5aa9f8ce5cb43f0a9c": "SELECT AVG(julianday(icustays.outtime) - julianday(icustays.intime)) AS avg_icu_duration\nFROM icustays;",
    "3086cebf36c3aeee27dd03d9": "SELECT eventtype AS reason_for_transfer, COUNT(*) AS count_of_transfers\nFROM transfers\nGROUP BY eventtype\nHAVING COUNT(*) > (SELECT AVG(count_of_transfers) FROM (SELECT eventtype, COUNT(*) AS count_of_transfers FROM transfers GROUP BY eventtype));",
    "ce0d216f4703f4417b14ea58": "",
    "ff24e91af68e8cab47eac8d5": "SELECT os, COUNT(*) as os_count\nFROM (\n  SELECT SUBSTR(SUBSTR(admissions.language, 1, INSTR(admissions.language, ' ') - 1), 1, INSTR(SUBSTR(admissions.language, 1, INSTR(admissions.language, ' ') - 1), ' ') - 1) AS os\n  FROM patients\n  JOIN admissions ON patients.subject_id = admissions.subject_id\n  WHERE patients.gender = 'White'\n) t\nGROUP BY os\nHAVING os_count > 10;",
    "0e0d0ac51d0e88111f25178e": "SELECT test_name, value\nFROM microbiologyevents\nWHERE subject_id = 15257 AND test_name LIKE '%MRI%';",
    "817fdd991bf061d43a6caf77": "SELECT long_title\nFROM d_icd_diagnoses\nWHERE long_title LIKE '%retropharyngeal abscess%'\nORDER BY row_id DESC\nLIMIT 1;",
    "1c7189f64663b34996998446": "SELECT p.dob\nFROM patients p\nJOIN (\n    SELECT subject_id, julianday(dischtime) - julianday(admittime) AS duration\n    FROM admissions\n) a ON p.subject_id = a.subject_id\nORDER BY a.duration DESC\nLIMIT 1;",
    "a3af29b331f6bb117e33572a": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_submitted_report\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 27964 AND (test_name LIKE '%COVID-19%' OR spec_type_desc LIKE '%COVID-19%');",
    "d3c3b021182c355c4e1b80bb": "",
    "b1408a3b1d78fe9f3e66a6b6": "",
    "cf7020f0a35629a60da14b9f": "",
    "fac90dfbb66690536c40e070": "SELECT DISTINCT last_careunit \nFROM icustays\nORDER BY outtime DESC\nLIMIT 1;",
    "1b07c4e732cbd5943a9075f4": "SELECT label \nFROM d_labitems \nWHERE label LIKE '%valence electrons shared between two atoms%'",
    "180f8faf4d285fb9cacfa8db": "SELECT\n    a.subject_id,\n    a.discharge_location,\n    a.dischtime\nFROM\n    admissions a\nWHERE\n    a.subject_id = 27463\n    AND (a.discharge_location LIKE '%HOME%' OR a.discharge_location LIKE '%DISCHARGED%');",
    "33d9a5f72eefb71b319b35b0": "SELECT replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(\n    drug, 'tab', 'tabletten'), 'caps', ' capsulen'), 'sol', ' L\u00f6sungen'), ' syrup', ' Syrups'), \n    ' inj', ' Injector'), ' inj.', ' Injector'), ' inj.', ' Injector'), ' inj.', ' Injector'), \n    ' inj.', ' Injector'), ' inj.', ' Injector') AS translated_drug\nFROM prescriptions\nWHERE drug LIKE '%atenolol%';",
    "fe69454584acd2f3b66e4d04": "SELECT COUNT(*) \nFROM admissions \nWHERE admission_type = 'Elective' AND language = 'Copy of prescription';",
    "199b2e2acc64428f7e798c47": "SELECT itemid\nFROM labevents\nWHERE valueuom LIKE '%water%'\nORDER BY valuenum DESC\nLIMIT 1;",
    "6d1fb25832dab886945dd8f4": "SELECT discharge_location\nFROM admissions\nWHERE subject_id = 10425;",
    "dec6c9f45523ef859e8d0977": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_remaining_appointments\nFROM admissions\nWHERE subject_id = 28443;",
    "7b472b0ae9e47179115926d5": "SELECT starttime\nFROM prescriptions\nWHERE drug = 'Alcohol Anonymous';",
    "4c6f37b09e9230a451cda980": "SELECT DISTINCT i.first_careunit AS icu_majors\nFROM icustays i\nWHERE i.intime >= DATE('now', '-1 month')\n  AND i.first_careunit = 'micu';",
    "9109c1477507cea3a56bc3ea": "SELECT AVG(admissions.age) AS average_age\nFROM admissions\nINNER JOIN diagnoses_icd ON admissions.hadm_id = diagnoses_icd.hadm_id\nINNER JOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title LIKE '%Alcohol%';",
    "0e4f2f4885ba4659c994247b": "SELECT \n    a.insurance,\n    SUM(c.cost) AS total_cost\nFROM admissions a\nINNER JOIN cost c ON a.hadm_id = c.hadm_id\nGROUP BY a.insurance;",
    "289e5edadc5007d6fa2e4a8b": "SELECT COUNT(DISTINCT subject_id) AS patient_count\nFROM prescriptions\nWHERE drug IS NOT NULL;",
    "2882cabf6e0939d1a7ecca52": "WITH LastMonthAdmissions AS (\n    SELECT \n        p.subject_id, \n        p.gender, \n        p.dob, \n        a.admittime\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE a.admittime BETWEEN DATE('now', '-1 month') AND DATE('now')\n),\nChildren AS (\n    SELECT \n        subject_id, \n        (strftime('%Y', 'now') - strftime('%Y', dob)) - (strftime('%m%d', 'now') < strftime('%m%d', dob)) AS age\n    FROM LastMonthAdmissions\n    WHERE gender = 'F' AND dob > DATE('now', '-18 years')\n),\nOrderedChildren AS (\n    SELECT age, ROW_NUMBER() OVER (ORDER BY age) AS row_num, COUNT(*) OVER () AS total_count\n    FROM Children\n)\nSELECT AVG(age) AS median_age\nFROM OrderedChildren\nWHERE row_num IN ((total_count + 1) / 2, (total_count + 2) / 2);",
    "6e638207c190b2bfc104c8ce": "",
    "9813253dbdee465b9e47ac5e": "SELECT label \nFROM d_labitems \nWHERE label LIKE '%idea of an international organization for food%';",
    "aaded7e531d63261d7e08157": "",
    "201669edbbf8a7370e1a5bf6": "SELECT \n    drug,\n    dose_val_rx,\n    dose_unit_rx,\n    route\nFROM \n    prescriptions\nWHERE \n    drug = 'Celestone';",
    "5d8d44474b013c5673581998": "",
    "7bc817217b3da62394e8dec8": "SELECT DISTINCT age \nFROM admissions a\nJOIN prescriptions p ON a.hadm_id = p.hadm_id\nWHERE p.drug = 'prochlorperazine maleate';",
    "b5704c126bc27a7b3e42628a": "SELECT \"value\"\nFROM \"outputevents\"\nWHERE \"itemid\" = 1 AND \"subject_id\" = 273;",
    "8ef1358c8e787e3b1ea7fad0": "",
    "b5f3104776346d61b316a145": "SELECT admission_type \nFROM admissions \nWHERE admission_location = 'MICYU' \nGROUP BY admission_type \nORDER BY COUNT(*) DESC \nLIMIT 1;",
    "179bf167c286b5f0fde2a9af": "",
    "62351eb9c74c2c464077bb48": "SELECT COUNT(*) AS procedure_count\nFROM icustays icu\nJOIN procedures_icd proc ON icu.hadm_id = proc.hadm_id\nWHERE icu.first_careunit = 'Neuro ICU';",
    "706b02d8754a0238a2b818aa": "SELECT * FROM news WHERE category = 'pediatrics' AND date >= DATE('now', '-7 days');",
    "5e79f764b9533eb69c07c4d0": "SELECT label\nFROM d_labitems;",
    "5c02f7ac0c5c557d72d6fe5f": "SELECT 'No USPS rates information available in the database schema.' AS result;",
    "420bccb119240479b01959f1": "SELECT *\nFROM \"SELECT\" \nWHERE \"FROM\" = 'history' \n  AND \"WHERE\" = 'event = \"first playstation was made\"' \n  AND \"LIMIT\" = 1;",
    "2036c83624be19f6568997c6": "SELECT MIN(dob) AS youngest_female_dob\nFROM patients\nWHERE gender = 'F' AND dob LIKE '%Seattle%';",
    "241237199afd4ab0bf19fa11": "SELECT drug AS drug_manufacturer, COUNT(*) AS prescription_count\nFROM prescriptions\nWHERE starttime >= DATE('now', 'start of year')\nGROUP BY drug\nORDER BY prescription_count DESC\nLIMIT 1;",
    "619c0d97069b2720eecadf4c": "SELECT \n  T2.admission_type AS anesthesia_type, \n  COUNT(T2.admission_type) AS count\nFROM \n  procedures_icd AS T1\nINNER JOIN \n  admissions AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n  d_icd_procedures AS T3 ON T1.icd_code = T3.icd_code\nWHERE \n  T3.long_title = 'Fusion or Refusion of 2-3 Vertebrae'\nGROUP BY \n  T2.admission_type\nORDER BY \n  count DESC;",
    "f1e94bfbd8a4acb2b97f0185": "SELECT DISTINCT insurance\nFROM admissions\nWHERE insurance != 'Technical';",
    "1d40c79522236fb151c0465a": "SELECT label \nFROM d_labitems \nWHERE label LIKE '%ac on chrn grft-vs-host%' \nORDER BY row_id DESC \nLIMIT 10;",
    "d259847dbbc43592b3e84f39": "SELECT 'ID Card', 'Passport', 'Medical Insurance Card', 'Travel Insurance', 'Vaccination Card';",
    "b15ea4eb1bb9661e3b9dd6d0": "SELECT \n  di.long_title AS procedure_name,\n  AVG(julianday(ie.endtime) - julianday(ie.starttime)) AS avg_anesthesia_duration\nFROM \n  inputevents ie\n  INNER JOIN d_items di ON ie.itemid = di.itemid\nWHERE \n  di.label LIKE '%anesthesia%' \n  AND ie.totalamountuom = 'minutes'\nGROUP BY \n  di.long_title\nORDER BY \n  avg_anesthesia_duration DESC\nLIMIT 5;",
    "2bfbfac869d7a901aa75a0e7": "SELECT DISTINCT c.event_type AS currency_used\nFROM cost c\nINNER JOIN admissions a ON c.hadm_id = a.hadm_id\nINNER JOIN patients p ON a.subject_id = p.subject_id\nWHERE p.dob < '2070-01-01';",
    "5d836a81b5ce8992269a142c": "SELECT p.gender\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'oseltamivir';",
    "91962d52a73615ffad6e748c": "SELECT\n    SUM(CASE WHEN a.admission_location = 'Emergency Room' THEN ce.valuenum ELSE 0 END) AS EmergencyRoomAnesthesiaDuration,\n    SUM(CASE WHEN a.admission_location != 'Emergency Room' THEN ce.valuenum ELSE 0 END) AS OtherAdmissionLocationAnesthesiaDuration\nFROM admissions a\nJOIN chartevents ce ON a.hadm_id = ce.hadm_id\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE di.label = 'Anesthesia Duration';",
    "065b020277adeeaf7b2334bf": "SELECT \n    p.subject_id,\n    p.gender,\n    strftime('%Y', p.dob) AS year_of_birth,\n    (strftime('%m', 'now') * 100 + strftime('%d', 'now')) - (strftime('%m', p.dob) * 100 + strftime('%d', p.dob)) AS age,\n    t1.long_title AS procedure,\n    COUNT(*) AS procedure_count\nFROM patients p\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures t1 ON pr.icd_code = t1.icd_code\nGROUP BY p.subject_id, p.gender, year_of_birth, age, t1.long_title\nORDER BY procedure_count DESC\nLIMIT 5;",
    "1e4e8dd0ff34ae33dcd8af9c": "SELECT \n  d.long_title AS diagnosis,\n  COUNT(*) AS count\nFROM \n  diagnoses_icd i\nJOIN \n  d_icd_diagnoses d ON i.icd_code = d.icd_code\nGROUP BY \n  d.long_title\nORDER BY \n  count DESC\nLIMIT 10;",
    "acc0c0cdef161a9284612252": "WITH DiagnosisCounts AS (\n  SELECT \n    T1.hadm_id, \n    COUNT(T1.icd_code) AS diagnosis_count\n  FROM diagnoses_icd T1\n  GROUP BY T1.hadm_id\n),\nFilteredAdmissions AS (\n  SELECT \n    T1.hadm_id\n  FROM DiagnosisCounts T1\n  WHERE T1.diagnosis_count > 10\n),\nAnesthesiaDurations AS (\n  SELECT \n    T1.hadm_id, \n    (julianday(T1.outtime) - julianday(T1.intime)) * 24 AS anesthesia_duration\n  FROM transfers T1\n  WHERE T1.eventtype = 'Anesthesia'\n)\nSELECT \n  AVG(T3.anesthesia_duration) AS average_anesthesia_duration\nFROM FilteredAdmissions T1\nINNER JOIN AnesthesiaDurations T3 ON T1.hadm_id = T3.hadm_id;",
    "c9c78d7791bc4da8fbbd4eaa": "SELECT \n  ie.subject_id, \n  ie.hadm_id, \n  ie.itemid, \n  ie.totalamount, \n  ie.totalamountuom, \n  ie.starttime, \n  ie.stay_id\nFROM \n  inputevents ie\nWHERE \n  ie.itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%audio%')\nUNION\nSELECT \n  oe.subject_id, \n  oe.hadm_id, \n  oe.itemid, \n  oe.value, \n  oe.valueuom, \n  oe.charttime, \n  oe.stay_id\nFROM \n  outputevents oe\nWHERE \n  oe.itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%audio%');",
    "a24c812c12df25630c3e42a2": "SELECT 'The SQL query cannot be derived from the natural language question.';",
    "1d55a2cb2075c095159fdcf5": "SELECT \n  d_labitems.label, \n  COUNT(labevents.itemid) AS test_frequency\nFROM \n  labevents\nINNER JOIN \n  d_labitems ON labevents.itemid = d_labitems.itemid\nGROUP BY \n  d_labitems.label\nORDER BY \n  test_frequency DESC;",
    "dcb81ae72e1d1a8401a39e97": "SELECT DISTINCT T3.drug\nFROM diagnoses_icd AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN prescriptions AS T3 ON T2.hadm_id = T3.hadm_id\nINNER JOIN d_icd_diagnoses AS T4 ON T1.icd_code = T4.icd_code\nWHERE T4.long_title LIKE '%hypertension%' AND T3.drug LIKE '%aspirin%'\nORDER BY T3.drug;",
    "7850fd4718ef0345b66f16ee": "SELECT \n    p.subject_id,\n    pr.drug,\n    AVG(a.age) AS average_age\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nJOIN \n    prescriptions pr ON a.hadm_id = pr.hadm_id\nGROUP BY \n    p.subject_id, pr.drug;",
    "6b38a2ea311d353bab0db4b1": "SELECT COUNT(*) \nFROM procedures_icd \nWHERE icd_code IN (\n    SELECT icd_code \n    FROM d_icd_procedures \n    WHERE long_title LIKE '%anesthesia%'\n) AND hadm_id IN (\n    SELECT hadm_id \n    FROM admissions \n    WHERE age > 65\n) AND charttime IN (\n    SELECT charttime \n    FROM chartevents \n    WHERE valuenum > 2 AND valueuom = 'hours'\n);",
    "e8057790cfb3bf1907c60c42": "SELECT \n  COUNT(*) \nFROM (\n  SELECT \n    p.subject_id\n  FROM \n    patients p\n  INNER JOIN \n    admissions a ON p.subject_id = a.subject_id\n  GROUP BY \n    p.subject_id\n  HAVING \n    COUNT(a.hadm_id) = 2\n) AS subquery;",
    "e6a16146de655c76e0a5a66e": "SELECT AVG(c.cost) AS average_procedure_cost\nFROM cost c\nJOIN procedures_icd p ON c.event_id = p.row_id\nJOIN admissions a ON p.hadm_id = a.hadm_id\nJOIN patients pa ON a.subject_id = pa.subject_id\nWHERE c.event_type = 'procedure';",
    "4d790b43564658ab3b4e0d03": "SELECT COUNT(*) \nFROM procedures_icd \nJOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code \nWHERE d_icd_procedures.long_title LIKE '%Cardiac Cath Lab%' \nAND strftime('%Y', procedures_icd.charttime) = strftime('%Y', 'now');",
    "9472d82ca22999ff5c901966": "",
    "ea02cf51a42cf529313b5bcc": "SELECT T1.valueuom AS most_common_currency\nFROM (\n    SELECT valueuom, COUNT(*) AS count\n    FROM chartevents\n    GROUP BY valueuom\n    ORDER BY count DESC\n    LIMIT 1\n) T1\nWHERE EXISTS (\n    SELECT 1\n    FROM patients P\n    JOIN admissions A ON P.subject_id = A.subject_id\n    WHERE P.subject_id = T1.subject_id\n    AND A.admittime >= DATE('now', 'start of year')\n    GROUP BY P.subject_id\n    HAVING COUNT(*) > 2\n)",
    "6e494bdfe5023a25242b95f9": "SELECT NULL AS doctor_phone_number\nFROM patients\nWHERE subject_id = 57023;",
    "2336788b39320ddc3aab7dfd": "SELECT DISTINCT drug\nFROM prescriptions\nWHERE drug LIKE '%insulin%' AND dose_unit_rx = 'U';",
    "721452586d364928353c1138": "SELECT MIN(ie.starttime) AS next_mri_time\nFROM inputevents ie\nJOIN d_items di ON ie.itemid = di.itemid\nWHERE ie.subject_id = 17462 AND di.label = 'MRI'\nAND ie.starttime > CURRENT_TIMESTAMP;",
    "73fb93b17e794549d7aefcf1": "SELECT DISTINCT p.subject_id, p.gender, p.dob, p.dod\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nJOIN d_icd_diagnoses dicd ON d.icd_code = dicd.icd_code\nWHERE dicd.long_title LIKE '%pneumonia%';",
    "1920549178d2063f406d999f": "SELECT \n  p.drug, \n  COUNT(p.row_id) AS total_prescriptions\nFROM \n  prescriptions p\nWHERE \n  strftime('%Y', p.starttime) = strftime('%Y', 'now')\nGROUP BY \n  p.drug\nORDER BY \n  total_prescriptions DESC\nLIMIT 5;",
    "346a6b1c95d407dd60ff4583": "SELECT AVG(T2.valuenum) AS average_blood_glucose\nFROM d_labitems AS T1\nINNER JOIN labevents AS T2 ON T1.itemid = T2.itemid\nWHERE T1.label LIKE '%Blood Glucose%';",
    "d2b91a51e6ef4727feef548d": "WITH OldestPatient AS (\n    SELECT dob\n    FROM patients\n    ORDER BY dob ASC\n    LIMIT 1\n),\nChildren AS (\n    SELECT \n        subject_id,\n        strftime('%Y', 'now') - strftime('%Y', dob) AS age\n    FROM patients\n    WHERE dob > (SELECT dob FROM OldestPatient)\n)\nSELECT MIN(age) AS min_age\nFROM Children;",
    "ab60620a256593c8855554f9": "SELECT \n  drug, \n  COUNT(*) AS total_prescriptions\nFROM \n  prescriptions\nWHERE \n  dose_val_rx IN ('100', '500', '1000', '2000', '5000', '10000', '20000', '50000', '100000')\nGROUP BY \n  drug\nORDER BY \n  total_prescriptions DESC\nLIMIT 5;",
    "5ff822748f260f0d813bfe27": "SELECT COUNT(*) AS total_referral_admissions\nFROM admissions\nWHERE admission_type = 'Referral';",
    "0c7166b81fe901725b7eb628": "",
    "8597515e0287991c861f671c": "",
    "6d76715f3b8643d188af9795": "SELECT p.gender, COUNT(*) AS num_prescriptions\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'lidocaine-prilocaine'\nGROUP BY p.gender;",
    "c31cb18da6bbbe1066aeb6be": "WITH MonthlyAdmissionsCTE AS (\n    SELECT \n        subject_id,\n        COUNT(*) AS admission_count\n    FROM \n        admissions\n    WHERE \n        admittime >= DATE('now', 'start of month') AND \n        admittime < DATE('now', 'start of month', '+1 month')\n    GROUP BY \n        subject_id\n),\nICUAdmissionsCTE AS (\n    SELECT \n        icu.subject_id\n    FROM \n        icustays icu\n    INNER JOIN \n        MonthlyAdmissionsCTE mac ON icu.subject_id = mac.subject_id\n    WHERE \n        mac.admission_count > 1\n)\nSELECT \n    AVG(distance) AS average_distance\nFROM (\n    SELECT \n        subject_id,\n        SQRT(POWER(MAX(icu.outtime) - MIN(icu.intime), 2)) AS distance\n    FROM \n        icustays icu\n    INNER JOIN \n        ICUAdmissionsCTE iac ON icu.subject_id = iac.subject_id\n    GROUP BY \n        subject_id\n)",
    "dfd68a634cff11f0c7c9dbce": "SELECT 'I am not happy' AS reason;",
    "056fb750773e90aa030e9950": "SELECT gender\nFROM patients\nWHERE gender = 'Asian'\nGROUP BY gender\nORDER BY COUNT(*) DESC\nLIMIT 1;",
    "a596ed8ea35947b5f68e0e42": "SELECT AVG(age) AS average_age\nFROM admissions\nWHERE language = 'English';",
    "536ee0098a55182b75db4447": "SELECT MAX(procedure_duration) AS longest_procedure_duration\nFROM (\n    SELECT julianday(p.outtime) - julianday(p.intime) AS procedure_duration\n    FROM icustays p\n    INNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\n    INNER JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\n    WHERE icd.long_title LIKE '%Cancer%'\n) AS procedure_durations;",
    "b50c0b91629c3e1eb8c1e1bf": "",
    "6cf1b55a68678674858c540c": "",
    "3c480ed464a8bb7f48ac6ad3": "SELECT gender\nFROM patients\nWHERE subject_id = 27656;",
    "a56ff0957a284d651e7e8abc": "SELECT 'No specific documents needed based on the provided schema.' AS result;",
    "fde3bbc35e10c13131806d0b": "SELECT \n    p.gender,\n    COUNT(DISTINCT p.subject_id) AS num_patients,\n    COUNT(DISTINCT pr.hadm_id) AS num_admissions\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    pr.drug = 'magnesium sulfate'\nGROUP BY \n    p.gender;",
    "706174ad5a8f8d55b224dbdf": "SELECT COUNT(*) \nFROM transfers \nWHERE eventtype LIKE '%complication%';",
    "de4cad0d0244ec1d5096631b": "",
    "35fbd2bb7e73dec7b0390bfd": "SELECT \n  admission_type,\n  admission_location,\n  discharge_location,\n  insurance,\n  language,\n  marital_status,\n  age,\n  admittime,\n  dischtime\nFROM \n  admissions;",
    "c8423168c30a91e86bd3a8fa": "SELECT abbreviation\nFROM d_items\nWHERE label LIKE '%fastacting insulin%';",
    "7d1731d972d68642a1d92376": "WITH CurrentGenderDistribution AS (\n    SELECT\n        strftime('%Y', dob) AS year_of_birth,\n        gender,\n        COUNT(*) AS gender_count\n    FROM patients\n    GROUP BY strftime('%Y', dob), gender\n),\nProjectedGenderDistribution AS (\n    SELECT\n        strftime('%Y', 'now') AS current_year,\n        year_of_birth,\n        gender,\n        gender_count\n    FROM CurrentGenderDistribution\n    UNION ALL\n    SELECT\n        current_year,\n        strftime('%Y', date(current_year, '+1 year')),\n        gender,\n        gender_count\n    FROM ProjectedGenderDistribution\n    WHERE strftime('%Y', date(current_year, '+1 year')) <= strftime('%Y', date('now', '+5 years'))\n)\nSELECT\n    strftime('%Y', current_year) AS year,\n    gender,\n    gender_count\nFROM ProjectedGenderDistribution\nWHERE year_of_birth BETWEEN strftime('%Y', date('now', '-5 years')) AND strftime('%Y', date('now', '+5 years'))\nORDER BY year, gender;",
    "7e49fe05e122e02f7b4dbc43": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1 \n            FROM microbiologyevents me\n            WHERE me.subject_id = 64983 \n            AND DATE(me.charttime) = DATE('now')\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS has_appointment;",
    "6f03fb45abf03355fdf2ebe5": "",
    "b10d95d377e7fd96548c50cd": "SELECT discharge_location\nFROM admissions\nWHERE insurance = 'Medicaid';",
    "04ed4b01566a9c408fc5f3cc": "",
    "e6233b691d261b0b5d750d60": "SELECT l.label AS test_name, le.valuenum AS result, le.valueuom AS unit\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nWHERE le.subject_id = 20066 AND l.label = 'PETCT EXAM';",
    "542be8111ffc89db7639ec01": "SELECT p.drug, p.dose_val_rx\nFROM prescriptions p\nINNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.age > 80\nGROUP BY p.drug, p.dose_val_rx\nORDER BY COUNT(*) DESC\nLIMIT 5;",
    "5feeffebbdb00685b21e88a4": "SELECT AVG(age) AS average_age\nFROM admissions\nWHERE age >= 65;",
    "c98c060929248bcba6628b8e": "SELECT discharge_location\nFROM admissions\nWHERE subject_id = 72909;",
    "b7b46d74fb37a9539786e740": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS tests_left\nFROM labevents le\nJOIN admissions a ON le.hadm_id = a.hadm_id\nWHERE a.subject_id = 17667\n  AND a.dischtime > le.charttime;",
    "1eac08ba1f265c3c327b62c1": "",
    "e4af8f1ba3897fc0635abfa6": "",
    "14dfee8ea5e8f46e6c25dd3b": "SELECT long_title FROM d_icd_diagnoses WHERE icd_code = '01170';",
    "429abe1449551a068765e97e": "",
    "ba6ba59aff69aa182b6e11ff": "SELECT \n  AVG(value) AS average_speed\nFROM \n  outputevents\nJOIN \n  icustays ON outputevents.stay_id = icustays.stay_id\nWHERE \n  icustays.last_careunit = 'csru' AND outputevents.valueuom = 'knots';",
    "601cdbff25250c54ae7b604d": "SELECT DISTINCT c.itemid\nFROM chartevents c\nJOIN admissions a ON c.hadm_id = a.hadm_id\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.subject_id = 22449 AND DATE(c.charttime) = DATE('now');",
    "da0649deb95e705d44b3a6bd": "SELECT NULL AS result;",
    "9c12b1908eecc96921e5b09d": "SELECT COUNT(*) \nFROM admissions \nWHERE language = 'English';",
    "dcd918b9b383d4c8b82d525a": "SELECT 'Peaceful nature sounds are now being played in the maternity ward to promote a relaxing environment for our patients.'",
    "39de5025dda78c678bc23c91": "SELECT DISTINCT \n    d.long_title AS discharge_summary\nFROM \n    admissions a\nINNER JOIN \n    diagnoses_icd di ON a.hadm_id = di.hadm_id\nINNER JOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n    d.long_title LIKE '%discharge%';",
    "d2195d39e2bb7f411ae6ced6": "",
    "542d6858a652ca64dd64426b": "SELECT AVG(latitude) AS average_latitude\nFROM patients\nJOIN (SELECT subject_id, 37.7749 AS latitude FROM admissions WHERE subject_id IN (SELECT subject_id FROM patients WHERE gender = 'M')) AS male_admissions\nON patients.subject_id = male_admissions.subject_id\nWHERE patients.gender = 'M';",
    "47b01aea87ca3478567aeb58": "SELECT language\nFROM patients\nINNER JOIN admissions ON patients.subject_id = admissions.subject_id\nWHERE marital_status = 'Married'\nAND insurance = 'Hispanic or Latino'\nAND language = 'English'\nGROUP BY language\nORDER BY COUNT(*) ASC\nLIMIT 1;",
    "068adca6e566c9ea7450afd5": "-- Since there is no direct way to get the companion's telephone number from the schema,\n-- and assuming that the question is not correctly formulated based on the schema,\n-- we will return a message indicating that the information cannot be derived.\n\nSELECT 'Information cannot be derived from the schema.' AS result;",
    "0577cc7be3dde491281e4ffb": "SELECT admissions.insurance \nFROM admissions \nINNER JOIN patients ON admissions.subject_id = patients.subject_id \nWHERE patients.subject_id = 370;",
    "682cc16deee208a0bbd263a1": "SELECT \n  i.label AS item_label\nFROM \n  inputevents ie\n  INNER JOIN d_items i ON ie.itemid = i.itemid\nWHERE \n  ie.totalamountuom = 'IV' AND i.label LIKE '%multivitamin%';"
}