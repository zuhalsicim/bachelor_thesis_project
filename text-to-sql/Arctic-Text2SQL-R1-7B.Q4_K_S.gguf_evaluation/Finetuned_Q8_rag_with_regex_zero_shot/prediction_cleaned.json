{
    "b9bf51c5e3af21242ac2e487": "",
    "71085ce4beef02dd87ed0ae5": "SELECT \n    route, \n    COUNT(*) AS route_count\nFROM prescriptions\nWHERE drug = 'amoxicillin'\nGROUP BY route\nORDER BY route_count DESC\nLIMIT 1;",
    "14282f53339c46daadec3a20": "SELECT DISTINCT p.route\nFROM prescriptions p\nWHERE p.drug = '5% DEXTROSE (EXCEL BAG)';",
    "776a4927e962a0f0d91d35e7": "SELECT \n  ie.itemid, \n  d_items.label, \n  ie.totalamount, \n  ie.totalamountuom\nFROM \n  inputevents ie\nINNER JOIN \n  d_items ON ie.itemid = d_items.itemid\nWHERE \n  d_items.label = 'citrate dextrose 3% (acd-a) crrt';",
    "e80f4420e687a67930a3fe82": "SELECT DISTINCT d_items.label\nFROM prescriptions\nJOIN d_items ON prescriptions.itemid = d_items.itemid\nWHERE prescriptions.drug = 'tamoxifen citrate';",
    "76e23fd708f338036f1db3a5": "SELECT \n  route, \n  COUNT(*) AS prescription_count\nFROM \n  prescriptions\nWHERE \n  drug = 'tramadol'\nGROUP BY \n  route;",
    "1a02966a7807415ea5d44f3e": "SELECT DISTINCT route \nFROM prescriptions \nWHERE drug = 'midodrine';",
    "6360cf590c61b892d228aec3": "SELECT T3.cost\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nINNER JOIN cost AS T3 ON T1.row_id = T3.event_id\nWHERE T2.long_title = 'Other incision of brain';",
    "fbcce2387805995ccfb14da7": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN procedures_icd pi ON c.event_id = pi.row_id\nJOIN d_icd_procedures dip ON pi.icd_code = dip.icd_code\nWHERE dip.long_title = 'Left Heart Cardiac Catheterization';",
    "5d3fdd6cfa3395ed7d31a509": "SELECT c.cost\nFROM cost c\nJOIN procedures_icd p ON c.hadm_id = p.hadm_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Alcohol Detoxification';",
    "ea5ae93b3e09584a70590863": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nJOIN procedures_icd p ON c.event_id = p.row_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Drainage of pericardial cavity with drainage device, percutaneous approach';",
    "3dad9658c00a426a28cd032a": "SELECT c.cost\nFROM cost c\nJOIN procedures_icd p ON c.event_id = p.row_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Catheter-based Invasive Electrophysiological Testing';",
    "23f5cb31ebe9cc2a949960b0": "SELECT SUM(c.cost) AS total_cost\nFROM procedures_icd AS p\nJOIN cost AS c ON p.row_id = c.event_id\nWHERE p.icd_code = '00.12';",
    "7c477af3b36987109db0d925": "SELECT AVG(T1.cost) AS typical_cost\nFROM cost AS T1\nINNER JOIN procedures_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Repair of rectocele with graft or prosthesis';",
    "6fd97088e685ba9d993b674a": "SELECT \n  (SUM(CASE WHEN c.event_type = 'Medication' THEN 1 ELSE 0 END) * 1.0 / COUNT(p.row_id)) AS selling_rate\nFROM \n  prescriptions p\n  LEFT JOIN cost c ON p.subject_id = c.subject_id AND p.hadm_id = c.hadm_id AND p.drug = c.event_id\nWHERE \n  p.drug = 'acetaminophen-caff-butalbital';",
    "e24decfb710d3c3dc6eab1d8": "SELECT dose_val_rx AS price\nFROM prescriptions\nWHERE drug = 'multivitamin' AND route = 'iv';",
    "3cf3b888f16e871e3f5f181c": "SELECT DISTINCT p.dose_val_rx AS dose, p.dose_unit_rx AS unit\nFROM prescriptions p\nWHERE p.drug LIKE '%vial%';",
    "a69dfee809d4c6a558d663e8": "SELECT c.cost\nFROM prescriptions p\nJOIN cost c ON p.hadm_id = c.hadm_id AND c.event_type = 'Prescription'\nWHERE p.drug = 'ferrous sulfate (liquid)';",
    "3a42a1f5b0ab7a9b081c5484": "SELECT SUM(T2.cost) AS total_cost\nFROM prescriptions AS T1\nJOIN cost AS T2 ON T1.hadm_id = T2.hadm_id AND T1.row_id = T2.event_id\nWHERE T1.drug = 'lactulose';",
    "451285f64c11d4d19cbf2a11": "",
    "ab2b79aa3faaaa7c9d7f7f40": "SELECT c.cost\nFROM cost c\nJOIN prescriptions p ON c.hadm_id = p.hadm_id AND c.subject_id = p.subject_id\nWHERE p.drug = 'buspirone';",
    "a635207e9ad6b0adfff52120": "SELECT SUM(cost) \nFROM cost \nJOIN diagnoses_icd ON cost.event_id = diagnoses_icd.row_id \nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code \nWHERE d_icd_diagnoses.long_title = 'Secondary malignant neoplasm of bone and bone marrow';",
    "37d5cb2d101d086c45aae957": "SELECT c.cost\nFROM cost c\nJOIN diagnoses_icd d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Personal history of transient ischemic attack (tia)';",
    "a8225cc86d80b3c2bcb42899": "SELECT SUM(c.cost) AS total_cost\nFROM cost AS c\nJOIN diagnoses_icd AS d ON c.event_id = d.row_id\nJOIN d_icd_diagnoses AS dd ON d.icd_code = dd.icd_code\nWHERE c.event_type = 'Diagnosis' AND dd.long_title LIKE '%Splenomegaly%';",
    "6e81a82c2e87daa57c7ae655": "SELECT c.cost\nFROM cost c\nJOIN diagnoses_icd di ON c.event_id = di.row_id\nJOIN d_icd_diagnoses did ON di.icd_code = did.icd_code\nWHERE did.long_title LIKE '%dependence on respirator [ventilator] status%';",
    "1c82eecbdc0ba4bcb2d34047": "SELECT SUM(c.cost) AS total_cost\nFROM cost c\nINNER JOIN diagnoses_icd d ON c.event_id = d.row_id\nINNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title LIKE '%other primary cardiomyopathies%';",
    "fc0f5148afa412b85497beb3": "SELECT \n  SUM(c.cost) AS total_cost\nFROM \n  cost c\n  JOIN diagnoses_icd d ON c.event_id = d.row_id\n  JOIN d_icd_diagnoses d_diagnoses ON d.icd_code = d_diagnoses.icd_code\nWHERE \n  d_diagnoses.long_title = 'Septicemia due to Escherichia coli [E. coli]';",
    "6594b2ea56fc3dde1c9203af": "SELECT \n  COALESCE(SUM(T2.cost), 0) AS diagnosis_cost\nFROM \n  d_icd_diagnoses T1\n  LEFT JOIN diagnoses_icd T3 ON T1.icd_code = T3.icd_code\n  LEFT JOIN cost T2 ON T3.row_id = T2.event_id\nWHERE \n  T1.long_title = 'Candidiasis of mouth' AND T2.event_type = 'diagnosis';",
    "cc2d0e8abf70d2897312faf2": "SELECT gender \nFROM patients \nWHERE subject_id = 10014078;",
    "caf2ed4e7d85cf6d0cba15f8": "SELECT gender\nFROM patients\nWHERE subject_id = 10005866;",
    "7a8719784f36b469832da18e": "SELECT gender\nFROM patients\nWHERE subject_id = 10014078;",
    "0e38c978a69e475449c84fee": "SELECT gender\nFROM patients\nWHERE subject_id = 10037975;",
    "cc30aba23d4b59298a12f192": "SELECT gender\nFROM patients\nWHERE subject_id = 10038933;",
    "261994390f6de9839143e6eb": "SELECT gender\nFROM patients\nWHERE subject_id = 10014354;",
    "2d6aa3feeed3bfeb72da5fb2": "SELECT gender FROM patients WHERE subject_id = 10005348;",
    "cd552ac1f210bf943008ccac": "SELECT dob \nFROM patients \nWHERE subject_id = 10031404;",
    "7e1617588226f306caaf252b": "SELECT dob\nFROM patients\nWHERE subject_id = 10007928;",
    "11f75d0b44ffab8233b7f684": "SELECT dob \nFROM patients \nWHERE subject_id = 10022281;",
    "16247191e328f040590ae2fc": "SELECT dob \nFROM patients \nWHERE subject_id = 10019568;",
    "d395d70704b10b00a4f7f1af": "SELECT dob\nFROM patients\nWHERE subject_id = 10019172;",
    "eddba4d41895f6e1c03c2a52": "",
    "9b7032c149a5ae595cfcdf73": "SELECT dob \nFROM patients \nWHERE subject_id = 10004457;",
    "28df618041d9cc5a95d8c30d": "",
    "ac3aa786885a117e774dc77c": "SELECT \n  (SELECT valuenum \n   FROM chartevents \n   WHERE subject_id = 10027602 \n     AND itemid = (SELECT itemid \n                   FROM d_items \n                   WHERE label = 'Weight') \n     AND charttime = (SELECT MIN(charttime) \n                      FROM chartevents \n                      WHERE subject_id = 10027602 \n                        AND itemid = (SELECT itemid \n                                      FROM d_items \n                                      WHERE label = 'Weight'))) \n  -\n  (SELECT valuenum \n   FROM chartevents \n   WHERE subject_id = 10027602 \n     AND itemid = (SELECT itemid \n                   FROM d_items \n                   WHERE label = 'Weight') \n     AND charttime = (SELECT MIN(charttime) \n                      FROM chartevents \n                      WHERE subject_id = 10027602 \n                        AND itemid = (SELECT itemid \n                                      FROM d_items \n                                      WHERE label = 'Weight'))) \n  AS weight_change;",
    "97a564727fd229d0a1d9c3ba": "",
    "10e5776d6866e2b43f77a084": "SELECT \n    ce1.valuenum AS weight_at_2020_12_30,\n    ce2.valuenum AS weight_at_2020_12_31\nFROM \n    chartevents ce1\nJOIN \n    chartevents ce2 ON ce1.subject_id = ce2.subject_id AND ce1.itemid = ce2.itemid\nJOIN \n    d_items di ON ce1.itemid = di.itemid\nWHERE \n    ce1.subject_id = 10018081\n    AND di.label = 'Weight'\n    AND ce1.charttime = '2020-12-30 00:00:00'\n    AND ce2.charttime = '2020-12-31 00:00:00';",
    "350e7b3e88e232febb94440c": "WITH patient_visits AS (\n    SELECT \n        hadm_id, \n        admittime, \n        dischtime \n    FROM admissions \n    WHERE subject_id = 10004422\n),\nlast_visit AS (\n    SELECT \n        hadm_id \n    FROM patient_visits \n    ORDER BY admittime DESC \n    LIMIT 1\n),\nsecond_last_visit AS (\n    SELECT \n        hadm_id \n    FROM patient_visits \n    ORDER BY admittime DESC \n    LIMIT 1 OFFSET 1\n),\nlast_visit_weight AS (\n    SELECT \n        valuenum \n    FROM chartevents \n    WHERE hadm_id = (SELECT hadm_id FROM last_visit)\n      AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\n    ORDER BY charttime DESC \n    LIMIT 1\n),\nsecond_last_visit_weight AS (\n    SELECT \n        valuenum \n    FROM chartevents \n    WHERE hadm_id = (SELECT hadm_id FROM second_last_visit)\n      AND itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\n    ORDER BY charttime DESC \n    LIMIT 1\n)\nSELECT \n    (SELECT valuenum FROM last_visit_weight) - (SELECT valuenum FROM second_last_visit_weight) AS weight_change;",
    "dc7482ecedbaea3e549bc140": "SELECT \n    (MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10027445 AND itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%weight%')) THEN ce.valuenum END) \n    - \n    MIN(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10027445 AND itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%weight%')) THEN ce.valuenum END)) AS weight_change\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10027445 AND di.label LIKE '%weight%';",
    "9fee7ced768b7c2b796af2ce": "SELECT \n    (SELECT totalamount \n     FROM inputevents \n     WHERE subject_id = 10007795 \n       AND starttime LIKE '%2001-01-02%' \n       AND itemid = (SELECT itemid \n                     FROM d_items \n                     WHERE label = 'Weight')) \n    - \n    (SELECT totalamount \n     FROM inputevents \n     WHERE subject_id = 10007795 \n       AND starttime LIKE '%2001-01-01%' \n       AND itemid = (SELECT itemid \n                     FROM d_items \n                     WHERE label = 'Weight')) AS weight_difference;",
    "922e1796a0883763c0252e8b": "SELECT \n  (second_val - first_val) AS difference\nFROM (\n  SELECT \n    le1.valuenum AS first_val,\n    le2.valuenum AS second_val\n  FROM \n    labevents le1\n    JOIN labevents le2 ON le1.subject_id = le2.subject_id AND le1.hadm_id = le2.hadm_id AND le2.row_id > le1.row_id\n    JOIN d_labitems li ON le1.itemid = li.itemid\n  WHERE \n    li.label = 'Alkaline Phosphatase' AND \n    le1.subject_id = 10002495 AND \n    le1.row_id = (\n      SELECT MIN(row_id) \n      FROM labevents \n      WHERE subject_id = 10002495 AND hadm_id = le1.hadm_id AND itemid = le1.itemid\n    )\n) subquery;",
    "efb37b1f8299f18af10b51ec": "WITH LastAdmission AS (\n  SELECT \n    MAX(hadm_id) AS hadm_id\n  FROM \n    admissions\n  WHERE \n    subject_id = 10019568\n),\nRelevantLabEvents AS (\n  SELECT \n    le.charttime,\n    le.valuenum\n  FROM \n    labevents le\n  JOIN \n    d_labitems li ON le.itemid = li.itemid\n  JOIN \n    LastAdmission la ON le.hadm_id = la.hadm_id\n  WHERE \n    li.label = 'Creatinine'\n  ORDER BY \n    le.charttime\n  LIMIT 2\n)\nSELECT \n  (SELECT valuenum FROM RelevantLabEvents ORDER BY charttime DESC LIMIT 1) - \n  (SELECT valuenum FROM RelevantLabEvents ORDER BY charttime ASC LIMIT 1) AS creatinine_difference;",
    "57c595ed27d732fb9989f76d": "SELECT \n  (SELECT T1.valuenum \n   FROM labevents AS T1 \n   WHERE T1.subject_id = 10038999 AND T1.itemid = 1 \n   ORDER BY T1.charttime DESC \n   LIMIT 1) \n  - \n  (SELECT T1.valuenum \n   FROM labevents AS T1 \n   WHERE T1.subject_id = 10038999 AND T1.itemid = 1 \n   ORDER BY T1.charttime ASC \n   LIMIT 1) \n  AS difference;",
    "f0713b333180377cd4e7a5ef": "SELECT \n  (t1.valuenum - t2.valuenum) AS difference\nFROM labevents t1\nJOIN labevents t2 ON t1.subject_id = t2.subject_id\nWHERE t1.subject_id = 10015272 \n  AND t1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Alkaline Phosphatase')\n  AND t2.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Alkaline Phosphatase')\n  AND t1.charttime = (SELECT MIN(charttime) FROM labevents WHERE subject_id = 10015272 AND itemid = t1.itemid AND hadm_id = 1)\n  AND t2.charttime = (SELECT MAX(charttime) FROM labevents WHERE subject_id = 10015272 AND itemid = t2.itemid AND hadm_id = 1)\n  AND t1.hadm_id = 1\n  AND t2.hadm_id = 1;",
    "01b66115a27e8ec4031d99ba": "SELECT \n  (SELECT T1.valuenum \n   FROM labevents AS T1 \n   INNER JOIN d_labitems AS T2 \n   ON T1.itemid = T2.itemid \n   WHERE T1.subject_id = 10025612 \n   AND T2.label = 'CK'\n   AND T1.hadm_id = (SELECT T3.hadm_id \n                     FROM admissions AS T3 \n                     WHERE T3.subject_id = 10025612 \n                     ORDER BY T3.admittime DESC \n                     LIMIT 1)\n   ORDER BY T1.charttime DESC \n   LIMIT 1 OFFSET 1) \n- (SELECT T1.valuenum \n  FROM labevents AS T1 \n  INNER JOIN d_labitems AS T2 \n  ON T1.itemid = T2.itemid \n  WHERE T1.subject_id = 10025612 \n  AND T2.label = 'CK'\n  AND T1.hadm_id = (SELECT T3.hadm_id \n                    FROM admissions AS T3 \n                    WHERE T3.subject_id = 10025612 \n                    ORDER BY T3.admittime DESC \n                    LIMIT 1)\n  ORDER BY T1.charttime DESC \n  LIMIT 1 OFFSET 0) \n  AS diff;",
    "beba7369b04f1b191db5f12e": "",
    "7e5e17dca306a105f47f9bb7": "SELECT \n  MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10002495 AND itemid = 455) THEN ce.valuenum END) \n  - \n  MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10002495 AND itemid = 455 AND charttime < (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10002495 AND itemid = 455)) THEN ce.valuenum END)\n  - \n  MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10002495 AND itemid = 455 AND charttime < (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10002495 AND itemid = 455 AND charttime < (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10002495 AND itemid = 455)))) THEN ce.valuenum END)\nFROM chartevents ce\nWHERE ce.subject_id = 10002495 AND ce.itemid = 455;",
    "eed5de84751262898d675c22": "SELECT \n  MAX(ce1.charttime) AS last_measured_time,\n  MAX(ce1.valuenum) AS last_measured_value,\n  MAX(ce2.valuenum) AS second_last_measured_value,\n  (MAX(ce1.valuenum) - MAX(ce2.valuenum)) AS spo2_change\nFROM \n  chartevents ce1\nJOIN \n  d_items di ON ce1.itemid = di.itemid\nJOIN \n  icustays icu1 ON ce1.stay_id = icu1.stay_id\nWHERE \n  di.label = 'SpO2'\n  AND ce1.subject_id = 10037975\n  AND icu1.stay_id = (\n    SELECT MIN(stay_id)\n    FROM icustays\n    WHERE subject_id = 10037975\n  )\n  AND ce1.charttime IN (\n    SELECT MAX(charttime)\n    FROM chartevents\n    WHERE subject_id = 10037975\n      AND stay_id = icu1.stay_id\n  )\n  AND ce2.valuenum IN (\n    SELECT MAX(valuenum)\n    FROM chartevents ce2\n    JOIN icustays icu2 ON ce2.stay_id = icu2.stay_id\n    WHERE ce2.subject_id = 10037975\n      AND icu2.stay_id = (\n        SELECT MIN(stay_id)\n        FROM icustays\n        WHERE subject_id = 10037975\n      )\n      AND ce2.charttime IN (\n        SELECT MAX(charttime)\n        FROM chartevents\n        WHERE subject_id = 10037975\n          AND stay_id = icu2.stay_id\n          AND charttime < (\n            SELECT MAX(charttime)\n            FROM chartevents\n            WHERE subject_id = 10037975\n              AND stay_id = icu2.stay_id\n          )\n      )\n  );",
    "6b3760b9b37e0bb8f9e647f8": "",
    "a2438ede03e572f4af4fcd58": "SELECT \n  (MAX(ce.valuenum) - MIN(ce.valuenum)) AS heart_rate_difference\nFROM \n  chartevents ce\nJOIN \n  d_items di ON ce.itemid = di.itemid\nWHERE \n  di.label = 'Heart Rate'\n  AND ce.subject_id = 10010471\n  AND ce.stay_id = (\n    SELECT \n      stay_id \n    FROM \n      icustays \n    WHERE \n      subject_id = 10010471 \n    ORDER BY \n      intime ASC \n    LIMIT 1\n  );",
    "941095e5c2a9df6746e4a383": "SELECT \n    MAX(oe1.value) - MIN(oe2.value) AS difference\nFROM \n    outputevents oe1\nINNER JOIN \n    outputevents oe2 ON oe1.subject_id = oe2.subject_id AND oe1.hadm_id = oe2.hadm_id AND oe1.itemid = oe2.itemid\nWHERE \n    oe1.subject_id = 10001725 \n    AND oe1.itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2')\n    AND oe1.charttime > oe2.charttime\n    AND oe1.stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = oe1.subject_id)\n    AND oe2.charttime < (SELECT MIN(charttime) FROM outputevents WHERE subject_id = oe1.subject_id AND itemid = oe1.itemid AND stay_id = oe1.stay_id)\nORDER BY \n    oe1.charttime DESC\nLIMIT 1;",
    "b5ddccb2652019203e02c96e": "SELECT \n  MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10003046 AND stay_id = ce.stay_id AND itemid = ce.itemid) THEN ce.valuenum END) AS first_systolic,\n  MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10003046 AND stay_id = ce.stay_id AND itemid = ce.itemid) THEN ce.valuenum END) AS last_systolic\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nJOIN icustays i ON ce.stay_id = i.stay_id\nWHERE di.label LIKE '%Systolic Blood Pressure%' \n  AND ce.subject_id = 10003046\n  AND i.subject_id = 10003046\n  AND ce.stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10003046 ORDER BY outtime DESC LIMIT 1);",
    "9ea8c0016a33c461c3a77f56": "SELECT \n    (T1.valuenum - T2.valuenum) AS difference\nFROM \n    labevents AS T1\nINNER JOIN \n    labevents AS T2\nON \n    T1.subject_id = T2.subject_id\n    AND T1.hadm_id = T2.hadm_id\n    AND T1.charttime > T2.charttime\nWHERE \n    T1.subject_id = 10037975\n    AND T1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Systolic BP')\n    AND T2.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Systolic BP')\n    AND T2.charttime = (SELECT MIN(charttime) FROM labevents WHERE subject_id = 10037975 AND itemid = T1.itemid)\n    AND T1.charttime = (SELECT MIN(charttime) FROM labevents WHERE subject_id = 10037975 AND itemid = T1.itemid AND charttime > T2.charttime)\nLIMIT 1;",
    "5ae9eba9c11262b3bc8961b7": "SELECT \n    (first_measurement.valuenum - second_measurement.valuenum) AS bp_change\nFROM\n(\n    SELECT \n        c.valuenum\n    FROM chartevents c\n    JOIN d_items d ON c.itemid = d.itemid\n    WHERE c.subject_id = 10020187\n    AND d.label = 'Systolic Blood Pressure'\n    AND c.stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10020187 ORDER BY intime DESC LIMIT 1)\n    ORDER BY c.charttime DESC\n    LIMIT 1\n) AS first_measurement,\n(\n    SELECT \n        c.valuenum\n    FROM chartevents c\n    JOIN d_items d ON c.itemid = d.itemid\n    WHERE c.subject_id = 10020187\n    AND d.label = 'Systolic Blood Pressure'\n    AND c.stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10020187 ORDER BY intime DESC LIMIT 1)\n    ORDER BY c.charttime DESC\n    LIMIT 1 OFFSET 1\n) AS second_measurement;",
    "617d9b7140ffa467be53e5b8": "SELECT \n    CASE \n        WHEN (SELECT valuenum \n              FROM chartevents ce2 \n              WHERE ce2.subject_id = ce.subject_id \n                AND ce2.hadm_id = ce.hadm_id \n                AND ce2.itemid = ce.itemid \n                AND ce2.charttime = (SELECT MAX(charttime) \n                                     FROM chartevents \n                                     WHERE subject_id = ce.subject_id \n                                       AND hadm_id = ce.hadm_id \n                                       AND itemid = ce.itemid)) < \n             (SELECT valuenum \n              FROM chartevents ce3 \n              WHERE ce3.subject_id = ce.subject_id \n                AND ce3.hadm_id = ce.hadm_id \n                AND ce3.itemid = ce.itemid \n                AND ce3.charttime = (SELECT MIN(charttime) \n                                     FROM chartevents \n                                     WHERE subject_id = ce.subject_id \n                                       AND hadm_id = ce.hadm_id \n                                       AND itemid = ce.itemid)) \n        THEN 'Yes' \n        ELSE 'No' \n    END AS co2_value_decreased\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10039831 AND \n    di.label = 'CO2' AND \n    ce.charttime = (SELECT MAX(charttime) \n                    FROM chartevents \n                    WHERE subject_id = ce.subject_id \n                      AND hadm_id = ce.hadm_id \n                      AND itemid = ce.itemid);",
    "769ea1c5d6c42c47ac9a1735": "",
    "ffc47b7e01463f229eb09bce": "",
    "ac19aaffd02ad22588a7a6e7": "SELECT \n    CASE\n        WHEN \n            (SELECT valuenum \n             FROM labevents le2 \n             WHERE le2.subject_id = 10021487 \n               AND le2.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Glucose') \n             ORDER BY le2.charttime DESC \n             LIMIT 1) < \n            (SELECT valuenum \n             FROM labevents le3 \n             WHERE le3.subject_id = 10021487 \n               AND le3.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Glucose') \n             ORDER BY le3.charttime DESC \n             LIMIT 1 OFFSET 1)\n        THEN 'Yes'\n        ELSE 'No'\n    END AS is_glucose_less\nFROM labevents le1\nWHERE le1.subject_id = 10021487 \n  AND le1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Glucose') \nLIMIT 1;",
    "fd2b88c449aa3147d9ef22a9": "SELECT \n    CASE \n        WHEN l2.valuenum > l1.valuenum THEN 'Yes' \n        ELSE 'No' \n    END AS is_greater\nFROM \n    labevents l1\nJOIN \n    labevents l2 ON l1.subject_id = l2.subject_id AND l1.hadm_id = l2.hadm_id\nJOIN \n    d_labitems d ON l2.itemid = d.itemid\nWHERE \n    l1.subject_id = 10004733 \n    AND d.label = 'Protein'\n    AND l1.charttime < l2.charttime\n    AND l1.row_id < l2.row_id\n    AND l2.charttime = (\n        SELECT MIN(charttime) \n        FROM labevents \n        WHERE subject_id = 10004733 \n        AND hadm_id = l2.hadm_id \n        AND itemid = l2.itemid\n    );",
    "06ed0a3cc8ab3dc7839b7919": "SELECT \n    CASE \n        WHEN first_measured < last_measured THEN 'greater'\n        ELSE 'not greater'\n    END AS result\nFROM (\n    SELECT \n        MIN(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10018501 AND hadm_id = a.hadm_id) THEN ce.valuenum END) AS first_measured,\n        MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10018501 AND hadm_id = a.hadm_id) THEN ce.valuenum END) AS last_measured\n    FROM admissions a\n    JOIN chartevents ce ON a.hadm_id = ce.hadm_id\n    JOIN d_items di ON ce.itemid = di.itemid\n    WHERE a.subject_id = 10018501 AND di.label = 'rdw'\n    LIMIT 1\n) AS subquery;",
    "96a829af0978aeef2a29366b": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10016810 AND itemid = d_items.itemid AND valuenum IS NOT NULL) THEN ce.valuenum END) \n    < MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10016810 AND itemid = d_items.itemid AND valuenum IS NOT NULL) THEN ce.valuenum END) \n    THEN 'Yes' \n    ELSE 'No' \n  END AS is_less\nFROM \n  chartevents ce\nJOIN \n  d_items d_items ON ce.itemid = d_items.itemid\nWHERE \n  ce.subject_id = 10016810 AND d_items.label = 'Calcium, Total';",
    "b45fe4ea7ffaf00e84199e79": "SELECT \n    (SELECTvaluenum \n    FROM chartevents \n    WHERE subject_id = 10016742 \n    AND itemid = 226705 \n    AND charttime = (SELECT MAX(charttime) \n    FROM chartevents \n    WHERE subject_id = 10016742 \n    AND itemid = 226705 \n    AND stay_id IN (SELECT stay_id \n    FROM icustays \n    WHERE subject_id = 10016742 \n    ORDER BY intime DESC \n    LIMIT 1))) \n    < \n    (SELECT valuenum \n    FROM chartevents \n    WHERE subject_id = 10016742 \n    AND itemid = 226705 \n    AND charttime = (SELECT MIN(charttime) \n    FROM chartevents \n    WHERE subject_id = 10016742 \n    AND itemid = 226705 \n    AND stay_id IN (SELECT stay_id \n    FROM icustays \n    WHERE subject_id = 10016742 \n    ORDER BY intime DESC \n    LIMIT 1)))",
    "0845eda9197d9666e0b3a017": "SELECT \n  CASE \n    WHEN MAX(CASE WHEN ce.charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = 10021118 AND hadm_id IN (SELECT hadm_id FROM icustays WHERE subject_id = 10021118 AND stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10021118 ORDER BY stay_id ASC LIMIT 1)) AND itemid = 245) THEN ce.valuenum END) > \n    MAX(CASE WHEN ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE subject_id = 10021118 AND hadm_id IN (SELECT hadm_id FROM icustays WHERE subject_id = 10021118 AND stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10021118 ORDER BY stay_id ASC LIMIT 1)) AND itemid = 245) THEN ce.valuenum END) \n    THEN 'Yes' \n    ELSE 'No' \n  END AS answer\nFROM chartevents ce\nWHERE ce.subject_id = 10021118 AND ce.itemid = 245 AND ce.hadm_id IN (SELECT hadm_id FROM icustays WHERE subject_id = 10021118 AND stay_id = (SELECT stay_id FROM icustays WHERE subject_id = 10021118 ORDER BY stay_id ASC LIMIT 1));",
    "7a1c80e590227785f1b6c6a6": "WITH O2SaturationMeasurements AS (\n    SELECT \n        c.charttime,\n        c.valuenum AS o2_saturation,\n        ROW_NUMBER() OVER (ORDER BY c.charttime DESC) AS rn\n    FROM chartevents c\n    JOIN icustays i ON c.hadm_id = i.hadm_id\n    WHERE c.subject_id = 10020944 \n      AND c.itemid = (SELECT itemid FROM d_items WHERE label = 'O2 saturation pulseoxymetry')\n      AND c.charttime IS NOT NULL\n)\nSELECT \n    CASE \n        WHEN last.o2_saturation > second_last.o2_saturation THEN 1\n        ELSE 0\n    END AS is_last_less_than_second_last\nFROM (\n    SELECT o2_saturation FROM O2SaturationMeasurements WHERE rn = 1\n) last\nCROSS JOIN (\n    SELECT o2_saturation FROM O2SaturationMeasurements WHERE rn = 2\n) second_last;",
    "a4067779dc66a630f0290603": "",
    "5defc394d5a39a4bee811cf5": "WITH LastICUStay AS (\n    SELECT \n        stay_id,\n        MAX(intime) AS last_intime\n    FROM \n        icustays\n    WHERE \n        subject_id = 10011398\n    GROUP BY \n        stay_id\n),\nFilteredChartEvents AS (\n    SELECT \n        chartevents.charttime,\n        chartevents.valuenum,\n        ROW_NUMBER() OVER (ORDER BY chartevents.charttime ASC) AS rn_asc,\n        ROW_NUMBER() OVER (ORDER BY chartevents.charttime DESC) AS rn_desc\n    FROM \n        chartevents\n    INNER JOIN \n        LastICUStay ON chartevents.stay_id = LastICUStay.stay_id\n    INNER JOIN \n        d_items ON chartevents.itemid = d_items.itemid\n    WHERE \n        d_items.label LIKE '%arterial blood pressure - systolic%'\n)\nSELECT \n    MAX(CASE WHEN rn_asc = 1 THEN valuenum END) AS first_value,\n    MAX(CASE WHEN rn_desc = 1 THEN valuenum END) AS last_value\nFROM \n    FilteredChartEvents\nHAVING \n    first_value < last_value;",
    "18712984cf426bc265ef3c86": "WITH SpO2Item AS (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label = 'O2 saturation pulseoxymetry'\n),\nFirstLabevent AS (\n    SELECT le.charttime AS first_charttime, le.valuenum AS first_valuenum\n    FROM labevents le\n    JOIN SpO2Item s ON le.itemid = s.itemid\n    WHERE le.subject_id = 10010471\n    ORDER BY le.charttime ASC\n    LIMIT 1\n),\nLastLabevent AS (\n    SELECT le.charttime AS last_charttime, le.valuenum AS last_valuenum\n    FROM labevents le\n    JOIN SpO2Item s ON le.itemid = s.itemid\n    WHERE le.subject_id = 10010471\n    ORDER BY le.charttime DESC\n    LIMIT 1\n)\nSELECT \n    CASE \n        WHEN fl.first_valuenum < ll.last_valuenum THEN 1\n        ELSE 0\n    END AS is_last_measurement_greater\nFROM FirstLabevent fl, LastLabevent ll;",
    "49096da9fc4db23df0c9ca94": "",
    "0aaf715cd38172a3fec8d22f": "SELECT age\nFROM admissions\nWHERE subject_id = 10022281\nORDER BY admittime DESC\nLIMIT 1;",
    "a5dc36ab0d9765ac8ab2b0be": "SELECT age \nFROM admissions \nWHERE subject_id = 10038992 \nAND admittime = (SELECT MAX(admittime) FROM admissions WHERE subject_id = 10038992);",
    "6a0426303656887491909d29": "SELECT \n    a.age\nFROM \n    admissions a\nWHERE \n    a.subject_id = 10022041\nORDER BY \n    a.admittime ASC\nLIMIT 1;",
    "8f9bd64fc45fb2e7efce6e09": "SELECT T1.age\nFROM admissions AS T1\nWHERE T1.subject_id = 10031757\nORDER BY T1.admittime DESC\nLIMIT 1;",
    "7181a0d2584214c798eeebfb": "SELECT age\nFROM admissions\nWHERE subject_id = 10000032\nORDER BY admittime ASC\nLIMIT 1;",
    "cf80e026f450ba3b1f34afca": "SELECT \n  (strftime('%Y', T2.admittime) - strftime('%Y', T1.dob)) - \n  (strftime('%m%d', T2.admittime) < strftime('%m%d', T1.dob)) AS age\nFROM \n  patients AS T1\n  INNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.subject_id = 10035185\nORDER BY \n  T2.admittime DESC\nLIMIT 1;",
    "d0fede74514340f1c6713467": "",
    "f34840d2e5d80b70e76bfdec": "SELECT \n    insurance\nFROM \n    admissions\nWHERE \n    subject_id = 10004422\nORDER BY \n    admittime DESC\nLIMIT 1;",
    "33eb641aa295e6631d41c5b9": "SELECT \n  insurance\nFROM \n  admissions\nWHERE \n  subject_id = 10004720 \nORDER BY \n  admittime DESC\nLIMIT 1;",
    "695375d6c1fa9fdcc62343bd": "SELECT insurance\nFROM admissions\nWHERE subject_id = 10007818\nORDER BY admittime\nLIMIT 1;",
    "cbb82c6ae494381e1e693100": "SELECT insurance \nFROM admissions \nWHERE subject_id = 10006053 \nORDER BY admittime DESC \nLIMIT 1;",
    "8166e7dd802e75a9bb516018": "SELECT T2.insurance \nFROM patients AS T1 \nINNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id \nWHERE T1.subject_id = 10022017;",
    "f6b19667a6aead364aac15bf": "SELECT insurance \nFROM admissions \nWHERE subject_id = 10023239 \nORDER BY hadm_id \nLIMIT 1;",
    "6938ea8746e5138601dbdae7": "WITH PatientAge AS (\n  SELECT age\n  FROM admissions\n  WHERE subject_id = 10035185 AND hadm_id = (\n    SELECT MIN(hadm_id)\n    FROM admissions\n    WHERE subject_id = 10035185\n  )\n),\nPatientUreaValues AS (\n  SELECT \n    l.valuenum AS urea_value,\n    PERCENT_RANK() OVER (ORDER BY l.valuenum) AS percentile\n  FROM \n    labevents l\n    INNER JOIN d_labitems d ON l.itemid = d.itemid\n    INNER JOIN admissions a ON l.hadm_id = a.hadm_id\n  WHERE \n    d.label = 'UREA NITROGEN' AND\n    a.age = (SELECT age FROM PatientAge)\n)\nSELECT \n  percentile\nFROM \n  PatientUreaValues\nWHERE \n  urea_value = 38.0;",
    "b88b37ae5acfee6df9247dfb": "WITH patient_age AS (\n  SELECT T2.age\n  FROM patients AS T1\n  INNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id\n  WHERE T1.subject_id = 10038081\n),\nfiltered_events AS (\n  SELECT T1.*\n  FROM labevents AS T1\n  INNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\n  WHERE T2.age = (SELECT age FROM patient_age)\n    AND T1.itemid = 1\n)\nSELECT PERCENT_RANK() OVER (ORDER BY valuenum) AS percentile\nFROM filtered_events\nWHERE valuenum = 2.71;",
    "f90fbe1a6c278c3d4b3d2829": "Select lab events (`labevents`) for the item `Magnesium` (`d_labitems.label = 'Magnesium'`).\n   - Filter these events for patients who are of the same age as identified in Step 1.\n\n3. **Calculate the Percentile**:\n   - Use the `PERCENT_RANK()` window function to determine the percentile of the magnesium level 2.0 among the filtered lab events.",
    "01f54f272e5f4a9bc0a7232d": "WITH LastEncounter AS (\n    SELECT \n        adm.hadm_id,\n        adm.age\n    FROM admissions adm\n    WHERE adm.subject_id = 10008287\n    ORDER BY adm.admittime DESC\n    LIMIT 1\n),\nAgeMatchedValues AS (\n    SELECT \n        lab.valuenum,\n        PERCENT_RANK() OVER (ORDER BY lab.valuenum) AS percentile\n    FROM labevents lab\n    INNER JOIN LastEncounter le ON lab.hadm_id = le.hadm_id\n    WHERE lab.itemid = (SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'PTT')\n)\nSELECT percentile\nFROM AgeMatchedValues\nWHERE valuenum = 23.5;",
    "325f8e14568068a880720cc4": "Select all `WBC` labevents for patients of the same age.\n3. Calculate the percentile rank for the value `10.8` among these patients.\n\nLet's break this down into steps and write the SQL query.",
    "1039ad255c53fd49a3e45f2f": "SELECT \n    PERCENT_RANK() OVER (ORDER BY T1.valuenum) * 100 AS percentile\nFROM \n    labevents T1\nINNER JOIN \n    d_labitems T2 ON T1.itemid = T2.itemid\nINNER JOIN \n    admissions T3 ON T1.hadm_id = T3.hadm_id\nWHERE \n    T1.subject_id = 10015931\n    AND T1.valuenum = 186.0\n    AND T2.label = 'Glucose'\n    AND T3.admittime = (\n        SELECT MAX(T4.admittime)\n        FROM admissions T4\n        WHERE T4.subject_id = 10015931\n    );",
    "7dc8ffd1359d41d1da9da63c": "WITH PatientAgeGroup AS (\n    SELECT\n        age\n    FROM\n        admissions\n    WHERE\n        subject_id = 10021487\n),\nLabEventResults AS (\n    SELECT\n        l.subject_id,\n        l.hadm_id,\n        l.charttime,\n        l.valuenum\n    FROM\n        labevents l\n    INNER JOIN\n        d_labitems d ON l.itemid = d.itemid\n    INNER JOIN\n        PatientAgeGroup pag ON pag.age = (\n            SELECT age FROM admissions WHERE subject_id = l.subject_id AND hadm_id = l.hadm_id\n        )\n    WHERE\n        d.label = 'PLATELET COUNT'\n        AND l.charttime BETWEEN (\n            SELECT admittime FROM admissions WHERE subject_id = 10021487\n        ) AND (\n            SELECT dischtime FROM admissions WHERE subject_id = 10021487\n        )\n),\nRankedResults AS (\n    SELECT\n        valuenum,\n        PERCENT_RANK() OVER (ORDER BY valuenum) AS percentile\n    FROM\n        LabEventResults\n)\nSELECT\n    percentile\nFROM\n    RankedResults\nWHERE\n    valuenum = 114.0;",
    "b1f43697c74666c4701854b3": "SELECT \n  (strftime('%s', T1.outtime) - strftime('%s', T1.intime)) / 3600.0 AS elapsed_hours\nFROM \n  icustays T1\nJOIN \n  admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T2.subject_id = 10018081;",
    "a4601ccbd52ea5048219a13a": "SELECT \n  (julianday('now') - julianday(i.intime)) AS days_since_icu_admission\nFROM \n  icustays i\nWHERE \n  i.subject_id = 10018081;",
    "90eb2c78447a14389410b63f": "SELECT \n    (julianday('now') - julianday(T1.intime)) * 24 AS hours_elapsed\nFROM \n    icustays AS T1\nWHERE \n    T1.subject_id = 10039831\nLIMIT 1;",
    "3444c5918e4cc5369449a9b3": "SELECT \n  (strftime('%s', T2.outtime) - strftime('%s', T2.intime)) / 3600.0 AS hours_in_icu\nFROM \n  patients AS T1\n  INNER JOIN icustays AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.subject_id = 10018081;",
    "ab9f098a63937bcf7a768bee": "SELECT (julianday('now') - julianday(i.intime)) * 24 AS hours_since_icu_admission\nFROM icustays i\nWHERE i.subject_id = 10018081;",
    "a08cb35b715a295797129d6f": "SELECT \n    (julianday('now') - julianday(ic.intime)) * 24 AS hours_since_admission\nFROM \n    icustays ic\nWHERE \n    ic.subject_id = 10039831;",
    "12c4448b67fe5aedbc6c32e2": "SELECT \n  julianday('now') - julianday(i.intime) AS days_since_admission\nFROM icustays i\nJOIN admissions a ON i.hadm_id = a.hadm_id\nWHERE a.subject_id = 10039831;",
    "2322a6ff73f6c9d85f8b5a42": "SELECT \n  (strftime('%s', 'now') - strftime('%s', T1.intime)) / 3600.0 AS hours_since_admission\nFROM \n  icustays T1\nWHERE \n  T1.subject_id = 10021487 \n  AND T1.first_careunit = 'med/surg/trauma'\nORDER BY \n  T1.intime\nLIMIT 1;",
    "55734b9319f9dd143aa308ee": "SELECT \n  (julianday('now') - julianday(icu.intime)) * 24 AS hours_since_intime\nFROM \n  icustays icu\nWHERE \n  icu.subject_id = 10004733 \n  AND icu.first_careunit = 'neurology'\nORDER BY \n  icu.intime ASC\nLIMIT 1;",
    "aedafdf56773a3d83e728b07": "SELECT \n    JULIANDAY('now') - JULIANDAY(MAX(T3.outtime)) AS days_since_last_stay\nFROM \n    patients AS T1\nINNER JOIN \n    admissions AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN \n    icustays AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE \n    T1.subject_id = 10021487 \n    AND T3.first_careunit = 'Emergency Department';",
    "14cbab955b0cd896876914ae": "SELECT \n    JULIANDAY('now') - JULIANDAY(outtime) AS days_since_last_stay\nFROM \n    icustays\nWHERE \n    subject_id = 10018081\n    AND last_careunit = 'tsicu'\nORDER BY \n    outtime DESC\nLIMIT 1;",
    "43896dd8714c99844b172005": "WITH CurrentAdmission AS (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10039831\n    ORDER BY admittime DESC\n    LIMIT 1\n),\nLastStayInDischargeLounge AS (\n    SELECT outtime\n    FROM icustays\n    WHERE subject_id = 10039831 AND hadm_id = (SELECT hadm_id FROM CurrentAdmission) AND last_careunit = 'discharge lounge'\n    ORDER BY outtime DESC\n    LIMIT 1\n)\nSELECT \n    julianday('now') - julianday(outtime) AS days_since_last_stay\nFROM LastStayInDischargeLounge;",
    "468c08e2b6a2ad56c3a4b7ce": "SELECT \n    (julianday('now') - julianday(i.intime)) * 24 AS hours_since_first_stay\nFROM \n    icustays i\nJOIN \n    admissions a ON i.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10004733\nORDER BY \n    i.intime ASC\nLIMIT 1;",
    "66efbf3af38673128432f1ca": "",
    "5c76a4f60142e53facaaad36": "SELECT \n  (julianday('now') - julianday(T1.charttime)) * 24 AS hours_since_diagnosis\nFROM \n  labevents AS T1\n  INNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10018081\n  AND (T2.label LIKE '%hyposmolality%' OR T2.label LIKE '%hyponatremia%')\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "e02703e99cca2a83c3ce8360": "SELECT \n  (julianday('now') - julianday(charttime)) * 24 AS hours_since_diagnosis\nFROM \n  diagnoses_icd\nWHERE \n  subject_id = 10018081\n  AND icd_code = 'I10'\nORDER BY \n  charttime DESC\nLIMIT 1;",
    "5ba5d822e1cd7d6ea2e879f5": "",
    "84abf7eeac8648121f34613c": "SELECT \n  (julianday(T2.charttime) - julianday(T1.admittime)) * 24 AS hours_since_admission\nFROM \n  admissions AS T1\n  INNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\n  INNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE \n  T1.subject_id = 10018081\n  AND T3.long_title LIKE '%severe sepsis%'\nORDER BY \n  T2.charttime\nLIMIT 1;",
    "851fcf327081528d82ce552c": "SELECT \n  (julianday('now') - julianday(di.charttime)) * 24 AS hours_since_diagnosis\nFROM \n  diagnoses_icd di\n  JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n  di.subject_id = 10021487\n  AND d.long_title = 'Other fluid overload';",
    "b9f5b0364513fe3fe10ac23e": "",
    "dcc1a24e525aca42e0faa8ad": "SELECT \n    (julianday('now') - julianday(diagnosis.charttime)) * 24 AS hours_since_diagnosis\nFROM \n    diagnoses_icd diagnosis\nJOIN \n    d_icd_diagnoses icd ON diagnosis.icd_code = icd.icd_code\nWHERE \n    diagnosis.subject_id = 10021487\n    AND icd.long_title LIKE '%acute vascular insufficiency of intestine%'\nLIMIT 1;",
    "b037cad3311b5d427cda5306": "",
    "fc9243a5cde088d80aaae29a": "SELECT \n    (strftime('%s', 'now') - strftime('%s', l.charttime)) / 3600.0 AS hours_since_test\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10021487 \n    AND d.label = 'AST'\nORDER BY \n    l.charttime ASC\nLIMIT 1;",
    "90b5ca0a939ce91e8678e9e2": "SELECT (strftime('%J', T2.charttime) - strftime('%J', T1.admittime)) AS days_since_admission\nFROM admissions T1\nINNER JOIN labevents T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE T2.itemid = 214 AND T2.charttime = (\n    SELECT MIN(charttime)\n    FROM labevents\n    WHERE subject_id = 10021487 AND hadm_id = T1.hadm_id AND itemid = 214\n)",
    "b2aa7e4ded1cb22312719f24": "SELECT (julianday(labevents.charttime) - julianday(admissions.admittime)) * 24 AS hours_since_admission\nFROM labevents\nJOIN admissions ON labevents.hadm_id = admissions.hadm_id\nWHERE labevents.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Creatinine')\nAND labevents.subject_id = 10039831\nAND admissions.subject_id = 10039831\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "de82a5b21bc173cb82992e90": "SELECT \n  julianday('now') - julianday(labevents.charttime) AS days_since_charttime\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.subject_id = 10021487\n  AND d_labitems.label = 'Amylase, Pleural'\nORDER BY \n  labevents.charttime ASC\nLIMIT 1;",
    "e76832974c5806793c6d4c8a": "SELECT \n  julianday('now') - julianday(MIN(charttime)) AS days_since_first_po2_test\nFROM \n  labevents\nWHERE \n  subject_id = 10021487 \n  AND itemid = (\n    SELECT itemid \n    FROM d_labitems \n    WHERE label = 'Po2'\n  );",
    "23dd8572482a3b9ef2437c37": "SELECT \n    (JULIANDAY(T1.charttime) - JULIANDAY(T2.admittime)) AS days_since_admission\nFROM \n    labevents T1\nINNER JOIN \n    admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10018081 AND T1.itemid IN (SELECT itemid FROM d_labitems WHERE label LIKE '%po2%')\nORDER BY \n    T1.charttime ASC\nLIMIT 1;",
    "b9271c00a9f5d1cda644a8f7": "SELECT \n  (julianday('now') - julianday(MAX(ie.charttime))) AS days_since_last_input\nFROM \n  inputevents ie\nWHERE \n  ie.subject_id = 10039831\n  AND ie.totalamount > 0\n  AND (ie.totalamountuom = 'ml' OR ie.totalamountuom = 'mL')\nORDER BY \n  ie.charttime DESC\nLIMIT 1;",
    "56d7f83c3d047987d4f5ad6a": "SELECT \n    (julianday('now') - julianday(starttime)) AS elapsed_days\nFROM \n    inputevents\nWHERE \n    subject_id = 10018081\n    AND itemid = 1\nORDER BY \n    starttime ASC\nLIMIT 1;",
    "d5598306e9ea4771b948f856": "SELECT (julianday(t2.charttime) - julianday(t1.intime)) * 24 AS elapsed_hours\nFROM icustays t1\nINNER JOIN inputevents t2 ON t1.stay_id = t2.stay_id\nWHERE t1.subject_id = 10018081 \nAND t2.itemid = (SELECT itemid FROM d_items WHERE label = 'NaCl 0.9%')\nAND t2.totalamount > 0\nLIMIT 1;",
    "86522357b4bc14150a100527": "",
    "b3f250788370221cd33bdb7b": "WITH CurrentICUStay AS (\n    SELECT \n        stay_id,\n        subject_id,\n        hadm_id,\n        intime,\n        outtime\n    FROM icustays\n    WHERE subject_id = 10018081\n    AND outtime IS NULL  -- Ensuring it's the current ICU stay\n),\nGastricMedInputs AS (\n    SELECT \n        ie.subject_id,\n        ie.starttime\n    FROM inputevents ie\n    INNER JOIN CurrentICUStay cis ON ie.hadm_id = cis.hadm_id AND ie.stay_id = cis.stay_id\n    WHERE ie.itemid = (SELECT itemid FROM d_items WHERE label LIKE '%Gastric Meds%')\n    ORDER BY ie.starttime ASC\n    LIMIT 1\n)\nSELECT \n    ROUND((strftime('%s', 'now') - strftime('%s', gi.starttime)) / 3600.0, 2) AS hours_since_first_input\nFROM GastricMedInputs gi;",
    "a19d8f8790ee9cc3b62ce290": "SELECT \n    (julianday('now') - julianday(ie.starttime)) AS days_since_input\nFROM \n    inputevents ie\nJOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    di.label = 'Nepro (full)'\n    AND ie.subject_id = 10018081\nORDER BY \n    ie.starttime ASC\nLIMIT 1;",
    "8fa5e7278b3b5b9b839b6135": "SELECT (julianday('now') - julianday(ie.starttime)) AS days_since_input\nFROM inputevents ie\nWHERE ie.subject_id = 10018081 AND ie.itemid = (SELECT itemid FROM d_items WHERE label = 'gt flush') AND ie.hadm_id IN (SELECT hadm_id FROM icustays WHERE subject_id = 10018081)\nLIMIT 1;",
    "653e63e266f88f5e4752d092": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10020740\nORDER BY admittime\nLIMIT 1;",
    "129654f0722de6dae2867660": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10018423\nORDER BY hadm_id\nLIMIT 1;",
    "6fd5e2805d0a42a23c2787ff": "SELECT admission_type\nFROM admissions\nWHERE subject_id = 10018081\nORDER BY admittime ASC\nLIMIT 1;",
    "68c085ad9374a9c886e43355": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10019917 \nORDER BY admittime DESC \nLIMIT 1;",
    "60f8d59c27fe673230ac2a83": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10006053;",
    "94cd2d4043d712084245bed1": "",
    "8df120a9e3e8d73de47c1a11": "SELECT admission_type \nFROM admissions \nWHERE subject_id = 10011398 \nORDER BY admittime DESC \nLIMIT 1;",
    "1b6f72d94895e62f9e279e35": "SELECT ce.valuenum AS last_weight\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10005909\n  AND ce.charttime LIKE '2023-11-%'\n  AND di.label LIKE '%Weight%'\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "b82dba86a4b2a808ab2cef89": "SELECT \n  T1.valuenum,\n  T1.valueuom\nFROM \n  chartevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10011398\n  AND T2.label = 'Weight'\n  AND T1.charttime >= date('now', '-30 months')\nORDER BY \n  T1.charttime DESC\nLIMIT 1;",
    "63359ce4687532a538d1238d": "",
    "27ce9933ce0b1542c2dd468c": "SELECT \n    ce.valuenum AS weight_in_grams\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10036156 AND di.label = 'Weight'\nORDER BY \n    ce.charttime\nLIMIT 1;",
    "9cd37fc842ad70310d54ee58": "SELECT charttime, valuenum, valueuom\nFROM chartevents\nWHERE itemid = (SELECT itemid FROM d_items WHERE label = 'Weight')\nAND subject_id = 10027602\nAND charttime >= DATETIME('now', '-5 months')\nORDER BY charttime ASC\nLIMIT 1;",
    "689684471cdf1a2cea58ca7c": "SELECT T1.valuenum AS weight\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nINNER JOIN admissions AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE T1.subject_id = 10007928\nAND T2.label = 'Weight'\nAND T1.charttime = (\n    SELECT MAX(charttime)\n    FROM chartevents\n    WHERE subject_id = 10007928\n    AND hadm_id = T3.hadm_id\n)\nORDER BY T1.charttime\nLIMIT 1;",
    "5b70769cdf8e342b6b7432c8": "SELECT \n  ce.valuenum AS weight\nFROM \n  admissions a\n  INNER JOIN chartevents ce ON a.hadm_id = ce.hadm_id\nWHERE \n  a.subject_id = 10005909\n  AND ce.valueuom = 'kg'\n  AND ce.charttime = (\n    SELECT MAX(ce2.charttime)\n    FROM chartevents ce2\n    WHERE ce2.hadm_id = a.hadm_id\n      AND ce2.valueuom = 'kg'\n  )\nORDER BY \n  ce.charttime DESC\nLIMIT 1;",
    "84ffe2eecf94db13c293cd18": "SELECT \n  d.long_title \nFROM \n  diagnoses_icd AS di \n  INNER JOIN d_icd_diagnoses AS d ON di.icd_code = d.icd_code \nWHERE \n  di.subject_id = 10006580 \n  AND di.charttime > DATE('now', '-1 year') \nORDER BY \n  di.charttime DESC \nLIMIT 1;",
    "531d3b5c9daeaf625b709381": "",
    "c382285cc641ffefb4754fec": "SELECT d.long_title\nFROM diagnoses_icd di\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.subject_id = 10011398 AND di.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10011398\n    ORDER BY admittime\n    LIMIT 1\n)\nORDER BY di.charttime DESC\nLIMIT 1;",
    "a68a8f7c8f9c51d21140fbb2": "SELECT d.long_title AS diagnosis\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.subject_id = 10020740 AND di.charttime >= '2100-01-01'\nORDER BY di.charttime ASC\nLIMIT 1;",
    "480b667942347b982307f45c": "SELECT \n  d.long_title AS first_diagnosis\nFROM \n  patients p\nJOIN \n  diagnoses_icd di ON p.subject_id = di.subject_id\nJOIN \n  d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n  p.subject_id = 10009628 AND \n  di.charttime LIKE '2100%'\nORDER BY \n  di.charttime\nLIMIT 1;",
    "19013f71186dd94c3663224d": "SELECT T2.long_title\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nWHERE T1.subject_id = 10029291\n  AND strftime('%Y', T1.charttime) = '2100'\nORDER BY T1.charttime\nLIMIT 1;",
    "b389e224ed07b11a553f0329": "",
    "882e179f26d1d73b14ec8e40": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10035185\n  AND route = 'nu'\n  AND hadm_id = (SELECT hadm_id\n                 FROM admissions\n                 WHERE subject_id = 10035185\n                 ORDER BY admittime DESC\n                 LIMIT 1)\nORDER BY starttime DESC\nLIMIT 1;",
    "0df69b82de6a35ad5bdec3d3": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10010471 \nAND route = 'neb' \nAND starttime >= '2021-12-01 00:00:00'\nORDER BY starttime ASC \nLIMIT 1;",
    "c1b92eb9d2e4ceedd614efe5": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10029291\nAND starttime BETWEEN '2023-03-01' AND '2023-03-31'\nAND route = 'iv'\nORDER BY starttime ASC\nLIMIT 1;",
    "ad08e146a6e37e3a138c8c78": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10020944\nAND route = 'iv'\nAND starttime = (\n    SELECT MIN(starttime)\n    FROM prescriptions p2\n    WHERE p2.subject_id = 10020944\n    AND p2.route = 'iv'\n)\nLIMIT 1;",
    "5bb6c677596960ca463e9a0c": "SELECT drug \nFROM prescriptions \nWHERE hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10038933 \n    ORDER BY admittime \n    LIMIT 1\n) \nAND route = 'td' \nORDER BY starttime DESC \nLIMIT 1;",
    "727a314e82ff330ad11ea76a": "SELECT \n    drug \nFROM \n    prescriptions \nWHERE \n    subject_id = 10020187 AND \n    route = 'po' AND \n    strftime('%Y-%m', starttime) = strftime('%Y-%m', 'now', '-1 month') \nORDER BY \n    starttime DESC \nLIMIT 1;",
    "86aa92cf8b22de77c9f101da": "SELECT T1.drug\nFROM prescriptions AS T1\nWHERE T1.subject_id = 10007818\nAND T1.hadm_id = (SELECT MIN(hadm_id) \n                  FROM admissions \n                  WHERE subject_id = 10007818)\nAND T1.route = 'replace'\nORDER BY T1.starttime ASC\nLIMIT 1;",
    "b1230a6aa17968195ee8b217": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10003400 \nAND starttime >= date('now', '-26 months') \nORDER BY starttime \nLIMIT 1;",
    "779440f275cacfb10aac9cd9": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10001725 \n  AND starttime >= DATE('now', '-28 months') \nORDER BY starttime ASC \nLIMIT 1;",
    "db9cfb9fbfbda61eb399064e": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10022041 AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10022041\n    ORDER BY admittime\n    LIMIT 1\n)\nORDER BY starttime DESC\nLIMIT 1;",
    "03dfaec9b60c0b6d9aa52f8a": "SELECT drug \nFROM prescriptions \nWHERE subject_id = 10021118 \nAND starttime LIKE '%12/2100%' \nORDER BY starttime DESC \nLIMIT 1;",
    "fe2d6c0f694f5a4cc2357932": "SELECT drug\nFROM prescriptions\nWHERE subject_id = 10005817\n  AND starttime >= '2021-09-01'\nORDER BY starttime ASC\nLIMIT 1;",
    "a0db7ff03e5bff5fb4b04f91": "SELECT \n  T1.drug \nFROM \n  prescriptions AS T1 \n  INNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id \nWHERE \n  T2.subject_id = 10007818 \nORDER BY \n  T1.stoptime DESC \nLIMIT 1;",
    "1bc55cd8f6d690799f8c4047": "SELECT T1.drug\nFROM prescriptions AS T1\nWHERE T1.subject_id = 10020306\nAND T1.starttime >= DATE('now', '-13 months')\nORDER BY T1.starttime ASC\nLIMIT 1;",
    "d668bffcab5e2672863cb63b": "SELECT DISTINCT p.drug\nFROM prescriptions p\nJOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nWHERE p.subject_id = 10018081\nAND d.icd_code = 'E110'\nAND p.starttime >= d.charttime\nAND p.starttime <= DATE(d.charttime, '+2 days');",
    "59e904000d52c139e656f371": "select the `drug`, `dose_val_rx`, and `dose_unit_rx` columns from the `prescriptions` table.\n2. **Join the `prescriptions` and `diagnoses_icd` tables:** We'll join these tables on the `hadm_id` to ensure we're looking at the same hospital visit.\n3. **Filter the diagnosis:** We'll filter for diagnoses related to hyposmolality and/or hyponatremia using the `icd_code`.\n4. **Filter the time:** We'll filter the diagnoses to only include those from the last three months.\n5. **Filter the patient:** We'll filter for the specific patient (subject_id = 10018081).\n6. **Order the results:** Finally, we'll order the results by `starttime` to get the most recent prescription first.",
    "084bc1062af3fecf71b004b8": "SELECT p.drug\nFROM patients p1\nJOIN diagnoses_icd d ON p1.subject_id = d.subject_id\nJOIN prescriptions p ON p1.subject_id = p.subject_id AND d.hadm_id = p.hadm_id\nWHERE p1.subject_id = 10022281\n  AND d.icd_code = 'E11'\n  AND p.starttime >= d.charttime\n  AND p.starttime <= datetime(d.charttime, '+1 day');",
    "edc9d546d2286562d9028ba2": "",
    "188165b0d15bdb552ff80f78": "SELECT \n    p.drug\nFROM \n    prescriptions p\nINNER JOIN \n    diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n    p.subject_id = 10015931 AND \n    d2.long_title LIKE '%long term (current) use of insulin%' AND \n    p.starttime >= DATE('now', 'start of year', '12 days') AND \n    p.starttime < DATE('now', 'start of year', '14 days')",
    "274b0d1304fb6e07afcfbbda": "SELECT \n  p.drug,\n  p.dose_val_rx,\n  p.dose_unit_rx,\n  p.route\nFROM \n  prescriptions p\n  INNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nWHERE \n  p.subject_id = 10021487\n  AND d.icd_code IN (\n    SELECT icd_code \n    FROM d_icd_diagnoses \n    WHERE long_title LIKE '%traumatic hemothorax%'\n    AND long_title NOT LIKE '%open wound into thorax%'\n  )\n  AND d.charttime BETWEEN DATE('now', 'start of month') AND DATE('now', 'start of month', '+1 month')\n  AND p.starttime BETWEEN d.charttime AND DATE(d.charttime, '+2 day');",
    "fb06199e01e940e2278f83e6": "SELECT T3.drug\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nINNER JOIN prescriptions AS T3 ON T1.subject_id = T3.subject_id AND T1.hadm_id = T3.hadm_id\nWHERE T1.subject_id = 10011398\nAND T2.long_title LIKE '%Intermediate coronary syndrome%'\nAND T1.charttime BETWEEN date('now', 'start of month') AND date('now', 'start of month', '+1 month')\nAND T3.starttime BETWEEN T1.charttime AND date(T1.charttime, '+2 days');",
    "d7d06c5202d42d089c98cbcb": "SELECT T1.drug\nFROM prescriptions AS T1\nINNER JOIN procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T1.subject_id = 10007818\nAND T1.starttime >= T2.charttime\nAND T1.starttime <= DATE(T2.charttime, '+1 day')\nAND T3.long_title LIKE '%fluoroscopy of superior vena cava using other contrast, guidance procedure%'\nAND strftime('%m', T2.charttime) = '07';",
    "0e6e7e38aaec3a977e832859": "SELECT p.drug\nFROM prescriptions p\nJOIN procedures_icd pro ON p.hadm_id = pro.hadm_id\nWHERE p.subject_id = 10019172\nAND pro.icd_code = 'S40.04'  -- ICD code for excision of dental lesion of jaw\nAND p.hadm_id = pro.hadm_id;",
    "7e34d3539103f069ec358935": "SELECT DISTINCT T4.drug\nFROM icustays AS T1\nINNER JOIN procedures_icd AS T3 ON T1.hadm_id = T3.hadm_id\nINNER JOIN prescriptions AS T4 ON T1.hadm_id = T4.hadm_id\nINNER JOIN patients AS T5 ON T4.subject_id = T5.subject_id\nWHERE T5.subject_id = 10027602\nAND T3.icd_code = 'Q84.62' -- Continuous invasive mechanical ventilation for less than 96 consecutive hours\nAND T1.outtime - T1.intime < 96 -- Duration of ICU stay less than 96 hours\nAND T4.starttime BETWEEN T1.intime AND T1.outtime; -- Prescription within the ICU stay",
    "72035c7e697aebbd36cc9933": "SELECT p.drug\nFROM prescriptions AS p\nJOIN procedures_icd AS pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\nJOIN d_icd_procedures AS d ON pr.icd_code = d.icd_code\nWHERE p.subject_id = 10027602\nAND pr.charttime >= DATE('now', '-1 month')\nAND d.long_title = 'Endovascular (total) Embolization or Occlusion of Head and Neck Vessels';",
    "812c6c46b3324a53a45d2aeb": "",
    "2a11db69d8090e01bd8a342f": "SELECT DISTINCT P.drug\nFROM prescriptions P\nINNER JOIN procedures_icd PR ON P.hadm_id = PR.hadm_id\nWHERE P.subject_id = 10027602\nAND PR.icd_code = '00.21'\nAND P.starttime >= DATE('now', 'start of month')\nAND P.starttime < DATE('now', 'start of month', '+1 month');",
    "7de6b061dc649d1607951286": "SELECT \n  T1.drug\nFROM \n  prescriptions AS T1\nINNER JOIN \n  procedures_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.subject_id = 10021312\n  AND T2.icd_code = 'P03.36' \n  AND T1.starttime >= (SELECT T2.charttime FROM procedures_icd AS T2 WHERE T2.subject_id = 10021312 AND T2.icd_code = 'P03.36')\n  AND T1.starttime < (SELECT T2.charttime FROM procedures_icd AS T2 WHERE T2.subject_id = 10021312 AND T2.icd_code = 'P03.36') + 2 * 24 * 60 * 60;",
    "73f7afc22d0bf51b0967f477": "SELECT \n    SUM(T1.totalamount) AS total_amount_administered\nFROM \n    inputevents AS T1\nINNER JOIN \n    prescriptions AS T2 ON T1.hadm_id = T2.hadm_id AND T1.itemid = T2.row_id\nWHERE \n    T1.subject_id = 10006053 \n    AND T2.drug LIKE '%0.9% sodium chloride%'\n    AND T1.starttime >= '10/2100';",
    "0d67d0933db06596007b915d": "SELECT \n    SUM(p.dose_val_rx) AS total_phenezopyridine_prescribed\nFROM \n    prescriptions p\nWHERE \n    p.subject_id = 10005909 \n    AND p.drug = 'phenazopyridine' \n    AND p.hadm_id = (\n        SELECT MAX(hadm_id) \n        FROM prescriptions \n        WHERE subject_id = 10005909\n    );",
    "011101a7eeb61bc7e999e5d0": "SELECT T1.dose_val_rx AS last_prescribed_amount\nFROM prescriptions AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.drug = 'ibuprofen suspension' AND T2.subject_id = 10014078\nORDER BY T2.hadm_id DESC, T1.starttime DESC\nLIMIT 1;",
    "8ddf87626d2c76b0babbc0d9": "SELECT dose_val_rx \nFROM prescriptions \nWHERE subject_id = 10007795 AND drug = 'Tamoxifen Citrate' \nORDER BY starttime DESC \nLIMIT 1;",
    "28fd166cd9efc2ab844c870d": "SELECT MAX(prescriptions.starttime) AS last_prescription_time, prescriptions.dose_val_rx, prescriptions.dose_unit_rx\nFROM prescriptions\nINNER JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id\nWHERE prescriptions.subject_id = 10018423\n  AND prescriptions.drug = 'metoprolol tartrate';",
    "7db7fa4ecb7523dc29380f8c": "SELECT p.dose_val_rx\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10031757\nAND p.drug = 'acetaminophen'\nAND p.route = 'IV'\nORDER BY p.starttime ASC\nLIMIT 1;",
    "63e4dddc1461b7b4506f3036": "SELECT T2.dose_val_rx\nFROM admissions AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10002495\nAND T2.drug = 'lidocaine jelly 2% (urojet)'\nAND T1.hadm_id = (\n    SELECT MAX(hadm_id)\n    FROM admissions\n    WHERE subject_id = 10002495\n)\nORDER BY T2.starttime\nLIMIT 1;",
    "652c13b3ffbd655d3934525f": "SELECT SUM(dose_val_rx) AS total_oxycodone_dose\nFROM prescriptions\nWHERE drug = 'oxycodone (immediate release)' AND subject_id = 10020187;",
    "ff8338b63365f7592e0f5601": "SELECT SUM(dose_val_rx) AS total_glucose_gel_prescribed\nFROM prescriptions\nWHERE subject_id = 10014354\nAND drug = 'glucose gel';",
    "89c2d37bc8253b4bbe4a7c48": "SELECT SUM(p.dose_val_rx) AS total_prescribed_dose\nFROM prescriptions p\nWHERE p.subject_id = 10020944 AND p.hadm_id = (\n  SELECT adm.hadm_id\n  FROM admissions adm\n  WHERE adm.subject_id = 10020944\n  ORDER BY adm.admittime\n  LIMIT 1\n) AND p.drug = 'PREGABALIN';",
    "c342b5e4b0e92d9e4a863516": "SELECT drug, dose_val_rx, dose_unit_rx \nFROM prescriptions \nWHERE subject_id = 10011398 AND starttime >= '2000-07-01';",
    "5d1a36d000cf036649466742": "SELECT SUM(T.dose_val_rx) AS total_simvastatin_dose\nFROM prescriptions AS T\nWHERE T.subject_id = 10025463 AND T.drug = 'Simvastatin' AND T.starttime >= '2011-11-01 00:00:00';",
    "372eebaf1307d345c3c26b97": "SELECT SUM(p.dose_val_rx) AS total_iron_dose\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10012853 AND a.hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10012853);",
    "21a26369d82d30e8f8036663": "SELECT SUM(prescriptions.dose_val_rx) AS total_levetiracetam_prescribed\nFROM prescriptions\nWHERE prescriptions.subject_id = 10016742 \nAND prescriptions.drug = 'Levetiracetam'\nAND prescriptions.starttime >= '2001-01-01';",
    "91c672fcc248e33a4019dadc": "select the `drug` column for the same patient, but this time where the `starttime` is yesterday.\n3. **Compare the Prescriptions**: Finally, we need to compare today's prescriptions with yesterday's prescriptions to find out the new medications that were added today.",
    "cf5ba52470d99772c0cfb0ff": "",
    "5b8ffff4e21d176e195d9c35": "SELECT DISTINCT drug\nFROM prescriptions\nWHERE subject_id = 10004733 \n  AND starttime <= CURRENT_DATE\n  AND stoptime >= CURRENT_DATE;",
    "5dc8c9a7928cb067f4b75d12": "SELECT \n    p.subject_id,\n    COUNT(p.row_id) AS new_prescriptions\nFROM \n    prescriptions p\nWHERE \n    p.subject_id = 10039831 \n    AND p.starttime >= datetime('now', '-1 day')\n    AND p.starttime < datetime('now')\nGROUP BY \n    p.subject_id;",
    "6675b86607ae8420ab26bdba": "SELECT \n    (SELECT COUNT(*) \n     FROM prescriptions \n     WHERE subject_id = 10039831 \n       AND starttime >= DATE('now', 'start of day') \n       AND starttime < DATE('now', 'start of day', '+1 day')) - \n    (SELECT COUNT(*) \n     FROM prescriptions \n     WHERE subject_id = 10039831 \n       AND starttime >= DATE('now', 'start of day', '-1 day') \n       AND starttime < DATE('now', 'start of day')) AS new_prescriptions_today;",
    "50a2de2aeac213e640ee8dfc": "SELECT \n  today.drug AS today_drug,\n  yesterday.drug AS yesterday_drug\nFROM (\n  SELECT drug \n  FROM prescriptions \n  WHERE subject_id = 10018081 AND starttime >= DATE('now')\n) AS today\nFULL OUTER JOIN (\n  SELECT drug \n  FROM prescriptions \n  WHERE subject_id = 10018081 AND starttime >= DATE('now', '-1 day') AND starttime < DATE('now')\n) AS yesterday\nON today.drug = yesterday.drug;",
    "28d1d61838e9ab66ccc8ae3c": "WITH today_prescriptions AS (\n  SELECT drug\n  FROM prescriptions\n  WHERE subject_id = 10004733\n    AND DATE(starttime) = DATE('now')\n),\nyesterday_prescriptions AS (\n  SELECT drug\n  FROM prescriptions\n  WHERE subject_id = 10004733\n    AND DATE(starttime) = DATE('now', '-1 day')\n)\nSELECT DISTINCT tp.drug\nFROM today_prescriptions tp\nLEFT JOIN yesterday_prescriptions yp ON tp.drug = yp.drug\nWHERE yp.drug IS NULL;",
    "e5441310205bb859e8ca31ba": "WITH FirstHemoglobin AS (\n    SELECT \n        le.valuenum,\n        ROW_NUMBER() OVER (ORDER BY le.charttime) AS row_num\n    FROM \n        labevents le\n    WHERE \n        le.subject_id = 10023117\n        AND le.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Hemoglobin')\n)\nSELECT \n    valuenum\nFROM \n    FirstHemoglobin\nWHERE \n    row_num = 1;",
    "4710d3c9173e3759cd533b86": "SELECT e.valuenum \nFROM labevents e\nJOIN d_labitems l ON e.itemid = l.itemid\nWHERE e.subject_id = 10016742 \n  AND l.label = 'Platelet Count' \n  AND e.charttime BETWEEN '2000-08-01 00:00:00' AND '2000-08-31 23:59:59'\nORDER BY e.charttime\nLIMIT 1;",
    "32dc827809f2f3b381144bfc": "",
    "95de1cbfea9cbbf15a57c2e4": "SELECT \n    MIN(ce.charttime) AS first_charttime,\n    ce.valuenum AS first_value\nFROM \n    chartevents ce\nWHERE \n    ce.subject_id = 10008454\n    AND ce.charttime LIKE '2022-12-%' -- Assuming this year is 2022, adjust as necessary\n    AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'EAG')\nORDER BY \n    ce.charttime ASC\nLIMIT 1;",
    "bebec164cfe1ff0dced197be": "SELECT \n    l.valuenum, \n    l.valueuom\nFROM \n    labevents l\nWHERE \n    l.subject_id = 10018423 \n    AND l.itemid = 12345  -- Assuming this is the itemid for potassium, whole blood\nORDER BY \n    l.charttime ASC\nLIMIT 1;",
    "0eeb80895de2cb7f545f7953": "SELECT le.valuenum\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10019917\n  AND li.label = 'Hematocrit'\n  AND le.hadm_id = (\n    SELECT a.hadm_id\n    FROM admissions a\n    WHERE a.subject_id = 10019917\n    ORDER BY a.admittime DESC\n    LIMIT 1\n  )\nORDER BY le.charttime ASC\nLIMIT 1;",
    "0252bfa6857e8fa392627cbf": "SELECT \n  l.valuenum AS o2_flow_value\nFROM \n  labevents l\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10021487\n  AND l.hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10021487 \n    ORDER BY admittime DESC \n    LIMIT 1\n  )\n  AND d.label = 'O2 flow'\nORDER BY \n  l.charttime ASC\nLIMIT 1;",
    "4be18d3033fa1bac9d4c0223": "SELECT d.label AS test_name\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10026255 AND l.charttime >= '2000-04-01'\nORDER BY l.charttime ASC\nLIMIT 1;",
    "bda2d1d92535f2f380e83c31": "",
    "22e094ace74f0664f5a0629e": "SELECT \n    d_labitems.label AS \"Test Label\"\nFROM \n    labevents\nINNER JOIN \n    d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n    labevents.subject_id = 10023239\n    AND strftime('%m', labevents.charttime) = '06'\n    AND strftime('%Y', labevents.charttime) = '2000'\nORDER BY \n    labevents.charttime\nLIMIT 1;",
    "d8d340c85d29c3512cdffb03": "SELECT d_labitems.label\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10004235\nAND labevents.charttime >= '2020-03-21'\nORDER BY labevents.charttime ASC\nLIMIT 1;",
    "1f1e33683e0ff2f0510efc21": "SELECT l.label AS lab_test, le.charttime AS test_time\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nWHERE le.subject_id = 10002428 \n  AND le.charttime BETWEEN '2000-07-01 00:00:00' AND '2000-07-31 23:59:59'\nORDER BY le.charttime ASC\nLIMIT 1;",
    "1a72596befd361ee133771b0": "SELECT label\nFROM d_labitems\nWHERE row_id = (SELECT itemid \n                FROM labevents \n                WHERE subject_id = 10015931 \n                AND charttime >= '2000-05-01' \n                ORDER BY charttime \n                LIMIT 1);",
    "ecd65c3d262d3e34018c162c": "SELECT labevents.itemid, d_labitems.label AS test_name\nFROM labevents\nINNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 10001725\nAND labevents.charttime >= date('now', '-9 months')\nORDER BY labevents.charttime DESC\nLIMIT 1;",
    "bd3ba61db07a88f7a5920ac6": "SELECT \n  AVG(l.valuenum) AS average_potassium\nFROM \n  labevents l\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10037975\n  AND d.label = 'Potassium, whole blood in 02/2100';",
    "0c93a24758fe815a4f4bf747": "",
    "9f0ee496296456e6f48a49a6": "SELECT MIN(T1.valuenum) AS min_protein_value\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10002495\nAND T1.hadm_id = (\n  SELECT MAX(hadm_id)\n  FROM admissions\n  WHERE subject_id = 10002495\n)\nAND T2.label = 'Protein';",
    "89f4e7daebe9b4f5c0d96263": "SELECT MAX(T1.valuenum) AS max_mchc\nFROM labevents AS T1\nJOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10026354\n  AND T1.charttime >= '2023-11-01' \n  AND T1.charttime < '2023-12-01'\n  AND T2.label = 'mchc';",
    "a19666f04f957b696244b895": "SELECT AVG(T3.valuenum) AS average_magnesium_value\nFROM patients T1\nINNER JOIN admissions T2 ON T1.subject_id = T2.subject_id\nINNER JOIN labevents T3 ON T2.hadm_id = T3.hadm_id\nWHERE T1.subject_id = 10006580\n  AND T3.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Magnesium')\n  AND T2.hadm_id = (SELECT MIN(hadm_id) FROM admissions WHERE subject_id = 10006580);",
    "aba8c9a560d7ec87a020f638": "SELECT AVG(T1.valuenum) AS average_value\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10021487\nAND T2.label IN ('Bilirubin', 'Total', 'Ascites')\nAND T1.charttime >= '2000-08-01 00:00:00';",
    "9941ca19aa20b45f0d59bc93": "",
    "c3edbb8f5bd0cfd4858c41be": "SELECT \n    T1.org_name\nFROM \n    microbiologyevents AS T1\nWHERE \n    T1.subject_id = 10027602\n    AND T1.charttime = '2012-12-21 00:00:00'\n    AND T1.test_name = 'MINI BAL';",
    "f6c2ec0da1bf93fc0c8595c0": "SELECT \n    me.org_name\nFROM \n    microbiologyevents me\nINNER JOIN \n    admissions a ON me.hadm_id = a.hadm_id\nWHERE \n    me.subject_id = 10029291 \n    AND me.spec_type_desc = 'Sputum'\nORDER BY \n    me.charttime ASC\nLIMIT 1;",
    "f2be9084ce59ddbf5372d16a": "",
    "bbef3c6dded10fa7874540f2": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10016742\n  AND charttime >= '2000-08-01'\n  AND spec_type_desc LIKE '%Sputum%'\nORDER BY charttime DESC\nLIMIT 1;",
    "dd880129ab0eb4dc203813f8": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10007818\nAND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10007818\n    ORDER BY admittime\n    LIMIT 1\n)\nAND spec_type_desc = 'Blood Culture'\nAND charttime = (\n    SELECT MIN(charttime)\n    FROM microbiologyevents\n    WHERE subject_id = 10007818\n    AND hadm_id = (\n        SELECT hadm_id\n        FROM admissions\n        WHERE subject_id = 10007818\n        ORDER BY admittime\n        LIMIT 1\n    )\n    AND spec_type_desc = 'Blood Culture'\n);",
    "f5f185ff5f7901dc7c4dd711": "SELECT org_name\nFROM microbiologyevents\nWHERE subject_id = 10037861 AND charttime >= '2000-05-01' AND spec_type_desc = 'Urine'\nORDER BY charttime ASC\nLIMIT 1;",
    "ee3ef44107690c988c06c3e4": "SELECT org_name \nFROM microbiologyevents \nWHERE subject_id = 10007818 \n  AND charttime > '2000-07-01' \n  AND test_name = 'First Bronchoalveolar Lavage Test';",
    "441abc9cec7ed48c4b29a5c3": "",
    "c309a617ea1462d56fdac6d2": "SELECT MIN(charttime) AS first_charttime, test_name\nFROM microbiologyevents\nWHERE subject_id = 10018501 AND charttime >= '2020-04-01 00:00:00'\nGROUP BY test_name\nORDER BY first_charttime ASC\nLIMIT 1;",
    "7782eddef35c5010b9b90ac3": "SELECT \n  test_name\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10036156 AND charttime >= '2021-06-01 00:00:00'\nORDER BY \n  charttime ASC\nLIMIT 1;",
    "38447d52a601457cc529a5b1": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10005909\nAND charttime >= DATE('now', '-15 months')\nORDER BY charttime DESC\nLIMIT 1;",
    "2d7404fcfff0b855a4fb2fe9": "SELECT \n    test_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10011398 AND \n    hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = 10011398)\nORDER BY \n    charttime ASC\nLIMIT 1;",
    "2e8d527ae93a03ae76d66369": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10007795\nORDER BY charttime ASC\nLIMIT 1;",
    "9720cb4a260b30525538f8b2": "",
    "bd164a06951b24d9fbb32e90": "SELECT me.test_name\nFROM microbiologyevents me\nINNER JOIN admissions a ON me.hadm_id = a.hadm_id\nWHERE a.subject_id = 10008454\n  AND me.charttime >= DATE('now', 'start of month')\n  AND me.charttime < DATE('now', 'start of month', '+1 month')\nORDER BY me.charttime DESC\nLIMIT 1;",
    "c03994e0de214c507a8f8002": "SELECT \n    MIN(charttime) AS first_test_time, \n    test_name \nFROM \n    microbiologyevents \nWHERE \n    subject_id = 10018845 \nGROUP BY \n    test_name \nORDER BY \n    first_test_time \nLIMIT 1;",
    "a49efc1cdf3ebbe617aa7d26": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10008454\n  AND charttime >= DATE('now', 'start of year', '+11 months')\n  AND charttime < DATE('now', 'start of year', '+12 months');",
    "fd2461146ec138678719d7e3": "SELECT T2.test_name\nFROM admissions AS T1\nINNER JOIN microbiologyevents AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10002495\nORDER BY T2.charttime DESC\nLIMIT 1;",
    "c68bc6d51b04677c09432ee6": "",
    "d738acddca870a290c446af4": "SELECT test_name\nFROM microbiologyevents\nWHERE subject_id = 10004720\n  AND charttime >= '2100-01-01'\nORDER BY charttime DESC\nLIMIT 1;",
    "677aa66bc6c493237c9e78ee": "WITH LastAdmission AS (\n    SELECT \n        hadm_id\n    FROM \n        admissions\n    WHERE \n        subject_id = 10018845\n    ORDER BY \n        admittime DESC\n    LIMIT 1\n),\nFirstMicrobiologyTest AS (\n    SELECT \n        charttime,\n        test_name\n    FROM \n        microbiologyevents\n    WHERE \n        hadm_id = (SELECT hadm_id FROM LastAdmission)\n    ORDER BY \n        charttime ASC\n    LIMIT 1\n)\nSELECT \n    test_name\nFROM \n    FirstMicrobiologyTest;",
    "21f4165a3f8a7a30e0b78f54": "SELECT \n  d_items.label \nFROM \n  inputevents \nJOIN \n  d_items ON inputevents.itemid = d_items.itemid \nWHERE \n  inputevents.subject_id = 10009049 \n  AND DATE(inputevents.starttime) = '2023-06-13' \nORDER BY \n  inputevents.starttime DESC \nLIMIT 1;",
    "ac033d9ef9eacbfbf6ddce05": "",
    "0265a95e555d0c4a8c1f3d50": "SELECT di.label \nFROM inputevents ie \nINNER JOIN d_items di ON ie.itemid = di.itemid \nWHERE ie.subject_id = 10021487 \nAND strftime('%Y-%m', ie.starttime) = '2023-11' \nORDER BY ie.starttime ASC \nLIMIT 1;",
    "674bcd311bac8e9ec3bcdba0": "SELECT d_items.label\nFROM inputevents\nJOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 10020786\nAND inputevents.starttime = (SELECT MAX(starttime)\n                             FROM inputevents\n                             WHERE subject_id = 10020786)\nAND DATE(inputevents.starttime) = '07/02/2100';",
    "45ecebf7e481e6c14fdc01cd": "",
    "18bf32ca58ea6def07157a60": "WITH LastICUStay AS (\n    SELECT\n        i.stay_id\n    FROM\n        icustays i\n    WHERE\n        i.subject_id = 10029291\n    ORDER BY\n        i.intime DESC\n    LIMIT 1\n)\nSELECT\n    ie.totalamount,\n    ie.totalamountuom\nFROM\n    inputevents ie\nJOIN\n    LastICUStay lis ON ie.stay_id = lis.stay_id\nORDER BY\n    ie.starttime DESC\nLIMIT 1;",
    "6f1d4f9ac8b86db76c98d50f": "SELECT \n    di.label\nFROM \n    inputevents ie\nJOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    ie.subject_id = 10011398 AND ie.starttime >= '2021-07-20 00:00:00'\nORDER BY \n    ie.starttime ASC\nLIMIT 1;",
    "6b01b95b07df8e89058e4862": "SELECT SUM(T1.totalamount) AS total_amount\nFROM inputevents AS T1\nWHERE T1.subject_id = 10021312\n  AND T1.starttime LIKE '%2021-09-17%'\n  AND T1.itemid IN (\n    SELECT itemid FROM d_items WHERE label LIKE '%or%' OR label LIKE '%crystalloid%'\n  );",
    "61044fc8b56af395d27bc3ca": "SELECT SUM(T.totalamount) AS total_cryoprecipitate_amount\nFROM inputevents AS T\nJOIN d_items AS D ON T.itemid = D.itemid\nWHERE T.subject_id = 10006053\n  AND strftime('%Y-%m-%d', T.starttime) = strftime('%Y-%m-%d', '2023-11-16')\n  AND D.label = 'Cryoprecipitate';",
    "654af28177758d29e5368635": "SELECT SUM(T.totalamount) AS total_amount\nFROM inputevents AS T\nJOIN d_items AS D ON T.itemid = D.itemid\nWHERE T.subject_id = 10004235\n  AND T.starttime LIKE '%03/20/2100%'\n  AND D.label = 'lr';",
    "9e06157df2f8d7330094763f": "",
    "4bc83d6264e9674296907cec": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10027602\n  AND starttime BETWEEN '2021-11-29 00:00:00' AND '2021-11-29 23:59:59'\n  AND itemid IN (\n    SELECT itemid\n    FROM d_items\n    WHERE label LIKE '%Gastric Meds%'\n  );",
    "9b1a61e9a3cf7261a416c001": "SELECT \n  SUM(T1.totalamount) AS total_amount\nFROM \n  inputevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10022017\n  AND T1.itemid = (SELECT itemid FROM d_items WHERE label = 'KCL (BOLUS)')\n  AND T1.starttime LIKE '2023-10-03%';",
    "62b637c8df8e9435c243a84a": "SELECT SUM(totalamount) AS total_rbc_intake\nFROM inputevents\nWHERE subject_id = 10039831\nAND starttime >= '2021-10-06 00:00:00'\nAND totalamountuom = 'packed units'\nAND itemid IN (\n  SELECT itemid\n  FROM d_items\n  WHERE label LIKE '%rbc%'\n);",
    "6136c38332507c02dfcc394d": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10010471 AND starttime >= '2021-06-08 00:00:00';",
    "032b87119c5b76d8394a9373": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10021487 AND DATE(starttime) = '2021-12-20';",
    "7868c1035a69f54e888cb24c": "SELECT SUM(totalamount) AS total_volume\nFROM inputevents\nWHERE subject_id = 10020740 AND starttime >= '2021-04-11 00:00:00' AND starttime < '2021-04-12 00:00:00';",
    "5e583d5affb4e1b0f6e62364": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10011398 AND starttime >= '2021-10-15 00:00:00';",
    "1652f9d26e284f0b715c9070": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10018081 \nAND starttime >= '2021-12-01 00:00:00';",
    "852fe0f9eab141f83e933cfd": "SELECT SUM(totalamount) AS total_input_amount\nFROM inputevents\nWHERE subject_id = 10018501 AND starttime LIKE '2000-08-10%';",
    "8e819ca96ee526f42389d521": "SELECT SUM(totalamount) AS total_input_volume\nFROM inputevents\nWHERE subject_id = 10005817 AND starttime >= '2021-04-14 00:00:00';",
    "be9406622ce9314da8536fea": "SELECT value, valueuom\nFROM outputevents\nWHERE subject_id = 10039831 AND charttime >= '2021-10-23 00:00:00'\nORDER BY charttime\nLIMIT 1;",
    "f6e8b06dc6af06677ce3573e": "SELECT value, valueuom\nFROM outputevents\nWHERE subject_id = 10014354 AND charttime > '2021-04-12 00:00:00'\nORDER BY charttime DESC\nLIMIT 1;",
    "ae9a06614595aba70dc8365e": "SELECT \n  value, \n  valueuom\nFROM \n  outputevents\nWHERE \n  subject_id = 10010471\n  AND charttime >= '2100-04-01'\nORDER BY \n  charttime ASC\nLIMIT 1;",
    "59e0af10bd7f401a8e0193db": "SELECT \n  MIN(charttime) AS first_output_time,\n  value AS output_value,\n  valueuom AS output_unit\nFROM \n  outputevents\nWHERE \n  subject_id = 10019172\n  AND charttime >= '2001-03-12 00:00:00'\nGROUP BY \n  value, valueuom\nHAVING \n  MIN(charttime) = (SELECT MIN(charttime) FROM outputevents WHERE subject_id = 10019172 AND charttime >= '2001-03-12 00:00:00');",
    "9381ef3a83219886a02144fc": "SELECT valueuom\nFROM outputevents\nWHERE subject_id = 10027602\n  AND charttime LIKE '2022-11-26%'\nORDER BY charttime ASC\nLIMIT 1;",
    "193315d3d4b5326e56e84b77": "SELECT \n  value, \n  valueuom \nFROM \n  outputevents \nWHERE \n  subject_id = 10035185 \n  AND DATE(charttime) = '2023-05-18';",
    "2766c75e65819b7cf9c0fba2": "SELECT o.valueuom \nFROM outputevents o \nWHERE o.subject_id = 10020944 AND o.charttime >= '2000-04-03'\nORDER BY o.charttime DESC \nLIMIT 1;",
    "1dd5f6600a1779d3902b0c74": "SELECT SUM(dose_val_rx) AS total_dose\nFROM prescriptions\nWHERE subject_id = 10006053\nAND drug = 'Blakemore'\nAND starttime >= '2021-01-17';",
    "e4f78cd53a4a70e9d10c4eea": "SELECT SUM(value) AS total_urine_output\nFROM outputevents\nWHERE subject_id = 10015931 AND charttime >= '2100-12-06 00:00:00' AND valueuom = 'urine';",
    "c99300a7ea88ef7b82951b42": "",
    "2821799cf4699b6d8e3e4c43": "SELECT SUM(totalamount) AS total_output\nFROM outputevents\nWHERE subject_id = 10020740\nAND charttime LIKE '2100-04-13%';",
    "e0ef594aee8d798aff512963": "SELECT SUM(totalamount) AS total_tf_residual_output_amount\nFROM outputevents o\nJOIN d_items d ON o.itemid = d.itemid\nWHERE o.subject_id = 10021487\n  AND o.charttime LIKE '%12/16/2100%'\n  AND d.label LIKE '%tf residual output%';",
    "7594a1fd06d38d2b7a869964": "SELECT \n    SUM(totalamount) AS total_volume\nFROM \n    inputevents\nWHERE \n    subject_id = 10004733 \n    AND starttime >= '2021-12-07 00:00:00';",
    "98a679829a4f28ba76a5e3dc": "SELECT SUM(totalamount) AS total_tf_residual\nFROM inputevents\nWHERE subject_id = 10007818\nAND starttime >= '2021-01-23'\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'tf residual');",
    "184fc5e11e0bfc9be1a0263c": "SELECT \n  value,\n  valueuom\nFROM \n  outputevents\nWHERE \n  subject_id = 10020944 AND \n  charttime >= DATE('now', 'start of year', '+3 months', '-1 day') AND \n  charttime < DATE('now', 'start of year', '+3 months');",
    "9f044b75ba284f6e96d21088": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10010471\nAND charttime >= '2021-04-11';",
    "06d531ccb4fb7b80b892121f": "SELECT SUM(value) AS total_output_volume\nFROM outputevents\nWHERE subject_id = 10023239 AND DATE(charttime) = '2023-06-29';",
    "67c2dbeaea4791e0feb0a69b": "SELECT SUM(value) AS total_output\nFROM outputevents\nWHERE subject_id = 10007058\nAND charttime >= '2021-10-05 00:00:00';",
    "b71409d570252fbb7bc7ecd0": "SELECT SUM(value) AS total_output_amount\nFROM outputevents\nWHERE subject_id = 10007058 AND charttime >= '2021-03-20';",
    "9cb9aa60b28077c70929769c": "SELECT \n    SUM(value) AS total_output\nFROM \n    outputevents\nWHERE \n    subject_id = 10018501 \n    AND charttime = (SELECT MAX(charttime) FROM outputevents WHERE subject_id = 10018501);",
    "8cf47ff1a1ec5cf642c7ff41": "SELECT \n  SUM(value) AS total_output\nFROM \n  outputevents\nWHERE \n  subject_id = 10020740\n  AND DATE(charttime) = '2100-04-06';",
    "8223111c9b4bc944555d36a9": "SELECT \n    SUM(inputevents.totalamount) - SUM(outputevents.value) AS volume_difference\nFROM \n    inputevents\nINNER JOIN \n    outputevents ON inputevents.subject_id = outputevents.subject_id\nWHERE \n    inputevents.subject_id = 10020944\n    AND inputevents.starttime >= '2021-03-07 00:00:00'\n    AND outputevents.charttime >= '2021-03-07 00:00:00';",
    "cfc51c8ede5f274642cc55f4": "SELECT \n    SUM(ie.totalamount) - SUM(oe.value) AS difference\nFROM \n    inputevents ie\nINNER JOIN \n    outputevents oe ON ie.subject_id = oe.subject_id AND ie.hadm_id = oe.hadm_id AND ie.stay_id = oe.stay_id\nWHERE \n    ie.subject_id = 10031404 AND ie.starttime >= '2021-05-06';",
    "1f2e5b03343f0c4f90575af1": "SELECT \n  SUM(CASE WHEN i.itemid IS NOT NULL THEN i.totalamount ELSE 0 END) - \n  SUM(CASE WHEN o.itemid IS NOT NULL THEN o.value ELSE 0 END) AS difference\nFROM \n  patients p\nJOIN \n  admissions a ON p.subject_id = a.subject_id\nJOIN \n  inputevents i ON a.hadm_id = i.hadm_id\nJOIN \n  outputevents o ON a.hadm_id = o.hadm_id\nWHERE \n  p.subject_id = 10038999 AND\n  i.starttime LIKE '2023-05-31%' AND\n  o.charttime LIKE '2023-05-31%'",
    "714cfbc303feb382801e761a": "SELECT \n  (SUM(T1.totalamount) - SUM(T2.value)) AS difference\nFROM \n  inputevents AS T1\n  INNER JOIN outputevents AS T2 \n  ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nWHERE \n  T1.subject_id = 10021487\n  AND T1.starttime >= '2021-07-21'\n  AND T2.charttime >= '2021-07-21';",
    "9e01feccdfca373aaed464f2": "SELECT \n  (SUM(ie.totalamount) - SUM(oe.value)) AS input_output_difference\nFROM \n  inputevents ie\n  INNER JOIN outputevents oe ON ie.subject_id = oe.subject_id\nWHERE \n  ie.subject_id = 10021666\n  AND ie.starttime >= '2021-03-27'\n  AND oe.charttime >= '2021-03-27';",
    "1f2b5a242cc55bb7ebee0365": "SELECT \n    SUM(inputevents.totalamount) - SUM(outputevents.value) AS volume_difference\nFROM \n    inputevents\nJOIN \n    outputevents ON inputevents.subject_id = outputevents.subject_id\nWHERE \n    inputevents.subject_id = 10015272 \n    AND inputevents.starttime >= '02/08/2100' \n    AND outputevents.charttime >= '02/08/2100';",
    "e64af8ed53f80505d1cf19e3": "SELECT \n  SUM(T.totalamount) - SUM(O.value) AS net_difference\nFROM \n  inputevents T\nJOIN \n  outputevents O\n  ON T.subject_id = O.subject_id AND T.hadm_id = O.hadm_id AND T.stay_id = O.stay_id\nWHERE \n  T.subject_id = 10021312 AND T.starttime >= datetime('now', '-155 days');",
    "34c6a8eeee0902700d4a2885": "SELECT \n    c.valuenum AS last_value\nFROM \n    chartevents c\nJOIN \n    d_items d ON c.itemid = d.itemid\nWHERE \n    c.subject_id = 10004422 \n    AND d.label = 'Respiratory Rate'\n    AND c.charttime LIKE '2022-01-22%'\nORDER BY \n    c.charttime DESC \nLIMIT 1;",
    "ea6a1b775d7a1387dac35ee2": "SELECT T1.valuenum\nFROM chartevents AS T1\nJOIN icustays AS T2 ON T1.stay_id = T2.stay_id\nWHERE T1.subject_id = 10003046\nAND T2.stay_id = (\n  SELECT stay_id\n  FROM icustays\n  WHERE subject_id = 10003046\n  ORDER BY intime ASC\n  LIMIT 1\n)\nAND T1.itemid = (\n  SELECT itemid\n  FROM d_items\n  WHERE label = 'Arterial Blood Pressure Systolic'\n)\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "3e69a6b789c8a2c74de0771d": "SELECT c.valuenum\nFROM chartevents c\nINNER JOIN d_items d ON c.itemid = d.itemid\nWHERE c.subject_id = 10009035\n  AND c.charttime LIKE '2100-05-12%'\n  AND d.label = 'Temperature Celsius'\nORDER BY c.charttime\nLIMIT 1;",
    "550a6a2fb0ecbf40e74fdb86": "SELECT ce.valuenum \nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE di.label = 'O2 saturation pulseoxymetry'\nAND ce.subject_id = 10010471\nORDER BY ce.charttime DESC\nLIMIT 1;",
    "34320356e0e8b8b03cfb94be": "SELECT \n  ce.valuenum \nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  di.label = 'Temperature Celsius'\n  AND ce.subject_id = 10009035\nORDER BY \n  ce.charttime DESC\nLIMIT 1;",
    "880392e9b0ba16e0c00356d2": "SELECT \n  T1.value \nFROM \n  outputevents AS T1 \n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid \nWHERE \n  T1.subject_id = 10021487 AND \n  T2.label = 'Respiratory Rate' AND \n  T1.charttime = (SELECT MAX(charttime) FROM outputevents WHERE subject_id = 10021487 AND itemid = T1.itemid)",
    "0e13e0edf9b3f935d475fa33": "",
    "068a6fbca2eb611746f77955": "SELECT MIN(c.valuenum) AS minimum_respiratory_rate\nFROM chartevents c\nJOIN d_items i ON c.itemid = i.itemid\nWHERE c.subject_id = 10021487\nAND c.charttime LIKE '2021-10-%'\nAND i.label = 'Respiratory Rate';",
    "8f13d57ff126b0360f9b38a9": "SELECT MIN( valuenum ) AS min_spo2\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE subject_id = 10037975\n  AND d_labitems.label = 'SpO2'\n  AND charttime BETWEEN '2023-02-10 00:00:00' AND '2023-02-10 23:59:59';",
    "7b7e0d370650fe79de5ab188": "SELECT MIN(c.valuenum) AS min_heart_rate\nFROM chartevents c\nINNER JOIN d_items d ON c.itemid = d.itemid\nWHERE d.label = 'Heart Rate'\n  AND c.charttime >= DATE('now', '-206 days')\n  AND c.subject_id = 10016810;",
    "fdc3e0fe626d90707f9b9320": "SELECT MAX(T1.valuenum) AS max_heart_rate\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10029291 AND T2.label = 'Heart Rate';",
    "ec946af2d91d7d53d35312e6": "SELECT MAX(ce.valuenum) AS max_spo2\nFROM chartevents ce\nINNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 10019568 AND di.label = 'SpO2';",
    "c002c7dd1abbdad1014192e2": "SELECT AVG(ce.valuenum) AS avg_diastolic_bp\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN icustays icu ON a.hadm_id = icu.hadm_id\nJOIN chartevents ce ON icu.stay_id = ce.stay_id\nWHERE p.subject_id = 10013049\nAND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Blood Pressure (Diastolic)')\nAND ce.charttime = (SELECT MAX(charttime) FROM chartevents WHERE stay_id = icu.stay_id);",
    "c4e3a7be2d01b9b7351a661d": "",
    "a5253b5b458dbf9c057541b0": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10011398 \nORDER BY admittime DESC \nLIMIT 1;",
    "f03270451ac730c92efdd5b1": "SELECT MAX(admittime) AS last_visit_time\nFROM admissions\nWHERE subject_id = 10039997;",
    "609e844629d62f94381a53ef": "select the maximum `admittime` from the filtered results.",
    "82fed921fe732e9851109fa0": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10016150\nORDER BY admittime DESC\nLIMIT 1;",
    "c9887571dd618b516d5a3741": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10003046\nORDER BY admittime ASC\nLIMIT 1;",
    "b357f1cf8213ef5655a20b3b": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10014729 \nORDER BY admittime \nLIMIT 1;",
    "6a0f9787ca51fccbc44a087c": "SELECT MAX(admittime) AS last_visit_time\nFROM admissions\nWHERE subject_id = 10021938;",
    "44e4b4d97cbe90cf626c4424": "SELECT MAX(admittime) AS last_admission_time\nFROM admissions\nWHERE subject_id = 10014729 AND admission_type = 'physician referral';",
    "138fe3a23beda4b897c27c94": "SELECT \n  admittime \nFROM \n  admissions \nWHERE \n  subject_id = 10004457 \nORDER BY \n  admittime ASC \nLIMIT 1;",
    "a3b2c1bfc83f38e441791752": "",
    "145d13b35f2fd6558b0a9b99": "SELECT \n  T2.admittime \nFROM \n  patients AS T1 \n  INNER JOIN admissions AS T2 ON T1.subject_id = T2.subject_id \nWHERE \n  T1.subject_id = 10007795 \n  AND T2.admission_type = 'transfer' \n  AND T2.admission_location = 'hospital' \nORDER BY \n  T2.admittime ASC \nLIMIT 1;",
    "d21ad3ab275f6cb81643201e": "SELECT admittime \nFROM admissions \nWHERE admission_type = 'physician referral' AND subject_id = 10002930 \nORDER BY admittime \nLIMIT 1;",
    "be0c83bb4816c62c521f4f19": "SELECT MIN(admittime) AS first_admission_time\nFROM admissions\nWHERE subject_id = 10025612 AND admission_type = 'Physician Referral';",
    "b20d40188481222bfbb9b02f": "SELECT MIN(admittime) AS first_admission_time\nFROM admissions\nWHERE subject_id = 10014078\n  AND admission_type = 'EMERGENCY';",
    "eaf50bee63448bac98063353": "SELECT dischtime \nFROM admissions \nWHERE subject_id = 10029484 \nORDER BY dischtime DESC \nLIMIT 1;",
    "8264ca08e450da03c5c58c2a": "SELECT dischtime \nFROM admissions \nWHERE subject_id = 10012552;",
    "2cdba5b8a95c49f552fbdf57": "SELECT dischtime \nFROM admissions \nWHERE subject_id = 10004235 \nORDER BY dischtime DESC \nLIMIT 1;",
    "7e8d5196747ac83500ed63a2": "SELECT dischtime \nFROM admissions \nWHERE subject_id = 10036156;",
    "4d5c298e863a86919a4a499a": "SELECT dischtime \nFROM admissions \nWHERE subject_id = 10015860 \nORDER BY dischtime ASC \nLIMIT 1;",
    "be1e758721f63febd66af577": "SELECT MIN(dischtime) AS first_leave_hospital\nFROM admissions\nWHERE subject_id = 10023239;",
    "d6ea3d8ed946d219e8c6b546": "SELECT dischtime AS last_discharge_time\nFROM admissions\nWHERE subject_id = 10029291;",
    "1300c7d483802a1d509ca6f4": "SELECT \n  (julianday(icu.outtime) - julianday(icu.intime)) AS days_in_icu\nFROM \n  icustays icu\nJOIN \n  admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE \n  adm.subject_id = 10019777\nLIMIT 1;",
    "01c32ce2101e22b2dfea210b": "SELECT \n  (strftime('%J', outtime) - strftime('%J', intime)) AS duration_in_days\nFROM \n  icustays\nWHERE \n  subject_id = 10016810\nORDER BY \n  intime DESC\nLIMIT 1;",
    "f632d74fbbe2ef65a5547997": "SELECT (julianday(T1.outtime) - julianday(T1.intime)) AS days_in_icu\nFROM icustays T1\nWHERE T1.subject_id = 10006580\nORDER BY T1.intime DESC\nLIMIT 1;",
    "e366e701723a7868b82006d6": "SELECT \n    julianday(icustays.outtime) - julianday(icustays.intime) AS length_of_stay\nFROM \n    icustays\nWHERE \n    icustays.subject_id = 10025612\nORDER BY \n    icustays.intime DESC\nLIMIT 1;",
    "07e1885e41d9b6a449fd69a5": "SELECT \n    julianday(i.outtime) - julianday(i.intime) AS last_stay_in_icu_days\nFROM \n    icustays i\nWHERE \n    i.subject_id = 10023239\nORDER BY \n    i.intime DESC\nLIMIT 1;",
    "461b2614afff7dfabc033d6e": "SELECT \n    JULIANDAY(i.outtime) - JULIANDAY(i.intime) AS length_of_stay_in_days\nFROM \n    icustays i\nJOIN \n    admissions a ON i.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10022041\nORDER BY \n    i.intime DESC\nLIMIT 1;",
    "4c25e26fad35ddcb5d7e1eb0": "",
    "c06d5f1b8c8e4396f73f77c8": "SELECT \n    MIN(starttime) AS first_prescription_time\nFROM \n    prescriptions\nWHERE \n    subject_id = 10014729;",
    "953fa6166e8ed2ab67753af8": "SELECT starttime\nFROM prescriptions\nWHERE subject_id = 10008287\n  AND starttime >= '01/2100'\nORDER BY starttime DESC\nLIMIT 1;",
    "73924b9389e02ce45d9e3c48": "SELECT MAX(starttime) AS LastPrescriptionTime\nFROM prescriptions\nWHERE subject_id = 10022017 AND starttime >= '04/21/2000';",
    "994ebca608bc1b2f8b1bb1c7": "",
    "0f107c9e56d31b410f4f045c": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10020740\nAND hadm_id IN (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10020740\n    ORDER BY admittime ASC\n    LIMIT 1\n);",
    "199101dc32631127e35693a6": "",
    "f5baeb5fd7062bd570005226": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10027602\n  AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10027602\n    ORDER BY admittime ASC\n    LIMIT 1\n  );",
    "d4f2dc48d747e43282e99fc7": "",
    "9ff61e95883c730111d063bb": "SELECT \n  MIN(starttime) AS first_prescription_time\nFROM \n  prescriptions\nWHERE \n  subject_id = 10010471 AND drug = 'Dextrose 5%' AND starttime > '2010-10-01';",
    "448d117f9de70ed2d4dc414e": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10019172\nAND drug LIKE '%metoprolol tartrate%'\nAND starttime BETWEEN '2020-10-01' AND '2020-10-31';",
    "42a6e5d9d3862cee91a004d2": "SELECT MAX(starttime) AS last_prescribed_time\nFROM prescriptions\nWHERE subject_id = 10027602\nAND drug = 'BISACODYL'\nAND starttime >= DATE('now', 'start of month')\nAND starttime < DATE('now', 'start of month', '+1 month');",
    "1763cfe655f1ba381ad8e71e": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10008454\nAND drug = 'CIPROFLOXACIN HCL';",
    "28cf75715d1cf3411a84ca65": "",
    "92d6c5d899dfa362deb44658": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10021487\nAND drug = 'heparin'\nAND starttime >= DATE('now', 'start of year', '+11 months')\nAND starttime < DATE('now', 'start of year', '+12 months');",
    "2a8fea2a00fcd986cf1b8067": "SELECT MIN(p1.starttime) AS first_prescription_time\nFROM prescriptions p1\nJOIN prescriptions p2 ON p1.subject_id = p2.subject_id AND p1.hadm_id = p2.hadm_id\nWHERE p1.subject_id = 10018423\n  AND p1.drug = 'VANCOMYCIN'\n  AND p2.drug = 'ONDANSETRON';",
    "df18089e3b87a2aa47f39d54": "",
    "d570690bd00855db57f1e385": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions p\nWHERE p.subject_id = 10007058\n  AND p.starttime >= DATE('now', '-1 month')\n  AND p.drug IN ('heparin', '5% dextrose');",
    "21a6fcf7e340c9ff6f9e4eda": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10019172\nAND drug IN ('0.9% sodium chloride', 'docusate sodium (liquid)')\nAND starttime >= DATE('now', '-1 month')",
    "380a7bc3779d96acb5543281": "SELECT T1.starttime\nFROM prescriptions AS T1\nWHERE T1.subject_id = 10020306\nAND T1.hadm_id IN (\n  SELECT T2.hadm_id\n  FROM prescriptions AS T2\n  WHERE T2.subject_id = 10020306\n  AND T2.drug IN ('glucose gel', 'hydrocodone-acetaminophen (5mg-500mg)')\n  GROUP BY T2.hadm_id\n  HAVING COUNT(DISTINCT T2.drug) = 2\n)\nORDER BY T1.starttime DESC\nLIMIT 1;",
    "50ba43b1b326c73868a72835": "WITH PrescribedDrugs AS (\n    SELECT\n        subject_id,\n        drug,\n        starttime,\n        stoptime,\n        ROW_NUMBER() OVER (PARTITION BY subject_id, drug ORDER BY starttime) AS drug_rank\n    FROM\n        prescriptions\n    WHERE\n        starttime >= '2012-12-01' AND starttime <= '2012-12-31'\n)\nSELECT\n    p.subject_id,\n    p.drug,\n    p.starttime,\n    p.stoptime\nFROM\n    PrescribedDrugs p\nWHERE\n    p.subject_id = 10021118\n    AND p.drug IN ('ketorolac', 'acetaminophen')\n    AND p.drug_rank = 1\nORDER BY\n    p.starttime\nLIMIT 1;",
    "9333b4860f452a4674c02cbc": "",
    "f75de59a1a66905c8e18c843": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10006580\nAND starttime >= DATE('now', '-26 months')\nAND route = 'im';",
    "bf8aee434927ad78efbb9c37": "SELECT starttime\nFROM prescriptions\nWHERE subject_id = 10026255\n  AND route = 'iv'\n  AND starttime > '2020-06-01'\nORDER BY starttime DESC\nLIMIT 1;",
    "ba85b4185b40acf102f505e5": "SELECT \n    MAX(starttime) AS last_prescription_time\nFROM \n    prescriptions\nWHERE \n    subject_id = 10022880 AND\n    starttime LIKE '%03/2100%' AND\n    route = 'IV';",
    "9c36c694493cc1a4533c0e35": "SELECT MAX(starttime) AS last_prescription_time\nFROM prescriptions\nWHERE subject_id = 10010471 AND starttime >= '2008-08-01 00:00:00' AND route = 'IV';",
    "9db8bd8eeca37c40ce0282d9": "SELECT MIN(p.starttime) AS first_prescription_time\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10038081 AND p.route = 'neb';",
    "0184b4b16596dc35beb98cfd": "SELECT \n    MIN(starttime) AS first_prescription_time\nFROM \n    prescriptions\nWHERE \n    subject_id = 10001217 \n    AND route IN ('po', 'ng')\n    AND starttime LIKE '%/%/2023%';",
    "4ec0747fdc64218ae8ffc26d": "SELECT MIN(starttime) AS first_prescription_time\nFROM prescriptions\nWHERE subject_id = 10019172\n  AND route = 'pr'\n  AND starttime >= DATE('now', '-1 month');",
    "314c43e484535c98944bc116": "SELECT MIN(labevents.charttime) AS first_lab_test_time\nFROM labevents\nWHERE labevents.subject_id = 10005817 AND labevents.charttime >= '2008-08-21 00:00:00';",
    "649fd348e56a70012edf8781": "SELECT \n    MAX(lab.charttime) AS last_test_time\nFROM \n    labevents lab\nJOIN \n    patients pat ON lab.subject_id = pat.subject_id\nWHERE \n    pat.subject_id = 10009628 \n    AND lab.charttime LIKE '2010-10-21%';",
    "a991a62ce361a4375831ca50": "SELECT MAX(charttime) AS last_lab_test_time\nFROM labevents\nWHERE subject_id = 10031404\nAND hadm_id = (\n  SELECT hadm_id\n  FROM admissions\n  WHERE subject_id = 10031404\n  ORDER BY admittime DESC\n  LIMIT 1\n);",
    "a79380b2785aa5ce66c4b881": "SELECT MAX(charttime) AS last_lab_test_time\nFROM labevents\nWHERE subject_id = 10036156 AND charttime >= '2000-07-01';",
    "f7e273153edfeb72b98bd9c7": "SELECT MAX(charttime) AS last_lab_test_time\nFROM labevents\nWHERE subject_id = 10009628\n  AND charttime BETWEEN '2023-10-01' AND '2023-10-31';",
    "5a5fd081d30e9927c3c6dad4": "SELECT charttime AS LastLabTestTime \nFROM labevents \nWHERE subject_id = 10015931 \n  AND charttime >= '2010-10-21' \nORDER BY charttime DESC \nLIMIT 1;",
    "8e40479dcfc63f5443fa3003": "SELECT MAX(charttime) AS last_charttime\nFROM labevents\nWHERE subject_id = 10006053 AND charttime >= '01/2100';",
    "9ae67f8f87f7be444b601b61": "SELECT MIN(l.charttime) AS first_charttime\nFROM labevents l\nINNER JOIN d_labitems dl ON l.itemid = dl.itemid\nWHERE l.subject_id = 10021118\n  AND dl.label LIKE '%Bilirubin, Total%'\n  AND l.charttime >= '2021-10-2100';",
    "c03885ae374eb4c770e9069a": "SELECT MAX(T2.charttime) AS last_charttime\nFROM admissions AS T1\nINNER JOIN labevents AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_labitems AS T3 ON T2.itemid = T3.itemid\nWHERE T1.subject_id = 10031757 AND T3.label = 'Alkaline Phosphatase';",
    "d495fd8395126c8eb2bfc70f": "SELECT MIN(T1.charttime) AS first_charttime\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10022880\nAND T2.label = 'Chloride'\nAND strftime('%m', T1.charttime) = '04'\nAND strftime('%Y', T1.charttime) = strftime('%Y', 'now');",
    "576e916cf4beca47606878ba": "SELECT MAX(charttime) AS last_test_time\nFROM labevents\nWHERE subject_id = 10016742\n  AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10016742\n    ORDER BY admittime DESC\n    LIMIT 1\n  );",
    "7dc3347edeff0be3bfeb2b14": "SELECT MIN(l.charttime) AS first_chart_time\nFROM labevents l\nINNER JOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE l.subject_id = 10022880\n  AND l.itemid = (\n    SELECT d.itemid\n    FROM d_labitems d\n    WHERE d.label = 'ntprobnp'\n  )\n  AND a.subject_id = 10022880\n  AND a.dischtime IS NOT NULL\n  AND l.charttime BETWEEN a.admittime AND a.dischtime;",
    "fd8916330e9d2c2e5b150852": "SELECT MAX(charttime) AS last_charttime\nFROM microbiologyevents\nWHERE subject_id = 10027445;",
    "528d495934e0aadbd47ad1b6": "SELECT MIN(charttime) AS first_test_time\nFROM labevents\nWHERE subject_id = 10021312 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'RDW');",
    "c80160c40fe40760c9ce27b2": "SELECT \n  MIN(T1.charttime) AS first_max_charttime \nFROM \n  labevents AS T1 \n  INNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid \nWHERE \n  T1.subject_id = 10016150 \n  AND T2.label = 'Lymphocytes' \n  AND T1.valuenum = (\n    SELECT MAX(valuenum) \n    FROM labevents \n    WHERE subject_id = 10016150 \n    AND itemid = T1.itemid\n  );",
    "d2063048958d7402567becbf": "SELECT \n  MIN(T1.charttime) AS first_charttime\nFROM \n  labevents AS T1\n  INNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10037928\n  AND T1.charttime >= '2000-04-01 00:00:00'\n  AND T2.label = 'Chloride'\n  AND T1.valuenum = (\n    SELECT MAX(T3.valuenum)\n    FROM labevents AS T3\n    INNER JOIN d_labitems AS T4 ON T3.itemid = T4.itemid\n    WHERE T3.subject_id = 10037928\n      AND T3.charttime >= '2000-04-01 00:00:00'\n      AND T4.label = 'Chloride'\n  );",
    "3701159d655f47f5724c7180": "SELECT MIN(charttime) AS min_charttime\nFROM chartevents\nWHERE subject_id = 10004720\nAND itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'Monocytes'\n)\nAND charttime >= '2012-12-21';",
    "0bf8b08208180cf560844cba": "SELECT MAX(charttime) AS last_charttime\nFROM labevents\nWHERE subject_id = 10016810\nAND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Minimum Phosphate')\nAND strftime('%m', charttime) = '07'\nAND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "f49e8d99f34677375d3e576d": "SELECT T1.charttime\nFROM labevents AS T1\nWHERE T1.subject_id = 10029484\n  AND T1.itemid = 257\n  AND T1.charttime = (\n    SELECT MAX(charttime)\n    FROM labevents\n    WHERE subject_id = 10029484\n      AND itemid = 257\n  )\nORDER BY T1.charttime DESC\nLIMIT 1;",
    "327eb60e80b925374560c88e": "SELECT MAX(labevents.charttime) AS last_time\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE d_labitems.label = 'Ferritin'\n  AND labevents.subject_id = 10039708\n  AND labevents.itemid = 11/2100;",
    "9078d39386848fe27cef5f31": "SELECT T1.charttime\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10004720\n  AND T2.label = 'Neutrophils'\n  AND T1.hadm_id = (\n    SELECT T3.hadm_id\n    FROM admissions AS T3\n    WHERE T3.subject_id = 10004720\n    ORDER BY T3.admittime ASC\n    LIMIT 1\n  )\n  AND T1.valuenum = (\n    SELECT MAX(T4.valuenum)\n    FROM labevents AS T4\n    WHERE T4.subject_id = 10004720\n      AND T4.hadm_id = (\n        SELECT T5.hadm_id\n        FROM admissions AS T5\n        WHERE T5.subject_id = 10004720\n        ORDER BY T5.admittime ASC\n        LIMIT 1\n      )\n  )\nORDER BY T1.charttime ASC\nLIMIT 1;",
    "494282796f9c3fdde2f7b727": "SELECT charttime\nFROM microbiologyevents\nWHERE subject_id = 10013049 AND charttime >= '2000-05-21 00:00:00'\nORDER BY charttime ASC\nLIMIT 1;",
    "56ca21bbb266b349bca3f6e5": "SELECT MIN(charttime) AS first_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10000032\nAND charttime >= '2021-05-01';",
    "073f2bf50f7338fb5c3bb42b": "SELECT MAX(charttime) AS last_microbiology_test_time\nFROM microbiologyevents\nWHERE subject_id = 10039997\n  AND STRFTIME('%Y-%m', charttime) = STRFTIME('%Y-%m', 'now', 'start of month', '+9 months');",
    "eeeb5ecc1778f72724d0534d": "SELECT MIN(charttime) AS first_microbiology_test\nFROM microbiologyevents\nWHERE subject_id = 10010471 AND charttime >= '2000-06-21';",
    "885642fd5ea14ba51403e397": "SELECT MAX(charttime) AS last_test_conducted\nFROM microbiologyevents\nWHERE subject_id = 10001725 AND charttime >= '2001-04-01';",
    "499518ffdd4562209632b0e7": "SELECT \n    charttime\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10002495\nORDER BY \n    charttime DESC\nLIMIT 1;",
    "f99580261637ffba691a9a72": "SELECT \n  charttime AS first_microbiology_test\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10010471\n  AND charttime >= DATE('now', '-1 month')\nORDER BY \n  charttime ASC\nLIMIT 1;",
    "21765b418ac742a54e95ff43": "SELECT MIN(charttime) AS first_test_date\nFROM microbiologyevents\nWHERE subject_id = 10021487\n  AND charttime >= '2000-07-21 00:00:00'\n  AND test_name = 'pleural fluid';",
    "031ff26b606f0d58d734256c": "SELECT MAX(charttime) AS last_swab_time\nFROM microbiologyevents\nWHERE subject_id = 10031757 \n  AND charttime >= DATE('2000-02-21') \n  AND spec_type_desc LIKE '%Swab%';",
    "8fc30d6e91b22c5fbe1a138b": "SELECT \n  MIN(charttime) AS first_charttime\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10016150 \n  AND charttime >= '05/2100' \n  AND spec_type_desc LIKE '%Urine%' \n  AND test_name LIKE '%Microbiology%';",
    "76a9a991435e9dfbb0590490": "SELECT MAX(charttime) AS last_mrsa_screen\nFROM microbiologyevents\nWHERE subject_id = 10019777\nAND charttime BETWEEN '2003-01-01' AND '2003-12-31';",
    "58f0822239c07b746c5df6fc": "SELECT MIN(T3.charttime) AS first_mrsa_screen_date\nFROM patients AS T1\nINNER JOIN microbiologyevents AS T3 ON T1.subject_id = T3.subject_id\nWHERE T1.subject_id = 10022041\n  AND strftime('%Y-%m', T3.charttime) = strftime('%Y-06', 'now')\n  AND T3.test_name = 'MRS SCREEN';",
    "689c016c32621989ea39ef0c": "SELECT MIN(charttime) AS first_mrsa_screen\nFROM microbiologyevents\nWHERE subject_id = 10008454\nAND test_name = 'MRSA SCREEN';",
    "a88028190c05dd2074203820": "SELECT \n    MAX(m.charttime) AS last_mic_test_time\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n    microbiologyevents m ON a.hadm_id = m.hadm_id\nWHERE \n    p.subject_id = 10005817 AND \n    m.spec_type_desc LIKE '%Staph Aureus%' AND \n    m.test_name LIKE '%Swab%';",
    "c503cb58dc8455398570f4a4": "SELECT \n  T1.starttime \nFROM \n  inputevents AS T1 \n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid \nWHERE \n  T1.subject_id = 10022880 \n  AND T2.label = 'NaCl 0.9%' \n  AND T1.starttime LIKE '2023-04-03%' \nORDER BY \n  T1.starttime DESC \nLIMIT 1;",
    "8ef3a4c7569d9db7872c7fde": "SELECT T1.starttime\nFROM inputevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 10010471\nAND T2.label = 'nacl 0.9%'\nAND DATE(T1.starttime) = '2021-12-20'\nORDER BY T1.starttime ASC\nLIMIT 1;",
    "5b97eeb5e63797ee9185b85c": "SELECT \n  MIN(starttime) AS first_dextrose_time\nFROM \n  inputevents\nWHERE \n  subject_id = 10022017 AND \n  itemid = (SELECT itemid FROM d_items WHERE label = 'Dextrose 5%') AND \n  starttime LIKE '%10/03/2100%'",
    "bf8bff577fb09a8df5d3e544": "SELECT MIN(starttime) AS first_intake_time\nFROM inputevents\nWHERE subject_id = 10027445\nAND starttime LIKE '2022-09-09%'\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'PO Intake');",
    "7b8dd010ac6d51609aa93314": "SELECT MAX(T1.starttime) AS last_administration_time\nFROM inputevents AS T1\nJOIN icustays AS T2 ON T1.hadm_id = T2.hadm_id AND T1.stay_id = T2.stay_id\nWHERE T1.subject_id = 10038933\n  AND T2.stay_id = (\n    SELECT MIN(stay_id) \n    FROM icustays \n    WHERE subject_id = 10038933\n  )\n  AND T1.itemid = (\n    SELECT itemid \n    FROM d_items \n    WHERE label LIKE '%multivitamins%'\n  );",
    "7c188f76017d685690e33f58": "Select the maximum start time**: Use the `MAX` function to get the latest `starttime` since the question asks for \"the last time\".",
    "55c38b5362bf49397a27774e": "SELECT starttime \nFROM inputevents \nWHERE subject_id = 10027602 \n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'NaCl 0.45%') \n  AND strftime('%Y-%m-%d', starttime) = '2023-11-30' \nORDER BY starttime ASC \nLIMIT 1;",
    "9bbe2a60bf98d234e5825b6d": "",
    "9bdee5cb67ac4e91e5b630da": "",
    "5d9fd7530f8b7c30df604ea3": "SELECT \n  MIN(starttime) AS first_input_time\nFROM \n  inputevents\nWHERE \n  subject_id = 10004733 AND \n  strftime('%Y-%m-%d', starttime) = '2023-12-28';",
    "4d8649af3dbd396df7c0075b": "",
    "3e3acb412956feade24cf02d": "SELECT MAX(starttime) AS last_input_time\nFROM inputevents\nWHERE subject_id = 10015860\nAND starttime >= '2003-07-03 00:00:00';",
    "3eb33ba93f9cf1fe30f6a3de": "SELECT MIN(starttime) AS first_input_time\nFROM inputevents\nWHERE subject_id = 10026354\nAND starttime >= '2100-07-14 00:00:00';",
    "b6f5c8c63479dc0c781f71d3": "SELECT MIN(starttime) AS first_inputtime\nFROM inputevents\nWHERE subject_id = 10005817 AND starttime > '2100-12-21';",
    "234ef243bc79fbeeafde9f09": "SELECT \n  T1.charttime\nFROM \n  chartevents AS T1\n  INNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10027602 \n  AND T2.label = 'Heart Rate'\n  AND DATE(T1.charttime) = '2100-11-27'\nORDER BY \n  T1.charttime ASC\nLIMIT 1;",
    "f54a4c50ee67f5dbec1add73": "SELECT \n    charttime \nFROM \n    chartevents \nWHERE \n    subject_id = 10020740 \nAND \n    itemid = (SELECT itemid FROM d_items WHERE label = 'SpO2') \nAND \n    charttime LIKE '2000-03-24%';",
    "176c4a282a56f000735207f8": "SELECT MIN(charttime) AS first_charttime\nFROM chartevents\nWHERE subject_id = 10010471\n  AND itemid IN (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\n  AND strftime('%Y-%m', charttime) = '2019-10'",
    "ae02dd831bcaea6f356e18cb": "",
    "ec5c2b153da669ee108c8957": "SELECT MAX(l.charttime) AS last_body_temp_check\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10021487\n  AND d.label = 'Body Temperature'\n  AND l.charttime >= '2100-06-06 00:00:00';",
    "9395b479ccae72fb9bd102d3": "SELECT c.charttime\nFROM chartevents c\nJOIN d_items i ON c.itemid = i.itemid\nWHERE c.subject_id = 10019568\nAND i.label = 'Heart Rate'\nAND DATE(c.charttime) = '2021-04-02'\nORDER BY c.charttime\nLIMIT 1;",
    "e5d7989d4180e49d445f9388": "SELECT MIN(ce.charttime) AS first_charttime\nFROM chartevents ce\nJOIN icustays icu ON ce.stay_id = icu.stay_id\nWHERE ce.subject_id = 10009035\n  AND ce.itemid = 138\n  AND icu.stay_id = (\n    SELECT MIN(stay_id) \n    FROM icustays \n    WHERE subject_id = 10009035\n  );",
    "53761ebb18ac5c642c4f2006": "SELECT \n  MIN(ce.charttime) AS first_charttime\nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  ce.subject_id = 10010471 \n  AND di.label = 'Respiratory Rate'\n  AND ce.charttime >= '2019-01-01' \n  AND ce.charttime < '2019-02-01' \n  AND ce.valuenum > 25.0;",
    "7af68876628a4636df61cbce": "SELECT MAX(T1.charttime) AS last_respiratory_rate_charttime\nFROM chartevents AS T1\nINNER JOIN d_items AS T2 ON T1.itemid = T2.itemid\nWHERE T2.label = 'Respiratory Rate'\n  AND T1.valuenum > 16.0\n  AND T1.subject_id = 10021487;",
    "aba2a9f835c596686850b00a": "SELECT \n  ce.charttime \nFROM \n  chartevents ce\n  INNER JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  ce.subject_id = 10007818 \n  AND di.label = 'Heart Rate'\n  AND ce.valuenum < 150.0\nORDER BY \n  ce.charttime DESC\nLIMIT 1;",
    "687e1ab45a6ab29b54c44861": "",
    "cb2576703363b2124ae28f7c": "SELECT \n    MIN(ce.charttime) AS first_time\nFROM \n    chartevents ce\nJOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10010471\n    AND di.label = 'Respiratory Rate'\n    AND ce.charttime >= '2023-12-20 00:00:00'\n    AND ce.charttime <= '2023-12-20 23:59:59'\n    AND ce.valuenum < 27.0;",
    "dcfff42d3b4e18800ea55074": "SELECT MIN(charttime) AS first_chart_time\nFROM chartevents\nWHERE subject_id = 10007818\nAND itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate')\nAND valuenum < 83.0\nAND charttime LIKE '%2100-07-05%';",
    "29145deb2421f340268f6323": "SELECT MIN(charttime) AS first_high_systolic_bp_time\nFROM chartevents\nWHERE subject_id = 10018081 AND itemid = 226705 AND valuenum > 127.0;",
    "b862c7be7085f5768ab9bd66": "",
    "b52f4e22cdd27322676517fc": "WITH LastIcuStay AS (\n    SELECT\n        icustays.stay_id\n    FROM\n        icustays\n    INNER JOIN admissions ON icustays.hadm_id = admissions.hadm_id\n    WHERE\n        admissions.subject_id = 10004235\n    ORDER BY\n        icustays.outtime DESC\n    LIMIT 1\n),\nMaxBloodPressure AS (\n    SELECT\n        charttime,\n        valuenum\n    FROM\n        chartevents\n    INNER JOIN LastIcuStay ON chartevents.stay_id = LastIcuStay.stay_id\n    WHERE\n        chartevents.itemid = (SELECT itemid FROM d_items WHERE label = 'Diastolic Blood Pressure')\n    ORDER BY\n        valuenum DESC\n    LIMIT 1\n)\nSELECT\n    charttime\nFROM\n    MaxBloodPressure;",
    "c0b00ebc518d168b79f08eb4": "SELECT MIN(valuenum) AS minimum_heart_rate\nFROM chartevents\nWHERE subject_id = 10023239\n  AND charttime LIKE '2021-06-29%'\n  AND itemid = (SELECT itemid FROM d_items WHERE label = 'Heart Rate');",
    "9ec14e1d25e50dd996d4e3a7": "",
    "565bd442b074a6efca2e0887": "SELECT ce.charttime \nFROM chartevents ce \nJOIN d_items di ON ce.itemid = di.itemid \nWHERE ce.subject_id = 10018081 \nAND di.label LIKE '%Diastolic Blood Pressure%' \nAND ce.charttime LIKE '%2023-12-26%' \nAND ce.valuenum = (\n    SELECT MAX(ce2.valuenum) \n    FROM chartevents ce2 \n    JOIN d_items di2 ON ce2.itemid = di2.itemid \n    WHERE ce2.subject_id = 10018081 \n    AND di2.label LIKE '%Diastolic Blood Pressure%' \n    AND ce2.charttime LIKE '%2023-12-26%'\n)\nLIMIT 1;",
    "b65ad812aa58a875e2d64890": "SELECT \n  MIN(ce.charttime) AS first_heart_rate_max_time\nFROM \n  chartevents ce\n  JOIN d_items di ON ce.itemid = di.itemid\nWHERE \n  di.label = 'Heart Rate'\n  AND ce.subject_id = 10038999\n  AND ce.charttime >= '2021-02-26'\nORDER BY \n  ce.charttime ASC;",
    "e799539afbf0b691d6a01724": "WITH MaxBP AS (\n    SELECT \n        c.charttime,\n        c.valuenum\n    FROM chartevents c\n    JOIN d_items d ON c.itemid = d.itemid\n    WHERE c.subject_id = 10039997\n      AND d.label = 'Mean Blood Pressure'\n      AND c.valuenum = (\n          SELECT MAX(valuenum)\n          FROM chartevents\n          WHERE subject_id = 10039997\n            AND itemid = d.itemid\n      )\n)\nSELECT \n    MAX(charttime) AS last_max_bp_time\nFROM MaxBP;",
    "7cf6accf1943c04c3021431d": "SELECT \n    CASE \n        WHEN COUNT(a.row_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_coming\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nWHERE \n    p.subject_id = 10004422 AND \n    a.admittime >= datetime('now', '-1 year');",
    "fbf6757b5a77304084ba36d9": "SELECT \n  CASE \n    WHEN COUNT(a.row_id) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_been_hospitalized\nFROM \n  admissions a\nWHERE \n  a.subject_id = 10018845\n  AND a.admittime > DATE('now', '-1 year');",
    "d012dd1a0c9587638828166b": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y' \n    ELSE 'N' \n  END AS has_come\nFROM \n  admissions \nWHERE \n  subject_id = 10015272 \n  AND admittime > '2100-01-01 00:00:00';",
    "44877f8ac388426e512417e3": "SELECT \n  CASE \n    WHEN EXISTS (SELECT 1 FROM admissions WHERE subject_id = 10021118 AND strftime('%Y', admittime) = '2100') THEN 'Yes'\n    ELSE 'No'\n  END AS has_been_hospitalized",
    "c73dd80145bee718f2bf509b": "SELECT CASE \n  WHEN COUNT(a.subject_id) > 0 THEN 'Yes'\n  ELSE 'No'\nEND AS has_come_to_hospital\nFROM admissions a\nWHERE a.subject_id = 10005909 AND a.admittime >= '2100-01-01';",
    "6699cff955e99112f866a2d5": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_been_hospitalized\nFROM admissions\nWHERE subject_id = 10020740 \n  AND admittime >= DATE('now', 'start of year');",
    "33c6e26e755a5e0efb3a25b9": "SELECT \n    CASE \n        WHEN T1.admission_location = 'Emergency Room' THEN 'Y'\n        ELSE 'N'\n    END AS in_emergency_room\nFROM admissions T1\nWHERE T1.subject_id = 10019568\nORDER BY T1.admittime\nLIMIT 1;",
    "b422362f19ca6957cfa3fb02": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS came_to_er\nFROM \n    admissions\nWHERE \n    subject_id = 10007795\n    AND admission_location = 'Emergency'\n    AND admittime >= DATE('now', '-1 year');",
    "c3c3a56dc8cd277bd5826031": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS went_to_er\nFROM \n    admissions\nWHERE \n    subject_id = 10007928 \n    AND admission_location = 'E.R.'\n    AND admittime >= DATE('now', '-1 year');",
    "461ed0b2f30a1fe2a7aca6e3": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS went_to_emergency_room\nFROM admissions\nWHERE subject_id = 10012853 AND admission_location = 'Emergency Room';",
    "38b8d432b6882df96340f954": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1 \n      FROM admissions \n      WHERE subject_id = 10008454 \n        AND admission_type = 'Emergency'\n        AND strftime('%Y', admittime) = '2100'\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS patient_admitted;",
    "f020778ee34bfe4318ed4bde": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1\n            FROM admissions a\n            WHERE a.subject_id = 10001217\n            AND a.admission_location = 'Emergency Room'\n            ORDER BY a.admittime\n            LIMIT 1\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS was_in_er;",
    "18827b43fd9e61dcfc5d9388": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1 \n      FROM admissions \n      WHERE subject_id = 10016810 \n        AND admission_location = 'ER' \n        AND admittime >= DATE('now', '-1 year')\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS came_to_er;",
    "e62cc504176c8533a1e60738": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_procedure\nFROM \n  procedures_icd \nWHERE \n  subject_id = 10018328;",
    "3376a341796a02ddf1d1814f": "SELECT DISTINCT p.subject_id\nFROM procedures_icd p\nINNER JOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.subject_id = 10021666 AND p.charttime >= '2100-01-01';",
    "0c85596eb9a5ce81b6fb531c": "SELECT \n  CASE \n    WHEN COUNT(T3.icd_code) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_procedures\nFROM \n  patients T1\n  LEFT JOIN procedures_icd T3 ON T1.subject_id = T3.subject_id\nWHERE \n  T1.subject_id = 10005909 \n  AND strftime('%Y', T3.charttime) = strftime('%Y', 'now');",
    "36178f6bba63163826d1292a": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS did_procedure\nFROM procedures_icd p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.subject_id = 10007795 \n  AND p.charttime >= DATE('now', '-1 year');",
    "7fbb236187007480210be707": "",
    "d081d7e2db7e69a70b388b51": "SELECT DISTINCT p.subject_id\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nWHERE p.subject_id = 10009035;",
    "10fd1a4b2a07afed251f289a": "",
    "bd8736e59f3b5eb724910a84": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS procedure_occurred\nFROM \n    procedures_icd p\nJOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n    p.subject_id = 10005909\n    AND d.long_title = 'Extirpation of matter from left femoral vein, percutaneous approach'\n    AND p.charttime >= DATE('now', '-1 year');",
    "889ee571402af73523bd702b": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_procedure\nFROM \n  procedures_icd AS p\nJOIN \n  d_icd_procedures AS d\nON \n  p.icd_code = d.icd_code\nWHERE \n  p.subject_id = 10007818 \n  AND d.long_title = 'Extirpation of matter from lung lingula, via natural or artificial opening endoscopic procedure'\n  AND p.charttime >= '2100-01-01';",
    "0018b73b2eda7611f63bee38": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1\n      FROM procedures_icd AS pi\n      INNER JOIN d_icd_procedures AS dip ON pi.icd_code = dip.icd_code\n      WHERE pi.subject_id = 10029291\n        AND dip.long_title LIKE '%ultrasonography of superior vena cava, guidance%'\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS procedure_occurred;",
    "05a8454a6a71435a557db2cc": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_central_vascular_catheter\nFROM procedures_icd \nWHERE icd_code IN (\n  SELECT icd_code \n  FROM d_icd_procedures \n  WHERE long_title LIKE '%central venous catheter placement with guidance%'\n)\nAND subject_id = 10004733;",
    "7ab5610ee5258787397017e1": "SELECT \n    COUNT(*) AS procedure_count\nFROM \n    procedures_icd p\nJOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n    p.subject_id = 10007818 \n    AND p.charttime >= '2100-01-01 00:00:00'\n    AND d.long_title = 'Urinary Filtration, Multiple';",
    "c8af28411a3f128722567f9e": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1 \n      FROM procedures_icd AS p \n      WHERE p.subject_id = 10023117 \n      AND p.hadm_id = (\n        SELECT hadm_id \n        FROM admissions \n        WHERE subject_id = 10023117 \n        ORDER BY hadm_id DESC \n        LIMIT 1\n      )\n      AND p.icd_code = '00.00' \n    ) THEN 'Yes' \n    ELSE 'No' \n  END AS procedure_performed",
    "75ad6fb522538101f974da54": "SELECT \n  p.subject_id,\n  dip.long_title\nFROM \n  procedures_icd picd\n  INNER JOIN d_icd_procedures dip ON picd.icd_code = dip.icd_code\n  INNER JOIN patients p ON picd.subject_id = p.subject_id\nWHERE \n  p.subject_id = 10025463 \n  AND dip.long_title LIKE '%excision or destruction of other lesion or tissue of heart, endovascular approach%';",
    "6cf60ddb53c69a32d984068c": "SELECT T1.drug, COUNT(*) AS treatment_count\nFROM prescriptions AS T1\nWHERE T1.subject_id = 10019777 AND T1.hadm_id = (\n    SELECT T2.hadm_id\n    FROM admissions AS T2\n    WHERE T2.subject_id = 10019777\n    ORDER BY T2.admittime ASC\n    LIMIT 1\n)\nGROUP BY T1.drug\nHAVING COUNT(*) >= 2;",
    "fcfa89f08cd7518cc467a635": "SELECT d.long_title\nFROM procedures_icd AS p\nINNER JOIN d_icd_procedures AS d ON p.icd_code = d.icd_code\nWHERE p.subject_id = 10002495 AND p.charttime >= '2000-06-01'\nGROUP BY d.long_title\nHAVING COUNT(p.row_id) >= 2;",
    "2bd36cdf648a73c1405bc0bd": "SELECT p_icd.icd_code\nFROM patients p\nINNER JOIN procedures_icd p_icd ON p.subject_id = p_icd.subject_id\nWHERE p.subject_id = 10007795\n  AND p_icd.charttime >= '2100-01-01'\nGROUP BY p_icd.icd_code\nHAVING COUNT(p_icd.row_id) = 2;",
    "68e68711b24f4ee363da9739": "SELECT \n  T3.long_title\nFROM \n  procedures_icd AS T1\n  INNER JOIN d_icd_procedures AS T3 ON T1.icd_code = T3.icd_code\nWHERE \n  T1.subject_id = 10027602\nGROUP BY \n  T3.long_title\nHAVING \n  COUNT(T1.row_id) = 2;",
    "080005219b1bf48862540ed2": "",
    "641bf23b0701d0025cafd597": "SELECT \n  p.long_title\nFROM \n  procedures_icd pi\n  INNER JOIN d_icd_procedures p ON pi.icd_code = p.icd_code\nWHERE \n  pi.subject_id = 10002495\n  AND pi.hadm_id IN (\n    SELECT hadm_id\n    FROM procedures_icd\n    WHERE subject_id = 10002495\n    GROUP BY hadm_id\n    HAVING COUNT(icd_code) >= 2\n  )\nGROUP BY \n  p.long_title;",
    "a868ec00f8a5fa468855f6fd": "SELECT p.long_title\nFROM procedures_icd AS pi\nINNER JOIN d_icd_procedures AS p ON pi.icd_code = p.icd_code\nINNER JOIN admissions AS a ON pi.hadm_id = a.hadm_id\nWHERE a.subject_id = 10021312 \nAND pi.charttime > datetime('now', '-10 months')\nGROUP BY p.long_title\nHAVING COUNT(pi.row_id) > 1\nLIMIT 1;",
    "cc4d6ffe4f9c497d114ffb8f": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS received_diagnosis\nFROM diagnoses_icd\nWHERE subject_id = 10036156;",
    "c5110fc62fc9ba15034f6482": "SELECT \n    CASE WHEN COUNT(*) > 0 THEN 'Yes' ELSE 'No' END AS is_diagnosed\nFROM \n    diagnoses_icd d\nJOIN \n    admissions a ON d.hadm_id = a.hadm_id\nWHERE \n    d.subject_id = 10018081\n    AND a.admittime >= DATE('now', '-1 year');",
    "eda3c6670454f65cad04f15c": "SELECT CASE WHEN COUNT(diagnoses_icd.row_id) > 0 THEN 'Yes' ELSE 'No' END AS has_diagnosis\nFROM diagnoses_icd\nJOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id\nWHERE admissions.subject_id = 10012552;",
    "56765c70e8dbcc6a5ecdaca5": "SELECT \n  COUNT(*) AS num_diagnoses \nFROM \n  diagnoses_icd \nWHERE \n  subject_id = 10007818 \n  AND charttime > '2100-01-01 00:00:00';",
    "c73288aeb0cfc184ac029f56": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS HasDiagnosis\nFROM \n  diagnoses_icd\nWHERE \n  subject_id = 10017492\n  AND hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10017492\n    ORDER BY admittime\n    LIMIT 1\n  );",
    "f209b8c081219def0ef4ace5": "SELECT \n    CASE \n        WHEN COUNT(T2.icd_code) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS received_diagnosis\nFROM \n    admissions T1\nLEFT JOIN \n    diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.subject_id = 10022041\n    AND T1.hadm_id = (\n        SELECT MAX(hadm_id) \n        FROM admissions \n        WHERE subject_id = 10022041\n    );",
    "b11b1fc29cb6a59522daeb8d": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS received_diagnosis\nFROM \n  diagnoses_icd\nWHERE \n  subject_id = 10004733;",
    "81233148fcdb550533d311a4": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_polyneuropathy\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE diagnoses_icd.subject_id = 10014354 \nAND d_icd_diagnoses.long_title = 'Polyneuropathy, unspecified'\nAND diagnoses_icd.charttime >= DATE('now', '-1 year');",
    "eaddbd134c399ccf75e4f24e": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y' \n    ELSE 'N' \n  END AS has_diagnosis\nFROM \n  patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  INNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\nWHERE \n  p.subject_id = 10018845 AND \n  di.long_title LIKE '%subdural hemorrhage following injury%' AND \n  NOT EXISTS (\n    SELECT 1 \n    FROM diagnoses_icd d2 \n    INNER JOIN d_icd_diagnoses di2 ON d2.icd_code = di2.icd_code \n    WHERE d2.hadm_id = d.hadm_id AND di2.long_title LIKE '%open intracranial wound%'\n  );",
    "ad475c1d5ff7b04c88a96e2c": "SELECT \n    CASE \n        WHEN COUNT(d.row_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_chronic_kidney_disease\nFROM \n    diagnoses_icd d\nJOIN \n    d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE \n    d.subject_id = 10015931\n    AND strftime('%Y', d.charttime) = '2100'\n    AND dd.long_title LIKE '%Chronic kidney disease, stage 3 (moderate)%';",
    "f39c38465d2dfe0e93701a52": "SELECT \n  CASE \n    WHEN COUNT(diagnoses_icd.icd_code) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS is_diagnosed\nFROM \n  diagnoses_icd\n  INNER JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id\nWHERE \n  admissions.admittime >= '2100-01-01'\n  AND diagnoses_icd.icd_code = 'I60'\n  AND admissions.subject_id = 10004235;",
    "50b2a084d9984e05d63230db": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS has_anticoagulant_diagnosis\nFROM \n  diagnoses_icd d\nINNER JOIN \n  d_icd_diagnoses icd ON d.icd_code = icd.icd_code\nWHERE \n  d.subject_id = 10018081 \n  AND icd.long_title LIKE '%long-term (current) use of anticoagulants%'",
    "23aeb815d2db0889eb0f2b24": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS received_encounter\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE diagnoses_icd.subject_id = 10015931\nAND d_icd_diagnoses.long_title = 'EXAMINATION FOR NORMAL COMPARISON AND CONTROL IN CLINICAL RESEARCH PROGRAM'\nAND diagnoses_icd.charttime >= DATE('2100-01-01');",
    "48fcb0d1e3395d14eae1e8b2": "SELECT CASE \n  WHEN COUNT(*) > 0 THEN 'Diagnosed'\n  ELSE 'Not Diagnosed'\nEND AS diagnosis_status\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses did ON di.icd_code = did.icd_code\nWHERE di.subject_id = 10004235\nAND did.long_title LIKE '%hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified%';",
    "605dc49bacfb0b462cf31880": "SELECT \n  p.subject_id,\n  CASE \n    WHEN SUM(CASE WHEN pr.drug = 'docusate sodium' THEN 1 ELSE 0 END) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS docusate_sodium,\n  CASE \n    WHEN SUM(CASE WHEN pr.drug = '5% dextrose' THEN 1 ELSE 0 END) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS dextrose,\n  CASE \n    WHEN SUM(CASE WHEN pr.drug = 'polyethylene glycol' THEN 1 ELSE 0 END) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS polyethylene_glycol\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE p.subject_id = 10021118\n  AND pr.starttime > '2022-11-21 00:00:00'\nGROUP BY p.subject_id;",
    "2e4d054961ab8dd569126be6": "",
    "c6e32087897377afc707821c": "",
    "03aa2747a4bbb38e1e9ccb85": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS prescribed\nFROM \n  prescriptions\nWHERE \n  subject_id = 10003400\n  AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10003400 ORDER BY admittime ASC LIMIT 1)\n  AND drug IN ('lisinopril', 'vitamin d', 'lenalidomide (revlimide)15mg');",
    "977a6055c6232b7e550211d6": "SELECT \n    p.subject_id, \n    pr.drug, \n    pr.dose_val_rx, \n    pr.dose_unit_rx, \n    pr.route, \n    pr.starttime, \n    pr.stoptime\nFROM \n    patients p\nINNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10011398\n    AND pr.drug IN ('ibuprofen', 'ondansetron', 'insulin human regular')\n    AND pr.starttime >= '2000-12-21';",
    "8575a4d0318c42ed703a89a1": "SELECT DISTINCT i.itemid, d.label, p.hadm_id, p.starttime, p.stoptime\nFROM inputevents p\nINNER JOIN d_items i ON p.itemid = i.itemid\nINNER JOIN patients pat ON p.subject_id = pat.subject_id\nINNER JOIN d_items d ON p.itemid = d.itemid\nWHERE pat.subject_id = 10015931 \nAND p.starttime LIKE '2012-12-21%' \nAND d.label IN ('5% DEXTROSE', 'GLUCOSE GEL', 'ONDANSETRON');",
    "b66ed8145c0b562f96f32f22": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_been_ordered\nFROM inputevents\nINNER JOIN d_items ON inputevents.itemid = d_items.itemid\nWHERE inputevents.subject_id = 10038933\nAND (d_items.label LIKE '%0.9% sodium chloride%'\nOR d_items.label LIKE '%levetiracetam%'\nOR d_items.label LIKE '%bag%')\nAND inputevents.starttime >= '2100';",
    "9a16562e6c22fbc3ecf55004": "",
    "d60412f228f0e3b6df5b6d8c": "SELECT DISTINCT drug\nFROM prescriptions\nWHERE subject_id = 10021312 AND starttime >= '03/2100';",
    "b07f1b0cf6f5838302e27ea2": "SELECT \n  CASE \n    WHEN COUNT(p.drug) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS any_medication\nFROM \n  prescriptions p\nWHERE \n  p.subject_id = 10005866 \n  AND p.hadm_id = (\n    SELECT hadm_id \n    FROM admissions \n    WHERE subject_id = 10005866 \n    ORDER BY admittime DESC \n    LIMIT 1\n  );",
    "407ffa4fc0b1f6b83c6a90e4": "",
    "6b7a85cc61dd82548ef2f988": "SELECT \n    p.subject_id,\n    pr.drug,\n    pr.starttime\nFROM \n    patients p\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    p.subject_id = 10040025 AND\n    strftime('%m', pr.starttime) = '04' AND\n    strftime('%Y', pr.starttime) = strftime('%Y', 'now', '-1 year');",
    "fdc9e1c2af088aa194e9faa5": "SELECT p.subject_id, COUNT(*) AS medication_count\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE p.subject_id = 10005817\nAND pr.starttime BETWEEN DATE('now', '-1 year') AND DATE('now')\nGROUP BY p.subject_id;",
    "7e472b43cb7c281ea7ad2326": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_been_given_medication\nFROM \n  prescriptions\nWHERE \n  subject_id = 10016150;",
    "ab2aad38b2169268cce19216": "",
    "732ddbd8735aa1ef150a5da1": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes' \n    ELSE 'No' \n  END AS lidocaine_1_percent_administered\nFROM \n  prescriptions\nWHERE \n  subject_id = 10004733 \n  AND drug = 'Lidocaine 1%' \n  AND dose_unit_rx = '1%';",
    "cc187d8a2ecb0abb9fd2ff92": "SELECT \n  MAX(CASE \n      WHEN drug = 'Clonidine Patch 0.3 mg/24 hr' AND starttime >= '2100-12-21' THEN 1 \n      ELSE 0 \n    END) AS clonidine_prescribed\nFROM prescriptions\nWHERE subject_id = 10004733;",
    "dab078420665e61aa6883a1d": "",
    "b3baba0d3d4a30996c8d7040": "",
    "29ea8f3acec04ab1a79ac191": "SELECT \n    i.itemid, \n    d.label, \n    i.totalamount, \n    i.totalamountuom\nFROM \n    inputevents i\nINNER JOIN \n    d_items d ON i.itemid = d.itemid\nWHERE \n    i.subject_id = 10020740 \n    AND i.starttime BETWEEN '2000-03-21 00:00:00' AND '2000-03-21 23:59:59'\n    AND d.label LIKE '%Insulin%';",
    "f4d19ba764d6773617847b52": "",
    "2b3268beab056ff505b05347": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_tested\nFROM \n  labevents\nWHERE \n  subject_id = 10029291 AND charttime > '2001-01-01';",
    "d2926f4a0d345771d9cecb6a": "SELECT MAX(l.charttime) AS latest_charttime\nFROM labevents l\nJOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE a.subject_id = 10031757\n  AND l.charttime >= DATE('now', '-15 months');",
    "d9f1d82756382ceba0364eb7": "SELECT COUNT(*) \nFROM labevents \nWHERE subject_id = 10020786 AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "9957eec4f3658a2214f701c9": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS lab_test_performed\nFROM \n  labevents\nWHERE \n  subject_id = 10007795 AND \n  charttime BETWEEN '2000-08-01' AND '2000-08-31';",
    "82c55832a756019258539f9d": "SELECT \n  subject_id\nFROM \n  labevents\nWHERE \n  subject_id = 10018423 \n  AND charttime > '2100-01-01';",
    "1a8e264083c39ca2b5c9bc74": "SELECT COUNT(*) > 0 AS received_lab_tests\nFROM labevents AS l\nJOIN patients AS p ON l.subject_id = p.subject_id\nWHERE p.subject_id = 10018423\n  AND l.charttime >= DATE('now', '-1 year');",
    "be808f9b9ff6628170faba78": "SELECT \n    CASE \n        WHEN COUNT(l.subject_id) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_lab_test\nFROM \n    patients p \nINNER JOIN \n    labevents l ON p.subject_id = l.subject_id \nWHERE \n    p.subject_id = 10019172 \n    AND l.charttime BETWEEN '2023-11-01' AND '2023-11-30';",
    "7c0a9c949c9ec7ff63c270ae": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS received_test\nFROM \n    labevents T1\nINNER JOIN \n    d_labitems T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.subject_id = 10009628 AND \n    T2.label = 'Total CO2' AND \n    T1.charttime BETWEEN '2021-10-01 00:00:00' AND '2021-10-21 23:59:59';",
    "4ec3447b9f00804b8d0a3da0": "",
    "d68bcea40377baf01b112ced": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS received_albumin_test\nFROM labevents le\nJOIN d_labitems li ON le.itemid = li.itemid\nWHERE le.subject_id = 10007818\n  AND li.label = 'Albumin'\n  AND le.charttime >= DATE('now', '-1 year');",
    "f53166032d928995607d2fc9": "",
    "97a7eba99e8adfa9dfe8aaca": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS calcium_test\nFROM \n    labevents l\nJOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.subject_id = 10005817\n    AND l.charttime > '2010-10-01'\n    AND d.label LIKE '%Free Calcium%';",
    "6f9ec204cf2995a0808955b7": "SELECT \n  CASE \n    WHEN T2.itemid IN (SELECT itemid FROM d_labitems WHERE label = 'CK-MB index') THEN 'Yes'\n    ELSE 'No'\n  END AS had_ck_mb_test\nFROM \n  patients AS T1\n  INNER JOIN labevents AS T2 ON T1.subject_id = T2.subject_id\nWHERE \n  T1.subject_id = 10029291 AND T2.hadm_id IN (\n    SELECT hadm_id FROM admissions WHERE subject_id = T1.subject_id\n    ORDER BY admittime ASC\n    LIMIT 1\n  );",
    "26fa750dccd4c284472ecb48": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS received_chloride_test\nFROM \n  labevents l\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE \n  l.subject_id = 10025463\n  AND d.label = 'Chloride Test'\n  AND l.charttime > DATE('now', '-1 month');",
    "c8c821f2bce77aa592def2d7": "select the relevant test results from the `microbiologyevents` table for the specified patient, filtered by the date condition. The `charttime` column will be compared to the date 24 months prior to the current date.",
    "c0193e5f3d01df8825ae0a53": "SELECT EXISTS (\n  SELECT 1 \n  FROM microbiologyevents \n  WHERE subject_id = 10039831 \n    AND charttime >= '2004-04-21'\n) AS has_microbiological_tests;",
    "6e5cae3a2758b55ff0bbfc87": "",
    "4a8bec0e16a11e2197448c3b": "SELECT COUNT(*) AS total_microbiology_events\nFROM microbiologyevents\nWHERE subject_id = 10038933 AND charttime BETWEEN date('now', '-1 year') AND date('now', '-1 month', '+7 days');",
    "adfdf07d99e741f927fb639b": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_tested\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10011398\n  AND charttime >= DATE('now', '-2 months');",
    "1abc175490e91fdbe78482fb": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS has_microbiology_test\nFROM \n  microbiologyevents \nWHERE \n  subject_id = 10001217 \n  AND strftime('%Y', charttime) = strftime('%Y', 'now');",
    "1c70ab701577302fd7bec691": "SELECT \n  MAX(CASE WHEN charttime >= '2000-09-21 00:00:00' THEN 1 ELSE 0 END) AS has_microbio_test\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10006053;",
    "4f4a3bef12490dacc3837b15": "SELECT \n    COUNT(*) AS count\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10002495 AND \n    charttime BETWEEN '2023-06-01' AND '2023-06-30' AND \n    spec_type_desc = 'First urine' AND \n    org_name IS NOT NULL;",
    "987c4c9f04e411a9be21bae2": "SELECT COUNT(*) > 0 AS found_organism\nFROM microbiologyevents me\nWHERE me.subject_id = 10007795\nAND me.charttime >= DATE('01/2100')\nAND me.test_name LIKE '%abscess%'\nAND me.org_name IS NOT NULL;",
    "128670f0128422d00c359ab0": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS found_organism\nFROM \n  microbiologyevents\nWHERE \n  subject_id = 10005348 \n  AND spec_type_desc = 'Blood Culture' \n  AND charttime >= DATE('now', '-1 year')\nLIMIT 1;",
    "2001cff617f1e7a9c0034942": "",
    "1478b8ca5010dfa67a0ce559": "SELECT MAX(CASE WHEN org_name IS NOT NULL THEN 1 ELSE 0 END) AS found_organism\nFROM microbiologyevents\nWHERE subject_id = 10007928 AND test_name LIKE '%serology/blood%';",
    "ec96517b92997f0de9c0bbbe": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS found_organism\nFROM \n  microbiologyevents me\nWHERE \n  me.subject_id = 10002428\n  AND me.charttime > DATE('now', '-1 year')\n  AND me.spec_type_desc LIKE '%blood culture%'\n  AND me.org_name IS NOT NULL;",
    "623a4a91b019a3f07aa9fbb9": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS found\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 10012552\n    AND charttime BETWEEN DATE('now', 'start of year', '+4 months') AND DATE('now', 'start of year', '+5 months')\n    AND spec_type_desc = 'Staph. Aureus Swab'\n    AND org_name IS NOT NULL;",
    "8ad3bd73b83b2ac224da4fdb": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS solution_administered\nFROM \n  inputevents \nWHERE \n  subject_id = 10007058 AND starttime >= '2100-10-01';",
    "422b6f9b75c44635d538e4ce": "Select the relevant columns from the `inputevents` table.",
    "e53e5f3db28341b88fe8d653": "SELECT \n    CASE \n        WHEN SUM(CASE WHEN i.totalamount > 0 THEN 1 ELSE 0 END) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS was_solution_administered\nFROM inputevents i\nJOIN icustays icu ON i.stay_id = icu.stay_id\nWHERE i.subject_id = 10029291\nAND icu.stay_id = (\n    SELECT MIN(stay_id)\n    FROM icustays\n    WHERE subject_id = 10029291\n)",
    "561e8b21d83aed1d199886d6": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS dextrose_administered\nFROM \n    inputevents\nWHERE \n    subject_id = 10027602\n    AND starttime >= '2000-02-21'\n    AND itemid = (SELECT itemid FROM d_items WHERE label = 'Dextrose 5%')",
    "e84f32d4fad193387ab842e2": "SELECT \n  p.subject_id,\n  MAX(i.starttime) AS last_starttime\nFROM \n  patients p\n  INNER JOIN inputevents i ON p.subject_id = i.subject_id\nWHERE \n  p.subject_id = 10007818 \n  AND i.itemid = (SELECT itemid FROM d_items WHERE label = 'STERILE WATER')\n  AND i.starttime >= '2000-06-21 00:00:00'\nGROUP BY \n  p.subject_id\nHAVING \n  MAX(i.starttime) >= '2000-06-21 00:00:00';",
    "e6ac4f454e0ced3ae3ac6332": "SELECT \n    CASE \n        WHEN COUNT(ie.itemid) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_platelets\nFROM \n    inputevents ie\nJOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    ie.subject_id = 10006053 \n    AND di.label = 'PLT'\n    AND ie.starttime LIKE '2023-11-16%';",
    "f67fb672b995cf406d9a11a1": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1\n            FROM inputevents ie\n            JOIN d_items di ON ie.itemid = di.itemid\n            WHERE ie.stay_id = (\n                SELECT icu.stay_id\n                FROM icustays icu\n                WHERE icu.subject_id = 10035185\n                ORDER BY icu.intime ASC\n                LIMIT 1\n            )\n            AND di.label = 'Or Crystalloid'\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS or_crystalloid_administered;",
    "58a8117dba6b4ae43b573d05": "SELECT \n    CASE \n        WHEN COUNT(*) > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS has_urine_event\nFROM \n    outputevents\nWHERE \n    subject_id = 10026354 AND\n    charttime >= '2021-10-04 00:00:00' AND\n    itemid IN (\n        SELECT itemid \n        FROM d_items \n        WHERE label LIKE '%Urine%' OR abbreviation LIKE '%Urine%'\n    );",
    "66226330040dffdd0d5fd903": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1\n      FROM inputevents AS ie\n      JOIN d_items AS di ON ie.itemid = di.itemid\n      WHERE ie.subject_id = 10015931\n        AND DATE(ie.starttime) = '2023-12-09'\n        AND di.label = 'Foley Catheter'\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS has_foley;",
    "471c207da5409f3275cc20cb": "",
    "e58ee0e5c472679a4d86b25e": "SELECT CASE \n  WHEN SUM(CASE WHEN itemid = 123 THEN totalamount ELSE 0 END) > 0 THEN 'Yes'\n  ELSE 'No'\nEND AS Foley Catheter\nFROM inputevents\nWHERE subject_id = 10022017\n  AND starttime >= DATE('now', 'start of year', '+10 months', '-3 days')\n  AND starttime < DATE('now', 'start of year', '+10 months', '-2 days');",
    "0c5849747818dd64e3090cd8": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Y'\n    ELSE 'N'\n  END AS emesis_occurred\nFROM \n  outputevents\nWHERE \n  subject_id = 10025612 \n  AND charttime LIKE '%2023-10-02%' \n  AND itemid = (\n    SELECT \n      itemid \n    FROM \n      d_items \n    WHERE \n      label = 'Emesis' OR label LIKE 'Vomiting%'\n  );",
    "cea5a40f3d9844b4ee58041d": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS had_procedure\nFROM \n  procedures_icd pi\nJOIN \n  d_icd_procedures dip ON pi.icd_code = dip.icd_code\nWHERE \n  pi.subject_id = 10013049\n  AND dip.long_title LIKE '%Oral gastric%'\n  AND strftime('%Y-%m', pi.charttime) = '2000-06';",
    "40de69e222a145027e4f2169": "SELECT \n  CASE \n    WHEN T1.valuenum >= 60 AND T1.valuenum <= 90 THEN 'Normal'\n    ELSE 'Abnormal'\n  END AS result\nFROM \n  labevents AS T1\n  INNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n  T1.subject_id = 10029291\n  AND T2.label = 'Diastolic Blood Pressure'\n  AND DATE(T1.charttime) = '2000-03-21';",
    "41e5c617af3a91492dc2e3d0": "",
    "97551740a3b364d8e2b6214c": "SELECT \n    CASE \n        WHEN COUNT(CASE WHEN ce.valueuom = 'Normal' THEN 1 END) = COUNT(*) THEN 'All values normal'\n        ELSE 'Not all values normal'\n    END AS respiratory_rate_status\nFROM \n    chartevents ce\nINNER JOIN \n    d_items di ON ce.itemid = di.itemid\nWHERE \n    ce.subject_id = 10018081 \n    AND ce.charttime LIKE '%2022-12-29%'\n    AND di.label = 'Respiratory Rate';",
    "b23b961d0f2fe2cf1eec5a22": "",
    "9a2f8970fbd241c4a1994704": "SELECT \n  CASE \n    WHEN c.valuenum BETWEEN 60 AND 100 THEN 'Normal'\n    ELSE 'Abnormal'\n  END AS heart_rate_status\nFROM \n  chartevents c\nJOIN \n  d_items di ON c.itemid = di.itemid\nWHERE \n  c.subject_id = 10015931 \n  AND c.charttime > '2022-10-21 00:00:00'\n  AND di.label = 'Heart Rate';",
    "9e463af82f31adb188a12310": "SELECT \n  CASE \n    WHEN COUNT(*) = COUNT(CASE WHEN le.valuenum BETWEEN 36.5 AND 37.5 THEN 1 END) THEN 'All readings were normal'\n    ELSE 'Not all readings were normal'\n  END AS temperature_status\nFROM \n  labevents le\n  INNER JOIN d_labitems li ON le.itemid = li.itemid\nWHERE \n  li.label LIKE '%Body Temperature%' \n  AND le.subject_id = 10021118 \n  AND le.charttime BETWEEN DATE('now', '-1 year') AND DATE('now', '-1 year', '+1 day')\n  AND le.charttime LIKE '%12/24%';",
    "b8e813ddf11159fa6c4ca4ca": "SELECT \n    CASE \n        WHEN T2.valuenum BETWEEN 0.9 AND 1.1 THEN 'Within Normal Range'\n        ELSE 'Outside Normal Range'\n    END AS spO2_Status\nFROM \n    d_labitems T1\nINNER JOIN \n    labevents T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.label = 'SpO2'\n    AND T2.subject_id = 10007818\n    AND T2.charttime BETWEEN '2023-07-08 00:00:00' AND '2023-07-08 23:59:59';",
    "d90596b35371ba4a84a1a128": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10020187;",
    "2fe2de5ecc04ecf656ea58f3": "SELECT admittime\nFROM admissions\nWHERE subject_id = 10023117\nAND admittime > datetime('now', '-1 year');",
    "0980045acad692ba2a8996db": "SELECT \n  admittime AS hospital_admission_time\nFROM \n  admissions\nWHERE \n  subject_id = 10016742\nAND \n  admittime >= '2100-01-01';",
    "05ac3a771a3724d766be2218": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10018423 AND strftime('%Y', admittime) = '2100';",
    "89880a69f1f260cad697501f": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10038999 \n  AND admittime >= DATE('now', 'start of year');",
    "fcb5ab40c54f3bce352480bc": "SELECT admittime, dischtime\nFROM admissions\nWHERE subject_id = 10020740 AND strftime('%Y', admittime) = '2100';",
    "bee55ba67d6da489306ff469": "SELECT admittime \nFROM admissions \nWHERE subject_id = 10035185;",
    "b9c136c1e1d19649caabdeb4": "",
    "ab28063625f4ba14b3379479": "SELECT \n    SUM(T1.valuenum) AS total_protein\nFROM \n    labevents AS T1\nINNER JOIN \n    d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE \n    T1.subject_id = 10035185\n    AND T2.label LIKE '%protein%'\nGROUP BY \n    strftime('%Y', T1.charttime)",
    "abd48dc45ba90022382e02c9": "SELECT \n  STRFTIME('%Y-%m', l.charttime) AS month,\n  AVG(l.valuenum) AS average_creatinine\nFROM \n  labevents l\nJOIN \n  d_labitems li ON l.itemid = li.itemid\nWHERE \n  li.label = 'Creatinine, Urine' AND l.valueuom = '2100' AND l.subject_id = 10021666\nGROUP BY \n  month;",
    "4ea43bff9e1b8d9f142a816d": "SELECT \n  strftime('%Y', T1.charttime) AS year,\n  MIN(T1.valuenum) AS yearly_min_mcv\nFROM \n  labevents AS T1\nINNER JOIN \n  d_labitems AS T2 \nON \n  T1.itemid = T2.itemid\nWHERE \n  T2.label = 'MCV' \n  AND T1.subject_id = 10021118 \n  AND T1.charttime > '2010-10-01'\nGROUP BY \n  year\nORDER BY \n  year;",
    "7a60c2c50fa3345765a83271": "SELECT strftime('%Y-%m', charttime) AS month, MIN(valuenum) AS min_lipase\nFROM labevents\nWHERE subject_id = 10038999\n  AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Lipase in 2100')\nGROUP BY strftime('%Y-%m', charttime)\nORDER BY month;",
    "acc9bade197c3728c67fcdd7": "SELECT \n    DATE(l.charttime) AS date, \n    MIN(l.valuenum) AS min_value \nFROM \n    labevents l \n    JOIN d_labitems dl ON l.itemid = dl.itemid \nWHERE \n    l.subject_id = 10021487 \n    AND dl.label = 'BILIRUBIN, DIRECT' \nGROUP BY \n    DATE(l.charttime) \nORDER BY \n    date;",
    "249619a43d4c7fe7add673f1": "SELECT \n  strftime('%Y', l.charttime) AS year, \n  MAX(l.valuenum) AS max_ldh\nFROM \n  labevents l\nJOIN \n  d_labitems di ON l.itemid = di.itemid\nWHERE \n  l.subject_id = 10038933\n  AND di.label = 'Lactate Dehydrogenase (LD)'\n  AND l.charttime >= '2100-01-01'\nGROUP BY \n  strftime('%Y', l.charttime)\nORDER BY \n  year DESC;",
    "c0faf3e95f2c2000bdda5a2e": "SELECT \n    strftime('%Y-%m', T1.charttime) AS month,\n    AVG(T1.valuenum) AS average_weight\nFROM \n    labevents T1\nINNER JOIN \n    admissions T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n    T1.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Weight')\n    AND T2.subject_id = 10036156\n    AND T2.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10036156 ORDER BY admittime ASC LIMIT 1)\nGROUP BY \n    strftime('%Y-%m', T1.charttime)\nORDER BY \n    strftime('%Y-%m', T1.charttime);",
    "fa0c00e540e79ae2f208cdee": "SELECT \n    DATE(c.charttime) AS date,\n    AVG(c.valuenum) AS average_weight\nFROM \n    chartevents c\nJOIN \n    admissions a ON c.hadm_id = a.hadm_id\nWHERE \n    a.subject_id = 10038933\n    AND c.itemid = (\n        SELECT itemid \n        FROM d_items \n        WHERE label = 'Weight'\n    )\nGROUP BY \n    DATE(c.charttime)\nORDER BY \n    DATE(c.charttime) DESC\nLIMIT 1;",
    "996258522002126afaf5a3c0": "SELECT MIN(chartevents.charttime) AS min_charttime, MIN(chartevents.valuenum) AS min_valuenum\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE chartevents.subject_id = 10027445 AND d_items.label = 'Weight' AND chartevents.charttime >= '2100-01-01';",
    "42d490e9dcc8cd200649d0ff": "SELECT \n  strftime('%Y-%m', l.charttime) AS month,\n  MIN(l.valuenum) AS min_weight\nFROM \n  labevents l\n  INNER JOIN d_labitems dl ON l.itemid = dl.itemid\nWHERE \n  l.subject_id = 10014729 \n  AND dl.label LIKE '%weight%'\n  AND strftime('%Y', l.charttime) = '2100'\nGROUP BY \n  strftime('%Y-%m', l.charttime)\nORDER BY \n  month;",
    "e8a376ca7f202983221786bd": "",
    "b029fa60f795c16ffec2ddf9": "select only the measurements from the past 16 months.\n4. **Calculate daily average**: We will calculate the average weight for each day and then compute the overall daily average.",
    "230b50a3e6a330e4047ecfd0": "SELECT AVG(we.valuenum) AS average_weight\nFROM labevents we\nJOIN d_labitems li ON we.itemid = li.itemid\nWHERE we.subject_id = 10014729\n  AND li.label = 'WEIGHT'\n  AND DATE(we.charttime) BETWEEN '2000-03-21' AND '2000-03-21';",
    "8a5a5d29e1a51c172836525e": "SELECT \n    strftime('%Y', ie.starttime) AS year,\n    AVG(ie.totalamount) AS avg_totalamount\nFROM \n    inputevents ie\nWHERE \n    ie.subject_id = 10020740 AND \n    ie.itemid = 1 AND \n    ie.starttime >= '2021-01-25'\nGROUP BY \n    strftime('%Y', ie.starttime);",
    "c37d80a17e1432e62f2c945c": "SELECT \n    strftime('%Y-%m', starttime) AS month,\n    AVG(totalamount) AS average_intake\nFROM \n    inputevents\nWHERE \n    subject_id = 10005909 AND hadm_id IN (\n        SELECT hadm_id \n        FROM admissions \n        WHERE subject_id = 10005909 \n        ORDER BY admittime \n        LIMIT 1\n    )\n    AND totalamountuom = 'mL'\n    AND itemid IN (\n        SELECT itemid \n        FROM d_items \n        WHERE label LIKE '%PO Intake%'\n    )\nGROUP BY \n    month;",
    "4811bca64998a864d6db6bc5": "SELECT \n  DATE(starttime) AS date,\n  MAX(totalamount) AS max_intake\nFROM \n  inputevents\nWHERE \n  subject_id = 10000032 AND totalamountuom = 'mg'\nGROUP BY \n  DATE(starttime)\nORDER BY \n  date;",
    "53d67e5afb0eef3231919c0e": "SELECT \n    DATE(ie.starttime) AS date,\n    MAX(ie.totalamount) AS max_kcl_input\nFROM \n    inputevents ie\nINNER JOIN \n    admissions a ON ie.hadm_id = a.hadm_id\nWHERE \n    ie.itemid = (SELECT itemid FROM d_items WHERE label = 'KCL (BOLUS)')\n    AND a.subject_id = 10019172\nGROUP BY \n    DATE(ie.starttime);",
    "5edb24fc6b54aabb2e6f6f5c": "SELECT \n    strftime('%Y-%m', i.starttime) AS month,\n    MAX(i.totalamount) AS max_rbc_intake\nFROM \n    inputevents i\nJOIN \n    d_items di ON i.itemid = di.itemid\nWHERE \n    i.subject_id = 10039831 \n    AND di.label LIKE '% packed rbc%'\n    AND i.starttime >= '2021-12-05 00:00:00'\nGROUP BY \n    strftime('%Y-%m', i.starttime);",
    "4e02c94268e273ceadb20be5": "SELECT \n  strftime('%Y-%m', T1.starttime) AS month,\n  MIN(T1.totalamount) AS minimum_bolus_amount\nFROM \n  inputevents AS T1\nWHERE \n  T1.subject_id = 10005817\n  AND T1.itemid = (SELECT itemid FROM d_items WHERE label = 'Magnesium Sulfate (Bolus)')\n  AND T1.starttime >= '2000-12-06'\nGROUP BY \n  strftime('%Y-%m', T1.starttime)\nORDER BY \n  month;",
    "e9a0e7111e770b55741de154": "SELECT \n    strftime('%m', starttime) AS month, \n    AVG(dose_val_rx) AS average_dose\nFROM \n    prescriptions\nWHERE \n    subject_id = 10021487 AND \n    starttime >= '2010-10-01' AND \n    drug = 'peptamen bariatric (full)'\nGROUP BY \n    strftime('%m', starttime)\nORDER BY \n    month;",
    "8a0c7a7faca024a1eb4dd993": "SELECT date(charttime) AS date, MAX(valuenum) AS max_respiratory_rate\nFROM chartevents\nWHERE subject_id = 10010471 AND itemid = (SELECT itemid FROM d_items WHERE label = 'Respiratory Rate')\n  AND charttime >= DATE('now', '-14 days')\nGROUP BY date(charttime)\nORDER BY date;",
    "2783cbb5eccb2b4d0c78a1e0": "SELECT DATE(l.charttime) AS date, MAX(l.valuenum) AS max_systolic_bp\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE l.subject_id = 10003046\nAND d.label = 'Systolic Blood Pressure'\nGROUP BY DATE(l.charttime)\nORDER BY date;",
    "dca7f0863bc05ed189b1b292": "",
    "e1d0b53beabc24ec45e07b2d": "Select the relevant records from the `chartevents` table.\n2. Join the `d_items` table to filter the respiratory rate records.\n3. Filter by the patient's `subject_id` and the `hadm_id`.\n4. Group by month using the `strftime` function.\n5. Calculate the average respiratory rate for each month.",
    "f5f18cb5c4dd940a95ec5360": "SELECT \n  MAX(ce.valuenum) AS max_body_temperature\nFROM \n  chartevents ce\n  INNER JOIN icustays icu ON ce.hadm_id = icu.hadm_id AND ce.stay_id = icu.stay_id\nWHERE \n  ce.subject_id = 10011398\n  AND ce.itemid = (SELECT itemid FROM d_items WHERE label = 'Body Temperature')\n  AND icu.stay_id = (SELECT MAX(stay_id) FROM icustays WHERE subject_id = 10011398);",
    "0d7f97f7f014369165ccb406": "SELECT \n  DATE(l.charttime) AS date, \n  MAX(l.valuenum) AS max_diastolic_bp\nFROM \n  labevents l\nJOIN \n  d_labitems di ON l.itemid = di.itemid\nWHERE \n  di.label = 'Diastolic Blood Pressure' \n  AND l.subject_id = 10005817\n  AND l.charttime >= DATE('now', '-14 months')\nGROUP BY \n  DATE(l.charttime)\nORDER BY \n  date DESC;",
    "2c5b0c8baa3288cd5ae25871": "SELECT AVG(ce.valuenum) AS avg_systolic_bp\nFROM icustays icu\nINNER JOIN chartevents ce ON icu.stay_id = ce.stay_id\nWHERE icu.subject_id = 10019385\n  AND icu.outtime = (\n    SELECT MAX(outtime)\n    FROM icustays\n    WHERE subject_id = 10019385\n  )\n  AND ce.itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'Systolic Blood Pressure'\n  );",
    "5e1e03c6f5228f110a137a50": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10023117 AND strftime('%Y', admittime) = '2100';",
    "cfd45a15a268ad1a89df54dd": "SELECT \n    COUNT(a.row_id) AS total_admissions\nFROM \n    admissions a\nJOIN \n    patients p ON a.subject_id = p.subject_id\nWHERE \n    p.subject_id = 10020944\n    AND a.admittime >= DATE('now', '-1 year');",
    "93181a0681785a3fc636f0c0": "SELECT COUNT(hadm_id) AS hospital_visits\nFROM admissions\nWHERE subject_id = 10037861 AND admittime >= DATE('now', 'start of year');",
    "1565b3431aebbecefff6df1d": "SELECT COUNT(*) AS number_of_hospital_visits\nFROM admissions\nWHERE subject_id = 10018501;",
    "97aace30ba0ffdefe43a92fd": "SELECT COUNT(*) AS hospital_visits\nFROM admissions\nWHERE subject_id = 10014729;",
    "2e777a27e1019908bf9c76e0": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10003400 \nAND admittime >= DATE('now', '-1 year');",
    "bb96274f7d0903a6f3ad4e76": "SELECT COUNT(*) \nFROM admissions \nWHERE subject_id = 10007058 AND admittime >= '2100-01-01';",
    "c6ef8b615b48c60724e2636d": "SELECT COUNT(*) AS icu_stay_count\nFROM icustays\nWHERE subject_id = 10022880;",
    "6065fc09f8cb8ae10fb76e62": "SELECT COUNT(*) AS icu_stay_count\nFROM admissions AS T1\nINNER JOIN icustays AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.subject_id = 10038081;",
    "3476f7a1daff51acd412b499": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10029291 \nAND intime >= DATETIME('now', '-1 year');",
    "2e1336e1727d7e40e18f93c4": "SELECT COUNT(*) AS icu_visits\nFROM icustays icu\nJOIN admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE adm.subject_id = 10037975\nAND adm.hadm_id = (\n    SELECT hadm_id\n    FROM admissions\n    WHERE subject_id = 10037975\n    ORDER BY hadm_id DESC\n    LIMIT 1\n);",
    "c25b681b346061f536aabbe6": "SELECT COUNT(*) \nFROM icustays \nWHERE subject_id = 10013049 \nAND intime >= '2100-01-01';",
    "2b28101243e3c66e8678625b": "SELECT COUNT(*) AS icu_admissions\nFROM icustays icu\nINNER JOIN admissions adm ON icu.hadm_id = adm.hadm_id\nWHERE adm.subject_id = 10021938 AND icu.intime LIKE '2100%';",
    "4a84bbe324a00742f9bdfa52": "SELECT COUNT(*) AS icu_visits_last_encounter\nFROM icustays\nWHERE subject_id = 10004720\nAND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10004720 ORDER BY admittime DESC LIMIT 1);",
    "72f9afe9d7752f2079ec4df1": "SELECT COUNT(DISTINCT p.drug) AS total_prescribed_drugs\nFROM prescriptions p\nWHERE p.subject_id = 10024043;",
    "9db928d9e5f6893e61f4f006": "SELECT COUNT(DISTINCT drug) AS total_unique_drugs\nFROM prescriptions\nWHERE subject_id = 10007818\n  AND starttime >= '2023-07-01 00:00:00'\n  AND starttime < '2023-08-01 00:00:00';",
    "ba5d2c366e08023fec9bfbe5": "SELECT COUNT(DISTINCT drug) \nFROM prescriptions \nWHERE subject_id = 10000032 AND starttime >= DATE('now', '-10 month');",
    "5861ef095f4c08ad236ab8c5": "",
    "8db871c52022d633a9f58b11": "SELECT COUNT(DISTINCT drug) AS total_prescriptions\nFROM prescriptions\nWHERE subject_id = 10004720 AND starttime >= '2000-11-21';",
    "81a5e45699cfa054a335726f": "SELECT COUNT(DISTINCT drug) AS total_unique_drugs_prescribed\nFROM prescriptions\nWHERE subject_id = 10009628\n  AND starttime >= '2023-09-01 00:00:00'\n  AND starttime < '2023-10-01 00:00:00';",
    "99420e9ae112f93bdf6f421a": "SELECT COUNT(DISTINCT drug) AS number_of_unique_drugs_prescribed\nFROM prescriptions\nWHERE subject_id = 10021938 AND starttime >= DATE('now', '-2 months');",
    "b0c1e2c1046cc6dad14ddbe4": "selects from the `prescriptions` table, joining with the `patients` table on `subject_id`, and filters based on the specified drug name and patient subject ID.",
    "3290627f36487b94ca743ca3": "SELECT \n  COUNT(*) AS num_dextrose_prescriptions\nFROM \n  prescriptions\nWHERE \n  subject_id = 10018081 AND \n  starttime >= '2023-12-01' AND \n  starttime < DATE('2023-13-01') AND \n  drug = 'Dextrose 5%' AND \n  dose_unit_rx = '%';",
    "f737cdc1f727761a17f22b7d": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE p.subject_id = 10038081\nAND p.hadm_id = (\n    SELECT MIN(hadm_id) \n    FROM admissions \n    WHERE subject_id = 10038081\n)\nAND p.drug = 'Albumin 25% (12.5g/50ml)';",
    "0035d27329064c6e313badd1": "SELECT COUNT(*) \nFROM prescriptions \nWHERE subject_id = 10005348 \n  AND drug = 'milk of magnesia' \n  AND starttime BETWEEN '2023-09-01' AND '2023-09-30';",
    "75f2ab4d9c265d10a7c0876f": "SELECT COUNT(*) \nFROM prescriptions p\nWHERE p.drug = 'potassium chloride replacement (critical care and oncology)'\nAND p.subject_id = 10015272\nAND p.starttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59';",
    "76ddecbe56caba3073d76d2d": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'Levetiracetam Oral Solution (09/2100)' \nAND subject_id = 10038933;",
    "70280353be78e0850355e08c": "SELECT COUNT(*) \nFROM prescriptions p\nWHERE p.subject_id = 10016810 \nAND p.drug = 'FAMOTIDINE' \nAND p.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10016810 ORDER BY admittime DESC LIMIT 1);",
    "bca12dbeb197151809e62874": "SELECT COUNT(*) \nFROM labevents le \nINNER JOIN d_labitems di ON le.itemid = di.itemid \nWHERE le.subject_id = 10009628 AND di.label = 'AST';",
    "18804b0230296456eb7bf9f3": "",
    "e46aecc50872e5e43f5dec8b": "SELECT COUNT(*) AS count_of_lab_tests\nFROM labevents l\nJOIN d_labitems di ON l.itemid = di.itemid\nWHERE l.subject_id = 10038999 AND di.label = 'Lipase';",
    "da0d0d0112db58fa527f189f": "SELECT COUNT(*) \nFROM labevents AS T1 \nJOIN d_labitems AS T2 ON T1.itemid = T2.itemid \nWHERE T1.subject_id = 10015931 AND T2.label = 'osmolality, urine in 2100';",
    "6b5cff60f50561310ed8c3c2": "SELECT COUNT(*) AS total_lab_events\nFROM labevents\nWHERE subject_id = 10011398\n  AND charttime BETWEEN DATE('now', '-10 years') AND DATE('now')\n  AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Platelet Count');",
    "d535c91e21f7926fb37d3dd8": "SELECT COUNT(*) \nFROM labevents \nJOIN d_labitems ON labevents.itemid = d_labitems.itemid \nWHERE labevents.subject_id = 10018845 \n  AND d_labitems.label LIKE '%hemoglobin%' \n  AND labevents.charttime >= '2007-07-01 00:00:00';",
    "272b7419a6f4ac420aae5839": "SELECT COUNT(*) \nFROM labevents \nWHERE subject_id = 10002428 \n  AND charttime LIKE '%07/%/2023%' \n  AND itemid IN (SELECT itemid FROM d_labitems WHERE label LIKE '%bicarbonate%');",
    "f9e651bab94c8b0cbc349c8a": "SELECT COUNT(subject_id) AS current_patient_count\nFROM patients\nWHERE dod IS NULL;",
    "42133f6ce3b196288d44b9b7": "SELECT COUNT(*) \nFROM admissions \nWHERE dischtime IS NULL;",
    "822fb5a81c6aa96e17079981": "",
    "adeec8d4eea99ded1a136fb0": "SELECT COUNT(*) AS patient_count\nFROM patients;",
    "b4e5170ce76c3fd49390d922": "SELECT COUNT(*) AS total_current_patients\nFROM patients p\nWHERE strftime('%Y', 'now') - strftime('%Y', p.dob) BETWEEN 20 AND 29;",
    "b9dd758d1b4184744da4955b": "SELECT COUNT(*) AS total_patients_30s\nFROM patients\nWHERE \n    (strftime('%Y', 'now') - strftime('%Y', dob)) BETWEEN 30 AND 39\n    AND dod IS NULL;",
    "87df01ff8e5b34782b6f1bab": "SELECT COUNT(*) \nFROM patients \nWHERE dod IS NULL AND (strftime('%Y', 'now') - strftime('%Y', dob)) BETWEEN 40 AND 49;",
    "29c1d5e3303ae477c836d0a2": "SELECT COUNT(*) \nFROM patients \nWHERE (julianday('now') - julianday(dob)) / 365.25 BETWEEN 30 AND 39 \n  AND dod IS NULL;",
    "87157dc1a0c697225e9e5356": "",
    "466f29187cd0639b0ab5a25c": "SELECT COUNT(*) AS total_current_patients\nFROM patients\nWHERE (julianday('now') - julianday(dob)) / 365 BETWEEN 40 AND 49;",
    "1408ef03b015c82da341f94f": "",
    "06766659b8f16c2233c677bd": "SELECT \n  CAST(SUM(CASE WHEN p.dod > DATE(a.admittime, '+6 months') THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(p.subject_id) AS survival_rate\nFROM \n  patients p\nINNER JOIN \n  admissions a ON p.subject_id = a.subject_id\nINNER JOIN \n  microbiologyevents m ON a.hadm_id = m.hadm_id\nINNER JOIN \n  prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE \n  m.test_name = 'Microscopic Hematuria' \n  AND pr.drug = 'Phytonadione';",
    "84cb84cd44b575f06211c452": "",
    "6292671bc40ee6988cb71e1f": "WITH PatientData AS (\n    SELECT\n        p.subject_id,\n        a.hadm_id,\n        d.icd_code,\n        pr.drug,\n        pr.starttime AS treatment_starttime\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n    JOIN procedures_icd p_icd ON a.hadm_id = p_icd.hadm_id\n    JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\n    WHERE d.icd_code = 'F29'\n    AND pr.drug = 'alteplase'\n)\nSELECT\n    CAST(SUM(CASE WHEN julianday(p.dod) - julianday(a.admittime) <= 90 THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) AS survival_rate\nFROM PatientData pd\nJOIN admissions a ON pd.hadm_id = a.hadm_id\nJOIN patients p ON pd.subject_id = p.subject_id\nWHERE julianday(a.admittime) - julianday(pd.treatment_starttime) <= 14;",
    "0c87ffd881def44ba1a584a4": "SELECT \n    (SUM(CASE WHEN p.dod IS NOT NULL THEN 1 ELSE 0 END) * 1.0 / COUNT(p.subject_id)) AS six_month_survival_rate\nFROM \n    patients p\nJOIN \n    diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id AND d.hadm_id = pr.hadm_id\nJOIN \n    microbiologyevents m ON p.subject_id = m.subject_id AND d.hadm_id = m.hadm_id\nWHERE \n    d.icd_code = 'J18.1' AND \n    pr.drug = 'insulin' AND \n    pr.starttime > d.charttime AND \n    m.spec_type_desc = 'Klebsiella pneumoniae';",
    "67fe7f95e308db2d9fe6ec8f": "SELECT \n    CAST(SUM(CASE \n        WHEN julianday(p.dod) - julianday(p.dob) >= 180 THEN 1 \n        ELSE 0 \n    END) AS REAL) / COUNT(*) AS survival_rate\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE d.icd_code = 'F04.1' AND pr.drug = 'glycerin supps';",
    "f92a0c61488b57aa3f7e3ab1": "SELECT \n  CAST(SUM(CASE \n            WHEN julianday(p.dod) - julianday(di.charttime) <= 90 THEN 1\n            ELSE 0 \n          END) AS REAL) * 100 / COUNT(p.row_id) AS survival_rate\nFROM \n  patients p\n  INNER JOIN diagnoses_icd di ON p.subject_id = di.subject_id\n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  di.icd_code = 'R19' \n  AND pr.drug = 'Rifaximin';",
    "6db6baede71203bbf3781655": "",
    "bb7f918822ae905cff9cc39e": "WITH MortalityIn3Months AS (\n  SELECT a.subject_id, a.hadm_id\n  FROM admissions a\n  JOIN patients p ON a.subject_id = p.subject_id\n  WHERE p.dod IS NOT NULL AND \n        julianday(p.dod) - julianday(a.admittime) <= 90\n),\nDiagnosesIn3Months AS (\n  SELECT d.subject_id, d.hadm_id, d.icd_code\n  FROM diagnoses_icd d\n  JOIN MortalityIn3Months m ON d.subject_id = m.subject_id AND d.hadm_id = m.hadm_id\n)\nSELECT icd_code, COUNT(*) AS count\nFROM DiagnosesIn3Months\nGROUP BY icd_code\nORDER BY count DESC\nLIMIT 4;",
    "808dfe41dea511c9420e7b88": "WITH DiagnosisMortality AS (\n    SELECT\n        d.icd_code,\n        COUNT(CASE WHEN julianday(p.dod) - julianday(a.admittime) <= 183 THEN 1 END) AS six_month_mortality,\n        COUNT(*) AS total_patients\n    FROM diagnoses_icd d\n    JOIN admissions a ON d.hadm_id = a.hadm_id\n    JOIN patients p ON a.subject_id = p.subject_id\n    GROUP BY d.icd_code\n),\nMortalityRate AS (\n    SELECT\n        icd_code,\n        CAST(six_month_mortality AS REAL) * 100 / total_patients AS mortality_rate\n    FROM DiagnosisMortality\n)\nSELECT\n    icd_code,\n    mortality_rate\nFROM MortalityRate\nORDER BY mortality_rate DESC\nLIMIT 5;",
    "7cc086ff238e8366912ab6a9": "SELECT \n  T2.icd_code, \n  COUNT(T2.icd_code) AS diagnosis_count\nFROM \n  admissions AS T1\nINNER JOIN \n  diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n  patients AS T3 ON T1.subject_id = T3.subject_id\nWHERE \n  T3.dod IS NOT NULL \n  AND (JULIANDAY(T3.dod) - JULIANDAY(T1.admittime)) <= 180\nGROUP BY \n  T2.icd_code\nORDER BY \n  diagnosis_count DESC\nLIMIT 4;",
    "66e468b8ba6fe6d332363ba2": "SELECT \n  d.long_title, \n  COUNT(p.subject_id) AS mortality_count\nFROM \n  patients p\n  INNER JOIN diagnoses_icd icd ON p.subject_id = icd.subject_id\n  INNER JOIN d_icd_diagnoses d ON icd.icd_code = d.icd_code\nWHERE \n  p.dod IS NOT NULL \n  AND p.dod <= DATE('now', '+3 months') \nGROUP BY \n  d.long_title\nORDER BY \n  mortality_count DESC\nLIMIT 3;",
    "561a6f6df9ce2b72802718f6": "WITH DiagnosisMortalityCTE AS (\n    SELECT \n        d.icd_code,\n        SUM(CASE WHEN p.dod IS NOT NULL AND p.dod <= DATE(a.admittime, '+3 months') THEN 1 ELSE 0 END) AS deceased_count,\n        SUM(CASE WHEN p.dod IS NOT NULL THEN 1 ELSE 0 END) AS total_deceased,\n        COUNT(p.row_id) AS total_patients\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        admissions a ON d.hadm_id = a.hadm_id\n    INNER JOIN \n        patients p ON a.subject_id = p.subject_id\n    GROUP BY \n        d.icd_code\n),\nTopDiagnosisMortalityCTE AS (\n    SELECT \n        icd_code,\n        CAST(deceased_count AS REAL) / total_patients AS mortality_rate\n    FROM \n        DiagnosisMortalityCTE\n)\nSELECT \n    icd_code,\n    mortality_rate\nFROM \n    TopDiagnosisMortalityCTE\nORDER BY \n    mortality_rate DESC\nLIMIT 3;",
    "4b624ad8a3b82ed7e3e29dc3": "WITH \n\n-- Calculate the duration of stay for each admission\nStayDuration AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        julianday(dischtime) - julianday(admittime) AS duration\n    FROM admissions\n),\n\n-- Filter admissions where the patient died within 6 months\nSixMonthMortality AS (\n    SELECT \n        sd.subject_id,\n        sd.hadm_id\n    FROM StayDuration sd\n    INNER JOIN admissions a ON sd.subject_id = a.subject_id AND sd.hadm_id = a.hadm_id\n    WHERE sd.duration <= 180 AND a.dod IS NOT NULL\n),\n\n-- Join diagnoses with admissions to get diagnoses for patients who died in 6 months\nDiagnosesForSixMonthMortality AS (\n    SELECT \n        dicd.icd_code,\n        dicd.long_title AS diagnosis\n    FROM diagnoses_icd di\n    INNER JOIN SixMonthMortality smm ON di.subject_id = smm.subject_id AND di.hadm_id = smm.hadm_id\n    INNER JOIN d_icd_diagnoses dicd ON di.icd_code = dicd.icd_code\n)\n\n-- Count diagnoses and get the top 3\nSELECT \n    diagnosis,\n    COUNT(*) AS count\nFROM DiagnosesForSixMonthMortality\nGROUP BY diagnosis\nORDER BY count DESC\nLIMIT 3;",
    "33531c8f62b92bd9245b9217": "WITH DiagnosisMortality AS (\n    SELECT \n        d.icd_code,\n        COUNT(p.row_id) AS total_patients,\n        SUM(CASE WHEN (julianday(p.dod) - julianday(adm.admittime)) <= 180 THEN 1 ELSE 0 END) AS mortality_count\n    FROM diagnoses_icd d\n    JOIN admissions adm ON d.hadm_id = adm.hadm_id\n    JOIN patients p ON adm.subject_id = p.subject_id\n    GROUP BY d.icd_code\n),\nMortalityRate AS (\n    SELECT \n        icd_code,\n        total_patients,\n        mortality_count,\n        (mortality_count * 1.0 / total_patients) AS six_month_mortality_rate\n    FROM DiagnosisMortality\n)\nSELECT \n    icd_code,\n    six_month_mortality_rate\nFROM MortalityRate\nORDER BY six_month_mortality_rate DESC\nLIMIT 4;",
    "18df7b68a00300388686a82b": "SELECT \n    MAX(t2.cost) AS max_total_cost\nFROM \n    admissions t1\nJOIN \n    cost t2 ON t1.hadm_id = t2.hadm_id\nJOIN \n    procedures_icd t3 ON t1.hadm_id = t3.hadm_id\nJOIN \n    d_icd_procedures t4 ON t3.icd_code = t4.icd_code\nWHERE \n    t4.long_title = 'Extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic'\n    AND strftime('%Y', t1.admittime) = strftime('%Y', 'now');",
    "c818322213949df55b14a582": "",
    "719bc524af77a513ee6e0aa0": "SELECT MAX(total_cost) AS max_total_cost\nFROM (\n  SELECT SUM(c.cost) AS total_cost\n  FROM cost c\n  JOIN procedures_icd p ON c.event_id = p.row_id\n  WHERE p.icd_code = '00.03'\n  GROUP BY c.subject_id\n) subquery;",
    "37edc3b1fd1e40d2f63d5c01": "SELECT \n  AVG(c.cost) AS average_cost\nFROM \n  cost c\n  INNER JOIN labevents l ON c.event_id = l.row_id\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\nWHERE \n  d.label = 'Other laparoscopic umbilical herniorrhaphy' AND c.event_type = 'Procedure';",
    "29fabfc4794a216ba5bf1993": "",
    "778832d66a9a3b3ebeb51d39": "SELECT AVG(T1.cost) AS average_cost\nFROM cost AS T1\nINNER JOIN procedures_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title = 'Extirpation of matter from lung lingula, via natural or artificial opening endoscopic';",
    "7bc94deacf6c02cba88f38e5": "SELECT AVG(T1.cost) AS average_cost\nFROM cost AS T1\nINNER JOIN procedures_icd AS T2 ON T1.event_id = T2.row_id\nINNER JOIN d_icd_procedures AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title LIKE '%other bronchoscopy in 2100%';",
    "5dc4ad2f2838085f7c4b9af3": "",
    "e684deacbe9f8050fb9c2537": "SELECT MIN(T3.cost) AS minimum_total_bill\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nINNER JOIN cost AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE T2.label = 'Creatine kinase (CK) test';",
    "d91ba5c2ed88034e0a2b3870": "WITH glucose_and_pleural_tests AS (\n  SELECT\n    l.subject_id,\n    l.hadm_id,\n    SUM(c.cost) AS total_cost\n  FROM\n    labevents l\n  JOIN\n    cost c ON l.hadm_id = c.hadm_id AND l.subject_id = c.subject_id\n  WHERE\n    l.itemid IN (\n      SELECT itemid FROM d_labitems WHERE label LIKE '%glucose%'\n    )\n    OR l.itemid IN (\n      SELECT itemid FROM d_labitems WHERE label LIKE '%pleural%'\n    )\n  GROUP BY\n    l.subject_id, l.hadm_id\n)\nSELECT\n  MAX(total_cost) AS max_total_cost\nFROM\n  glucose_and_pleural_tests;",
    "f25934f599ad692e3d1cd779": "SELECT MIN(tot.cost) AS min_total_cost\nFROM (\n  SELECT \n    c.subject_id, \n    SUM(c.cost) AS tot_cost\n  FROM \n    cost c\n  WHERE \n    c.event_type = 'Lab'\n    AND c.chargetime >= DATE('now', '-1 year')\n    AND c.event_id IN (\n      SELECT \n        l.row_id \n      FROM \n        labevents l\n      JOIN \n        d_labitems d ON l.itemid = d.itemid\n      WHERE \n        d.label = '% hemoglobin a1c'\n    )\n  GROUP BY \n    c.subject_id\n) tot;",
    "8a678e5db3bbbe38b320aa96": "SELECT \n    MAX(c.cost) AS max_cost\nFROM \n    cost c\nINNER JOIN \n    labevents l ON c.event_id = l.row_id\nINNER JOIN \n    d_labitems d ON l.itemid = d.itemid\nWHERE \n    l.charttime >= '2100-01-01' AND \n    (d.label LIKE '%lactate dehydrogenase%' OR d.label LIKE '%pleural%');",
    "688e0f542dd5995fefbabee6": "SELECT MIN(total_bill) AS min_total_bill\nFROM (\n  SELECT SUM(c.cost) AS total_bill\n  FROM cost c\n  INNER JOIN labevents l ON c.event_id = l.row_id\n  INNER JOIN d_labitems dl ON l.itemid = dl.itemid\n  WHERE dl.label LIKE '%Lipase%'\n  GROUP BY c.hadm_id\n) AS subquery;",
    "8b08fcfc0a63eadbb17b7167": "SELECT MIN(T1.cost) AS minimum_total_cost\nFROM cost AS T1\nINNER JOIN labevents AS T2 ON T1.event_id = T2.row_id\nWHERE T2.itemid IN (\n    SELECT itemid\n    FROM d_labitems\n    WHERE label LIKE '%hyaline casts%'\n) AND strftime('%Y', T2.charttime) = strftime('%Y', 'now');",
    "b0ded0fa2296a8f7a4d0926b": "",
    "ee519753d2c9f939d5fb4219": "SELECT AVG(T1.cost) AS average_cost\nFROM cost AS T1\nINNER JOIN prescriptions AS T2 ON T1.event_id = T2.row_id\nWHERE T2.drug = 'neomycin-polymyxin-bacitracin';",
    "3017014a16809262a247bee7": "SELECT AVG(total_cost) AS average_total_cost\nFROM (\n    SELECT SUM(T1.cost) AS total_cost\n    FROM cost AS T1\n    INNER JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\n    WHERE T2.drug LIKE '%phenazopyridine%' AND T1.chargetime >= DATE('now', 'start of year')\n    GROUP BY T1.hadm_id\n) AS T;",
    "6b5d224a0e7421bcf92afd3c": "SELECT MAX(total_cost) AS max_total_cost\nFROM (\n    SELECT SUM(c.cost) AS total_cost\n    FROM cost c\n    INNER JOIN prescriptions p ON c.subject_id = p.subject_id AND c.hadm_id = p.hadm_id\n    WHERE p.drug = 'carvedilol' AND p.dose_val_rx = '2100'\n    GROUP BY c.subject_id, c.hadm_id\n) AS subquery;",
    "a1e65b03fe2b7016b885dc09": "SELECT MIN(T1.cost) AS min_cost\nFROM cost AS T1\nJOIN prescriptions AS T2 ON T1.event_id = T2.row_id\nWHERE T2.drug = 'nicotine patch' AND T1.chargetime >= '2100-01-01';",
    "a1070d070dd65690e308619d": "SELECT MIN(total_cost) AS minimum_total_cost\nFROM (\n  SELECT SUM(c.cost) AS total_cost\n  FROM prescriptions p\n  INNER JOIN cost c ON p.hadm_id = c.hadm_id\n  WHERE p.drug = 'ezetimibe'\n  GROUP BY p.hadm_id\n) AS subquery;",
    "064647795088c18c2eea104a": "SELECT MAX(T2.cost) AS max_total_cost\nFROM prescriptions AS T1\nINNER JOIN cost AS T2\nON T1.hadm_id = T2.hadm_id\nWHERE T1.drug LIKE '%vial%' AND T2.event_type = 'Medication' AND T2.chargetime LIKE '2100%';",
    "e2dee747281ae9a00c1fc13f": "SELECT MAX(total_cost) AS max_total_cost\nFROM (\n  SELECT \n    c.subject_id, \n    c.hadm_id, \n    SUM(c.cost) AS total_cost\n  FROM \n    cost c\n  INNER JOIN \n    diagnoses_icd di ON c.hadm_id = di.hadm_id AND c.subject_id = di.subject_id\n  INNER JOIN \n    d_icd_diagnoses did ON di.icd_code = did.icd_code\n  WHERE \n    did.long_title LIKE '%Esophageal Obstruction%'\n  GROUP BY \n    c.subject_id, c.hadm_id\n) AS subquery;",
    "86af6dbec3fe033cc1dee870": "SELECT MAX(cost.total_cost) AS max_total_cost\nFROM (\n  SELECT c.subject_id, SUM(c.cost) AS total_cost\n  FROM cost c\n  JOIN procedures_icd p ON c.event_id = p.row_id\n  JOIN d_icd_procedures di ON p.icd_code = di.icd_code\n  WHERE di.long_title LIKE '%Pneumothorax%'\n  AND c.event_type = 'postprocedure'\n  AND c.chargetime LIKE '%2100%'\n  GROUP BY c.subject_id\n) AS cost;",
    "416f64511f06e29fd379a373": "",
    "40314c9ace9e04fb7834c2b1": "SELECT MIN(T2.cost) AS min_total_cost\nFROM diagnoses_icd AS T1\nINNER JOIN cost AS T2 ON T1.row_id = T2.event_id\nWHERE T1.icd_code = 'I63.1' AND T2.event_type = 'Diagnosis';",
    "fd9d2ad9b857f9d53588d882": "SELECT AVG(T1.cost) AS average_total_cost\nFROM cost AS T1\nWHERE T1.event_type = 'Total hospital cost';",
    "ecd19094660d16b8b750e976": "SELECT MAX(total_cost) AS max_total_cost\nFROM (\n    SELECT \n        a.hadm_id,\n        SUM(c.cost) AS total_cost\n    FROM \n        admissions a\n        JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n        JOIN cost c ON a.hadm_id = c.hadm_id\n    WHERE \n        di.icd_code IN ('I13', 'I13.0', 'I13.1', 'I13.2', 'I13.3', 'I13.4', 'I13.5', 'I13.6', 'I13.7', 'I13.8', 'I13.9')\n    GROUP BY \n        a.hadm_id\n) AS admission_costs;",
    "1d487033ea60fadd114b1b53": "SELECT MAX(total_cost) AS max_total_cost\nFROM (\n    SELECT SUM(c.cost) AS total_cost\n    FROM admissions a\n    JOIN diagnoses_icd d ON a.subject_id = d.subject_id AND a.hadm_id = d.hadm_id\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    JOIN cost c ON a.subject_id = c.subject_id AND a.hadm_id = c.hadm_id\n    WHERE dd.long_title LIKE '%closed fracture of two ribs%'\n      AND a.dischtime >= '2021-01-01'\n    GROUP BY a.subject_id, a.hadm_id\n) AS subquery;",
    "93102b4334928d2d31c801fb": "",
    "0d43d9237d6c0f97e565e463": "SELECT \n  STRFTIME('%Y-%m', p.dob) AS month_of_birth,\n  COUNT(*) AS monthly_records\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses i ON d.icd_code = i.icd_code\nWHERE i.long_title LIKE '%Other reconstructive surgery%'\n  AND i.long_title LIKE '%Abnormal reaction of the patient%'\n  AND i.long_title LIKE '%Later complication%'\n  AND i.long_title NOT LIKE '%misadventure%'\n  AND STRFTIME('%Y', a.admittime) = '2100'\nGROUP BY month_of_birth\nORDER BY monthly_records DESC\nLIMIT 1;",
    "e2beb6df478d6979ad0aa648": "SELECT \n    MAX(monthly_count) AS max_monthly_count\nFROM (\n    SELECT \n        strftime('%Y-%m', d.charttime) AS month,\n        COUNT(*) AS monthly_count\n    FROM \n        diagnoses_icd d\n    WHERE \n        d.icd_code = 'M10.0'\n    GROUP BY \n        strftime('%Y-%m', d.charttime)\n);",
    "1cb58d36d8c6b931e631e3da": "SELECT \n    MIN(yearly_patient_count) AS min_yearly_patient_count\nFROM (\n    SELECT \n        strftime('%Y', d.charttime) AS year,\n        COUNT(*) AS yearly_patient_count\n    FROM diagnoses_icd d\n    JOIN d_icd_diagnoses icd ON d.icd_code = icd.icd_code\n    WHERE icd.long_title = 'Unspecified vascular insufficiency of intestine'\n        AND d.charttime >= '2100-01-01'\n    GROUP BY strftime('%Y', d.charttime)\n) AS yearly_counts;",
    "96da08df43f14b5424aed61f": "SELECT AVG(total_admissions) AS average_daily_admissions\nFROM (\n    SELECT COUNT(*) AS total_admissions\n    FROM admissions AS a\n    INNER JOIN diagnoses_icd AS d ON a.hadm_id = d.hadm_id\n    WHERE d.icd_code = 'I50.01' AND strftime('%Y', a.admittime) = '2100'\n    GROUP BY strftime('%Y-%m-%d', a.admittime)\n) AS daily_admissions;",
    "799182af909a63e2da1ddacf": "SELECT \n  MIN(monthly_count) AS min_monthly_count\nFROM (\n  SELECT \n    STRFTIME('%Y-%m', starttime) AS month,\n    COUNT(DISTINCT subject_id) AS monthly_count\n  FROM \n    prescriptions\n  WHERE \n    drug = 'Insulin'\n  GROUP BY \n    STRFTIME('%Y-%m', starttime)\n) AS monthly_counts;",
    "b720f1ba67b87fd98f11e04c": "SELECT \n    strftime('%Y-%m', charttime) AS month, \n    AVG(CASE \n        WHEN valuenum BETWEEN 38.0 AND 38.9 THEN valuenum \n        ELSE NULL \n    END) AS avg_bmi\nFROM \n    chartevents\nWHERE \n    itemid IN (SELECT itemid FROM d_items WHERE label LIKE '%bmi%')\nGROUP BY \n    month\nHAVING \n    COUNT(*) > 0;",
    "278f3690974261bfe1e57d23": "SELECT COUNT(*) AS discharged_patient_count\nFROM patients\nWHERE dob >= DATE('now', '-1 year');",
    "4c6b438bb57ca0920edd4e9c": "SELECT COUNT(*) \nFROM admissions \nWHERE discharge_location = 'Discharged to Home' AND strftime('%Y', dischtime) = '2100';",
    "8ba9ec982c184a417b8e5f83": "SELECT \n    COUNT(*) AS total_released\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nWHERE \n    p.dod IS NOT NULL\n    AND strftime('%Y', a.dischtime) = strftime('%Y', 'now');",
    "ebd67617c22beab016550006": "select the correct tables and columns. The question asks for the count of patients discharged from the hospital within the last year.",
    "199488cf0d6a538d41fdc01b": "SELECT \n  COUNT(*) AS discharged_count \nFROM \n  admissions \nWHERE \n  strftime('%Y', dischtime) = '2100';",
    "6b1fd8208b249c9a3f399917": "SELECT COUNT(*) AS discharged_patients\nFROM admissions\nWHERE STRFTIME('%Y', dischtime) = STRFTIME('%Y', 'now');",
    "f92a9715af7d181a656d4998": "SELECT COUNT(*) AS discharged_last_year\nFROM admissions\nWHERE dischtime >= DATE('now', '-1 year');",
    "521aab3060d8c38e0cfbfa52": "SELECT COUNT(*) \nFROM icustays \nWHERE first_careunit IN ('MICU', 'SICU') \nAND intime >= DATE('now', 'start of year');",
    "2d8946a73f748f86fc32345c": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN icustays i ON p.subject_id = i.subject_id\nWHERE i.first_careunit = 'vascular'\nAND i.intime >= DATE('now', '-1 year');",
    "b593bfbb3c11df43f547bfcc": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.admittime >= DATE('now', '-1 year')\nAND a.admission_location IN ('Medicine/Cardiology', 'Cardiology');",
    "8ba1b2de9452cc1d23057b9f": "SELECT COUNT(*) AS num_patients\nFROM icustays\nWHERE first_careunit = 'neuro sicu' AND intime >= DATE('now', '-1 year');",
    "a85685397831a790ea2cc0a7": "SELECT COUNT(*) AS patient_count\nFROM admissions\nWHERE admission_location = 'Med/Surg/GYN'\nAND admittime >= '2100-01-01';",
    "04ceafe43c52472b3acaedb4": "",
    "775f200f8927ed7b82f10ff9": "",
    "97d71a4dfbda63c1b6544be6": "SELECT \n    COUNT(DISTINCT p.subject_id) AS total_patients\nFROM \n    patients p\nJOIN \n    diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN \n    d_icd_diagnoses did ON d.icd_code = did.icd_code\nJOIN \n    admissions a ON p.subject_id = a.subject_id\nWHERE \n    did.long_title = 'Multiple fractures of ribs, left side, initial encounter for closed fracture in 2100'\n    AND EXISTS (\n        SELECT 1\n        FROM diagnoses_icd di\n        JOIN d_icd_diagnoses didi ON di.icd_code = didi.icd_code\n        WHERE di.subject_id = p.subject_id\n        AND didi.long_title = 'Patient room in hospital, place of occurrence of the external cause'\n        AND a.admittime BETWEEN di.charttime AND DATE(di.charttime, '+2 months')\n    );",
    "72392c4da0fd16d899e4307e": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d1 ON p.subject_id = d1.subject_id\nJOIN diagnoses_icd d2 ON p.subject_id = d2.subject_id AND d1.hadm_id = d2.hadm_id\nJOIN d_icd_diagnoses did1 ON d1.icd_code = did1.icd_code\nJOIN d_icd_diagnoses did2 ON d2.icd_code = did2.icd_code\nWHERE did1.icd_code = 'F31.0'\n  AND did2.icd_code = 'E70.9'\n  AND EXISTS (\n    SELECT 1\n    FROM diagnoses_icd d3\n    JOIN d_icd_diagnoses did3 ON d3.icd_code = did3.icd_code\n    WHERE d3.subject_id = p.subject_id\n      AND d3.hadm_id = d1.hadm_id\n      AND did3.icd_code IN ('F31.0', 'F31.1', 'F31.2', 'F31.3', 'F31.4', 'F31.5', 'F31.8', 'F31.9')\n  );",
    "ddee5ac733d7dabd9130af5c": "SELECT \n  COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses d1 ON d.icd_code = d1.icd_code\nINNER JOIN diagnoses_icd d2 ON a.hadm_id = d2.hadm_id\nINNER JOIN d_icd_diagnoses d3 ON d2.icd_code = d3.icd_code\nWHERE d1.icd_code = 'I85.1' \n  AND d3.icd_code = 'K70' \n  AND d1.icd_code != d3.icd_code;",
    "d81467bbe205d33ca94ef61f": "SELECT COUNT(*) AS num_diagnoses\nFROM diagnoses_icd di1\nJOIN diagnoses_icd di2 ON di1.subject_id = di2.subject_id AND di1.hadm_id = di2.hadm_id\nWHERE di1.icd_code = 'K51' -- Diarrhea\n  AND di2.icd_code = 'F10' -- Tobacco Use Disorder\n  AND di1.charttime > di2.charttime\n  AND di1.charttime LIKE '2100%';",
    "43c158cb01b2f2079157b719": "WITH FeverDiagnoses AS (\n    SELECT d.subject_id, d.charttime AS fever_charttime\n    FROM diagnoses_icd d\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Postprocedural fever'\n    AND d.charttime >= '2100-01-01'\n),\nValveDiagnoses AS (\n    SELECT d.subject_id, d.charttime AS valve_charttime\n    FROM diagnoses_icd d\n    JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE dd.long_title = 'Aortic valve disorders'\n    AND d.charttime >= '2100-01-01'\n),\nDiagnosisPairs AS (\n    SELECT f.subject_id, f.fever_charttime, v.valve_charttime\n    FROM FeverDiagnoses f\n    JOIN ValveDiagnoses v ON f.subject_id = v.subject_id\n    WHERE strftime('%Y-%m', f.fever_charttime) < strftime('%Y-%m', v.valve_charttime)\n)\nSELECT COUNT(DISTINCT subject_id) AS patient_count\nFROM (\n    SELECT subject_id, fever_charttime, valve_charttime,\n    ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY fever_charttime) as fever_rank,\n    ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY valve_charttime) as valve_rank\n    FROM DiagnosisPairs\n) AS ranked_diagnoses\nWHERE fever_rank + 1 = valve_rank;",
    "3e9064d2108a3ee8c6ae4ee2": "",
    "f87b894e8644d660bf3e856f": "SELECT COUNT(*) AS patient_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses dicd ON di.icd_code = dicd.icd_code\nJOIN admissions a ON di.hadm_id = a.hadm_id\nWHERE dicd.long_title = 'Collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture in 2100'\nAND a.admission_location = 'Patient Room'\nAND di.charttime BETWEEN a.admittime AND a.dischtime;",
    "dd686405621c04ac8522072e": "SELECT COUNT(*) AS count_of_people\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title LIKE '%mitral valve disorders%'\nAND diagnoses_icd.subject_id IN (\n    SELECT subject_id \n    FROM patients \n    WHERE dob >= '2100-01-01' AND dod <= '2100-12-31'\n);",
    "81a0501d514e4a4fa8672c08": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN diagnoses_icd d ON p.subject_id = d.subject_id \nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code \nWHERE dd.long_title LIKE '%BMI 19-24%' \nAND d.charttime >= '2100-01-01';",
    "9e655b0885b1141a8fcb1bb1": "SELECT COUNT(*) AS total_patients\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title = 'Major depressive disorder, single episode, unspecified (ICD-10: 210.0)';",
    "e843bc5ff21d749a06ab5bc3": "SELECT COUNT(DISTINCT t1.subject_id) \nFROM diagnoses_icd AS t1 \nWHERE t1.icd_code = 'M40.03' \nAND STRFTIME('%Y', t1.charttime) = '2100';",
    "6708f1fa7b82536c05febcef": "SELECT COUNT(DISTINCT T1.subject_id) AS diagnosis_count\nFROM diagnoses_icd AS T1\nJOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nWHERE T2.long_title = 'Acute edema of lung, unspecified';",
    "6d5bb8b2a694bc9e91caea13": "SELECT COUNT(DISTINCT d.subject_id) \nFROM diagnoses_icd d\nJOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\nWHERE di.long_title = 'Acute venous embolism and thrombosis of subclavian veins'\nAND d.charttime > DATE('now', '-1 year');",
    "9b08cb9ac92f27049de294fd": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN diagnoses_icd di ON p.subject_id = di.subject_id\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title LIKE '%hemiplegia and hemiparesis%'\nAND d_icd_diagnoses.icd_code = 'I63.%'  -- Assuming 'I63.%' is the relevant code for cerebral infarction affecting left non-dominant side\nAND di.charttime >= '2100-01-01';",
    "a2af82429c00976d404b6e5d": "SELECT \n  p.subject_id,\n  SUM(CASE WHEN d.long_title LIKE '%open cecectomy%' THEN 1 ELSE 0 END) AS open_cecectomy_procedures,\n  SUM(CASE WHEN d.long_title LIKE '%other cecectomy%' THEN 1 ELSE 0 END) AS other_cecectomy_procedures\nFROM \n  patients p\nJOIN \n  procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN \n  d_icd_procedures d ON pr.icd_code = d.icd_code\nGROUP BY \n  p.subject_id;",
    "d09c79e777148f87f0c15c92": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title = 'Other electroshock therapy treatment (C04.7)'\n  AND strftime('%Y', pr.charttime) = '2100';",
    "c7bc7892dca1cc286f05887f": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM procedures_icd AS pr\nJOIN d_icd_procedures AS d ON pr.icd_code = d.icd_code\nJOIN admissions AS a ON pr.hadm_id = a.hadm_id\nJOIN patients AS p ON a.subject_id = p.subject_id\nWHERE d.long_title LIKE '%Other Incision of Brain%'\nAND strftime('%Y', a.admittime) = strftime('%Y', 'now');",
    "3fa5e54471bc2eac34ec48ed": "SELECT COUNT(*) AS num_patients\nFROM diagnoses_icd\nJOIN d_icd_diagnoses ON diagnoses_icd.icd_code = d_icd_diagnoses.icd_code\nWHERE d_icd_diagnoses.long_title = 'Destruction of left main bronchus, via natural or artificial opening endoscopic procedure';",
    "ea784a4b3ba382dd3a8dca8e": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE pr.icd_code LIKE '86%';",
    "e39e837fb8cffe6bbe93bb60": "SELECT COUNT(*) AS bypass_coronary_artery_count\nFROM procedures_icd AS p\nJOIN d_icd_procedures AS d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Bypass coronary artery, one artery from aorta with autologous venous tissue, open approach';",
    "a8a7ae0b4b0cdddab9d4616d": "SELECT COUNT(*) AS patient_count\nFROM procedures_icd picd\nJOIN d_icd_procedures dip ON picd.icd_code = dip.icd_code\nWHERE dip.long_title = 'Excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure'\nAND picd.charttime LIKE '%2100%';",
    "af72aeed0e5cc61f2a10a8ed": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pi ON a.hadm_id = pi.hadm_id\nJOIN d_icd_procedures d ON pi.icd_code = d.icd_code\nWHERE d.long_title = 'Insertion of infusion device into right atrium, percutaneous approach'\n  AND pi.charttime >= '2100-01-01'\nGROUP BY p.subject_id\nHAVING COUNT(pi.row_id) >= 2;",
    "225970019a185c7b566265ff": "SELECT COUNT(*) \nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE d.long_title = 'Excision of dental lesion of jaw, 2'\n  AND p.charttime >= DATE('now', 'start of year');",
    "a51c8d210fb99892e9c4157c": "SELECT COUNT(T1.subject_id) AS total_patients\nFROM (\n  SELECT T1.subject_id\n  FROM procedures_icd AS T1\n  INNER JOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\n  WHERE T2.long_title = 'Angiocardiography of left heart structures'\n    AND T1.charttime >= date('now', '-1 year')\n  GROUP BY T1.subject_id\n  HAVING COUNT(T1.row_id) = 2\n) AS T1;",
    "4f58f3a3dafa1f8cd4ff29a8": "",
    "3b064609e2c9c1d5192c303d": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title = 'Other Computer Assisted Surgery'\n  AND pr.charttime >= DATE('now', '-1 year')\nGROUP BY p.subject_id\nHAVING COUNT(pr.row_id) = 2;",
    "3984301a9bd8a75a815b502a": "SELECT COUNT(T1.subject_id)\nFROM procedures_icd AS T1\nJOIN d_icd_procedures AS T2 ON T1.icd_code = T2.icd_code\nWHERE T2.long_title LIKE '%excision of dental lesion of jaw%'\n  AND T1.charttime >= '2100-01-01'\nGROUP BY T1.subject_id\nHAVING COUNT(T1.subject_id) >= 2;",
    "3ee1fa015c88d17b50ff62cb": "SELECT COUNT(p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN procedures_icd pr ON a.hadm_id = pr.hadm_id\nJOIN d_icd_procedures icd ON pr.icd_code = icd.icd_code\nWHERE icd.long_title = 'Endoscopic Control of Gastric or Duodenal Bleeding'\n  AND a.admittime BETWEEN DATE('now', '-1 year') AND DATE('now')\nGROUP BY p.subject_id\nHAVING COUNT(pr.row_id) = 2;",
    "68483e4f1201b049144af718": "",
    "1773166323d7822bd908fecf": "SELECT COUNT(DISTINCT T1.subject_id) AS patient_count\nFROM diagnoses_icd T1\nINNER JOIN procedures_icd T2 \n  ON T1.subject_id = T2.subject_id \n  AND T1.hadm_id = T2.hadm_id\nWHERE T1.icd_code = 'R13.4' -- Diagnosis code for \"Other postprocedural shock, initial encounter\"\n  AND T2.icd_code = '40.5' -- Procedure code for \"Drainage of peritoneal cavity, percutaneous approach\";",
    "942ff36dd9b2fbe79fa75553": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd di ON p.subject_id = di.subject_id\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id AND di.hadm_id = pr.hadm_id\nWHERE di.icd_code = 'S16.1' \nAND pr.icd_code = 'Q50.0'\nAND pr.charttime > di.charttime\nAND EXISTS (\n    SELECT 1\n    FROM procedures_icd pr2\n    WHERE pr2.subject_id = pr.subject_id\n    AND pr2.hadm_id = pr.hadm_id\n    AND pr2.icd_code = 'Q50.0'\n    AND pr2.charttime > pr.charttime\n    AND julianday(pr2.charttime) - julianday(pr.charttime) >= 96\n);",
    "90b0586c4e17390d3684288d": "SELECT \n  COUNT(*) AS count\nFROM \n  patients p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  INNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n  INNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\n  INNER JOIN d_icd_procedures pr2 ON pr.icd_code = pr2.icd_code\nWHERE \n  d2.icd_code = 'N18.5' \n  AND pr2.icd_code = 'R09.1' \n  AND d.charttime BETWEEN DATE('now', '-1 year') AND DATE('now')\n  AND pr.charttime BETWEEN DATE('now', '-1 year') AND DATE('now')\n  AND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', pr.charttime);",
    "0179a63a9ea6811f17901566": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE d.icd_code = 'I10' \n  AND pr.icd_code = 'S42.5' \n  AND d.charttime < pr.charttime \n  AND (julianday(pr.charttime) - julianday(d.charttime)) <= 60;",
    "f770528a39adb96dadeb2ece": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p\nINNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\nINNER JOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id\nINNER JOIN d_icd_procedures pr2 ON pr.icd_code = pr2.icd_code\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE d2.long_title = 'Iatrogenic Pneumothorax' \nAND pr2.long_title = 'Extracorporeal Circulation Auxiliary to Open Heart Surgery'\nAND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', pr.charttime)\nAND strftime('%Y', d.charttime) > '2100';",
    "59c016a2706b41628b2c89c5": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN procedures_icd pr ON p.subject_id = pr.subject_id\nWHERE d.icd_code IN (\n    SELECT icd_code \n    FROM d_icd_diagnoses \n    WHERE long_title LIKE '%Family history of malignant neoplasm of trachea, bronchus, and lung%'\n)\nAND pr.icd_code IN (\n    SELECT icd_code \n    FROM d_icd_procedures \n    WHERE long_title LIKE '%Central Venous Catheter Placement with Guideline%'\n)\nAND pr.charttime >= DATE('now', '-1 year')\nAND pr.charttime BETWEEN DATE('now', '-1 month') AND DATE('now');",
    "4fbf6bc24f6506d4e0648954": "",
    "399219ab0cecf87bb146bf4f": "SELECT COUNT(*) \nFROM labevents AS T1 \nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid \nWHERE T2.label = 'Diagnostic Ultrasound Abdomen & Retroperitoneum';",
    "b887f31e7adc13f9605b4ce5": "SELECT \n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd p\n  INNER JOIN d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n  d.long_title LIKE '%Alcohol detoxification%' \n  AND p.charttime BETWEEN '2023-01-01 00:00:00' AND '2023-12-31 23:59:59';",
    "637392b0ddde6c01f3635914": "SELECT \n  COUNT(*) \nFROM \n  procedures_icd AS pi \n  INNER JOIN d_icd_procedures AS dip ON pi.icd_code = dip.icd_code \nWHERE \n  dip.long_title = 'Excision of left internal mammary artery, percutaneous endoscopic approach' \n  AND strftime('%Y', pi.charttime) = '2100';",
    "888ffc67091ab77a0031df58": "SELECT COUNT(*) \nFROM procedures_icd AS p \nINNER JOIN d_icd_procedures AS d ON p.icd_code = d.icd_code \nWHERE d.long_title = 'Respiratory Ventilation, Greater than 96 Consecutive Hours';",
    "a7705b90ca7be8540a57b179": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd AS p\nJOIN d_icd_procedures AS d ON p.icd_code = d.icd_code\nWHERE d.long_title LIKE '%excision of right lower lung lobe, via natural or artificial opening endoscopic procedures%';",
    "5c2f1712b0944318f3f979b0": "SELECT COUNT(p.row_id) \nFROM procedures_icd AS p \nINNER JOIN d_icd_procedures AS d \nON p.icd_code = d.icd_code \nWHERE d.long_title = 'Excision of left saphenous vein, percutaneous endoscopic approach' \nAND strftime('%Y', p.charttime) = strftime('%Y', 'now');",
    "4556ccee5b6838ef92b0563d": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'nitroprusside sodium';",
    "8a2eb3b60c1ea3c2e4c41c3d": "SELECT \n    COUNT(DISTINCT p.subject_id) AS patient_count\nFROM \n    patients p\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    pr.drug = 'oxycodone (immediate release)' \n    AND pr.starttime >= '2100-01-01' \n    AND pr.stoptime <= '2100-12-31';",
    "2e78bc9dfee6ec2d33d855e8": "SELECT COUNT(DISTINCT p.subject_id) \nFROM patients p \nJOIN prescriptions pr ON p.subject_id = pr.subject_id \nWHERE pr.drug = 'Dexamethasone';",
    "66c7ab0996cecda175a87a37": "SELECT COUNT(DISTINCT p.subject_id) AS metformin_patients\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'metformin'\nAND pr.starttime >= DATE('now', 'start of year')\nAND pr.stoptime <= DATE('now', 'start of year', '+1 year', '-1 day');",
    "1e4019a7c27981289e8158a6": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE drug = 'doxycycline hyclate';",
    "585481006142353555e7db6c": "",
    "387e90582a0211b4f9b8baa0": "SELECT \n  COUNT(DISTINCT subject_id) AS total_patients\nFROM \n  prescriptions\nWHERE \n  drug = 'fenofibrate';",
    "9fd92541abda6f41b7def429": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE drug = 'quinidine gluconate e.r.'\n  AND starttime >= DATE('now', '-1 year');",
    "f2f618df33524232a41e164a": "SELECT COUNT(*) \nFROM prescriptions \nWHERE starttime >= '2100-01-01' \nAND drug = 'heparin (crrt machine priming)';",
    "12e5aa7d6e4aad370d1ec784": "SELECT COUNT(*) AS prescription_count\nFROM prescriptions\nWHERE starttime >= DATE('now', 'start of year')\nAND drug = 'diltiazem extended-release';",
    "9629cd5b13741202a0e1dc2e": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'midodrine' AND starttime >= datetime('now', '-1 year');",
    "c0c458bde811f783bf9c0186": "SELECT COUNT(*) AS num_prescriptions\nFROM prescriptions\nWHERE drug = 'latanoprost 0.005% ophth. soln.'\n  AND starttime >= DATE('now', '-1 year');",
    "c62d48014cb74f4fc40d76b2": "SELECT COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE drug = 'Docusate';",
    "e278ba85bcbc856b575a2432": "SELECT COUNT(*) \nFROM prescriptions \nWHERE drug = 'tramadol' \nAND starttime >= DATE('now', '-1 year');",
    "5bfb3ee348b0af2b550eb5fd": "",
    "77afb1ef1604c879a7c457e5": "WITH PercutaneousAbdominalDrainage AS (\n  SELECT p.subject_id, a.hadm_id\n  FROM patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  JOIN icustays icu ON a.hadm_id = icu.hadm_id\n  JOIN procedures_icd pr ON icu.hadm_id = pr.hadm_id\n  JOIN d_icd_procedures icd ON pr.icd_code = icd.icd_code\n  WHERE icd.long_title = ' Percutaneous abdominal drainage'\n),\nSpirinolactonePrescriptions AS (\n  SELECT p.subject_id, a.hadm_id\n  FROM patients p\n  JOIN prescriptions pr ON p.subject_id = pr.subject_id\n  JOIN admissions a ON pr.hadm_id = a.hadm_id\n  WHERE pr.drug = 'Spiroolactone'\n)\nSELECT COUNT(DISTINCT pad.subject_id)\nFROM PercutaneousAbdominalDrainage pad\nJOIN SpironolactonePrescriptions sp ON pad.subject_id = sp.subject_id AND pad.hadm_id = sp.hadm_id;",
    "b155b30fab3d7945e185f841": "SELECT \n  COUNT(DISTINCT p.subject_id) AS total_patients\nFROM \n  procedures_icd p\n  INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n  p.icd_code = 'T77.12' \n  AND pr.drug = 'glucose gel'\n  AND STRFTIME('%Y-%m', p.charttime) = STRFTIME('%Y-%m', pr.starttime);",
    "cdc0b49b39728980763c9830": "SELECT COUNT(DISTINCT p.subject_id) AS patient_count\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nJOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nJOIN procedures_icd p_i ON a.hadm_id = p_i.hadm_id\nWHERE pr.drug = 'ketorolac'\n  AND strftime('%Y', a.admittime) = strftime('%Y', 'now')\n  AND strftime('%m', pr.starttime) = strftime('%m', a.admittime)\n  AND p_i.icd_code = '0000000000'  -- Assuming this is a placeholder for a procedure code that represents cardiac output",
    "545884471d7fc70a0f8b1fce": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'Acetaminophen'\n  AND pr.starttime >= (SELECT MIN(charttime) FROM labevents l WHERE l.subject_id = p.subject_id AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Pancreatic Cyst Drainage') AND l.charttime < DATE(pr.starttime, '+2 month'))\n  AND pr.starttime <= (SELECT MAX(charttime) FROM labevents l WHERE l.subject_id = p.subject_id AND l.itemid = (SELECT itemid FROM d_labitems WHERE label = 'Pancreatic Cyst Drainage') AND l.charttime < DATE(pr.starttime, '+2 month'));",
    "8fdc820d61c609ac4f0bed57": "SELECT COUNT(*) \nFROM prescriptions AS p\nJOIN procedures_icd AS pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\nWHERE p.drug = '0.9% sodium chloride (mini bag plus)'\n  AND p.starttime >= DATE('2100-01-01') AND p.starttime < DATE('2101-01-01')\n  AND pr.icd_code = 'K59.1'\n  AND pr.charttime >= DATE('2100-01-01') AND pr.charttime < DATE('2101-01-01')\n  AND strftime('%m', p.starttime) = strftime('%m', pr.charttime);",
    "ef78694fed50bccd3e8eed2e": "SELECT \n    COUNT(DISTINCT p.subject_id) AS total_patients\nFROM \n    prescriptions p\nINNER JOIN \n    procedures_icd pi ON p.subject_id = pi.subject_id AND p.hadm_id = pi.hadm_id\nINNER JOIN \n    d_icd_procedures dp ON pi.icd_code = dp.icd_code\nWHERE \n    dp.long_title = 'Restriction of left internal carotid artery with intraluminal device, percutaneous approach'\n    AND p.drug = 'Lidocaine 5% patch'\n    AND strftime('%Y', p.starttime) = '2100'\n    AND strftime('%m', p.starttime) = strftime('%m', pi.charttime);",
    "4ae971e027ab0b11a6f1c018": "SELECT COUNT(DISTINCT l.subject_id) AS total_metamyelocytes_tests\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nWHERE d.label LIKE '%metamyelocytes%'\n  AND l.charttime BETWEEN DATE('now', 'start of year') AND DATE('now', 'end of year');",
    "de0718a1175887225e4a3701": "SELECT COUNT(DISTINCT m.subject_id) AS plasma_cells_count\nFROM microbiologyevents m\nWHERE m.test_name LIKE '%plasma cells%' AND m.charttime >= DATE('now', '-1 year');",
    "db4ebf8381b39fb14b2f5dab": "",
    "be7de3372a4c08b2ae411296": "SELECT COUNT(*) AS num_patients_with_test\nFROM patients AS p\nJOIN admissions AS a ON p.subject_id = a.subject_id\nJOIN microbiologyevents AS m ON a.hadm_id = m.hadm_id\nWHERE m.test_name LIKE '%Epithelial Cells%' AND m.charttime >= DATE('now', '-1 year');",
    "0ab0e14edb41ec298e991c8c": "SELECT COUNT(DISTINCT T1.subject_id)\nFROM patients AS T1\nINNER JOIN labevents AS T2\nON T1.subject_id = T2.subject_id\nINNER JOIN d_labitems AS T3\nON T2.itemid = T3.itemid\nWHERE T3.label LIKE '%uric acid%' AND strftime('%Y', T2.charttime) = '2100';",
    "37c4dfeda91b7ea5c88a15b6": "",
    "ec12c483a1d7d0bf16b1fbc4": "SELECT \n    COUNT(DISTINCT p.subject_id) AS num_patients\nFROM \n    patients p\nINNER JOIN \n    labevents le ON p.subject_id = le.subject_id\nINNER JOIN \n    d_labitems li ON le.itemid = li.itemid\nWHERE \n    li.label = 'Rheumatoid Factor' \n    AND le.charttime >= DATE('now', '-1 year');",
    "9b6fff1f017a3163467fb155": "SELECT COUNT(DISTINCT subject_id) \nFROM inputevents \nWHERE itemid IN (SELECT itemid FROM d_items WHERE label = 'Dextrose 50%') \nAND starttime >= DATE('now', 'start of year');",
    "d9dc77e2a9eef59e0164883e": "SELECT COUNT(*) AS patient_count\nFROM inputevents\nWHERE totalamountuom = 'D5 1/2NS'\n  AND starttime >= date('now', '-1 year');",
    "e793c664c5790f8705865139": "SELECT \n  COUNT(*) \nFROM \n  inputevents \nWHERE \n  itemid = (SELECT itemid FROM d_items WHERE label = 'Water') \n  AND totalamountuom = 'Liter' \n  AND totalamount = 2100;",
    "a36f72eb4bd75e8ee0def85f": "",
    "07cfe6a604bc9ff70115ca01": "SELECT COUNT(DISTINCT T1.subject_id) AS total_patients\nFROM admissions T1\nINNER JOIN inputevents T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_items T3 ON T2.itemid = T3.itemid\nWHERE T3.label = 'Fresh frozen plasma'\n  AND T2.starttime >= DATE('now', '-1 year');",
    "abef8d8c91bb576ba70341f2": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'promote with fiber (full)'\nAND pr.starttime >= date('now', '-1 year');",
    "07b458a4465bdc3893cd4d3b": "SELECT COUNT(DISTINCT ie.subject_id) AS total_albumin_5_percent_inputs\nFROM inputevents ie\nJOIN d_items di ON ie.itemid = di.itemid\nWHERE di.label = 'Albumin 5%' AND ie.starttime >= DATE('now', '-1 year');",
    "7ade7790a24e397e1e54a0a0": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "8b18506ab5223069c0701a48": "SELECT \n  d.long_title AS diagnosis_description,\n  COUNT(*) AS diagnosis_count\nFROM \n  diagnoses_icd icd\nINNER JOIN \n  d_icd_diagnoses d ON icd.icd_code = d.icd_code\nWHERE \n  icd.charttime LIKE '2100%'\nGROUP BY \n  d.long_title\nORDER BY \n  diagnosis_count DESC\nLIMIT 4;",
    "be30cffa66ec6b8f274e5abc": "SELECT icd_code, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd\nWHERE charttime > '2100-01-01'\nGROUP BY icd_code\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "4afbd97439436cbe90ee25f1": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE strftime('%Y', di.charttime) = '2100'\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "ad66076596714253fdd0da06": "SELECT d.long_title, COUNT(*) as frequency\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE di.charttime > '2100-01-01'\nGROUP BY d.long_title\nORDER BY frequency DESC\nLIMIT 5;",
    "70782f0b95270ba463ce4f33": "SELECT \n  d.long_title AS diagnosis,\n  COUNT(*) AS frequency\nFROM \n  diagnoses_icd di\n  INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE \n  di.charttime >= DATE('now', 'start of year')\nGROUP BY \n  d.long_title\nORDER BY \n  frequency DESC\nLIMIT 5;",
    "6aaf71c0cfa396b28f225bc3": "WITH diagnoses AS (\n    SELECT icd_code, COUNT(*) AS count\n    FROM diagnoses_icd\n    WHERE charttime >= DATE('now', '-1 year')\n    GROUP BY icd_code\n)\nSELECT d.long_title, d1.count\nFROM diagnoses d1\nJOIN d_icd_diagnoses d ON d1.icd_code = d.icd_code\nORDER BY d1.count DESC\nLIMIT 3;",
    "4ea2037fa4bc87104f556c64": "SELECT \n    d.long_title AS diagnosis, \n    COUNT(*) AS frequency\nFROM \n    diagnoses_icd di\nINNER JOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nINNER JOIN \n    admissions a ON di.hadm_id = a.hadm_id\nWHERE \n    a.admittime >= '2023-01-01' AND a.admittime < '2024-01-01'\n    AND a.age >= 60\nGROUP BY \n    d.long_title\nORDER BY \n    frequency DESC\nLIMIT 3;",
    "40d147343c07229976c1f711": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN patients p ON di.subject_id = p.subject_id\nWHERE strftime('%Y', 'now') - strftime('%Y', p.dob) >= 60\nGROUP BY d.long_title\nORDER BY diagnosis_count DESC\nLIMIT 5;",
    "88bfa1913eb595bb2ec3e15e": "WITH PatientDiagnoses AS (\n  SELECT \n    p.subject_id,\n    d.long_title AS diagnosis\n  FROM patients p\n  INNER JOIN diagnoses_icd di ON p.subject_id = di.subject_id\n  INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n  WHERE p.gender = 'F'\n    AND p.dob BETWEEN DATE('now', '-30 years') AND DATE('now', '-29 years')\n),\nDiagnosisCounts AS (\n  SELECT \n    diagnosis,\n    COUNT(*) AS diagnosis_count\n  FROM PatientDiagnoses\n  GROUP BY diagnosis\n)\nSELECT \n  diagnosis,\n  diagnosis_count\nFROM DiagnosisCounts\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "6fcb390235190f852352ba02": "SELECT \n  d.long_title AS diagnosis,\n  COUNT(*) AS diagnosis_count\nFROM \n  diagnoses_icd di\nINNER JOIN \n  d_icd_diagnoses d ON di.icd_code = d.icd_code\nINNER JOIN \n  admissions a ON di.hadm_id = a.hadm_id\nWHERE \n  a.age BETWEEN 20 AND 29\n  AND strftime('%Y', a.admittime) = '2100'\nGROUP BY \n  d.long_title\nORDER BY \n  diagnosis_count DESC\nLIMIT 4;",
    "e3171ac111633770ec5fe8d0": "SELECT \n  T2.icd_code,\n  COUNT(T2.icd_code) AS diagnosis_count\nFROM \n  admissions AS T1\nINNER JOIN \n  diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.age BETWEEN 50 AND 59 AND T1.admittime >= '2100-01-01'\nGROUP BY \n  T2.icd_code\nORDER BY \n  diagnosis_count DESC\nLIMIT 3;",
    "7f14fffc462f0b0f329a9639": "SELECT \n  d.long_title, \n  COUNT(*) as frequency\nFROM \n  diagnoses_icd di\nJOIN \n  d_icd_diagnoses d ON di.icd_code = d.icd_code\nJOIN \n  patients p ON di.subject_id = p.subject_id\nWHERE \n  p.dob >= DATE('now', '-1 year') \n  AND p.dob < DATE('now', '-40 years')\nGROUP BY \n  d.long_title\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "82f39085117b4eee63cfcbd8": "SELECT d.long_title, COUNT(*) AS diagnosis_count\nFROM admissions a\nJOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE strftime('%Y', a.admittime) = '2100' AND a.age BETWEEN 30 AND 39\nGROUP BY d.icd_code\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "ed396de025aef41a12776f3d": "SELECT \n  d.long_title AS diagnosis_title,\n  COUNT(*) AS frequency\nFROM \n  diagnoses_icd di\n  INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n  INNER JOIN procedures_icd pi ON di.subject_id = pi.subject_id AND di.hadm_id = pi.hadm_id\n  INNER JOIN d_icd_procedures p ON pi.icd_code = p.icd_code\nWHERE \n  p.long_title LIKE '%Resection of vessel with replacement, thoracic vessels%' \n  AND pi.charttime LIKE '2100-%'\n  AND di.charttime LIKE '2100-%'\n  AND di.charttime BETWEEN pi.charttime AND DATE(pi.charttime, '+1 month')\nGROUP BY \n  d.long_title\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "6fdd01eeff3d0426c273f13a": "SELECT T2.long_title AS diagnosis, COUNT(*) AS frequency\nFROM diagnoses_icd AS T1\nINNER JOIN d_icd_diagnoses AS T2 ON T1.icd_code = T2.icd_code\nINNER JOIN procedures_icd AS T3 ON T1.hadm_id = T3.hadm_id\nWHERE T1.charttime > '2100-01-01' AND T3.charttime > '2100-01-01'\n  AND julianday(T3.charttime) - julianday(T1.charttime) BETWEEN 0 AND 60\nGROUP BY T2.long_title\nORDER BY frequency DESC\nLIMIT 4;",
    "47c10150fc2a7ef2316ffcd9": "",
    "db3c11ffd16f4f7b363b7a95": "WITH HemodialysisPatients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE a.admission_type = 'Hemodialysis'\n      AND strftime('%Y', a.admittime) = strftime('%Y', 'now')\n),\nDiagnosesAfterHemodialysis AS (\n    SELECT d.subject_id, d.icd_code, d.charttime\n    FROM diagnoses_icd d\n    JOIN HemodialysisPatients hdp ON d.subject_id = hdp.subject_id\n    WHERE strftime('%Y-%m', d.charttime) = strftime('%Y-%m', a.admittime)\n)\nSELECT icd_code, COUNT(*) as diagnosis_count\nFROM DiagnosesAfterHemodialysis\nGROUP BY icd_code\nORDER BY diagnosis_count DESC\nLIMIT 4;",
    "2a9d69b2f33ebef60868e9bd": "-- Step 1: Identify diagnoses related to the specified procedure\nWITH ProcedureDiagnoses AS (\n    SELECT\n        p.subject_id,\n        p.hadm_id,\n        p.icd_code,\n        p.charttime AS diagnosis_time\n    FROM\n        diagnoses_icd p\n    INNER JOIN\n        procedures_icd pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\n    WHERE\n        pr.icd_code IN (SELECT icd_code FROM d_icd_procedures WHERE long_title LIKE 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic%')\n),\n\n-- Step 2: Filter diagnoses within 2 months after the procedure\nFilteredDiagnoses AS (\n    SELECT\n        pd.subject_id,\n        pd.icd_code\n    FROM\n        ProcedureDiagnoses pd\n    WHERE\n        pd.diagnosis_time BETWEEN (SELECT charttime FROM ProcedureDiagnoses WHERE subject_id = pd.subject_id AND icd_code = pd.icd_code) \n        AND (SELECT charttime FROM ProcedureDiagnoses WHERE subject_id = pd.subject_id AND icd_code = pd.icd_code) + 60 * 24 * 2\n),\n\n-- Step 3: Count the frequency of each diagnosis\nDiagnosisFrequency AS (\n    SELECT\n        icd_code,\n        COUNT(*) AS frequency\n    FROM\n        FilteredDiagnoses\n    GROUP BY\n        icd_code\n),\n\n-- Step 4: Order the diagnoses by frequency and limit to top 3\nTopDiagnoses AS (\n    SELECT\n        icd_code,\n        frequency\n    FROM\n        DiagnosisFrequency\n    ORDER BY\n        frequency DESC\n    LIMIT 3\n)\n\n-- Final selection of top diagnoses\nSELECT\n    icd_code,\n    frequency\nFROM\n    TopDiagnoses;",
    "cc3d7bf75c6a91650fa5a25b": "SELECT d.long_title, COUNT(*) AS count \nFROM diagnoses_icd di \nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code \nJOIN procedures_icd pr ON di.subject_id = pr.subject_id \nWHERE pr.icd_code = '00.15' \nAND di.charttime BETWEEN pr.charttime AND DATE(pr.charttime, '+2 month') \nGROUP BY d.long_title \nORDER BY count DESC \nLIMIT 4;",
    "cd0f6d12276b6dd053848329": "WITH LaparoscopicPartialCholecystectomyCTE AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        charttime\n    FROM \n        diagnoses_icd\n    WHERE \n        icd_code = '00.07'  \n        AND charttime >= DATE('now', '-1 year')  \n        AND EXISTS (\n            SELECT 1 \n            FROM diagnoses_icd d2\n            WHERE d2.subject_id = diagnoses_icd.subject_id\n              AND d2.charttime >= DATE('now', '-2 months')\n              AND d2.icd_code = '00.07'  \n        )\n)\nSELECT \n    d3.icd_code,\n    COUNT(*) AS diagnosis_count\nFROM \n    LaparoscopicPartialCholecystectomyCTE lpc\nJOIN \n    diagnoses_icd d3 ON lpc.subject_id = d3.subject_id\nWHERE \n    d3.charttime >= DATE('now', '-1 year')\nGROUP BY \n    d3.icd_code\nORDER BY \n    diagnosis_count DESC\nLIMIT 5;",
    "f43d8c604807bcac934596ac": "SELECT drug, COUNT(*) as treatment_count\nFROM prescriptions\nGROUP BY drug\nORDER BY treatment_count DESC\nLIMIT 3;",
    "1f74b6c69a55bb5e16c32cba": "SELECT \n  p.long_title AS procedure_name,\n  COUNT(pr.icd_code) AS procedure_count\nFROM \n  procedures_icd pr\n  INNER JOIN d_icd_procedures p ON pr.icd_code = p.icd_code\nGROUP BY \n  p.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 3;",
    "49d6f4a86b0609b109d0e3a1": "SELECT \n    d.long_title AS procedure_title,\n    COUNT(p.icd_code) AS frequency\nFROM \n    procedures_icd p\nINNER JOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nGROUP BY \n    d.long_title\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "591c758b0e137d7671f1af3e": "SELECT d_ip.long_title, COUNT(*) AS procedure_count\nFROM procedures_icd p_icd\nINNER JOIN d_icd_procedures d_ip ON p_icd.icd_code = d_ip.icd_code\nWHERE p_icd.charttime >= '2100-01-01'\nGROUP BY d_ip.long_title\nORDER BY procedure_count DESC\nLIMIT 4;",
    "9a613ce39888ea07ffbd3a23": "SELECT \n    T2.long_title AS procedure_name,\n    COUNT(*) AS procedure_count\nFROM \n    procedures_icd T1\nINNER JOIN \n    d_icd_procedures T2 ON T1.icd_code = T2.icd_code\nWHERE \n    T1.charttime >= DATE('now', '-1 year')\nGROUP BY \n    T2.long_title\nORDER BY \n    procedure_count DESC\nLIMIT 3;",
    "715714e43d5b44633c2f88df": "SELECT drug, COUNT(*) AS treatment_count\nFROM prescriptions\nWHERE starttime >= DATE('now', 'start of year')\nGROUP BY drug\nORDER BY treatment_count DESC\nLIMIT 4;",
    "2db144511074e195767dbef5": "SELECT \n  d_ip.long_title AS procedure_name, \n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd p_icd\n  INNER JOIN d_icd_procedures d_ip ON p_icd.icd_code = d_ip.icd_code\n  INNER JOIN admissions a ON p_icd.hadm_id = a.hadm_id\n  INNER JOIN patients p ON a.subject_id = p.subject_id\nWHERE \n  p.dob >= DATE('now', '-1 year')\n  AND a.admittime >= DATE('now', '-1 year')\n  AND (strftime('%Y', 'now') - strftime('%Y', p.dob)) BETWEEN 40 AND 49\nGROUP BY \n  d_ip.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 5;",
    "852528505a7b6f035ae431de": "SELECT T1.drug, COUNT(*) AS frequency\nFROM prescriptions AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.age >= 60 AND T2.admittime LIKE '2100%'\nGROUP BY T1.drug\nORDER BY frequency DESC\nLIMIT 3;",
    "61158e9ccd8015f7898cb6e8": "WITH ProcedureCount AS (\n  SELECT p.subject_id, COUNT(*) as procedure_count\n  FROM procedures_icd p\n  JOIN admissions a ON p.hadm_id = a.hadm_id\n  WHERE a.age BETWEEN 20 AND 29\n  GROUP BY p.subject_id\n)\nSELECT d.long_title, SUM(pc.procedure_count) as total_procedures\nFROM ProcedureCount pc\nJOIN procedures_icd p ON pc.subject_id = p.subject_id\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nGROUP BY d.long_title\nORDER BY total_procedures DESC\nLIMIT 4;",
    "e6db613772003ec72d44ebe5": "SELECT \n  T2.drug, \n  COUNT(T2.drug) AS frequency\nFROM \n  admissions AS T1\nINNER JOIN \n  prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T1.age >= 20 AND T1.age <= 29\nGROUP BY \n  T2.drug\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "899575480ec0184f34a313b4": "SELECT p.icd_code, d.long_title, COUNT(*) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.age BETWEEN 30 AND 39\nGROUP BY p.icd_code, d.long_title\nORDER BY procedure_count DESC\nLIMIT 5;",
    "0f8875bf841f89f578f97551": "WITH procedure_counts AS (\n  SELECT \n    p.icd_code,\n    COUNT(*) AS procedure_count\n  FROM \n    procedures_icd p\n  JOIN \n    admissions a ON p.hadm_id = a.hadm_id\n  WHERE \n    a.age >= 60 AND \n    p.charttime >= DATE('now', '-1 year')\n  GROUP BY \n    p.icd_code\n)\nSELECT \n  icd_code,\n  procedure_count\nFROM \n  procedure_counts\nORDER BY \n  procedure_count DESC\nLIMIT 5;",
    "41610f36281d57ea3abb005b": "SELECT p1.drug, COUNT(*) AS frequency\nFROM prescriptions p1\nINNER JOIN admissions a ON p1.hadm_id = a.hadm_id\nWHERE a.admittime >= '2100-01-01' AND a.age BETWEEN 40 AND 49\nGROUP BY p1.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "c8514097484be2c378e72761": "WITH RelevantProcedures AS (\n    SELECT p.subject_id\n    FROM procedures_icd p\n    JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n    WHERE d.long_title LIKE '%drainage of peritoneal cavity, percutaneous approach, diagnostic%'\n      AND p.charttime >= DATE('now', '-2 months')\n),\nFilteredPatients AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN RelevantProcedures rp ON p.subject_id = rp.subject_id\n    WHERE p.dob <= DATE('now', '-1 year') -- Assuming age criteria is not explicitly defined in the question\n)\nSELECT d.long_title, COUNT(*) AS procedure_count\nFROM procedures_icd p\nJOIN d_icd_procedures d ON p.icd_code = d.icd_code\nJOIN FilteredPatients fp ON p.subject_id = fp.subject_id\nGROUP BY d.long_title\nORDER BY procedure_count DESC\nLIMIT 5;",
    "6ef0a4d357592b4eadc2b1b7": "SELECT t2.drug, COUNT(*) AS frequency\nFROM procedures_icd AS t1\nJOIN prescriptions AS t2 ON t1.subject_id = t2.subject_id AND t1.hadm_id = t2.hadm_id\nWHERE t1.icd_code = 'P23.1'\nAND strftime('%Y-%m', t2.starttime) = strftime('%Y-%m', (SELECT MIN(admittime) FROM admissions WHERE subject_id = t1.subject_id))\nGROUP BY t2.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "7c6f2aa274207d68024f4cd4": "SELECT p.drug, COUNT(*) AS treatment_frequency\nFROM prescriptions p\nJOIN procedures_icd pr ON p.hadm_id = pr.hadm_id AND p.subject_id = pr.subject_id\nJOIN d_icd_procedures d ON pr.icd_code = d.icd_code\nWHERE d.long_title LIKE 'Fluoroscopy of right heart using other contrast since 2100'\nGROUP BY p.drug\nORDER BY treatment_frequency DESC\nLIMIT 4;",
    "bbebbefb1d815b174837d57e": "SELECT \n    p1.long_title AS surgery_name,\n    COUNT(*) AS surgery_count\nFROM \n    procedures_icd pr1\nJOIN \n    d_icd_procedures p1 ON pr1.icd_code = p1.icd_code\nJOIN \n    procedures_icd pr2 ON pr1.subject_id = pr2.subject_id AND pr1.hadm_id = pr2.hadm_id\nJOIN \n    d_icd_procedures p2 ON pr2.icd_code = p2.icd_code\nWHERE \n    pr1.charttime BETWEEN pr2.charttime AND DATE(pr2.charttime, '+1 month')\n    AND p2.long_title = ' Percutaneous abdominal drainage'\nGROUP BY \n    p1.long_title\nORDER BY \n    surgery_count DESC\nLIMIT 4;",
    "c5fa37f5342eb658b8fa6776": "WITH IncisionProcedureCTE AS (\n    SELECT p.subject_id, \n           strftime('%Y-%m', p.charttime) AS procedure_month\n    FROM diagnoses_icd p\n    INNER JOIN d_icd_diagnoses d ON p.icd_code = d.icd_code\n    WHERE d.long_title = 'Incision with drainage of skin and subcutaneous tissue'\n),\nSameMonthProceduresCTE AS (\n    SELECT p.subject_id, \n           d.long_title AS procedure_name,\n           strftime('%Y-%m', p.charttime) AS procedure_month\n    FROM diagnoses_icd p\n    INNER JOIN d_icd_diagnoses d ON p.icd_code = d.icd_code\n    WHERE p.subject_id IN (SELECT subject_id FROM IncisionProcedureCTE)\n      AND strftime('%Y-%m', p.charttime) = (SELECT procedure_month FROM IncisionProcedureCTE WHERE IncisionProcedureCTE.subject_id = p.subject_id)\n)\nSELECT procedure_name, COUNT(*) AS procedure_count\nFROM SameMonthProceduresCTE\nWHERE procedure_name != 'Incision with drainage of skin and subcutaneous tissue'\nGROUP BY procedure_name\nORDER BY procedure_count DESC\nLIMIT 3;",
    "a3a4751b104710cf0148a297": "SELECT T2.label, COUNT(T1.row_id) AS treatment_count\nFROM procedures_icd T3\nJOIN inputevents T1 ON T3.hadm_id = T1.hadm_id\nJOIN d_items T2 ON T1.itemid = T2.itemid\nWHERE T3.icd_code = '00.26'\nGROUP BY T2.label\nORDER BY treatment_count DESC\nLIMIT 3;",
    "a6ad56047cfb5ab47409c6a5": "SELECT \n    d.long_title, \n    COUNT(p.icd_code) AS frequency\nFROM \n    procedures_icd p\nINNER JOIN \n    d_icd_procedures d ON p.icd_code = d.icd_code\nWHERE \n    p.icd_code NOT LIKE '2100%'\nGROUP BY \n    d.long_title\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "46a6f6b786c670f60f62c369": "SELECT \n  p.drug, \n  COUNT(*) AS count\nFROM \n  prescriptions p\n  INNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\n  INNER JOIN d_icd_diagnoses did ON d.icd_code = did.icd_code\nWHERE \n  did.long_title = 'Long term (current) use of opiate analgesic'\n  AND p.starttime >= '2100-01-01 00:00:00'\nGROUP BY \n  p.drug\nORDER BY \n  count DESC\nLIMIT 4;",
    "53ae274dd031672e790039de": "select the top 5.",
    "23a42f7835688c75021035ac": "SELECT \n  T3.long_title AS procedure,\n  COUNT(*) AS procedure_count\nFROM \n  diagnoses_icd T1\n  INNER JOIN d_icd_diagnoses T2 ON T1.icd_code = T2.icd_code\n  INNER JOIN procedures_icd T4 ON T1.hadm_id = T4.hadm_id\n  INNER JOIN d_icd_procedures T3 ON T4.icd_code = T3.icd_code\nWHERE \n  T2.long_title LIKE '%diaphragmatic hernia%'\n  AND T2.long_title NOT LIKE '%obstruction%'\n  AND T2.long_title NOT LIKE '%gangrene%'\nGROUP BY \n  T3.long_title\nORDER BY \n  procedure_count DESC\nLIMIT 4;",
    "1acf7fc31384e1c31147c768": "SELECT p.long_title, COUNT(*) AS procedure_frequency\nFROM procedures_icd pr\nJOIN d_icd_procedures p ON pr.icd_code = p.icd_code\nJOIN diagnoses_icd di ON pr.hadm_id = di.hadm_id\nWHERE di.icd_code = 'I48.1' AND pr.charttime >= '2020-01-01'\nGROUP BY p.long_title\nORDER BY procedure_frequency DESC\nLIMIT 3;",
    "71e45f1414e9c508d0f88b96": "SELECT \n    p.drug,\n    COUNT(p.row_id) AS total_prescriptions\nFROM \n    prescriptions p\nJOIN \n    diagnoses_icd d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nJOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n    d2.long_title LIKE '%Other and unspecified Escherichia coli (E. coli) in the same month%'\nGROUP BY \n    p.drug\nORDER BY \n    total_prescriptions DESC\nLIMIT 4;",
    "1f8afcb7747a797d8e8f612a": "SELECT \n  p.long_title AS procedure,\n  COUNT(*) AS frequency\nFROM \n  diagnoses_icd d\n  INNER JOIN procedures_icd p_i ON d.subject_id = p_i.subject_id AND d.hadm_id = p_i.hadm_id\n  INNER JOIN d_icd_procedures p ON p_i.icd_code = p.icd_code\nWHERE \n  d.icd_code = 'J93.00' \n  AND strftime('%Y-%m', d.charttime) = strftime('%Y-%m', p_i.charttime)\nGROUP BY \n  p.long_title\nORDER BY \n  frequency DESC\nLIMIT 3;",
    "a35a9346ab483d0db0f202ca": "SELECT p2.long_title AS procedure, COUNT(*) AS procedure_count\nFROM diagnoses_icd d\nJOIN d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nJOIN procedures_icd p ON d.hadm_id = p.hadm_id\nJOIN d_icd_procedures p2 ON p.icd_code = p2.icd_code\nWHERE d2.long_title LIKE '%end stage renal disease%'\nGROUP BY p2.long_title\nORDER BY procedure_count DESC\nLIMIT 5;",
    "2efdde96ce7011cebcfc05db": "SELECT drug, COUNT(*) AS prescription_count\nFROM prescriptions\nWHERE starttime >= '2021-01-01' AND starttime < '2022-01-01'\nGROUP BY drug\nORDER BY prescription_count DESC\nLIMIT 4;",
    "a9b38a0fdefc73e3b49a6266": "SELECT drug, COUNT(*) AS count\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY count DESC\nLIMIT 4;",
    "4960b6194d17e9d1c2ac34f2": "",
    "0f46ce74f036db898fe9d288": "SELECT drug, COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE starttime >= DATE('now', '-1 year')\nGROUP BY drug\nORDER BY total_prescriptions DESC\nLIMIT 3;",
    "5e50d8202a81e15b06471b88": "SELECT drug, COUNT(*) AS count\nFROM prescriptions\nWHERE strftime('%Y', starttime) = '2100'\nGROUP BY drug\nORDER BY count DESC\nLIMIT 4;",
    "06b9ac11749e295ddd6d0c34": "SELECT \n  drug, \n  COUNT(*) AS total_prescriptions\nFROM \n  prescriptions\nWHERE \n  starttime >= date('now', '-1 year')\nGROUP BY \n  drug\nORDER BY \n  total_prescriptions DESC\nLIMIT 3;",
    "e9a9b12dc29949b932dfcb92": "SELECT drug, COUNT(*) as total_orders \nFROM prescriptions \nWHERE starttime >= '2100-01-01' \nGROUP BY drug \nORDER BY total_orders DESC \nLIMIT 3;",
    "421833b510b5ec197a16d68f": "WITH HydrocodonePatients AS (\n  SELECT DISTINCT p.subject_id\n  FROM prescriptions p\n  WHERE p.drug = 'hydrocodone-acetaminophen (5mg-325mg)'\n    AND p.starttime >= DATE('now', '-1 year')\n    AND p.stoptime <= DATE('now', '-2 months')\n),\nRecentPrescriptions AS (\n  SELECT p.drug, COUNT(*) AS prescription_count\n  FROM prescriptions p\n  JOIN HydrocodonePatients hp ON p.subject_id = hp.subject_id\n  WHERE p.starttime >= DATE('now', '-1 year')\n  GROUP BY p.drug\n)\nSELECT drug, prescription_count\nFROM RecentPrescriptions\nORDER BY prescription_count DESC\nLIMIT 5;",
    "44162aee19eabadbab9a0172": "SELECT T2.drug, COUNT(*) AS frequency\nFROM prescriptions AS T2\nINNER JOIN (\n  SELECT T2.subject_id, MIN(T2.starttime) AS earliest_starttime\n  FROM prescriptions AS T2\n  WHERE T2.drug = 'acd-a'\n  GROUP BY T2.subject_id\n) AS T1 ON T1.subject_id = T2.subject_id\nWHERE T2.starttime BETWEEN T1.earliest_starttime AND DATE(T1.earliest_starttime, '+2 months')\nGROUP BY T2.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "5f2f54291860e0ab6a44e725": "SELECT \n    pr.drug,\n    COUNT(pr.drug) AS num_prescriptions\nFROM \n    prescriptions pr\nWHERE \n    pr.starttime >= '2100-01-01' \n    AND pr.drug = 'plasmalyte' \n    AND EXISTS (\n        SELECT 1 \n        FROM prescriptions pr2 \n        WHERE pr2.subject_id = pr.subject_id \n          AND pr2.starttime >= pr.starttime \n          AND pr2.starttime < DATE(pr.starttime, '+1 month') \n          AND pr2.drug <> 'plasmalyte'\n    )\nGROUP BY \n    pr.drug\nORDER BY \n    num_prescriptions DESC\nLIMIT 5;",
    "48e40b5c41147007595a5175": "WITH donepezil_prescriptions AS (\n    SELECT \n        subject_id, \n        hadm_id, \n        starttime, \n        stoptime\n    FROM \n        prescriptions\n    WHERE \n        drug LIKE '%donepezil%'\n),\nfiltered_prescriptions AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id, \n        p.starttime, \n        p.stoptime, \n        p.drug\n    FROM \n        prescriptions p\n    INNER JOIN \n        donepezil_prescriptions dp\n    ON \n        p.subject_id = dp.subject_id AND p.hadm_id = dp.hadm_id\n    WHERE \n        p.starttime > dp.starttime \n        AND p.starttime <= DATE(dp.starttime, '+2 months')\n)\nSELECT \n    drug, \n    COUNT(*) AS num_prescriptions\nFROM \n    filtered_prescriptions\nGROUP BY \n    drug\nORDER BY \n    num_prescriptions DESC\nLIMIT 3;",
    "7ec4445b22dfabb102812643": "SELECT \n  p.drug AS prescribed_drug, \n  COUNT(*) AS total_prescriptions \nFROM \n  prescriptions p \nWHERE \n  p.hadm_id IN ( \n    SELECT \n      p1.hadm_id \n    FROM \n      prescriptions p1 \n    WHERE \n      p1.drug = 'MICONAZOLE POWDER 2%' \n      AND p1.starttime > '2100'\n  ) \n  AND p.starttime > '2100'\nGROUP BY \n  p.drug \nORDER BY \n  total_prescriptions DESC \nLIMIT 3;",
    "b85c5a437b3cb22920ce10fb": "SELECT \n  p.drug, \n  COUNT(p.drug) AS prescription_count\nFROM \n  prescriptions p\nWHERE \n  p.hadm_id IN (\n    SELECT \n      p2.hadm_id\n    FROM \n      prescriptions p2\n    WHERE \n      p2.drug = 'bupropion (sustained release)'\n      AND p2.starttime >= DATE('now', '-1 year')\n  )\n  AND p.starttime >= DATE('now', '-1 year')\nGROUP BY \n  p.drug\nORDER BY \n  prescription_count DESC\nLIMIT 5;",
    "757270424b26647955e34c40": "SELECT drug, COUNT(*) AS prescription_count\nFROM prescriptions\nWHERE starttime >= DATE('now', 'start of year')\n  AND starttime <= DATE('now', 'start of year', '+1 month', '-1 day')\n  AND drug != 'Vecuronium Bromide'\nGROUP BY drug\nHAVING COUNT(*) IN (\n  SELECT COUNT(*) AS prescription_count\n  FROM prescriptions\n  WHERE starttime >= DATE('now', 'start of year')\n    AND starttime <= DATE('now', 'start of year', '+1 month', '-1 day')\n    AND drug = 'Vecuronium Bromide'\n  GROUP BY strftime('%m', starttime)\n  ORDER BY prescription_count DESC\n  LIMIT 4\n)\nORDER BY prescription_count DESC\nLIMIT 4;",
    "4a03eabf717f99697bb5ba08": "SELECT p.drug, COUNT(*) AS prescription_count\nFROM prescriptions p\nINNER JOIN procedures_icd pr ON p.subject_id = pr.subject_id AND p.hadm_id = pr.hadm_id\nWHERE pr.icd_code = 'K85.1' \n  AND p.starttime >= DATE('2100-01-01')\n  AND p.starttime < DATE('2100-03-01')\nGROUP BY p.drug\nORDER BY prescription_count DESC\nLIMIT 4;",
    "c8175712036320a9b391cf5f": "SELECT \n    p1.drug,\n    COUNT(p1.drug) AS frequency\nFROM \n    prescriptions p1\nINNER JOIN \n    admissions a ON p1.subject_id = a.subject_id AND p1.hadm_id = a.hadm_id\nWHERE \n    p1.starttime >= DATE('now', '-1 year') AND \n    p1.starttime <= DATE('now', '-1 month') AND \n    a.dischtime >= DATE('now', '-1 month') AND \n    a.dischtime <= DATE('now')\nGROUP BY \n    p1.drug\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "7a3e856c5351161f228b56ea": "SELECT p.drug, COUNT(*) AS frequency\nFROM prescriptions p\nJOIN admissions a ON p.hadm_id = a.hadm_id\nJOIN procedures_icd pi ON p.hadm_id = pi.hadm_id\nJOIN d_icd_procedures dip ON pi.icd_code = dip.icd_code\nWHERE dip.long_title LIKE '%extracorporeal circulation auxiliary%'\n  AND a.admittime >= '2100-01-01'\n  AND a.admittime <= DATE('2100-01-01', '+2 months')\nGROUP BY p.drug\nORDER BY frequency DESC\nLIMIT 5;",
    "242455bec537f7c263ad40b0": "",
    "842e8f2f6e1757279aaf5fc9": "SELECT \n    T3.drug,\n    COUNT(*) AS drug_count\nFROM \n    inputevents AS T1\nJOIN \n    prescriptions AS T3 ON T1.subject_id = T3.subject_id AND T1.hadm_id = T3.hadm_id\nWHERE \n    T1.itemid = (SELECT itemid FROM d_items WHERE label = 'Introduction of nutritional substance into lower gi, via natural or artificial opening')\nGROUP BY \n    T3.drug\nORDER BY \n    drug_count DESC\nLIMIT 5;",
    "30f8a5d33eb7287c9cf8412a": "SELECT T2.drug, COUNT(*) AS frequency\nFROM procedures_icd AS T1\nINNER JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.icd_code = 'K91.15'\nGROUP BY T2.drug\nORDER BY frequency DESC\nLIMIT 4;",
    "4cfe2481c4220d5f42e7a66c": "SELECT T2.drug, COUNT(*) AS frequency\nFROM procedures_icd T1\nJOIN prescriptions T2 ON T1.hadm_id = T2.hadm_id\nWHERE T1.icd_code = 'R60.5'  -- Assuming 'R60.5' is the ICD code for the specific procedure\nGROUP BY T2.drug\nORDER BY frequency DESC\nLIMIT 5;",
    "dbbf8af9c5e0fe77e81a2ecc": "SELECT \n    p.drug,\n    COUNT(*) AS total_orders\nFROM \n    prescriptions p\nINNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses d_diagnosis ON d.icd_code = d_diagnosis.icd_code\nWHERE \n    d_diagnosis.long_title = 'Gastro-esophageal reflux disease without esophagitis'\n    AND p.starttime BETWEEN '2100-01-01' AND '2100-12-31'\nGROUP BY \n    p.drug\nORDER BY \n    total_orders DESC\nLIMIT 5;",
    "2f7d49a71a664a3c5367e8a7": "SELECT \n  T1.drug, \n  COUNT(*) AS num_prescriptions\nFROM \n  prescriptions T1\n  INNER JOIN diagnoses_icd T2 ON T1.hadm_id = T2.hadm_id\nWHERE \n  T2.icd_code LIKE '2100%' \n  AND T1.starttime >= DATE('now', 'start of month') \n  AND T1.starttime < DATE('now', 'start of month', '+1 month')\nGROUP BY \n  T1.drug\nORDER BY \n  num_prescriptions DESC\nLIMIT 4;",
    "9177cde69132a37cbac544ee": "SELECT T1.drug, COUNT(T1.drug) AS frequency\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.icd_code = 'I47.0' -- ICD code for defibrination syndrome\n  AND T2.charttime > DATE('now', '-2 months')\n  AND T1.starttime > DATE('now', '-1 year')\nGROUP BY T1.drug\nORDER BY frequency DESC\nLIMIT 3;",
    "144cd6f1acfad4416003c26c": "SELECT drug, COUNT(*) AS count\nFROM prescriptions\nWHERE subject_id IN (\n  SELECT subject_id\n  FROM diagnoses_icd\n  WHERE icd_code = 'I47.0'\n)\nAND hadm_id IN (\n  SELECT hadm_id\n  FROM diagnoses_icd\n  WHERE icd_code = 'I47.0'\n)\nGROUP BY drug\nORDER BY count DESC\nLIMIT 4;",
    "aef8b935473950853a7d8448": "SELECT \n  p.drug, \n  COUNT(p.drug) AS prescription_count\nFROM \n  diagnoses_icd d\n  JOIN labevents l ON d.subject_id = l.subject_id AND d.hadm_id = l.hadm_id\n  JOIN prescriptions p ON d.subject_id = p.subject_id AND d.hadm_id = p.hadm_id\nWHERE \n  d.icd_code IN ('E11.1', 'E11.3')  -- Hypo-osmolality and Hyponatremia\n  AND l.charttime >= DATE('now', '-1 year')\n  AND p.starttime BETWEEN l.charttime AND DATE(l.charttime, '+2 months')\nGROUP BY \n  p.drug\nORDER BY \n  prescription_count DESC\nLIMIT 3;",
    "2b134de41e611c4124b04f3b": "Select the top three most frequently prescribed medications.",
    "48f94d76de26cca5b25ee77f": "SELECT \n    p.drug,\n    COUNT(p.drug) AS drug_count\nFROM \n    prescriptions p\nINNER JOIN \n    diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\nWHERE \n    d2.long_title = 'Acquired absence of organ, genital organs previously within the same hospital visit'\n    AND p.starttime >= DATE('now', 'start of year')\nGROUP BY \n    p.drug\nORDER BY \n    drug_count DESC\nLIMIT 3;",
    "f9dc2fa964b252fd6c5baac9": "SELECT p1.drug, COUNT(*) AS frequency\nFROM prescriptions p1\nINNER JOIN diagnoses_icd d1 ON p1.hadm_id = d1.hadm_id\nINNER JOIN admissions a1 ON p1.hadm_id = a1.hadm_id\nWHERE d1.icd_code IN ('L30.0', 'L30.1')\n  AND a1.admittime >= '2100-01-01'\n  AND p1.starttime >= '2100-01-01'\n  AND a1.age >= 60\n  AND p1.subject_id = a1.subject_id\nGROUP BY p1.drug\nORDER BY frequency DESC\nLIMIT 3;",
    "e55b54e06750117ab5f1a053": "WITH ldh_admissions AS (\n  SELECT a.subject_id, a.hadm_id, a.admittime\n  FROM admissions a\n  JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n  WHERE d.icd_code = 'R24.00' \n    AND a.admittime >= '2100-01-01'\n),\nfiltered_patients AS (\n  SELECT p.subject_id\n  FROM patients p\n  WHERE p.gender = 'Male' \n    AND p.dob BETWEEN '1950-01-01' AND '1959-12-31'\n),\nfiltered_admissions AS (\n  SELECT la.subject_id, la.hadm_id, la.admittime\n  FROM ldh_admissions la\n  JOIN filtered_patients fp ON la.subject_id = fp.subject_id\n),\nprescriptions_same_month AS (\n  SELECT pr.drug\n  FROM prescriptions pr\n  JOIN filtered_admissions fa ON pr.hadm_id = fa.hadm_id\n  WHERE strftime('%Y-%m', pr.starttime) = strftime('%Y-%m', fa.admittime)\n)\nSELECT drug, COUNT(*) AS prescription_count\nFROM prescriptions_same_month\nGROUP BY drug\nORDER BY prescription_count DESC\nLIMIT 5;",
    "1eb7d8845e0439e31945047c": "WITH AdmittedPatients AS (\n  SELECT \n    p.subject_id,\n    a.hadm_id,\n    a.admittime\n  FROM patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  WHERE a.admittime >= DATE('now', '-1 year')\n    AND a.age BETWEEN 50 AND 59\n),\nDiagnosedPatients AS (\n  SELECT \n    ap.subject_id,\n    ap.hadm_id,\n    ap.admittime\n  FROM AdmittedPatients ap\n  JOIN diagnoses_icd d ON ap.hadm_id = d.hadm_id\n  JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n  WHERE ddi.long_title = 'Acute pulmonary edema'\n),\nPrescribedDrugs AS (\n  SELECT \n    dp.subject_id,\n    dp.hadm_id,\n    dp.admittime,\n    pr.drug\n  FROM DiagnosedPatients dp\n  JOIN prescriptions pr ON dp.hadm_id = pr.hadm_id\n  WHERE pr.starttime >= dp.admittime\n    AND pr.starttime <= DATE(dp.admittime, '+2 months')\n)\nSELECT \n  drug,\n  COUNT(*) as frequency\nFROM PrescribedDrugs\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 5;",
    "80d21b657d5ff088f889a360": "WITH Age50Patients AS (\n    SELECT \n        p.subject_id\n    FROM \n        patients p\n    INNER JOIN \n        diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN \n        d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n    WHERE \n        p.age >= 50 \n        AND d2.long_title LIKE '%pulmonary collapse%'\n),\nFrequentDrugs AS (\n    SELECT \n        pr.drug,\n        COUNT(*) AS count\n    FROM \n        prescriptions pr\n    INNER JOIN \n        Age50Patients ap ON pr.subject_id = ap.subject_id\n    WHERE \n        pr.hadm_id IS NOT NULL\n    GROUP BY \n        pr.drug\n)\nSELECT \n    drug, \n    count\nFROM \n    FrequentDrugs\nORDER BY \n    count DESC\nLIMIT 3;",
    "41cdc4c25b362c10ff183c0c": "SELECT \n  p.drug, \n  COUNT(p.row_id) AS prescription_count\nFROM \n  prescriptions p\nJOIN \n  diagnoses_icd d ON p.subject_id = d.subject_id AND p.hadm_id = d.hadm_id\nJOIN \n  d_icd_diagnoses di ON d.icd_code = di.icd_code\nJOIN \n  admissions a ON p.subject_id = a.subject_id AND p.hadm_id = a.hadm_id\nWHERE \n  di.long_title LIKE '%unspecified atrial fibrillation%' \n  AND a.age >= 60 \n  AND p.starttime >= '2100-01-01' \n  AND p.stoptime <= DATE(p.starttime, '+2 months')\nGROUP BY \n  p.drug\nORDER BY \n  prescription_count DESC\nLIMIT 5;",
    "2666b04409be1528ae23a0f2": "WITH patient_data AS (\n    SELECT\n        p.subject_id,\n        a.admittime,\n        d.icd_code,\n        c.drug,\n        c.dose_val_rx,\n        c.dose_unit_rx,\n        c.route\n    FROM\n        patients p\n        JOIN admissions a ON p.subject_id = a.subject_id\n        JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id\n        JOIN prescriptions c ON a.hadm_id = c.hadm_id\n    WHERE\n        p.gender IN ('Male', 'Female') AND\n        a.admittime >= '2100-01-01' AND\n        a.admittime <= DATE('2100-01-01', '+2 months') AND\n        a.age >= 60 AND\n        d.icd_code IN (\n            SELECT icd_code FROM d_icd_diagnoses WHERE long_title LIKE '%Esophageal Reflux%'\n        )\n),\nprescription_counts AS (\n    SELECT\n        drug,\n        COUNT(*) AS prescription_count\n    FROM\n        patient_data\n    GROUP BY\n        drug\n)\nSELECT\n    drug,\n    prescription_count\nFROM\n    prescription_counts\nORDER BY\n    prescription_count DESC\nLIMIT 4;",
    "b37d67ade52f97c81e373d0a": "SELECT T1.drug, COUNT(*) AS frequency\nFROM prescriptions T1\nJOIN admissions T2 ON T1.hadm_id = T2.hadm_id\nJOIN diagnoses_icd T3 ON T2.hadm_id = T3.hadm_id\nJOIN d_icd_diagnoses T4 ON T3.icd_code = T4.icd_code\nWHERE T4.long_title LIKE '%long-term use of anticoagulants%'\n  AND T2.admittime >= '2100-01-01'\n  AND T2.age BETWEEN 40 AND 49\n  AND T1.starttime BETWEEN T2.admittime AND DATE(T2.admittime, '+2 months')\nGROUP BY T1.drug\nORDER BY frequency DESC\nLIMIT 5;",
    "d13e321a100730513005c82e": "SELECT \n  d_labitems.label, \n  COUNT(labevents.row_id) AS frequency\nFROM \n  labevents\n  INNER JOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE \n  labevents.charttime >= '2100-01-01 00:00:00'\nGROUP BY \n  d_labitems.label\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "af7e3057fad8f361ba5398f2": "SELECT itemid, COUNT(*) as frequency\nFROM labevents\nGROUP BY itemid\nORDER BY frequency DESC\nLIMIT 3;",
    "f84cee29b1ae0e5b38a4dad0": "SELECT \n    l.label AS lab_test, \n    COUNT(le.row_id) AS test_count\nFROM \n    labevents le\nINNER JOIN \n    d_labitems l ON le.itemid = l.itemid\nGROUP BY \n    l.label\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "1d528e1e56f65f65ff457076": "SELECT \n  l.label, \n  COUNT(le.row_id) AS total_events\nFROM \n  labevents le\n  INNER JOIN d_labitems l ON le.itemid = l.itemid\nWHERE \n  le.charttime >= '2020-01-01' AND le.charttime <= '2020-12-31'\nGROUP BY \n  l.label\nORDER BY \n  total_events DESC\nLIMIT 3;",
    "5fb01bc80ec79080b29a6120": "SELECT \n  dl.label AS lab_test, \n  COUNT(*) AS num_lab_events\nFROM \n  labevents le\n  INNER JOIN d_labitems dl ON le.itemid = dl.itemid\nWHERE \n  strftime('%Y', le.charttime) = strftime('%Y', 'now')\nGROUP BY \n  dl.label\nORDER BY \n  num_lab_events DESC\nLIMIT 5;",
    "ce78082eae0149ee1ca4091e": "SELECT \n  l.label AS test_name, \n  COUNT(le.row_id) AS num_tests\nFROM \n  labevents le\n  INNER JOIN d_labitems l ON le.itemid = l.itemid\nWHERE \n  le.charttime >= DATE('now', '-1 year')\nGROUP BY \n  l.label\nORDER BY \n  num_tests DESC\nLIMIT 4;",
    "7bd6751dde3ebad15506d38c": "SELECT itemid, COUNT(*) AS count\nFROM labevents\nGROUP BY itemid\nORDER BY count DESC\nLIMIT 3;",
    "bf24656774e10abbee09d3cd": "SELECT \n  l.label, \n  COUNT(le.row_id) AS test_count\nFROM \n  labevents le\n  JOIN d_labitems l ON le.itemid = l.itemid\n  JOIN patients p ON le.subject_id = p.subject_id\nWHERE \n  strftime('%Y', le.charttime) = strftime('%Y', 'now') \n  AND (strftime('%Y', p.dob) * -1 + strftime('%m%d', p.dob) < 5000 \n       OR strftime('%Y', p.dob) * -1 + strftime('%m%d', p.dob) >= 4959)\nGROUP BY \n  l.label\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "cef34f939a935672ef767a10": "WITH Admissions2100 AS (\n  SELECT \n    subject_id\n  FROM \n    admissions\n  WHERE \n    admittime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59'\n    AND age BETWEEN 30 AND 39\n)\nSELECT \n  dl.label AS LabTest,\n  COUNT(le.row_id) AS Frequency\nFROM \n  Admissions2100 a\n  INNER JOIN labevents le ON a.subject_id = le.subject_id\n  INNER JOIN d_labitems dl ON le.itemid = dl.itemid\nGROUP BY \n  dl.label\nORDER BY \n  Frequency DESC\nLIMIT 3;",
    "d1d88ee5c7476300c168be49": "SELECT \n    dl.label AS lab_test_name, \n    COUNT(*) AS test_count\nFROM \n    labevents le\nINNER JOIN \n    d_labitems dl ON le.itemid = dl.itemid\nINNER JOIN \n    admissions a ON le.hadm_id = a.hadm_id\nWHERE \n    a.age >= 60\nGROUP BY \n    dl.label\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "a3ae25ab7f7d7f11e9ba773d": "SELECT d.label, COUNT(*) AS test_count\nFROM labevents l\nJOIN d_labitems d ON l.itemid = d.itemid\nJOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE a.age = 40\nGROUP BY d.label\nORDER BY test_count DESC\nLIMIT 5;",
    "d53c40ad49a43a529f6a58f1": "SELECT \n  L.label AS lab_test_name,\n  COUNT(*) AS test_count\nFROM \n  labevents LE\n  INNER JOIN d_labitems L ON LE.itemid = L.itemid\nWHERE \n  LE.charttime >= DATE('now', '-1 year') \n  AND LE.subject_id IN (\n    SELECT \n      A.subject_id\n    FROM \n      admissions A\n    WHERE \n      A.age BETWEEN 30 AND 39\n  )\nGROUP BY \n  L.label\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "7057698bd91fd3229c372ff8": "SELECT l.label, COUNT(*) AS frequency\nFROM labevents le\nJOIN d_labitems l ON le.itemid = l.itemid\nJOIN admissions a ON le.hadm_id = a.hadm_id\nWHERE le.charttime >= DATE('now', '-1 year')\n  AND a.age BETWEEN 20 AND 29\nGROUP BY l.label\nORDER BY frequency DESC\nLIMIT 3;",
    "66d3d7f7819e195408389a4b": "WITH PatientsIn20s AS (\n    SELECT \n        p.subject_id\n    FROM \n        patients p\n    WHERE \n        strftime('%Y', 'now') - strftime('%Y', p.dob) BETWEEN 20 AND 29\n),\nLabTests AS (\n    SELECT \n        l.subject_id,\n        d.label AS lab_test\n    FROM \n        labevents l\n    JOIN \n        d_labitems d ON l.itemid = d.itemid\n    WHERE \n        l.subject_id IN (SELECT subject_id FROM PatientsIn20s)\n),\nTestCounts AS (\n    SELECT \n        lab_test,\n        COUNT(*) AS test_count\n    FROM \n        LabTests\n    GROUP BY \n        lab_test\n)\nSELECT \n    lab_test,\n    test_count\nFROM \n    TestCounts\nORDER BY \n    test_count DESC\nLIMIT 3;",
    "dd62c1497314b1bea83b2d03": "WITH AdmittedPatients AS (\n  SELECT \n    a.subject_id,\n    a.hadm_id\n  FROM \n    admissions a\n  INNER JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\n  INNER JOIN \n    d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE \n    di.long_title LIKE '%personal history of malignant neoplasm of other gastrointestinal tract%'\n),\nLabEvents AS (\n  SELECT \n    l.subject_id,\n    l.itemid,\n    COUNT(*) AS frequency\n  FROM \n    labevents l\n  INNER JOIN \n    AdmittedPatients ap ON l.subject_id = ap.subject_id AND l.hadm_id = ap.hadm_id\n  GROUP BY \n    l.subject_id, l.itemid\n),\nRankedTests AS (\n  SELECT \n    l.itemid,\n    li.label,\n    SUM(l.frequency) AS total_frequency\n  FROM \n    LabEvents l\n  INNER JOIN \n    d_labitems li ON l.itemid = li.itemid\n  GROUP BY \n    l.itemid, li.label\n  ORDER BY \n    total_frequency DESC\n)\nSELECT \n  label, \n  total_frequency\nFROM \n  RankedTests\nLIMIT 3;",
    "1fe684c6e5b20d9ad964f6ac": "",
    "0bdfa86a31bd61b14767f632": "SELECT \n  l.label, \n  COUNT(*) AS test_count\nFROM \n  labevents le\nJOIN \n  d_labitems l ON le.itemid = l.itemid\nWHERE \n  le.charttime >= '2100-01-01' \n  AND le.charttime < DATE('2100-01-01', '+1 month')\nGROUP BY \n  l.label\nORDER BY \n  test_count DESC\nLIMIT 3;",
    "8cbd43defc418d1da88f21b2": "Select admissions where patients are diagnosed as adults since 1 year ago.\n2. **Filter Diagnoses**: Ensure the diagnoses are for BMI between 19-24.\n3. **Join Lab Events**: Join with `labevents` to get the lab tests performed during those admissions.\n4. **Count Lab Tests**: Count the frequency of each lab test.\n5. **Limit to Top 3**: Order the counts and limit the results to the top three.",
    "89a55d6a6cba3898d5b52d9c": "WITH DiagnosedPatients AS (\n    SELECT DISTINCT p.subject_id\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    INNER JOIN d_icd_diagnoses ddi ON d.icd_code = ddi.icd_code\n    WHERE ddi.long_title LIKE '%Drug-induced agranulocytosis%'\n),\nFilteredLabEvents AS (\n    SELECT le.subject_id, le.itemid, le.charttime\n    FROM labevents le\n    INNER JOIN DiagnosedPatients dp ON le.subject_id = dp.subject_id\n    WHERE le.charttime >= DATE('now', 'start of year')\n)\nSELECT l.label, COUNT(*) AS frequency\nFROM FilteredLabEvents fle\nINNER JOIN d_labitems l ON fle.itemid = l.itemid\nGROUP BY l.label\nORDER BY frequency DESC\nLIMIT 3;",
    "e874c2a103f4267d6ddfed15": "SELECT \n  d_labitems.label AS lab_test,\n  COUNT(*) AS frequency\nFROM \n  labevents le\n  INNER JOIN d_labitems d_labitems ON le.itemid = d_labitems.itemid\n  INNER JOIN diagnoses_icd di ON le.hadm_id = di.hadm_id\n  INNER JOIN d_icd_diagnoses d_icd_diagnoses ON di.icd_code = d_icd_diagnoses.icd_code\nWHERE \n  d_icd_diagnoses.long_title = 'Cerebral laceration and contusion, other and unspecified; without mention of open intracranial wound; with loss of consciousness of unspecified duration'\n  AND le.charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59'\n  AND STRFTIME('%m', le.charttime) = STRFTIME('%m', DATE(le.charttime, '+1 month'))\nGROUP BY \n  d_labitems.label\nORDER BY \n  frequency DESC\nLIMIT 4;",
    "6d7e2ca9e692a3b833e8d4c2": "-- Step 1: Identify patients diagnosed with esophagitis, unspecified since 2100.\n-- Step 2: Find lab tests for these patients.\n-- Step 3: Count the frequency of each lab test.\n-- Step 4: Select the top five lab tests.\n\nWITH DiagnosedPatients AS (\n    SELECT p.subject_id, d.label AS diagnosis_label\n    FROM patients p\n    INNER JOIN diagnoses_icd di ON p.subject_id = di.subject_id\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE d.icd_code = 'K25.11'\n),\nLabTests AS (\n    SELECT dp.subject_id, dl.label AS lab_test_label\n    FROM DiagnosedPatients dp\n    INNER JOIN labevents l ON dp.subject_id = l.subject_id\n    INNER JOIN d_labitems dl ON l.itemid = dl.itemid\n)\nSELECT lab_test_label, COUNT(*) AS test_count\nFROM LabTests\nGROUP BY lab_test_label\nORDER BY test_count DESC\nLIMIT 5;",
    "70826ed4c727196227cb1ef9": "SELECT \n  d.label AS LabTest, \n  COUNT(*) AS TestCount\nFROM \n  labevents l\n  INNER JOIN d_labitems d ON l.itemid = d.itemid\n  INNER JOIN procedures_icd p ON l.subject_id = p.subject_id AND l.hadm_id = p.hadm_id\nWHERE \n  p.icd_code = '00.63' AND \n  strftime('%Y-%m', l.charttime) = strftime('%Y-%m', (SELECT charttime FROM labevents WHERE itemid = d.row_id LIMIT 1))\nGROUP BY \n  d.label\nORDER BY \n  TestCount DESC\nLIMIT 5;",
    "5a615775859c42b0cfc588b1": "WITH lab_tests AS (\n  SELECT \n    l.itemid,\n    d.label,\n    strftime('%Y-%m', l.charttime) AS lab_test_month\n  FROM \n    labevents l\n  INNER JOIN \n    d_labitems d ON l.itemid = d.itemid\n  INNER JOIN \n    prescriptions p ON l.subject_id = p.subject_id AND l.hadm_id = p.hadm_id\n  WHERE \n    p.drug = 'Ultrasonography of Superior Vena Cava, Guidance in 2100'\n    AND l.charttime >= p.starttime\n    AND l.charttime <= p.stoptime\n)\nSELECT \n  label,\n  COUNT(*) AS total_tests\nFROM \n  lab_tests\nGROUP BY \n  label, lab_test_month\nORDER BY \n  total_tests DESC\nLIMIT 5;",
    "96dabd861de92e31433a8552": "SELECT l.itemid, COUNT(*) AS frequency\nFROM labevents l\nJOIN admissions a ON l.hadm_id = a.hadm_id\nWHERE strftime('%Y-%m', l.charttime) = strftime('%Y-%m', a.admittime)\n  AND a.admission_type = 'Alcohol Detoxification in 2100'\nGROUP BY l.itemid\nORDER BY frequency DESC\nLIMIT 5;",
    "03a6a876fbcd2443f7f28749": "SELECT \n  l.label, \n  COUNT(*) AS lab_test_count\nFROM \n  procedures_icd p\n  JOIN d_icd_procedures pr ON p.icd_code = pr.icd_code\n  JOIN labevents lb ON p.subject_id = lb.subject_id AND p.hadm_id = lb.hadm_id\n  JOIN d_labitems l ON lb.itemid = l.itemid\nWHERE \n  pr.long_title = 'Other skin graft to other sites'\n  AND strftime('%Y-%m', lb.charttime) = strftime('%Y-%m', p.charttime)\nGROUP BY \n  l.label\nORDER BY \n  lab_test_count DESC\nLIMIT 4;",
    "7af6e600c77232304b81e62d": "selections, and misalignment with the question. Let's start from scratch and craft a proper SQL query.",
    "91b9ca43bd8f11ad31a158c7": "WITH icd_procedures AS (\n    SELECT icd_code \n    FROM d_icd_procedures \n    WHERE long_title LIKE '%laryngoscopy%' \n       OR long_title LIKE '%other tracheoscopy%'\n),\nlabeled_lab_events AS (\n    SELECT l.itemid, d.label, l.charttime \n    FROM labevents l \n    INNER JOIN d_labitems d ON l.itemid = d.itemid \n    INNER JOIN procedures_icd p ON l.subject_id = p.subject_id AND l.hadm_id = p.hadm_id\n    WHERE p.icd_code IN (SELECT icd_code FROM icd_procedures)\n)\nSELECT label, COUNT(*) AS test_count\nFROM labeled_lab_events\nGROUP BY label\nORDER BY test_count DESC\nLIMIT 4;",
    "43bc1abffacc510680225ed9": "SELECT l.itemid, COUNT(*) AS lab_test_count\nFROM labevents l\nJOIN procedures_icd p ON l.hadm_id = p.hadm_id\nWHERE p.icd_code = '00.82' \nAND l.charttime BETWEEN DATE('now', '-1 year') AND DATE('now', '+1 month')\nGROUP BY l.itemid\nORDER BY lab_test_count DESC\nLIMIT 3;",
    "ecea3263ba9f3a57a309a2e0": "WITH SpecimenTests AS (\n    SELECT \n        test_name,\n        COUNT(*) AS test_count\n    FROM \n        microbiologyevents\n    WHERE \n        charttime >= DATE('now', '-1 year')\n    GROUP BY \n        test_name\n)\nSELECT \n    test_name,\n    test_count\nFROM \n    SpecimenTests\nORDER BY \n    test_count DESC\nLIMIT 3;",
    "edfa0b11933920062d92aacd": "SELECT \n  spec_type_desc, \n  COUNT(*) as test_count\nFROM \n  microbiologyevents\nWHERE \n  strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY \n  spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "26803d48dd00e769e38ea0c9": "SELECT \n    spec_type_desc,\n    COUNT(*) AS test_count\nFROM \n    microbiologyevents\nWHERE \n    charttime >= DATE('now', '-1 year')\nGROUP BY \n    spec_type_desc\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "9e48890388b483b0f182a90f": "SELECT \n    spec_type_desc, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents\nGROUP BY \n    spec_type_desc\nORDER BY \n    test_count DESC\nLIMIT 3;",
    "1be9f21ac47235a697190eda": "SELECT \n  spec_type_desc,\n  COUNT(*) AS num_tests\nFROM \n  microbiologyevents\nWHERE \n  charttime >= date('now', 'start of year')\nGROUP BY \n  spec_type_desc\nORDER BY \n  num_tests DESC\nLIMIT 3;",
    "ebbeed93dad8985ba95cce74": "SELECT spec_type_desc, COUNT(*) AS test_count\nFROM microbiologyevents\nGROUP BY spec_type_desc\nORDER BY test_count DESC\nLIMIT 3;",
    "dbc4399f5a3526b4598df3ef": "SELECT \n    spec_type_desc, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents\nWHERE \n    strftime('%Y', charttime) = '2100'\nGROUP BY \n    spec_type_desc\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "bbd60f29527c9ff438a314a7": "SELECT \n    test_name, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents\nWHERE \n    strftime('%Y', charttime) = '2100'\nGROUP BY \n    test_name\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "1fc44208dad68f8a906cda39": "SELECT \n    m.test_name, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents m\nWHERE \n    strftime('%Y', m.charttime) = strftime('%Y', 'now')\nGROUP BY \n    m.test_name\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "4a3678f63c0a0b08ed66585f": "SELECT \n  test_name, \n  COUNT(*) AS total_tests\nFROM \n  microbiologyevents\nGROUP BY \n  test_name\nORDER BY \n  total_tests DESC\nLIMIT 5;",
    "d2e2315a6ae7e509d95f1cdd": "SELECT test_name, COUNT(*) as frequency\nFROM microbiologyevents\nWHERE strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY test_name\nORDER BY frequency DESC\nLIMIT 5;",
    "4fcb903cb5d317c791dae3af": "SELECT test_name, COUNT(*) AS total_tests\nFROM microbiologyevents\nWHERE charttime >= '2100-01-01'\nGROUP BY test_name\nORDER BY total_tests DESC\nLIMIT 5;",
    "4fd7632b17c70b416ebcfdda": "SELECT \n  test_name, \n  COUNT(*) AS total_tests\nFROM \n  microbiologyevents\nWHERE \n  strftime('%Y', charttime) = strftime('%Y', 'now')\nGROUP BY \n  test_name\nORDER BY \n  total_tests DESC\nLIMIT 3;",
    "bf89f78810c2095c0e36f24b": "SELECT test_name, COUNT(*) AS test_count\nFROM microbiologyevents\nGROUP BY test_name\nORDER BY test_count DESC\nLIMIT 4;",
    "433a98b0bf77207fccd6fb2f": "SELECT \n  micro.spec_type_desc \nFROM \n  microbiologyevents micro \n  INNER JOIN diagnoses_icd diag \n  ON micro.hadm_id = diag.hadm_id \nWHERE \n  diag.icd_code = 'V07.0' \n  AND micro.charttime BETWEEN '2100-01-01' AND '2100-12-31' \nGROUP BY \n  micro.spec_type_desc \nORDER BY \n  COUNT(micro.spec_type_desc) DESC \nLIMIT 5;",
    "9e193ae2615e441e04331514": "WITH diagnosed_patients AS (\n  SELECT p.subject_id\n  FROM patients p\n  INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n  INNER JOIN d_icd_diagnoses di ON d.icd_code = di.icd_code\n  WHERE di.long_title LIKE '%encounter for attention to other artificial openings of digestive tract%'\n    AND d.charttime BETWEEN p.dob AND DATE(p.dob, '+2 months')\n),\ntested_specimens AS (\n  SELECT m.spec_type_desc, COUNT(*) AS test_count\n  FROM diagnosed_patients dp\n  INNER JOIN microbiologyevents m ON dp.subject_id = m.subject_id\n  GROUP BY m.spec_type_desc\n)\nSELECT spec_type_desc, test_count\nFROM tested_specimens\nORDER BY test_count DESC\nLIMIT 3;",
    "65d676a4636cc2e1592ca2c0": "WITH diagnosed_patients AS (\n    SELECT p.subject_id, d.charttime AS diagnosis_time\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    WHERE d.icd_code = '2100'\n),\ntested_specimens AS (\n    SELECT dp.subject_id, m.spec_type_desc, m.charttime AS test_time\n    FROM diagnosed_patients dp\n    INNER JOIN microbiologyevents m ON dp.subject_id = m.subject_id\n    WHERE m.charttime BETWEEN dp.diagnosis_time AND DATE(dp.diagnosis_time, '+1 month')\n)\nSELECT spec_type_desc, COUNT(*) AS test_count\nFROM tested_specimens\nGROUP BY spec_type_desc\nORDER BY test_count DESC\nLIMIT 4;",
    "5fc8a96c9b2c962520c2667f": "",
    "925dc1173f6122d67b2847c7": "SELECT \n    m.spec_type_desc, \n    COUNT(*) AS test_frequency\nFROM \n    microbiologyevents m\nJOIN \n    diagnoses_icd d ON m.subject_id = d.subject_id AND m.hadm_id = d.hadm_id\nJOIN \n    d_icd_diagnoses di ON d.icd_code = di.icd_code\nWHERE \n    di.long_title IN ('Oliguria', 'Anuria')\n    AND strftime('%Y', m.charttime) = strftime('%Y', 'now')\n    AND strftime('%m', m.charttime) = strftime('%m', d.charttime)\nGROUP BY \n    m.spec_type_desc\nORDER BY \n    test_frequency DESC\nLIMIT 4;",
    "325e6c5f09459a46cc53281b": "WITH ChronicLymphocyticLeukemia AS (\n    SELECT hadm_id\n    FROM diagnoses_icd\n    WHERE icd_code = 'C91.0'\n),\nSpecimenCounts AS (\n    SELECT \n        micro.spec_type_desc, \n        COUNT(*) AS count\n    FROM ChronicLymphocyticLeukemia cll\n    JOIN microbiologyevents micro ON cll.hadm_id = micro.hadm_id\n    GROUP BY micro.spec_type_desc\n)\nSELECT \n    spec_type_desc, \n    count\nFROM SpecimenCounts\nORDER BY count DESC\nLIMIT 5;",
    "50cfc25b33dbf1f04dd32e42": "SELECT \n  spec_type_desc \nFROM \n  microbiologyevents \nWHERE \n  charttime >= DATE('now', '-1 year') \nGROUP BY \n  spec_type_desc \nORDER BY \n  COUNT(spec_type_desc) DESC \nLIMIT 4;",
    "7a8ffac3b4d9276671a4aa1f": "",
    "10c4954997c7b5eab9c3c231": "SELECT me.test_name, COUNT(*) AS test_count\nFROM microbiologyevents me\nJOIN admissions a ON me.hadm_id = a.hadm_id\nJOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\nJOIN d_icd_diagnoses dicd ON di.icd_code = dicd.icd_code\nWHERE dicd.long_title = 'Noncompliance with renal dialysis'\nAND (a.dischtime IS NULL OR a.dischtime > DATE(a.admittime, '+2 months'))\nGROUP BY me.test_name\nORDER BY test_count DESC\nLIMIT 5;",
    "ff5188901ba8d46da87b9474": "SELECT m.test_name, COUNT(*) AS frequency\nFROM microbiologyevents m\nJOIN diagnoses_icd d ON m.subject_id = d.subject_id AND m.hadm_id = d.hadm_id\nWHERE d.icd_code = 'I50.1' \nAND strftime('%Y-%m', m.charttime) = strftime('%Y-%m', d.charttime)\nGROUP BY m.test_name\nORDER BY frequency DESC\nLIMIT 4;",
    "e63613e89815854b2cdf338c": "SELECT \n    T2.test_name AS \"Test Name\",\n    COUNT(*) AS \"Test Count\"\nFROM \n    diagnoses_icd AS T1\nINNER JOIN \n    microbiologyevents AS T2 ON T1.subject_id = T2.subject_id AND T1.hadm_id = T2.hadm_id\nINNER JOIN \n    d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nWHERE \n    T3.long_title LIKE '%hemoperitoneum%' AND \n    T2.charttime >= '2100-01-01'\nGROUP BY \n    T2.test_name\nORDER BY \n    \"Test Count\" DESC\nLIMIT 3;",
    "26c5ef7c7c93262038e4d7d0": "WITH DiagnosisCTE AS (\n    SELECT \n        hadm_id\n    FROM diagnoses_icd\n    WHERE icd_code = 'C19.00'\n),\nMicrobiologyCTE AS (\n    SELECT \n        test_name\n    FROM microbiologyevents\n    WHERE hadm_id IN (SELECT hadm_id FROM DiagnosisCTE)\n)\nSELECT \n    test_name, \n    COUNT(*) AS frequency\nFROM MicrobiologyCTE\nGROUP BY test_name\nORDER BY frequency DESC\nLIMIT 5;",
    "e62be6f32c868f298911cc1e": "WITH RelevantDiagnoses AS (\n    SELECT \n        d.subject_id,\n        d.hadm_id\n    FROM \n        diagnoses_icd d\n    INNER JOIN \n        d_icd_diagnoses dd ON d.icd_code = dd.icd_code\n    WHERE \n        dd.long_title LIKE '%Supermarket%' OR\n        dd.long_title LIKE '%Store%' OR\n        dd.long_title LIKE '%Market%'\n),\nRelevantAdmissions AS (\n    SELECT \n        a.subject_id,\n        a.hadm_id,\n        strftime('%Y-%m', a.admittime) AS admittime_month\n    FROM \n        admissions a\n    INNER JOIN \n        RelevantDiagnoses rd ON a.subject_id = rd.subject_id AND a.hadm_id = rd.hadm_id\n),\nRelevantMicrobiologyEvents AS (\n    SELECT \n        me.subject_id,\n        me.hadm_id,\n        me.test_name,\n        strftime('%Y-%m', me.charttime) AS charttime_month\n    FROM \n        microbiologyevents me\n    INNER JOIN \n        RelevantAdmissions ra ON me.subject_id = ra.subject_id AND me.hadm_id = ra.hadm_id\n    WHERE \n        me.charttime_month = ra.admittime_month\n)\nSELECT \n    test_name,\n    COUNT(*) AS test_count\nFROM \n    RelevantMicrobiologyEvents\nGROUP BY \n    test_name\nORDER BY \n    test_count DESC\nLIMIT 4;",
    "10f5ecdf9123785c95f2bff6": "SELECT \n    me.test_name, \n    COUNT(*) as frequency\nFROM \n    microbiologyevents me\nJOIN \n    transfers t ON me.subject_id = t.subject_id AND me.hadm_id = t.hadm_id\nWHERE \n    t.eventtype = 'Dependence on Respirator'\n    AND me.charttime > t.intime \n    AND me.charttime < t.outtime\nGROUP BY \n    me.test_name\nORDER BY \n    frequency DESC\nLIMIT 5;",
    "ed1c971e6bd14f5788256c98": "WITH UltrasoundPatients AS (\n  SELECT p.subject_id, p.hadm_id\n  FROM procedures_icd p\n  JOIN d_icd_procedures d ON p.icd_code = d.icd_code\n  WHERE d.long_title = 'Diagnostic ultrasound of digestive system'\n),\nSpecimensTested AS (\n  SELECT m.spec_type_desc\n  FROM UltrasoundPatients u\n  JOIN microbiologyevents m ON u.subject_id = m.subject_id AND u.hadm_id = m.hadm_id\n)\nSELECT spec_type_desc, COUNT(*) AS frequency\nFROM SpecimensTested\nGROUP BY spec_type_desc\nORDER BY frequency DESC\nLIMIT 3;",
    "f5b5e126ecc950d4e5b6eb18": "SELECT me.spec_type_desc, COUNT(*) AS frequency\nFROM microbiologyevents me\nINNER JOIN procedures_icd pi ON me.subject_id = pi.subject_id AND me.hadm_id = pi.hadm_id\nINNER JOIN d_icd_procedures dip ON pi.icd_code = dip.icd_code\nWHERE dip.long_title = 'Fluoroscopy of right heart using other contrast'\n  AND me.charttime BETWEEN DATE('now', '-1 year') AND DATE('now', '-2 months')\nGROUP BY me.spec_type_desc\nORDER BY frequency DESC\nLIMIT 5;",
    "7d987252b086db272f8e0751": "SELECT spec_type_desc\nFROM (\n    SELECT spec_type_desc, COUNT(*) AS count\n    FROM microbiologyevents\n    WHERE charttime BETWEEN '2100-01-01' AND '2100-01-31'\n    AND hadm_id IN (\n        SELECT hadm_id\n        FROM procedures_icd\n        INNER JOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\n        WHERE d_icd_procedures.long_title = 'Drainage of peritoneal cavity, percutaneous approach'\n    )\n    GROUP BY spec_type_desc\n) AS subquery\nORDER BY count DESC\nLIMIT 3;",
    "f9e732b63b0f86d15d3ab6be": "SELECT \n  spec_type_desc,\n  COUNT(*) AS test_count\nFROM \n  microbiologyevents\nWHERE \n  charttime BETWEEN DATE('now', '-2 months') AND DATE('now')\nGROUP BY \n  spec_type_desc\nORDER BY \n  test_count DESC\nLIMIT 5;",
    "2ee9bfe879e3910ff859b7cc": "WITH ProcedurePatients AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.charttime AS procedure_date\n    FROM \n        procedures_icd p\n    INNER JOIN \n        d_icd_procedures icd ON p.icd_code = icd.icd_code\n    WHERE \n        icd.long_title = 'Dilation of left external iliac vein with intraluminal device, percutaneous approach since 2100'\n),\nSpecimens AS (\n    SELECT \n        m.spec_type_desc AS specimen,\n        m.charttime AS specimen_date\n    FROM \n        ProcedurePatients pp\n    INNER JOIN \n        microbiologyevents m ON pp.subject_id = m.subject_id AND pp.hadm_id = m.hadm_id\n    WHERE \n        m.charttime BETWEEN pp.procedure_date AND DATE(pp.procedure_date, '+2 month')\n)\nSELECT \n    specimen,\n    COUNT(*) AS specimen_count\nFROM \n    Specimens\nGROUP BY \n    specimen\nORDER BY \n    specimen_count DESC\nLIMIT 4;",
    "aec06629971fa88ed8810ca9": "SELECT \n  m.spec_type_desc AS Specimen_Type, \n  COUNT(m.row_id) AS Specimen_Count\nFROM \n  microbiologyevents m\n  JOIN diagnoses_icd d ON m.hadm_id = d.hadm_id\n  JOIN admissions a ON m.hadm_id = a.hadm_id\nWHERE \n  d.icd_code = 'B95.1'\n  AND m.charttime >= DATE('now', '-2 months')\n  AND m.charttime < DATE('now')\nGROUP BY \n  m.spec_type_desc\nORDER BY \n  Specimen_Count DESC\nLIMIT 5;",
    "4ba8cbb501d0444c977e72d0": "SELECT \n    T1.spec_type_desc, \n    COUNT(*) AS test_count\nFROM \n    microbiologyevents AS T1\nINNER JOIN \n    admissions AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN \n    prescriptions AS T3 ON T2.hadm_id = T3.hadm_id\nWHERE \n    T3.drug LIKE '%introduction of nutritional substance into central vein, percutaneous approach%'\nGROUP BY \n    T1.spec_type_desc\nORDER BY \n    test_count DESC\nLIMIT 5;",
    "be6fb8ffe49a397f297313f4": "SELECT \n  itemid,\n  totalamount,\n  totalamountuom,\n  COUNT(*) AS input_count\nFROM \n  inputevents\nWHERE \n  starttime >= DATETIME('now', '-1 year')\nGROUP BY \n  itemid, totalamount, totalamountuom\nORDER BY \n  input_count DESC\nLIMIT 5;",
    "bd78210b53ac66e8ca86ce3a": "",
    "f3977e7e8ae83d49d9e455e4": "SELECT \n  itemid,\n  COUNT(*) AS count\nFROM \n  inputevents\nWHERE \n  starttime >= datetime('now', '-1 year')\nGROUP BY \n  itemid\nORDER BY \n  count DESC\nLIMIT 5;",
    "66479b0a7f2004d265bf0c60": "SELECT \n  itemid, \n  COUNT(*) AS frequency \nFROM \n  inputevents \nWHERE \n  starttime > '2100-01-01' \nGROUP BY \n  itemid \nORDER BY \n  frequency DESC \nLIMIT 5;",
    "95f221c0f7e5b86fbfb2ff79": "SELECT \n  itemid, \n  COUNT(*) as total_inputs \nFROM \n  inputevents \nWHERE \n  starttime >= DATE('now', 'start of year') \nGROUP BY \n  itemid \nORDER BY \n  total_inputs DESC \nLIMIT 4;",
    "daa34761c136dbde698516a2": "SELECT \n  itemid, \n  COUNT(*) AS event_count\nFROM \n  inputevents\nWHERE \n  starttime >= '2000-01-01 00:00:00' AND starttime < '2001-01-01 00:00:00'\nGROUP BY \n  itemid\nORDER BY \n  event_count DESC\nLIMIT 4;",
    "e1f8cb5aaff18c51a75dbced": "",
    "2a77f183135d862ea4731d6a": "SELECT \n  itemid,\n  COUNT(*) AS output_count\nFROM \n  outputevents\nWHERE \n  charttime > '2100-01-01'\nGROUP BY \n  itemid\nORDER BY \n  output_count DESC\nLIMIT 3;",
    "fdafa588e078b95229c79d45": "SELECT itemid, COUNT(*) AS frequency\nFROM outputevents\nGROUP BY itemid\nORDER BY frequency DESC\nLIMIT 5;",
    "9d45b985bd7bacacbf80b3c2": "SELECT \n    outputevents.itemid, \n    d_items.label, \n    COUNT(*) AS event_count\nFROM \n    outputevents\nINNER JOIN \n    d_items ON outputevents.itemid = d_items.itemid\nGROUP BY \n    outputevents.itemid, d_items.label\nORDER BY \n    event_count DESC\nLIMIT 3;",
    "6537f5be5f67a433fed84ca7": "SELECT valueuom, COUNT(*) as output_count\nFROM outputevents\nWHERE valueuom LIKE '2100%'\nGROUP BY valueuom\nORDER BY output_count DESC\nLIMIT 4;",
    "6730aa47b18b0105eb3dd8a2": "SELECT \n  event_type, \n  COUNT(*) AS event_count\nFROM \n  cost\nWHERE \n  strftime('%Y', chargetime) = strftime('%Y', 'now')\nGROUP BY \n  event_type\nORDER BY \n  event_count DESC\nLIMIT 3;",
    "9fb8afdaaf96b44431b66905": "SELECT \n  oe.itemid, \n  oe.valueuom, \n  COUNT(*) AS total_output_events\nFROM \n  outputevents oe\nWHERE \n  oe.charttime >= DATE('now', '-1 year')\nGROUP BY \n  oe.itemid, oe.valueuom\nORDER BY \n  total_output_events DESC\nLIMIT 5;",
    "34c567a447d41ec8f026b6e3": "SELECT event_type, COUNT(*) AS event_count\nFROM cost\nWHERE chargetime >= DATE('now', '-1 year')\nGROUP BY event_type\nORDER BY event_count DESC\nLIMIT 3;",
    "7bdfe013186f828667928905": "SELECT phone_number\nFROM users\nWHERE user_id = (SELECT user_id FROM patient_care WHERE patient_id = 28447);",
    "2a929f4140fa128b102740cd": "SELECT label FROM d_labitems WHERE label LIKE '%tanning beds%';\nSELECT label FROM d_labitems WHERE label LIKE '%fetus%';",
    "83ec5f2878ea0c3503d1e17b": "SELECT DISTINCT p.subject_id\nFROM prescriptions p\nWHERE p.drug = 'packed cell transfusion';",
    "f268157490484fd392fc3625": "SELECT 'Software' AS software;",
    "293a491c440d62e67c686f47": "",
    "66849fb36f1b3833ece51450": "",
    "003f7650b1ad418ca111edc9": "",
    "f0d34937f5d41dd42fe0b372": "SELECT long_title\nFROM d_icd_diagnoses\nWHERE long_title = 'depress psychosis-unspec'\nORDER BY row_id DESC\nLIMIT 10;",
    "f0058451e642bc79081d5500": "SELECT DISTINCT T1.label, T2.label\nFROM d_labitems T1\nINNER JOIN diagnoses_icd T3 ON T1.itemid = T3.row_id\nINNER JOIN d_icd_diagnoses T4 ON T3.icd_code = T4.icd_code\nINNER JOIN d_items T2 ON T2.itemid = T3.row_id\nWHERE T4.long_title LIKE '%pancreas pain%';",
    "c1d459523b1199c08ad0e0bc": "",
    "81998505a14291319bd54753": "SELECT label\nFROM d_labitems\nWHERE label LIKE '%engineer%';",
    "6762712ae8423c26a0745d35": "",
    "1bef0c762add8a8a0a693e94": "SELECT \n    CASE \n        WHEN a.language IS NOT NULL THEN a.language\n        ELSE (\n            SELECT p.gender \n            FROM patients p \n            WHERE p.subject_id = a.subject_id \n            LIMIT 1\n        )\n    END AS language\nFROM admissions a;",
    "d06e1b6a44abb8c2d06f5c31": "SELECT \n  icd_code, \n  COUNT(*) AS procedure_count\nFROM \n  procedures_icd\nGROUP BY \n  icd_code\nORDER BY \n  procedure_count DESC\nLIMIT 10;",
    "84c0a3f1d8f6eba51c9d5bee": "",
    "b61cbedd599810345dbf4e51": "",
    "9e1673ff38efcb44fd73240c": "SELECT \n  ic.first_careunit \nFROM \n  icustays ic \nWHERE \n  ic.first_careunit = 'MICU';",
    "a024d0f2f669a49d6d23c3cb": "WITH reflux_diagnoses AS (\n    SELECT\n        a.hadm_id,\n        a.admittime,\n        d.long_title AS diagnosis_title\n    FROM admissions a\n    INNER JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\n    INNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\n    WHERE d.long_title LIKE '%esophageal reflux%'\n)\nSELECT\n    hadm_id,\n    admittime,\n    diagnosis_title\nFROM reflux_diagnoses\nORDER BY admittime DESC\nLIMIT 10;",
    "30e2f83874ad5cfcfad469ae": "SELECT AVG(last_careunit - first_careunit) AS average_careunit_area\nFROM icustays;",
    "85e3fca57790810bb1784334": "SELECT DISTINCT test_name\nFROM microbiologyevents\nWHERE subject_id = 55360 AND DATE(charttime) = DATE('now');",
    "2421e3311f43427ac609f160": "",
    "216188fe302509bfcf221465": "SELECT DISTINCT a.marital_status\nFROM admissions a\nJOIN patients p ON a.subject_id = p.subject_id\nWHERE p.gender = 'Female' AND p.subject_id = (\n    SELECT subject_id\n    FROM patients\n    WHERE gender = 'Female' AND dob IS NOT NULL AND dod IS NULL\n    LIMIT 1\n);",
    "ca5022461fd46823f66c73e1": "SELECT \n  CAST(SUM(CASE WHEN T1.icd_code = 'I10' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.subject_id) AS percentage_with_hypertension\nFROM (\n  SELECT \n    p.subject_id, \n    d_icd.icd_code\n  FROM \n    patients p\n  JOIN \n    admissions a ON p.subject_id = a.subject_id\n  JOIN \n    diagnoses_icd d_icd ON a.hadm_id = d_icd.hadm_id\n  WHERE \n    p.gender = 'engineer'\n) T1;",
    "da729a26fea20170777e7a67": "",
    "56677fd269582e66886924c8": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nGROUP BY drug\nORDER BY frequency DESC;",
    "f1735f59888dc5e92a980156": "SELECT \n  T2.valueuom\nFROM \n  patients T1\n  INNER JOIN cost T3 ON T1.subject_id = T3.subject_id\n  INNER JOIN labevents T2 ON T3.hadm_id = T2.hadm_id\nWHERE \n  T1.gender = 'M'\nGROUP BY \n  T2.valueuom\nORDER BY \n  COUNT(T2.valueuom) DESC\nLIMIT 1;",
    "bc11ae111fd50da24024a238": "",
    "e6b1ea98e579fc0b9bbaf0da": "SELECT \n    p.gender,\n    COUNT(pr.row_id) AS prescription_count\nFROM \n    patients p\nJOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\nWHERE \n    pr.drug = 'Fentanyl Citrate'\nGROUP BY \n    p.gender;",
    "48f1e69154c4643e5a5b35d5": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1 \n            FROM admissions a1 \n            INNER JOIN admissions a2 ON a1.subject_id = a2.subject_id \n            WHERE a1.row_id <> a2.row_id \n            AND a2.dischtime > a1.admittime \n            AND a1.subject_id = 3745\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS future_visits;",
    "adc65ada307e86fe87be278f": "",
    "00d3e734f6e0469592eee929": "SELECT DISTINCT p.drug\nFROM prescriptions p\nWHERE p.drug IN (\n  SELECT d.label\n  FROM d_labitems d\n  WHERE d.label LIKE '%Headache%' OR d.label LIKE '%Migraine%'\n);",
    "14bb6c7bed022d576caf2a44": "SELECT T1.route, COUNT(T1.drug) AS total_prescriptions\nFROM prescriptions AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.age < 30\nGROUP BY T1.route\nORDER BY total_prescriptions DESC\nLIMIT 1;",
    "a4fb3217af375fa0143a8cbf": "SELECT \n    CASE \n        WHEN EXISTS (\n            SELECT 1 \n            FROM admissions a \n            WHERE a.subject_id = 26817 AND a.discharge_location IN (\n                SELECT t.careunit \n                FROM transfers t \n                WHERE t.subject_id = 26817 AND t.eventtype = 'discharge' AND t.outtime IS NOT NULL\n            )\n        ) THEN 'Yes'\n        ELSE 'No'\n    END AS plan_to_visit_other_departments;",
    "e1f71e2a39e7ce12a6a21ad9": "SELECT T2.label \nFROM labevents AS T1 \nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid \nWHERE T1.valuenum = 63.5;",
    "5a5c4c6d198bda6e1670161f": "SELECT COUNT(*) AS number_of_procedures\nFROM procedures_icd pi\nINNER JOIN d_icd_procedures dp ON pi.icd_code = dp.icd_code\nWHERE dp.long_title LIKE '%anesthesia%'\nAND pi.charttime >= DATE('now', '-1 month');",
    "a9c7e7917e0b8969446e33a7": "SELECT COUNT(*) AS total_admissions\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE strftime('%Y', a.admittime) = strftime('%Y', 'now')\nAND p.gender = 'Male'\nAND p.gender = 'Female'\nAND p.gender != 'Unknown'\nAND p.dob LIKE '%France%';",
    "c9dd0d430bbf3d22e3f3e059": "",
    "8769c33294b067dafbe858b1": "SELECT NULL AS companion_number\nFROM patients\nWHERE subject_id = 18866;",
    "2024e435133e2efe817fdc1a": "",
    "7244f2d8e5c70022f4884696": "-- Since there is no phone number of a doctor in the schema, the query cannot be executed as requested.\n-- However, to follow the structure of providing a SQL query, we will indicate the correct approach based on the schema.\nSELECT 'Doctor Phone Number' AS result\nFROM patients\nWHERE subject_id = 30826;",
    "f29c341f04a2ef448f0cc363": "SELECT AVG(\n    JULIANDAY(T1.dischtime) - JULIANDAY(T2.admittime)\n) AS avg_days_between\nFROM admissions T1\nJOIN admissions T2 ON T1.subject_id = T2.subject_id AND T2.admittime > T1.dischtime\nWHERE T1.dischtime IS NOT NULL AND T2.admittime IS NOT NULL\nGROUP BY T1.subject_id\nHAVING COUNT(T2.admittime) >= 1\nORDER BY T1.dischtime;",
    "5497eb668de1ff020fd4e774": "SELECT \n    d.label AS equipment_label,\n    COUNT(o.eventid) AS usage_count,\n    SUM(o.value) AS total_output_amount\nFROM \n    outputevents o\nINNER JOIN \n    d_items d ON o.itemid = d.itemid\nGROUP BY \n    d.label\nORDER BY \n    d.label;",
    "c8912477d5181d9a93846c73": "SELECT DISTINCT T1.drug\nFROM prescriptions T1\nINNER JOIN admissions T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN diagnoses_icd T3 ON T2.hadm_id = T3.hadm_id\nWHERE T3.icd_code LIKE 'I10%' -- Assuming I10 series codes represent hypertension\nAND T1.drug LIKE '%headache%' -- Assuming the drug name contains 'headache'\nAND T1.stoptime IS NOT NULL; -- Ensuring the prescription has been stopped",
    "052a50039b6037274420dd8f": "WITH AdmissionPairs AS (\n    SELECT \n        a1.subject_id,\n        a1.admittime AS first_admittime,\n        a1.dischtime AS first_dischtime,\n        a2.admittime AS second_admittime,\n        a2.dischtime AS second_dischtime\n    FROM admissions a1\n    JOIN admissions a2 ON a1.subject_id = a2.subject_id\n    WHERE a2.admittime > a1.admittime\n    AND julianday(a2.admittime) - julianday(a1.admittime) <= 30\n),\nAnesthesiaDurations AS (\n    SELECT \n        subject_id,\n        julianday(second_dischtime) - julianday(second_admittime) AS anesthesia_duration\n    FROM AdmissionPairs\n)\nSELECT \n    AVG(anesthesia_duration) AS average_anesthesia_duration\nFROM AnesthesiaDurations;",
    "8d80b1b9e406fe7a5a097ec2": "SELECT drug, dose_val_rx \nFROM prescriptions \nWHERE subject_id = 10128 AND starttime = '2104-1106 00:00:00';",
    "7669405a2a1666ecbfff8817": "SELECT COUNT(DISTINCT subject_id) AS patient_count\nFROM prescriptions\nWHERE route = 'Copy';",
    "98b8b345de9b31cd2668b9b2": "SELECT AVG(julianday(p.dod) - julianday(p.dob)) AS average_duration\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.marital_status = 'Married' AND p.dod IS NOT NULL;",
    "8bada17662a355a51ea59bda": "SELECT marital_status, COUNT(*) AS patient_count\nFROM admissions\nGROUP BY marital_status;",
    "1b1eb68d8eca94f1888c01df": "select the `drug` column with the specified condition.",
    "20dc30c77f1b416cf280b62b": "SELECT d_items.label\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE chartevents.subject_id = 17667 AND DATE(chartevents.charttime) = DATE('now');",
    "c232e6794bf8d1dbf9ff6a31": "",
    "b4308f599ae4e9243b96c815": "SELECT p.subject_id, p.gender, p.dob, p.dod\nFROM patients p\nJOIN (\n    SELECT subject_id, (strftime('%Y', dischtime) - strftime('%Y', admittime)) - \n           (strftime('%m-%d', dischtime) < strftime('%m-%d', admittime)) AS age\n    FROM admissions\n) a ON p.subject_id = a.subject_id\nWHERE a.age > 50;",
    "0ffa12eb413fe198d8ad5615": "SELECT \n  p.starttime, \n  p.drug, \n  p.dose_val_rx, \n  p.dose_unit_rx, \n  p.route\nFROM \n  prescriptions p\nWHERE \n  p.drug LIKE '%insulin%'\nORDER BY \n  p.starttime DESC\nLIMIT 10;",
    "6d276e472515f3a34e65d3c0": "SELECT \n  CAST(STRFTIME('%Y-%m-%d %H:%M:%S', T1.charttime) AS TEXT) AS most_recent_physician_discussion\nFROM \n  chartevents AS T1\nWHERE \n  T1.itemid = 1  -- Assuming itemid 1 represents a complex case discussion\nORDER BY \n  T1.charttime DESC\nLIMIT 1;",
    "c82edfa2a6b5736bd0ba574c": "WITH PatientsWithAlcoholUse AS (\n    SELECT p.subject_id\n    FROM patients p\n    JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    JOIN d_icd_diagnoses dicd ON d.icd_code = dicd.icd_code\n    WHERE dicd.long_title LIKE '%alcohol%'\n),\nStayDurations AS (\n    SELECT a.subject_id,\n           julianday(a.dischtime) - julianday(a.admittime) AS stay_duration\n    FROM admissions a\n),\nAverageStayDuration AS (\n    SELECT \n        CASE WHEN p.subject_id IN (SELECT subject_id FROM PatientsWithAlcoholUse) THEN 'With Alcohol Use' ELSE 'Without Alcohol Use' END AS alcohol_use,\n        AVG(sd.stay_duration) AS avg_stay_duration\n    FROM StayDurations sd\n    JOIN patients p ON sd.subject_id = p.subject_id\n    GROUP BY alcohol_use\n)\nSELECT *\nFROM AverageStayDuration\nORDER BY avg_stay_duration DESC;",
    "4eb570ece07f38aa85107fcf": "SELECT MIN(ce.charttime) AS next_mri_scan\nFROM chartevents ce\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE ce.subject_id = 77676\nAND di.label LIKE '%MRI%';",
    "cdcda008dc7819a1b0327522": "",
    "c7f3fe77ea11f0bbf111258c": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS remaining_tests\nFROM \n  labevents \nWHERE \n  subject_id = 7742 \n  AND charttime < (SELECT dischtime FROM admissions WHERE subject_id = 7742);",
    "bdec7c306774d6d605d4da77": "WITH RelevantPatients AS (\n    SELECT \n        p.subject_id,\n        c.event_type\n    FROM \n        patients p\n    JOIN \n        cost c ON p.subject_id = c.subject_id\n    WHERE \n        c.event_type IN ('completed', 'delayed')\n),\nICUStayDurations AS (\n    SELECT \n        r.subject_id,\n        r.event_type,\n        (julianday(icu.outtime) - julianday(icu.intime)) AS icu_stay_length\n    FROM \n        RelevantPatients r\n    JOIN \n        icustays icu ON r.subject_id = icu.subject_id\n)\nSELECT \n    SUM(CASE WHEN event_type = 'completed' THEN icu_stay_length ELSE 0 END) - \n    SUM(CASE WHEN event_type = 'delayed' THEN icu_stay_length ELSE 0 END) AS icu_stay_length_difference\nFROM \n    ICUStayDurations;",
    "3edd4a4d0001415835f3d941": "SELECT \n  A.language,\n  COUNT(*) AS total\nFROM \n  patients AS P\n  INNER JOIN admissions AS A ON P.subject_id = A.subject_id\n  INNER JOIN prescriptions AS PR ON A.hadm_id = PR.hadm_id AND P.subject_id = PR.subject_id\nWHERE \n  PR.dose_val_rx > 0\nGROUP BY \n  A.language\nORDER BY \n  total DESC;",
    "e63445c44aa8a8b69bdfb8eb": "",
    "db942f82c8b54c6c40b1d995": "SELECT label \nFROM d_items \nWHERE label LIKE '%rapid action insulin%';",
    "6019c6cfa331a76747e3e179": "SELECT \n  COUNT(DISTINCT a.subject_id) AS count\nFROM \n  admissions a\nJOIN \n  prescriptions p ON a.hadm_id = p.hadm_id\nWHERE \n  p.stoptime IS NOT NULL;",
    "fa5955074cefb8227fce847c": "",
    "2221c6ca4b7bdd6b39d061ab": "SELECT p.gender, COUNT(*) AS total_prescriptions\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'buprenorphine'\nGROUP BY p.gender;",
    "8ed214a3b37b99e4b939b91a": "WITH HypertensionPatients AS (\n  SELECT \n    p.subject_id\n  FROM \n    patients p\n  INNER JOIN \n    diagnoses_icd d ON p.subject_id = d.subject_id\n  INNER JOIN \n    d_icd_diagnoses d2 ON d.icd_code = d2.icd_code\n  WHERE \n    d2.long_title LIKE '%Hypertension%'\n),\nHypertensionMedications AS (\n  SELECT \n    p.subject_id,\n    pr.drug\n  FROM \n    HypertensionPatients p\n  INNER JOIN \n    prescriptions pr ON p.subject_id = pr.subject_id\n)\nSELECT \n  drug, \n  COUNT(*) AS frequency\nFROM \n  HypertensionMedications\nGROUP BY \n  drug\nORDER BY \n  frequency DESC\nLIMIT 1;",
    "c8eb4a1719c5627ddf87792c": "SELECT *\nFROM patients\nWHERE gender = 'Windows embedded standard e sku';",
    "427d21d4ec4e4df52e74038b": "SELECT AVG(cost.cost) AS average_insurance_cost\nFROM cost\nJOIN admissions ON cost.hadm_id = admissions.hadm_id\nWHERE admissions.insurance IS NOT NULL;",
    "9ed9ea6427a74331f8c0ae9f": "SELECT COUNT(*) AS patient_count\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nJOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title LIKE '%hypertension%'\n  AND p.gender = 'F';",
    "f046767dd9ee27d2e46f089a": "SELECT \n    subject_id,\n    hadm_id,\n    charttime,\n    spec_type_desc,\n    test_name,\n    org_name\nFROM \n    microbiologyevents\nWHERE \n    subject_id = 269;",
    "3c5224fd3b9805031e6c563b": "",
    "531d0af347664f410627a0fc": "SELECT COUNT(DISTINCT p.subject_id) AS num_patients_requested_prescription\nFROM prescriptions p\nJOIN admissions a ON p.subject_id = a.subject_id AND p.hadm_id = a.hadm_id;",
    "03f31ef366447668d469435e": "SELECT 'Denver, Colorado' AS location\nFROM patients\nLIMIT 1;",
    "970880ac21066f749bba19ad": "SELECT \n  (CASE \n     WHEN SUM(CASE WHEN discharge_location != admission_location THEN 1 ELSE 0 END) > 0 THEN 'Yes'\n     ELSE 'No'\n   END) AS went_elsewhere\nFROM \n  admissions;",
    "cae9f75aaa264530ca43f2d8": "SELECT \n  'Daily Surgery Schedule: ' || \n  GROUP_CONCAT(\n    strftime('%Y-%m-%d', adm.admittime) || ' (' || \n    COUNT(*) || ' surgeries)' \n  ) AS note\nFROM \n  admissions adm\nWHERE \n  adm.admission_type = 'surgery'\nGROUP BY \n  strftime('%Y-%m-%d', adm.admittime);",
    "4a543d7a5a2b445c6d3832f4": "SELECT me.value, me.valueuom\nFROM microbiologyevents me\nWHERE me.subject_id = 59049 AND me.test_name LIKE '%MRI%';",
    "5b125ca978768d6d90c96817": "SELECT p.*\nFROM patients p\nJOIN (\n    SELECT t.subject_id\n    FROM transfers t\n    WHERE t.careunit = 'MICU'\n    GROUP BY t.subject_id\n    HAVING COUNT(t.transfer_id) > 1\n) subq ON p.subject_id = subq.subject_id;",
    "868f55abba5b9b51520d27e4": "WITH LastMonthEvents AS (\n    SELECT\n        subject_id,\n        hadm_id,\n        icd_code,\n        charttime\n    FROM\n        procedures_icd\n    WHERE\n        charttime >= DATE('now', 'start of month', '-1 month')\n        AND charttime < DATE('now', 'start of month')\n),\nDurationOfAnesthesia AS (\n    SELECT\n        lme.subject_id,\n        lme.icd_code,\n        lme.charttime,\n        (SELECT MAX(outtime) FROM transfers t WHERE t.subject_id = lme.subject_id AND t.intime >= lme.charttime AND t.intime < DATE(lme.charttime, '+1 month')) - lme.charttime AS duration\n    FROM\n        LastMonthEvents lme\n)\nSELECT\n    p.subject_id,\n    d.long_title,\n    doa.duration\nFROM\n    DurationOfAnesthesia doa\nJOIN\n    d_icd_procedures d ON doa.icd_code = d.icd_code\nJOIN\n    patients p ON doa.subject_id = p.subject_id\nORDER BY\n    doa.duration DESC\nLIMIT 1;",
    "1c7aab76fcd16c27eb23677e": "SELECT DISTINCT drug \nFROM prescriptions \nWHERE drug LIKE '%insulin%' AND drug LIKE '%fast acting%';",
    "35e213805db89bbf446e5831": "SELECT le.valuenum AS mri_result\nFROM labevents le\nJOIN d_labitems dl ON le.itemid = dl.itemid\nWHERE le.subject_id = 32163 AND dl.label LIKE '%MRI%';",
    "6a969b626da94022cd09b496": "",
    "54d266747ccc80d0ed29f19e": "SELECT d_items.label\nFROM chartevents\nJOIN d_items ON chartevents.itemid = d_items.itemid\nWHERE chartevents.subject_id = 1242;",
    "bbb7101ab70e7712f9d01ec7": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS gets_pet_ct\nFROM labevents AS le\nINNER JOIN d_labitems AS li ON le.itemid = li.itemid\nWHERE le.subject_id = 19412 AND li.label LIKE '%pet-ct%';",
    "ff8528ddb6bb24fd4ac86a40": "SELECT \n  ie.row_id,\n  ie.subject_id,\n  ie.hadm_id,\n  ie.stay_id,\n  ie.itemid,\n  ie.starttime,\n  ie.totalamount,\n  ie.totalamountuom,\n  di.label\nFROM \n  inputevents ie\n  JOIN d_items di ON ie.itemid = di.itemid\nWHERE \n  di.label LIKE '%Physical Therapy%';",
    "ef75f75beef8f335b9baa3da": "",
    "e9075a46d6776298a18655db": "SELECT DISTINCT d.test_name\nFROM d_icd_procedures d\nJOIN procedures_icd p ON d.icd_code = p.icd_code\nJOIN admissions a ON p.hadm_id = a.hadm_id\nWHERE a.subject_id = 83062 AND p.charttime >= datetime('now', 'start of day') AND p.charttime < datetime('now', 'start of day', '+1 day');",
    "1d9f34f734a17a488fefeebe": "SELECT \n    p.gender, \n    p.dob, \n    p.dod, \n    a.hadm_id, \n    a.admittime, \n    a.dischtime, \n    a.admission_type, \n    a.admission_location, \n    a.discharge_location, \n    a.insurance, \n    a.language, \n    a.marital_status, \n    a.age\nFROM \n    patients p\nINNER JOIN \n    admissions a ON p.subject_id = a.subject_id\nWHERE \n    p.subject_id = 728;",
    "fc91b305e4be2838d4a5b0c5": "WITH AdministeredPotassium AS (\n    SELECT i.subject_id, p.gender\n    FROM inputevents i\n    JOIN d_items di ON i.itemid = di.itemid\n    JOIN patients p ON i.subject_id = p.subject_id\n    WHERE di.label = 'Potassium Chloride (Powder)'\n)\nSELECT gender, COUNT(*) AS count\nFROM AdministeredPotassium\nGROUP BY gender;",
    "235c0b04c31a09d7781e4dac": "WITH PrescriptionsBeforeAfter AS (\n    SELECT \n        p.subject_id,\n        p.hadm_id,\n        p.starttime,\n        p.stoptime,\n        m.charttime,\n        m.value AS growth_rate,\n        CASE \n            WHEN m.charttime < p.starttime THEN 'Before'\n            WHEN m.charttime > p.stoptime THEN 'After'\n            ELSE 'During'\n        END AS period\n    FROM prescriptions p\n    INNER JOIN microbiologyevents m ON p.subject_id = m.subject_id AND p.hadm_id = m.hadm_id\n),\nAverageGrowthRates AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        AVG(CASE WHEN period = 'Before' THEN growth_rate ELSE NULL END) AS avg_growth_rate_before,\n        AVG(CASE WHEN period = 'After' THEN growth_rate ELSE NULL END) AS avg_growth_rate_after\n    FROM PrescriptionsBeforeAfter\n    GROUP BY subject_id, hadm_id\n),\nGrowthRateDifference AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        (avg_growth_rate_after - avg_growth_rate_before) AS growth_rate_diff\n    FROM AverageGrowthRates\n)\nSELECT \n    p.drug,\n    p.dose_val_rx,\n    p.dose_unit_rx,\n    p.route,\n    g.growth_rate_diff\nFROM prescriptions p\nINNER JOIN GrowthRateDifference g ON p.subject_id = g.subject_id AND p.hadm_id = g.hadm_id\nORDER BY g.growth_rate_diff DESC\nLIMIT 1;",
    "930950b0e61480275d875940": "SELECT \n  strftime('%Y-%m-%d', p.dod) AS date_of_death\nFROM \n  patients p\nWHERE \n  p.dod IS NOT NULL \n  AND strftime('%Y-%m-%d', p.dod) = date('now', '-3 days');",
    "48889ad5f102d84349096d62": "SELECT \n  T2.eventtype AS transfer_reason\nFROM \n  icustays AS T1\nINNER JOIN \n  transfers AS T2 ON T1.hadm_id = T2.hadm_id AND T1.subject_id = T2.subject_id\nWHERE \n  T1.stay_id = 239118 AND T2.careunit = 'MICU';",
    "246f8359ba09e783f4e449b4": "SELECT \n    p.gender,\n    COUNT(*) AS patient_count\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'spironolactone'\nGROUP BY p.gender;",
    "14a66c48aae42d8235db66d6": "SELECT p.subject_id, p.gender, p.dob, p.dod\nFROM patients p\nINNER JOIN icustays i ON p.subject_id = i.subject_id\nWHERE i.first_careunit = 'CCU';",
    "6142ac809b4e6d03dc0b2fbc": "SELECT AVG(p.age) AS average_patient_age\nFROM patients p\nJOIN diagnoses_icd d ON p.subject_id = d.subject_id\nWHERE d.icd_code = 'I50';",
    "5ac240bc6491d1ec78be8ab3": "SELECT AVG(p.age) AS average_pet_age\nFROM (\n  SELECT icu.subject_id, julianday(icu.outtime) - julianday(icu.intime) AS icu_days\n  FROM icustays icu\n) AS icu_stays\nJOIN patients p ON icu_stays.subject_id = p.subject_id\nWHERE icu_stays.icu_days > 5;",
    "ec9f9a82be39ce9a1b98770f": "SELECT DISTINCT p.subject_id\nFROM patients p\nINNER JOIN icustays i ON p.subject_id = i.subject_id\nWHERE i.intime >= DATE('now', '-3 years');",
    "92f2bfda6464ad834b3d3668": "WITH ProcAdmissions AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id, \n        p.icd_code,\n        a.dischtime,\n        a2.admittime AS next_admittime\n    FROM procedures_icd p\n    INNER JOIN admissions a ON p.hadm_id = a.hadm_id\n    LEFT JOIN admissions a2 ON p.subject_id = a2.subject_id AND a2.admittime > a.dischtime\n    WHERE a.dischtime IS NOT NULL\n),\nTimeDifferences AS (\n    SELECT \n        icd_code,\n        AVG(JULIANDAY(next_admittime) - JULIANDAY(dischtime)) AS avg_time_diff\n    FROM ProcAdmissions\n    WHERE next_admittime IS NOT NULL\n    GROUP BY icd_code\n)\nSELECT \n    icd_code,\n    avg_time_diff\nFROM TimeDifferences\nORDER BY avg_time_diff\nLIMIT 1;",
    "77fa89ae38c8c39f7c81d4b7": "",
    "c6b1da83d4b63322c4b4c6a9": "SELECT * \nFROM microbiologyevents\nORDER BY charttime DESC\nLIMIT 10;",
    "6713cf24d007377d7e869099": "SELECT DISTINCT T1.drug\nFROM prescriptions AS T1\nJOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nWHERE T2.icd_code LIKE 'I10%'  -- ICD code for Hypertension\nAND (T1.drug LIKE '%acetaminophen%' OR T1.drug LIKE '%ibuprofen%')  -- Medicines for headache\nORDER BY T1.drug;",
    "4d3a84d5c5ed76fcb4951341": "WITH OrganismGrowth AS (\n    SELECT \n        me.org_name,\n        me.charttime,\n        LAG(me.charttime) OVER (PARTITION BY me.subject_id, me.hadm_id ORDER BY me.charttime) AS prev_charttime,\n        LAG(me.value) OVER (PARTITION BY me.subject_id, me.hadm_id ORDER BY me.charttime) AS prev_value\n    FROM \n        microbiologyevents me\n),\nGrowthRates AS (\n    SELECT \n        og.org_name,\n        (og.value - og.prev_value) / (julianday(og.charttime) - julianday(og.prev_charttime)) * 100.0 AS growth_rate\n    FROM \n        OrganismGrowth og\n    WHERE \n        og.prev_value IS NOT NULL AND og.prev_charttime IS NOT NULL\n)\nSELECT \n    ic.first_careunit AS care_unit,\n    AVG(gr.growth_rate) AS avg_growth_rate\nFROM \n    GrowthRates gr\nJOIN \n    microbiologyevents me ON gr.org_name = me.org_name AND gr.charttime = me.charttime\nJOIN \n    icustays ic ON me.subject_id = ic.subject_id AND me.hadm_id = ic.hadm_id\nGROUP BY \n    ic.first_careunit\nORDER BY \n    avg_growth_rate DESC;",
    "1501ae8d8efab085f519b248": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS squirrel_found\nFROM patients\nWHERE gender = 'squirrel';",
    "c8ba34fa5105957a68d936fa": "WITH PatientCosts AS (\n    SELECT \n        p.subject_id,\n        SUM(c.cost) AS total_cost\n    FROM patients p\n    INNER JOIN cost c ON p.subject_id = c.subject_id\n    GROUP BY p.subject_id\n)\nSELECT \n    subject_id,\n    NTILE(10) OVER (ORDER BY total_cost) AS cost_cluster\nFROM PatientCosts\nORDER BY cost_cluster, subject_id;",
    "43dd6a535818b9817b393135": "",
    "c1b6430d833cda363c07e4a4": "SELECT COUNT(*) AS total_expected_admissions\nFROM admissions\nWHERE strftime('%Y-%m', admittime) = strftime('%Y-%m', 'now', '+1 month');",
    "ace343c8a0e67cd244b3d081": "SELECT \n  p.long_title AS procedure_name,\n  MIN(JULIANDAY(a.dischtime) - JULIANDAY(p_i.charttime)) AS shortest_duration\nFROM \n  procedures_icd p_i\nINNER JOIN \n  d_icd_procedures p ON p_i.icd_code = p.icd_code\nINNER JOIN \n  admissions a ON p_i.hadm_id = a.hadm_id\nGROUP BY \n  p.long_title;",
    "a77018c703503d0e6e17cf18": "SELECT T2.label AS ct_scan_result\nFROM labevents AS T1\nINNER JOIN d_labitems AS T2 ON T1.itemid = T2.itemid\nWHERE T1.subject_id = 66015 AND T2.label LIKE '%CT SCAN%';",
    "fe862ff2d922e1153830a746": "SELECT T2.drug, COUNT(*) AS prescription_count\nFROM patients T1\nJOIN prescriptions T2 ON T1.subject_id = T2.subject_id\nWHERE T1.dob > DATE('now', '-18 years')\nGROUP BY T2.drug\nORDER BY prescription_count DESC\nLIMIT 1;",
    "f0d4fd4f9ef83a84556038a0": "",
    "3767ecc6700c56b7e24069df": "SELECT CASE \n           WHEN COUNT(*) > 0 THEN 'Yes'\n           ELSE 'No'\n       END AS reported_covid_test\nFROM microbiologyevents\nWHERE subject_id = 18877 AND test_name = 'COVID-19';",
    "29f11be3511916b829d232f1": "SELECT 'iELTS' AS metric",
    "52c617e596accfe965a74a66": "SELECT \n  p.long_title AS procedure_name,\n  SUM(c.cost) AS total_cost\nFROM \n  cost c\n  INNER JOIN procedures_icd pic ON c.event_id = pic.row_id\n  INNER JOIN d_icd_procedures p ON pic.icd_code = p.icd_code\nWHERE \n  c.event_type = 'Procedure'\n  AND c.chargetime BETWEEN DATE('now', 'start of year') AND DATE('now')\n  AND c.subject_id IN (\n    SELECT \n      a.subject_id\n    FROM \n      admissions a\n    WHERE \n      a.insurance = ' Anthem'\n  )\nGROUP BY \n  p.long_title\nORDER BY \n  total_cost DESC\nLIMIT 5;",
    "51f107a86832910517f841d1": "SELECT \n    ie.starttime AS next_mri_time\nFROM \n    inputevents ie\nINNER JOIN \n    d_items di ON ie.itemid = di.itemid\nWHERE \n    di.label LIKE '%MRI%' \n    AND ie.subject_id = 24894\nORDER BY \n    ie.starttime ASC\nLIMIT 1;",
    "1d6044d33845efb3cb927bac": "SELECT COUNT(DISTINCT p.subject_id) AS total_patients_no_allergies\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nLEFT JOIN diagnoses_icd d ON a.hadm_id = d.hadm_id AND d.icd_code IN ('A15.1', 'A15.2')\nWHERE strftime('%Y', a.admittime) = strftime('%Y', 'now')\nAND d.row_id IS NULL;",
    "d1fadb6c8dd5eec6647e6a16": "SELECT DISTINCT p.subject_id\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN prescriptions pr ON a.hadm_id = pr.hadm_id\nWHERE pr.drug IS NOT NULL;",
    "24eb409247f4e7e43aba26bc": "",
    "f3232c5aa9f8ce5cb43f0a9c": "SELECT \n    AVG(julianday(T2.outtime) - julianday(T2.intime)) AS average_distance\nFROM \n    patients AS T1\nINNER JOIN \n    icustays AS T2 ON T1.subject_id = T2.subject_id;",
    "3086cebf36c3aeee27dd03d9": "SELECT \n    eventtype\nFROM \n    (SELECT \n         eventtype, \n         COUNT(*) as count\n     FROM \n         transfers\n     GROUP BY \n         eventtype)\nWHERE \n    count > (SELECT AVG(count) \n             FROM (SELECT COUNT(*) as count \n                   FROM transfers \n                   GROUP BY eventtype));",
    "ce0d216f4703f4417b14ea58": "SELECT labevents.itemid, d_labitems.label, labevents.charttime, labevents.valuenum, labevents.valueuom\nFROM labevents\nJOIN d_labitems ON labevents.itemid = d_labitems.itemid\nWHERE labevents.subject_id = 18866\nAND d_labitems.label LIKE '%MRI%';",
    "ff24e91af68e8cab47eac8d5": "SELECT gender, COUNT(*) AS patient_count\nFROM patients\nWHERE gender = 'White'\nGROUP BY gender\nHAVING COUNT(*) > 10;",
    "0e0d0ac51d0e88111f25178e": "SELECT mr.test_name, mr.org_name\nFROM microbiologyevents AS mr\nWHERE mr.subject_id = 15257;",
    "817fdd991bf061d43a6caf77": "SELECT d.long_title\nFROM diagnoses_icd di\nJOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title LIKE '%retropharyngeal abscess%'\nORDER BY di.charttime DESC\nLIMIT 1;",
    "1c7189f64663b34996998446": "SELECT p.dob\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nORDER BY (julianday(a.dischtime) - julianday(a.admittime)) DESC\nLIMIT 1;",
    "a3af29b331f6bb117e33572a": "SELECT CASE \n         WHEN COUNT(*) > 0 THEN 'Yes'\n         ELSE 'No'\n       END AS has_covid_19_test_report\nFROM microbiologyevents\nWHERE subject_id = 27964\nAND test_name LIKE '%Covid-19%';",
    "d3c3b021182c355c4e1b80bb": "SELECT \n  spec_type_desc, \n  test_name, \n  org_name \nFROM \n  microbiologyevents \nWHERE \n  subject_id = 8016 \n  AND test_name = 'MRI';",
    "b1408a3b1d78fe9f3e66a6b6": "SELECT insurance\nFROM admissions\nJOIN patients ON admissions.subject_id = patients.subject_id\nWHERE patients.gender = 'White'\nGROUP BY insurance\nORDER BY COUNT(insurance) DESC\nLIMIT 1;",
    "cf7020f0a35629a60da14b9f": "SELECT 'Unknown' AS Religion\nFROM patients\nWHERE 0=1;",
    "fac90dfbb66690536c40e070": "SELECT DISTINCT first_careunit\nFROM icustays\nWHERE first_careunit != 'sicu'\nORDER BY first_careunit DESC\nLIMIT 1;",
    "1b07c4e732cbd5943a9075f4": "SELECT 'The concept of chemical bonds is not directly answerable by the provided database schema.' AS answer;",
    "180f8faf4d285fb9cacfa8db": "",
    "33d9a5f72eefb71b319b35b0": "SELECT drug, dose_val_rx, dose_unit_rx, route\nFROM prescriptions\nWHERE drug = 'atenolol';",
    "fe69454584acd2f3b66e4d04": "",
    "199b2e2acc64428f7e798c47": "SELECT \n  valueuom, \n  SUM(value) AS total_value\nFROM \n  labevents \nWHERE \n  valueuom = 'mL' \nGROUP BY \n  valueuom \nORDER BY \n  total_value DESC \nLIMIT 1;",
    "6d1fb25832dab886945dd8f4": "SELECT \n  CASE \n    WHEN EXISTS (\n      SELECT 1 \n      FROM transfers t \n      INNER JOIN admissions a ON t.hadm_id = a.hadm_id \n      WHERE t.subject_id = 10425 AND t.intime > a.dischtime AND t.eventtype = 'ADMISSION'\n    ) THEN 'Yes' \n    ELSE 'No' \n  END AS has_future_transfer;",
    "dec6c9f45523ef859e8d0977": "SELECT COUNT(*) AS remaining_appointments\nFROM cost\nWHERE subject_id = 28443 AND event_type = 'appointment';",
    "7b472b0ae9e47179115926d5": "SELECT starttime \nFROM prescriptions \nWHERE drug = 'Alcohol Anonymous';",
    "4c6f37b09e9230a451cda980": "SELECT DISTINCT T1.gender\nFROM patients AS T1\nINNER JOIN icustays AS T2 ON T1.subject_id = T2.subject_id\nWHERE T2.first_careunit = 'micu'\nAND T2.intime >= DATE('now', '-1 month')\nAND T2.intime < DATE('now');",
    "9109c1477507cea3a56bc3ea": "SELECT AVG(T2.age) AS average_age\nFROM diagnoses_icd AS T1\nINNER JOIN admissions AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_diagnoses AS T3 ON T1.icd_code = T3.icd_code\nWHERE T3.icd_code = 'K96';",
    "0e4f2f4885ba4659c994247b": "SELECT \n    a.insurance, \n    SUM(c.cost) AS total_cost_spent\nFROM admissions a\nJOIN cost c ON a.hadm_id = c.hadm_id\nGROUP BY a.insurance\nORDER BY total_cost_spent DESC;",
    "289e5edadc5007d6fa2e4a8b": "SELECT COUNT(DISTINCT subject_id) \nFROM transfers \nWHERE eventtype = 'Copy Requested';",
    "2882cabf6e0939d1a7ecca52": "WITH admitted_last_month AS (\n  SELECT p.subject_id, \n         (strftime('%Y', a.admittime) - strftime('%Y', p.dob)) - \n         (strftime('%m-%d', a.admittime) < strftime('%m-%d', p.dob)) AS age\n  FROM patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  WHERE strftime('%Y-%m', a.admittime) = strftime('%Y-%m', date('now', '-1 month'))\n),\nfirst_child_age AS (\n  SELECT age\n  FROM admitted_last_month\n  WHERE age > 0\n  ORDER BY age\n  LIMIT 1\n)\nSELECT age AS median_age\nFROM first_child_age;",
    "6e638207c190b2bfc104c8ce": "SELECT DISTINCT T1.drug\nFROM prescriptions AS T1\nINNER JOIN diagnoses_icd AS T2 ON T1.hadm_id = T2.hadm_id\nINNER JOIN d_icd_diagnoses AS T3 ON T2.icd_code = T3.icd_code\nWHERE T3.long_title LIKE '%Hypertension%' AND T1.drug LIKE '%pain reliever%' OR T1.drug LIKE '%analgesic%';",
    "9813253dbdee465b9e47ac5e": "SELECT charttime \nFROM labevents \nWHERE itemid IN (\n  SELECT itemid \n  FROM d_labitems \n  WHERE label = 'International Organization for Food');",
    "aaded7e531d63261d7e08157": "SELECT T2.route\nFROM patients AS T1\nINNER JOIN prescriptions AS T2\nON T1.subject_id = T2.subject_id\nWHERE T1.gender = 'F' OR T1.gender = 'M'\nGROUP BY T2.route\nHAVING COUNT(T2.route) > 1;",
    "201669edbbf8a7370e1a5bf6": "SELECT * \nFROM prescriptions \nWHERE drug = 'celestone';",
    "5d8d44474b013c5673581998": "SELECT DISTINCT first_careunit AS care_unit\nFROM icustays\nUNION\nSELECT DISTINCT last_careunit AS care_unit\nFROM icustays;",
    "7bc817217b3da62394e8dec8": "SELECT MIN(p.age) AS min_age\nFROM admissions p\nINNER JOIN prescriptions pr ON p.hadm_id = pr.hadm_id\nWHERE pr.drug = 'prochlorperazine maleate';",
    "b5704c126bc27a7b3e42628a": "",
    "8ef1358c8e787e3b1ea7fad0": "SELECT DISTINCT gender\nFROM patients\nWHERE dod IS NULL;",
    "b5f3104776346d61b316a145": "",
    "179bf167c286b5f0fde2a9af": "",
    "62351eb9c74c2c464077bb48": "SELECT COUNT(pi.row_id) AS procedure_count\nFROM icustays i\nINNER JOIN procedures_icd pi ON i.hadm_id = pi.hadm_id\nWHERE i.last_careunit = 'Neuro ICU';",
    "706b02d8754a0238a2b818aa": "WITH RecentDiagnoses AS (\n    SELECT \n        d.subject_id, \n        d.hadm_id, \n        d.charttime, \n        di.long_title AS diagnosis\n    FROM \n        diagnoses_icd d \n    JOIN \n        d_icd_diagnoses di ON d.icd_code = di.icd_code\n),\nRecentProcedures AS (\n    SELECT \n        p.subject_id, \n        p.hadm_id, \n        p.charttime, \n        pr.long_title AS procedure\n    FROM \n        procedures_icd p \n    JOIN \n        d_icd_procedures pr ON p.icd_code = pr.icd_code\n),\nRecentLabResults AS (\n    SELECT \n        l.subject_id, \n        l.hadm_id, \n        l.charttime, \n        di.label AS lab_item, \n        l.valuenum, \n        l.valueuom\n    FROM \n        labevents l \n    JOIN \n        d_labitems di ON l.itemid = di.itemid\n),\nPatientInfo AS (\n    SELECT \n        p.subject_id, \n        p.gender\n    FROM \n        patients p\n    WHERE \n        p.gender = 'F' OR p.gender = 'M'  -- Assuming 'F' and 'M' are used for female and male respectively\n)\nSELECT \n    MAX(CASE WHEN rd.charttime IS NOT NULL THEN rd.charttime END) AS latest_diagnosis_time,\n    MAX(CASE WHEN rp.charttime IS NOT NULL THEN rp.charttime END) AS latest_procedure_time,\n    MAX(CASE WHEN rl.charttime IS NOT NULL THEN rl.charttime END) AS latest_lab_result_time\nFROM \n    PatientInfo pi\nLEFT JOIN \n    RecentDiagnoses rd ON pi.subject_id = rd.subject_id\nLEFT JOIN \n    RecentProcedures rp ON pi.subject_id = rp.subject_id\nLEFT JOIN \n    RecentLabResults rl ON pi.subject_id = rl.subject_id;",
    "5e79f764b9533eb69c07c4d0": "SELECT DISTINCT event_type\nFROM cost\nWHERE event_type = 'discharge';",
    "5c02f7ac0c5c557d72d6fe5f": "",
    "420bccb119240479b01959f1": "-- The question \"Who made the first playstation\" cannot be answered with the provided database schema.\n-- There is no table or field that directly relates to the creator of the first PlayStation.",
    "2036c83624be19f6568997c6": "SELECT p.subject_id, p.gender, p.dob\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE p.gender = 'F' AND a.language = 'Seattle'\nORDER BY p.dob DESC\nLIMIT 1;",
    "241237199afd4ab0bf19fa11": "SELECT drug, COUNT(*) AS frequency\nFROM prescriptions\nWHERE starttime >= DATE('now', 'start of year')\nGROUP BY drug\nORDER BY frequency DESC\nLIMIT 1;",
    "619c0d97069b2720eecadf4c": "SELECT \n  p.route,\n  COUNT(*) AS anesthesia_count\nFROM \n  procedures_icd AS pr\n  INNER JOIN d_icd_procedures AS icd ON pr.icd_code = icd.icd_code\n  INNER JOIN prescriptions AS p ON pr.hadm_id = p.hadm_id AND pr.subject_id = p.subject_id\nWHERE \n  icd.long_title LIKE '%Fusion or Refusion of 2-3 Vertebrae%'\n  AND p.route LIKE '%Anesthesia%'\nGROUP BY \n  p.route\nORDER BY \n  anesthesia_count DESC;",
    "f1e94bfbd8a4acb2b97f0185": "SELECT DISTINCT insurance\nFROM admissions\nWHERE insurance NOT LIKE '%technical%';",
    "1d40c79522236fb151c0465a": "SELECT \n  label AS \"Procedure/Condition\"\nFROM \n  d_icd_procedures\nWHERE \n  long_title LIKE '%ac on chrn grft-vs-host%'\nORDER BY \n  row_id DESC\nLIMIT 10;",
    "d259847dbbc43592b3e84f39": "",
    "b15ea4eb1bb9661e3b9dd6d0": "SELECT \n    icd.icd_code,\n    d.long_title,\n    AVG(icd.charttime - icd.charttime) AS avg_duration\nFROM \n    procedures_icd icd\nINNER JOIN \n    d_icd_procedures d ON icd.icd_code = d.icd_code\nGROUP BY \n    icd.icd_code, d.long_title\nORDER BY \n    avg_duration DESC\nLIMIT 5;",
    "2bfbfac869d7a901aa75a0e7": "SELECT DISTINCT 'USD' AS currency\nFROM patients\nWHERE strftime('%Y', dob) < '2070';",
    "5d836a81b5ce8992269a142c": "SELECT DISTINCT p.gender\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'oseltamivir';",
    "91962d52a73615ffad6e748c": "WITH EmergencyAdmissions AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        admittime,\n        dischtime,\n        (julianday(dischtime) - julianday(admittime)) * 24 * 60 AS anesthesia_duration\n    FROM admissions\n    WHERE admission_type = 'Emergency'\n),\nNonEmergencyAdmissions AS (\n    SELECT \n        subject_id,\n        hadm_id,\n        admittime,\n        dischtime,\n        (julianday(dischtime) - julianday(admittime)) * 24 * 60 AS anesthesia_duration\n    FROM admissions\n    WHERE admission_type != 'Emergency'\n)\nSELECT \n    AVG(E.anesthesia_duration) - AVG(N.anesthesia_duration) AS avg_duration_difference\nFROM EmergencyAdmissions E\nJOIN NonEmergencyAdmissions N ON E.subject_id = N.subject_id;",
    "065b020277adeeaf7b2334bf": "WITH PatientDemographics AS (\n    SELECT\n        p.subject_id,\n        p.gender,\n        strftime('%Y', 'now') - strftime('%Y', p.dob) AS age,\n        p.gender\n    FROM\n        patients p\n),\nTopFiveProcedures AS (\n    SELECT\n        p.icd_code,\n        d.long_title AS procedure,\n        COUNT(*) AS procedure_count\n    FROM\n        procedures_icd p\n    JOIN\n        d_icd_procedures d ON p.icd_code = d.icd_code\n    GROUP BY\n        p.icd_code\n    ORDER BY\n        procedure_count DESC\n    LIMIT 5\n)\nSELECT\n    pd.subject_id,\n    pd.gender,\n    pd.age,\n    tfp.procedure\nFROM\n    PatientDemographics pd\nCROSS JOIN\n    TopFiveProcedures tfp;",
    "1e4e8dd0ff34ae33dcd8af9c": "SELECT \n    d.long_title,\n    COUNT(di.icd_code) AS diagnosis_count\nFROM \n    diagnoses_icd di\nINNER JOIN \n    d_icd_diagnoses d ON di.icd_code = d.icd_code\nGROUP BY \n    d.long_title\nORDER BY \n    diagnosis_count DESC\nLIMIT 10;",
    "acc0c0cdef161a9284612252": "WITH patient_diagnoses AS (\n  SELECT \n    a.subject_id,\n    a.hadm_id,\n    COUNT(d.row_id) AS diagnosis_count\n  FROM \n    admissions a\n  JOIN \n    diagnoses_icd d ON a.hadm_id = d.hadm_id\n  GROUP BY \n    a.subject_id, a.hadm_id\n),\nfiltered_admissions AS (\n  SELECT \n    a.subject_id,\n    a.admittime,\n    a.dischtime,\n    (julianday(a.dischtime) - julianday(a.admittime)) AS anesthesia_duration\n  FROM \n    admissions a\n  JOIN \n    patient_diagnoses pd ON a.subject_id = pd.subject_id AND a.hadm_id = pd.hadm_id\n  WHERE \n    pd.diagnosis_count > 10\n)\nSELECT \n  AVG(anesthesia_duration) AS average_anesthesia_duration\nFROM \n  filtered_admissions;",
    "c9c78d7791bc4da8fbbd4eaa": "SELECT \n    charttime, \n    value, \n    valueuom\nFROM \n    outputevents\nWHERE \n    valueuom LIKE '%audio%';",
    "a24c812c12df25630c3e42a2": "SELECT * FROM patients;",
    "1d55a2cb2075c095159fdcf5": "SELECT \n  dl.label, \n  COUNT(*) as frequency\nFROM \n  labevents le\n  INNER JOIN d_labitems dl ON le.itemid = dl.itemid\nGROUP BY \n  dl.label;",
    "dcb81ae72e1d1a8401a39e97": "SELECT DISTINCT p.drug\nFROM prescriptions p\nINNER JOIN diagnoses_icd d ON p.hadm_id = d.hadm_id\nINNER JOIN d_icd_diagnoses dd ON d.icd_code = dd.icd_code\nWHERE dd.long_title LIKE '%Hypertension%' AND p.drug LIKE '%Headache%';",
    "7850fd4718ef0345b66f16ee": "WITH drug_age AS (\n  SELECT\n    p.drug,\n    a.age\n  FROM\n    prescriptions p\n  JOIN\n    admissions a ON p.hadm_id = a.hadm_id\n),\n\navg_age AS (\n  SELECT\n    drug,\n    AVG(age) AS avg_age\n  FROM\n    drug_age\n  GROUP BY\n    drug\n)\n\nSELECT\n  da.drug,\n  da.age,\n  aa.avg_age\nFROM\n  drug_age da\nJOIN\n  avg_age aa ON da.drug = aa.drug\nORDER BY\n  da.drug, da.age;",
    "6b38a2ea311d353bab0db4b1": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd AS p\nJOIN admissions AS a ON p.hadm_id = a.hadm_id\nWHERE a.age > 65\nAND p.charttime >= (SELECT MIN(charttime) \n                    FROM procedures_icd AS p2 \n                    WHERE p2.hadm_id = p.hadm_id \n                    AND p2.icd_code = p.icd_code\n                    AND p2.charttime >= p.charttime\n                    AND p2.charttime <= (SELECT MAX(charttime) \n                                         FROM procedures_icd AS p3 \n                                         WHERE p3.hadm_id = p.hadm_id \n                                         AND p3.icd_code = p.icd_code\n                                         AND p3.charttime >= p.charttime\n                                         AND p3.charttime <= p.charttime + 2 * 60 * 60)\n                   )\nAND p.charttime <= (SELECT MAX(charttime) \n                    FROM procedures_icd AS p2 \n                    WHERE p2.hadm_id = p.hadm_id \n                    AND p2.icd_code = p.icd_code\n                    AND p2.charttime >= p.charttime\n                    AND p2.charttime <= (SELECT MAX(charttime) \n                                         FROM procedures_icd AS p3 \n                                         WHERE p3.hadm_id = p.hadm_id \n                                         AND p3.icd_code = p.icd_code\n                                         AND p3.charttime >= p.charttime\n                                         AND p3.charttime <= p.charttime + 2 * 60 * 60)\n                   );",
    "e8057790cfb3bf1907c60c42": "SELECT COUNT(*) AS truck_owners\nFROM (\n  SELECT p.subject_id\n  FROM patients p\n  INNER JOIN admissions a ON p.subject_id = a.subject_id\n  WHERE a.admission_location LIKE '%truck%'\n  GROUP BY p.subject_id\n  HAVING COUNT(a.row_id) >= 2\n) AS filtered_patients;",
    "e6a16146de655c76e0a5a66e": "SELECT AVG(T3.cost) AS average_cost\nFROM patients AS T1\nINNER JOIN procedures_icd AS T2 ON T1.subject_id = T2.subject_id\nINNER JOIN cost AS T3 ON T2.row_id = T3.event_id\nWHERE T1.gender = 'Male' OR T1.gender = 'Female'\nAND T3.event_type = 'procedure'\nAND LOWER(T1.dob) LIKE '%boston%';",
    "4d790b43564658ab3b4e0d03": "SELECT COUNT(*) AS procedure_count\nFROM procedures_icd\nINNER JOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code\nWHERE d_icd_procedures.long_title LIKE '%Cardiac Cath Lab%'\nAND strftime('%Y', procedures_icd.charttime) = strftime('%Y', 'now');",
    "9472d82ca22999ff5c901966": "SELECT DISTINCT gender\nFROM patients\nWHERE gender = 'M';",
    "ea02cf51a42cf529313b5bcc": "WITH admitted_patients AS (\n  SELECT p.subject_id\n  FROM patients p\n  JOIN admissions a ON p.subject_id = a.subject_id\n  WHERE strftime('%Y', a.admittime) = strftime('%Y', 'now')\n  GROUP BY p.subject_id\n  HAVING COUNT(a.hadm_id) > 2\n)\nSELECT c.cost AS currency_used\nFROM cost c\nJOIN admitted_patients ap ON c.subject_id = ap.subject_id\nWHERE strftime('%Y', c.chargetime) = strftime('%Y', 'now')\nGROUP BY c.cost\nORDER BY COUNT(c.cost) DESC\nLIMIT 1;",
    "6e494bdfe5023a25242b95f9": "SELECT * \nFROM patients\nWHERE subject_id = 57023;",
    "2336788b39320ddc3aab7dfd": "SELECT DISTINCT label\nFROM d_items\nWHERE label LIKE '%insulin%' AND label LIKE '%fast%';",
    "721452586d364928353c1138": "SELECT \n  l.charttime \nFROM \n  labevents l \nJOIN \n  d_labitems di ON l.itemid = di.itemid \nWHERE \n  l.subject_id = 17462 \n  AND di.label LIKE '%MRI%' \nORDER BY \n  l.charttime DESC \nLIMIT 1;",
    "73fb93b17e794549d7aefcf1": "SELECT DISTINCT p.subject_id\nFROM patients p\nINNER JOIN admissions a ON p.subject_id = a.subject_id\nINNER JOIN diagnoses_icd di ON a.hadm_id = di.hadm_id\nINNER JOIN d_icd_diagnoses d ON di.icd_code = d.icd_code\nWHERE d.long_title LIKE '%pneumonia%';",
    "1920549178d2063f406d999f": "SELECT \n    drug AS drug_manufacturer,\n    COUNT(*) AS total_prescriptions\nFROM \n    prescriptions\nWHERE \n    starttime >= DATE('now', 'start of year')\nGROUP BY \n    drug\nORDER BY \n    total_prescriptions DESC\nLIMIT 5;",
    "346a6b1c95d407dd60ff4583": "SELECT AVG(ce.valuenum) AS avg_blood_glucose\nFROM chartevents ce\nJOIN patients p ON ce.subject_id = p.subject_id\nJOIN d_items di ON ce.itemid = di.itemid\nWHERE di.label = 'Blood Glucose' AND p.gender = 'Male';",
    "d2b91a51e6ef4727feef548d": "SELECT MAX(age) AS oldest_child_age\nFROM admissions\nWHERE admission_type = 'Newborn';",
    "ab60620a256593c8855554f9": "SELECT drug, COUNT(*) AS total_prescriptions\nFROM prescriptions\nWHERE dose_val_rx IN ('100', '500', '1000', '2000', '3000')\nGROUP BY drug\nORDER BY total_prescriptions DESC\nLIMIT 5;",
    "5ff822748f260f0d813bfe27": "SELECT COUNT(*) \nFROM admissions \nWHERE admission_type = 'Referral';",
    "0c7166b81fe901725b7eb628": "WITH ExpectedAdmissions AS (\n    SELECT \n        p.subject_id,\n        a.hadm_id,\n        a.admittime\n    FROM patients p\n    INNER JOIN admissions a ON p.subject_id = a.subject_id\n    WHERE a.admittime BETWEEN DATE('now') AND DATE('now', '+1 month')\n),\nRecentAdmissions AS (\n    SELECT \n        ea.subject_id,\n        ea.hadm_id,\n        ea.admittime,\n        ROW_NUMBER() OVER (PARTITION BY ea.subject_id ORDER BY ea.admittime DESC) as recent_admission\n    FROM ExpectedAdmissions ea\n),\nAdmissionCosts AS (\n    SELECT \n        ra.subject_id,\n        ra.hadm_id,\n        SUM(c.cost) as total_cost\n    FROM RecentAdmissions ra\n    INNER JOIN cost c ON ra.hadm_id = c.hadm_id\n    WHERE ra.recent_admission = 1\n    GROUP BY ra.subject_id, ra.hadm_id\n)\nSELECT \n    ac.subject_id,\n    ac.total_cost\nFROM AdmissionCosts ac;",
    "8597515e0287991c861f671c": "SELECT \n    p.subject_id, \n    p.gender, \n    p.dob, \n    p.dod, \n    a.hadm_id, \n    a.admittime, \n    a.dischtime, \n    a.admission_type, \n    a.admission_location, \n    a.discharge_location, \n    a.insurance, \n    a.language, \n    a.marital_status, \n    a.age\nFROM \n    patients p\nJOIN \n    admissions a ON p.subject_id = a.subject_id;",
    "6d76715f3b8643d188af9795": "SELECT DISTINCT p.gender\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'lidocaine-prilocaine';",
    "c31cb18da6bbbe1066aeb6be": "",
    "dfd68a634cff11f0c7c9dbce": "SELECT \n    c.event_type,\n    c.cost\nFROM \n    cost c\nWHERE \n    c.cost > 10000;",
    "056fb750773e90aa030e9950": "SELECT p.gender AS operating_system\nFROM patients p\nWHERE p.gender = 'Asian'\nGROUP BY p.gender\nORDER BY COUNT(*) DESC\nLIMIT 1;",
    "a596ed8ea35947b5f68e0e42": "",
    "536ee0098a55182b75db4447": "SELECT \n    MAX(julianday(pi.charttime) - julianday(pi.charttime)) AS longest_procedure_duration\nFROM \n    procedures_icd pi\nJOIN \n    d_icd_procedures d ON pi.icd_code = d.icd_code;",
    "b50c0b91629c3e1eb8c1e1bf": "SELECT l.label, e.valuenum, e.valueuom\nFROM labevents e\nJOIN d_labitems l ON e.itemid = l.itemid\nWHERE e.subject_id = 11823 AND l.label LIKE '%MRI%';",
    "6cf1b55a68678674858c540c": "SELECT\n    admission_type,\n    admission_location,\n    discharge_location,\n    insurance,\n    language,\n    marital_status,\n    age,\n    COUNT(*) AS total_admissions\nFROM admissions\nGROUP BY\n    admission_type,\n    admission_location,\n    discharge_location,\n    insurance,\n    language,\n    marital_status,\n    age;",
    "3c480ed464a8bb7f48ac6ad3": "SELECT 'No companion or telephone number information available' AS result;",
    "a56ff0957a284d651e7e8abc": "SELECT \n  admission_type,\n  admission_location,\n  discharge_location,\n  insurance,\n  language,\n  marital_status,\n  age\nFROM admissions;",
    "fde3bbc35e10c13131806d0b": "WITH MagnesiumPatients AS (\n    SELECT\n        p.gender\n    FROM\n        patients p\n        INNER JOIN prescriptions pr ON p.subject_id = pr.subject_id\n    WHERE\n        pr.drug = 'Magnesium Sulfate'\n),\nGenderCounts AS (\n    SELECT\n        gender,\n        COUNT(*) AS count\n    FROM\n        MagnesiumPatients\n    GROUP BY\n        gender\n)\nSELECT\n    gc.gender,\n    gc.count,\n    (gc.count * 1.0 / (SELECT COUNT(*) FROM MagnesiumPatients)) AS percentage\nFROM\n    GenderCounts gc;",
    "706174ad5a8f8d55b224dbdf": "SELECT COUNT(*) \nFROM transfers \nWHERE eventtype = 'Complications';",
    "de4cad0d0244ec1d5096631b": "",
    "35fbd2bb7e73dec7b0390bfd": "",
    "c8423168c30a91e86bd3a8fa": "SELECT label\nFROM d_items\nWHERE label LIKE '%fast-acting insulin%';",
    "7d1731d972d68642a1d92376": "WITH PatientAgeCTE AS (\n    SELECT \n        gender,\n        strftime('%Y', dob) AS year_of_birth,\n        strftime('%Y', 'now') - strftime('%Y', dob) AS current_age\n    FROM \n        patients\n),\nGenderDistributionCTE AS (\n    SELECT \n        year_of_birth,\n        gender,\n        COUNT(*) AS count\n    FROM \n        PatientAgeCTE\n    GROUP BY \n        year_of_birth, gender\n)\nSELECT \n    year_of_birth,\n    gender,\n    count,\n    LAG(count, 1, 0) OVER (PARTITION BY gender ORDER BY year_of_birth) AS previous_year_count,\n    (count - LAG(count, 1, 0) OVER (PARTITION BY gender ORDER BY year_of_birth)) AS change_in_gender_distribution\nFROM \n    GenderDistributionCTE\nWHERE \n    year_of_birth BETWEEN (SELECT MIN(year_of_birth) FROM GenderDistributionCTE) AND (SELECT MAX(year_of_birth) FROM GenderDistributionCTE) + 5\nORDER BY \n    gender, year_of_birth;",
    "7e49fe05e122e02f7b4dbc43": "SELECT \n  CASE \n    WHEN COUNT(*) > 0 THEN 'Yes'\n    ELSE 'No'\n  END AS appointment_today\nFROM \n  labevents\nWHERE \n  subject_id = 64983 \n  AND DATE(charttime) = DATE('now');",
    "6f03fb45abf03355fdf2ebe5": "WITH HypertensionPatients AS (\n    SELECT \n        p.subject_id,\n        p.dob\n    FROM patients p\n    INNER JOIN diagnoses_icd d ON p.subject_id = d.subject_id\n    WHERE d.icd_code = 'I10'\n),\nFirstChildAge AS (\n    SELECT\n        hp.subject_id,\n        (julianday('now') - julianday(hp.dob)) / 365.25 AS age\n    FROM HypertensionPatients hp\n)\nSELECT \n    AVG(fca.age) AS average_age_of_first_child\nFROM (\n    SELECT \n        fca.subject_id,\n        fca.age,\n        ROW_NUMBER() OVER (PARTITION BY fca.subject_id ORDER BY fca.age) AS row_num\n    FROM FirstChildAge fca\n) fca\nWHERE fca.row_num = 1;",
    "b10d95d377e7fd96548c50cd": "SELECT \n    (JULIANDAY(admissions.dischtime) - JULIANDAY(admissions.admittime)) AS duration\nFROM \n    admissions\nWHERE \n    admissions.insurance = 'Medicaid';",
    "04ed4b01566a9c408fc5f3cc": "",
    "e6233b691d261b0b5d750d60": "Select the lab event results (valuenum and valueuom).",
    "542be8111ffc89db7639ec01": "SELECT \n    p.drug, \n    p.dose_val_rx\nFROM \n    prescriptions p\nJOIN \n    admissions a ON p.hadm_id = a.hadm_id\nWHERE \n    a.age > 80\nGROUP BY \n    p.drug, \n    p.dose_val_rx\nORDER BY \n    COUNT(*) DESC\nLIMIT 5;",
    "5feeffebbdb00685b21e88a4": "SELECT AVG(age) AS average_age\nFROM (\n    SELECT \n        p.subject_id,\n        (strftime('%Y', 'now') - strftime('%Y', p.dob)) - \n        (strftime('%m%d', 'now') < strftime('%m%d', p.dob)) AS age\n    FROM patients p\n) AS patient_age\nGROUP BY subject_id;",
    "c98c060929248bcba6628b8e": "",
    "b7b46d74fb37a9539786e740": "SELECT \n    CASE \n        WHEN COUNT(CASE WHEN le.charttime > a.dischtime THEN 1 ELSE NULL END) > 0 THEN 'Yes'\n        ELSE 'No'\n    END AS has_tests_left\nFROM labevents le\nJOIN admissions a ON le.subject_id = a.subject_id\nWHERE le.subject_id = 17667;",
    "1eac08ba1f265c3c327b62c1": "",
    "e4af8f1ba3897fc0635abfa6": "",
    "14dfee8ea5e8f46e6c25dd3b": "SELECT long_title \nFROM d_icd_diagnoses \nWHERE icd_code = '01170';",
    "429abe1449551a068765e97e": "SELECT DISTINCT label \nFROM d_labitems \nWHERE label LIKE '%discharge%' \n   OR label LIKE '%discharge summary%' \n   OR label LIKE '%discharge instructions%';",
    "ba6ba59aff69aa182b6e11ff": "SELECT AVG(value) AS average_speed\nFROM outputevents\nWHERE itemid = (\n    SELECT itemid\n    FROM d_items\n    WHERE label = 'speed in knots'\n)\nAND valueuom = 'knots'\nAND stay_id IN (\n    SELECT stay_id\n    FROM icustays\n    WHERE last_careunit = 'csru'\n);",
    "601cdbff25250c54ae7b604d": "SELECT test_name, spec_type_desc\nFROM microbiologyevents\nWHERE subject_id = 22449 AND DATE(charttime) = DATE('now');",
    "da0649deb95e705d44b3a6bd": "SELECT 'No recipe found in the database.' AS result;",
    "9c12b1908eecc96921e5b09d": "SELECT COUNT(DISTINCT subject_id) \nFROM admissions \nWHERE language = 'english';",
    "dcd918b9b383d4c8b82d525a": "SELECT 'Play nature sounds in the maternity ward to promote relaxation' AS quote\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE a.admission_location = 'Maternity';",
    "39de5025dda78c678bc23c91": "SELECT \n  discharge_location, \n  insurance \nFROM admissions;",
    "d2195d39e2bb7f411ae6ced6": "SELECT DISTINCT drug AS manufacturer\nFROM prescriptions;",
    "542d6858a652ca64dd64426b": "SELECT AVG(age) AS average_age\nFROM patients p\nJOIN admissions a ON p.subject_id = a.subject_id\nWHERE p.gender = 'M';",
    "47b01aea87ca3478567aeb58": "SELECT marital_status\nFROM admissions\nWHERE admission_location = 'HISPANIC OR LATINO' AND language = 'ENGLISH' AND admission_type = 'MARRIED'\nGROUP BY marital_status\nORDER BY COUNT(*) ASC\nLIMIT 1;",
    "068adca6e566c9ea7450afd5": "",
    "0577cc7be3dde491281e4ffb": "SELECT \n    insurance AS original_insurance,\n    -- Assuming there's a way to translate 'insurance' into Greek.\n    -- Here, we use a placeholder for the translation logic.\n    -- In practice, you would replace this with the actual translation function or method.\n    -- For demonstration, we'll just return the original value.\n    insurance AS greek_insurance\nFROM \n    admissions\nWHERE \n    subject_id = 370;",
    "682cc16deee208a0bbd263a1": "SELECT DISTINCT p.gender\nFROM patients p\nJOIN prescriptions pr ON p.subject_id = pr.subject_id\nWHERE pr.drug = 'Multivitamin IV';"
}